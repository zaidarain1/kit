import{g as im,d as ds,e as ne,f as sm,w as Dl,h as Fl,j as yc,k as fo,l as nm,c as Mr,a as Ll,I as _i,A as om,U as am,m as Q,n as cm,o as oc,p as um,q as hm,P as lm,V as Ah,s as fm,D as pm,C as dm,Z as Ch,$ as gm,u as ym,v as co,x as vm,y as $l,z as Lr,B as mm,E as wm,X as hs,F as Ft,G as tr,H as wi,J as ur,K as _m,L as ls,M as Ml,N as bm,O as Em,Q as Im,R as jl,S as xm,T as zl,Y as Ul,W as fs,a0 as ac,a1 as io,a2 as ps,a3 as Sm,a4 as so,a5 as Pm,a6 as Am,a7 as Cm,a8 as Om,a9 as Rm,aa as Ha,ab as Oh,ac as Tm,ad as Nm,ae as Dm,af as Rh,ag as Fm,ah as Lm,ai as $m,aj as Mm,ak as jm,al as zm,am as Um,an as no,ao as ql,ap as ka,aq as qm,ar as Bm}from"./index-1b4dc470.js";import{e as Cr,N as vc}from"./events-90d6e183.js";const Hm=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,km=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,Km=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function Vm(c,r){if(c==="__proto__"||c==="constructor"&&r&&typeof r=="object"&&"prototype"in r){Gm(c);return}return r}function Gm(c){console.warn(`[destr] Dropping "${c}" key to prevent prototype pollution.`)}function Zn(c,r={}){if(typeof c!="string")return c;const i=c.trim();if(c[0]==='"'&&c.at(-1)==='"'&&!c.includes("\\"))return i.slice(1,-1);if(i.length<=9){const n=i.toLowerCase();if(n==="true")return!0;if(n==="false")return!1;if(n==="undefined")return;if(n==="null")return null;if(n==="nan")return Number.NaN;if(n==="infinity")return Number.POSITIVE_INFINITY;if(n==="-infinity")return Number.NEGATIVE_INFINITY}if(!Km.test(c)){if(r.strict)throw new SyntaxError("[destr] Invalid JSON");return c}try{if(Hm.test(c)||km.test(c)){if(r.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(c,Vm)}return JSON.parse(c)}catch(n){if(r.strict)throw n;return c}}function Wm(c){return!c||typeof c.then!="function"?Promise.resolve(c):c}function qt(c,...r){try{return Wm(c(...r))}catch(i){return Promise.reject(i)}}function Jm(c){const r=typeof c;return c===null||r!=="object"&&r!=="function"}function Ym(c){const r=Object.getPrototypeOf(c);return!r||r.isPrototypeOf(Object)}function oo(c){if(Jm(c))return String(c);if(Ym(c)||Array.isArray(c))return JSON.stringify(c);if(typeof c.toJSON=="function")return oo(c.toJSON());throw new Error("[unstorage] Cannot stringify value!")}function Bl(){if(typeof Buffer===void 0)throw new TypeError("[unstorage] Buffer is not supported!")}const cc="base64:";function Xm(c){if(typeof c=="string")return c;Bl();const r=Buffer.from(c).toString("base64");return cc+r}function Zm(c){return typeof c!="string"||!c.startsWith(cc)?c:(Bl(),Buffer.from(c.slice(cc.length),"base64"))}function cr(c){return c?c.split("?")[0].replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""):""}function Qm(...c){return cr(c.join(":"))}function Qn(c){return c=cr(c),c?c+":":""}const e1="memory",t1=()=>{const c=new Map;return{name:e1,options:{},hasItem(r){return c.has(r)},getItem(r){return c.get(r)??null},getItemRaw(r){return c.get(r)??null},setItem(r,i){c.set(r,i)},setItemRaw(r,i){c.set(r,i)},removeItem(r){c.delete(r)},getKeys(){return Array.from(c.keys())},clear(){c.clear()},dispose(){c.clear()}}};function r1(c={}){const r={mounts:{"":c.driver||t1()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},i=m=>{for(const S of r.mountpoints)if(m.startsWith(S))return{base:S,relativeKey:m.slice(S.length),driver:r.mounts[S]};return{base:"",relativeKey:m,driver:r.mounts[""]}},n=(m,S)=>r.mountpoints.filter(O=>O.startsWith(m)||S&&m.startsWith(O)).map(O=>({relativeBase:m.length>O.length?m.slice(O.length):void 0,mountpoint:O,driver:r.mounts[O]})),o=(m,S)=>{if(r.watching){S=cr(S);for(const O of r.watchListeners)O(m,S)}},l=async()=>{if(!r.watching){r.watching=!0;for(const m in r.mounts)r.unwatch[m]=await Th(r.mounts[m],o,m)}},d=async()=>{if(r.watching){for(const m in r.unwatch)await r.unwatch[m]();r.unwatch={},r.watching=!1}},v=(m,S,O)=>{const F=new Map,z=R=>{let K=F.get(R.base);return K||(K={driver:R.driver,base:R.base,items:[]},F.set(R.base,K)),K};for(const R of m){const K=typeof R=="string",re=cr(K?R:R.key),he=K?void 0:R.value,le=K||!R.options?S:{...S,...R.options},fe=i(re);z(fe).items.push({key:re,value:he,relativeKey:fe.relativeKey,options:le})}return Promise.all([...F.values()].map(R=>O(R))).then(R=>R.flat())},b={hasItem(m,S={}){m=cr(m);const{relativeKey:O,driver:F}=i(m);return qt(F.hasItem,O,S)},getItem(m,S={}){m=cr(m);const{relativeKey:O,driver:F}=i(m);return qt(F.getItem,O,S).then(z=>Zn(z))},getItems(m,S){return v(m,S,O=>O.driver.getItems?qt(O.driver.getItems,O.items.map(F=>({key:F.relativeKey,options:F.options})),S).then(F=>F.map(z=>({key:Qm(O.base,z.key),value:Zn(z.value)}))):Promise.all(O.items.map(F=>qt(O.driver.getItem,F.relativeKey,F.options).then(z=>({key:F.key,value:Zn(z)})))))},getItemRaw(m,S={}){m=cr(m);const{relativeKey:O,driver:F}=i(m);return F.getItemRaw?qt(F.getItemRaw,O,S):qt(F.getItem,O,S).then(z=>Zm(z))},async setItem(m,S,O={}){if(S===void 0)return b.removeItem(m);m=cr(m);const{relativeKey:F,driver:z}=i(m);z.setItem&&(await qt(z.setItem,F,oo(S),O),z.watch||o("update",m))},async setItems(m,S){await v(m,S,async O=>{O.driver.setItems&&await qt(O.driver.setItems,O.items.map(F=>({key:F.relativeKey,value:oo(F.value),options:F.options})),S),O.driver.setItem&&await Promise.all(O.items.map(F=>qt(O.driver.setItem,F.relativeKey,oo(F.value),F.options)))})},async setItemRaw(m,S,O={}){if(S===void 0)return b.removeItem(m,O);m=cr(m);const{relativeKey:F,driver:z}=i(m);if(z.setItemRaw)await qt(z.setItemRaw,F,S,O);else if(z.setItem)await qt(z.setItem,F,Xm(S),O);else return;z.watch||o("update",m)},async removeItem(m,S={}){typeof S=="boolean"&&(S={removeMeta:S}),m=cr(m);const{relativeKey:O,driver:F}=i(m);F.removeItem&&(await qt(F.removeItem,O,S),(S.removeMeta||S.removeMata)&&await qt(F.removeItem,O+"$",S),F.watch||o("remove",m))},async getMeta(m,S={}){typeof S=="boolean"&&(S={nativeOnly:S}),m=cr(m);const{relativeKey:O,driver:F}=i(m),z=Object.create(null);if(F.getMeta&&Object.assign(z,await qt(F.getMeta,O,S)),!S.nativeOnly){const R=await qt(F.getItem,O+"$",S).then(K=>Zn(K));R&&typeof R=="object"&&(typeof R.atime=="string"&&(R.atime=new Date(R.atime)),typeof R.mtime=="string"&&(R.mtime=new Date(R.mtime)),Object.assign(z,R))}return z},setMeta(m,S,O={}){return this.setItem(m+"$",S,O)},removeMeta(m,S={}){return this.removeItem(m+"$",S)},async getKeys(m,S={}){m=Qn(m);const O=n(m,!0);let F=[];const z=[];for(const R of O){const re=(await qt(R.driver.getKeys,R.relativeBase,S)).map(he=>R.mountpoint+cr(he)).filter(he=>!F.some(le=>he.startsWith(le)));z.push(...re),F=[R.mountpoint,...F.filter(he=>!he.startsWith(R.mountpoint))]}return m?z.filter(R=>R.startsWith(m)&&!R.endsWith("$")):z.filter(R=>!R.endsWith("$"))},async clear(m,S={}){m=Qn(m),await Promise.all(n(m,!1).map(async O=>{if(O.driver.clear)return qt(O.driver.clear,O.relativeBase,S);if(O.driver.removeItem){const F=await O.driver.getKeys(O.relativeBase||"",S);return Promise.all(F.map(z=>O.driver.removeItem(z,S)))}}))},async dispose(){await Promise.all(Object.values(r.mounts).map(m=>Nh(m)))},async watch(m){return await l(),r.watchListeners.push(m),async()=>{r.watchListeners=r.watchListeners.filter(S=>S!==m),r.watchListeners.length===0&&await d()}},async unwatch(){r.watchListeners=[],await d()},mount(m,S){if(m=Qn(m),m&&r.mounts[m])throw new Error(`already mounted at ${m}`);return m&&(r.mountpoints.push(m),r.mountpoints.sort((O,F)=>F.length-O.length)),r.mounts[m]=S,r.watching&&Promise.resolve(Th(S,o,m)).then(O=>{r.unwatch[m]=O}).catch(console.error),b},async unmount(m,S=!0){m=Qn(m),!(!m||!r.mounts[m])&&(r.watching&&m in r.unwatch&&(r.unwatch[m](),delete r.unwatch[m]),S&&await Nh(r.mounts[m]),r.mountpoints=r.mountpoints.filter(O=>O!==m),delete r.mounts[m])},getMount(m=""){m=cr(m)+":";const S=i(m);return{driver:S.driver,base:S.base}},getMounts(m="",S={}){return m=cr(m),n(m,S.parents).map(F=>({driver:F.driver,base:F.mountpoint}))}};return b}function Th(c,r,i){return c.watch?c.watch((n,o)=>r(n,i+o)):()=>{}}async function Nh(c){typeof c.dispose=="function"&&await qt(c.dispose)}function qi(c){return new Promise((r,i)=>{c.oncomplete=c.onsuccess=()=>r(c.result),c.onabort=c.onerror=()=>i(c.error)})}function Hl(c,r){const i=indexedDB.open(c);i.onupgradeneeded=()=>i.result.createObjectStore(r);const n=qi(i);return(o,l)=>n.then(d=>l(d.transaction(r,o).objectStore(r)))}let Ka;function ks(){return Ka||(Ka=Hl("keyval-store","keyval")),Ka}function Dh(c,r=ks()){return r("readonly",i=>qi(i.get(c)))}function i1(c,r,i=ks()){return i("readwrite",n=>(n.put(r,c),qi(n.transaction)))}function s1(c,r=ks()){return r("readwrite",i=>(i.delete(c),qi(i.transaction)))}function n1(c=ks()){return c("readwrite",r=>(r.clear(),qi(r.transaction)))}function o1(c,r){return c.openCursor().onsuccess=function(){this.result&&(r(this.result),this.result.continue())},qi(c.transaction)}function a1(c=ks()){return c("readonly",r=>{if(r.getAllKeys)return qi(r.getAllKeys());const i=[];return o1(r,n=>i.push(n.key)).then(()=>i)})}const c1=c=>JSON.stringify(c,(r,i)=>typeof i=="bigint"?i.toString()+"n":i),u1=c=>{const r=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,i=c.replace(r,'$1"$2n"$3');return JSON.parse(i,(n,o)=>typeof o=="string"&&o.match(/^\d+n$/)?BigInt(o.substring(0,o.length-1)):o)};function Ks(c){if(typeof c!="string")throw new Error(`Cannot safe json parse value of type ${typeof c}`);try{return u1(c)}catch{return c}}function Ui(c){return typeof c=="string"?c:c1(c)||""}const h1="idb-keyval";var l1=(c={})=>{const r=c.base&&c.base.length>0?`${c.base}:`:"",i=o=>r+o;let n;return c.dbName&&c.storeName&&(n=Hl(c.dbName,c.storeName)),{name:h1,options:c,async hasItem(o){return!(typeof await Dh(i(o),n)>"u")},async getItem(o){return await Dh(i(o),n)??null},setItem(o,l){return i1(i(o),l,n)},removeItem(o){return s1(i(o),n)},getKeys(){return a1(n)},clear(){return n1(n)}}};const f1="WALLET_CONNECT_V2_INDEXED_DB",p1="keyvaluestorage";let d1=class{constructor(){this.indexedDb=r1({driver:l1({dbName:f1,storeName:p1})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(r=>[r.key,r.value])}async getItem(r){const i=await this.indexedDb.getItem(r);if(i!==null)return i}async setItem(r,i){await this.indexedDb.setItem(r,Ui(i))}async removeItem(r){await this.indexedDb.removeItem(r)}};var Va=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ao={exports:{}};(function(){let c;function r(){}c=r,c.prototype.getItem=function(i){return this.hasOwnProperty(i)?String(this[i]):null},c.prototype.setItem=function(i,n){this[i]=String(n)},c.prototype.removeItem=function(i){delete this[i]},c.prototype.clear=function(){const i=this;Object.keys(i).forEach(function(n){i[n]=void 0,delete i[n]})},c.prototype.key=function(i){return i=i||0,Object.keys(this)[i]},c.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof Va<"u"&&Va.localStorage?ao.exports=Va.localStorage:typeof window<"u"&&window.localStorage?ao.exports=window.localStorage:ao.exports=new r})();function g1(c){var r;return[c[0],Ks((r=c[1])!=null?r:"")]}let y1=class{constructor(){this.localStorage=ao.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(g1)}async getItem(r){const i=this.localStorage.getItem(r);if(i!==null)return Ks(i)}async setItem(r,i){this.localStorage.setItem(r,Ui(i))}async removeItem(r){this.localStorage.removeItem(r)}};const v1="wc_storage_version",Fh=1,m1=async(c,r,i)=>{const n=v1,o=await r.getItem(n);if(o&&o>=Fh){i(r);return}const l=await c.getKeys();if(!l.length){i(r);return}const d=[];for(;l.length;){const v=l.shift();if(!v)continue;const b=v.toLowerCase();if(b.includes("wc@")||b.includes("walletconnect")||b.includes("wc_")||b.includes("wallet_connect")){const m=await c.getItem(v);await r.setItem(v,m),d.push(v)}}await r.setItem(n,Fh),i(r),w1(c,d)},w1=async(c,r)=>{r.length&&r.forEach(async i=>{await c.removeItem(i)})};let _1=class{constructor(){this.initialized=!1,this.setInitialized=i=>{this.storage=i,this.initialized=!0};const r=new y1;this.storage=r;try{const i=new d1;m1(r,i,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(r){return await this.initialize(),this.storage.getItem(r)}async setItem(r,i){return await this.initialize(),this.storage.setItem(r,i)}async removeItem(r){return await this.initialize(),this.storage.removeItem(r)}async initialize(){this.initialized||await new Promise(r=>{const i=setInterval(()=>{this.initialized&&(clearInterval(i),r())},20)})}};var gs={},Ls={},Ga={},$s={};let Bi=class{};const b1=Object.freeze(Object.defineProperty({__proto__:null,IEvents:Bi},Symbol.toStringTag,{value:"Module"})),E1=im(b1);var Lh;function I1(){if(Lh)return $s;Lh=1,Object.defineProperty($s,"__esModule",{value:!0}),$s.IHeartBeat=void 0;const c=E1;class r extends c.IEvents{constructor(n){super()}}return $s.IHeartBeat=r,$s}var $h;function kl(){return $h||($h=1,function(c){Object.defineProperty(c,"__esModule",{value:!0}),ds.__exportStar(I1(),c)}(Ga)),Ga}var Wa={},ji={},Mh;function x1(){if(Mh)return ji;Mh=1,Object.defineProperty(ji,"__esModule",{value:!0}),ji.HEARTBEAT_EVENTS=ji.HEARTBEAT_INTERVAL=void 0;const c=ne;return ji.HEARTBEAT_INTERVAL=c.FIVE_SECONDS,ji.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},ji}var jh;function Kl(){return jh||(jh=1,function(c){Object.defineProperty(c,"__esModule",{value:!0}),ds.__exportStar(x1(),c)}(Wa)),Wa}var zh;function S1(){if(zh)return Ls;zh=1,Object.defineProperty(Ls,"__esModule",{value:!0}),Ls.HeartBeat=void 0;const c=ds,r=Cr,i=ne,n=kl(),o=Kl();class l extends n.IHeartBeat{constructor(v){super(v),this.events=new r.EventEmitter,this.interval=o.HEARTBEAT_INTERVAL,this.interval=(v==null?void 0:v.interval)||o.HEARTBEAT_INTERVAL}static init(v){return c.__awaiter(this,void 0,void 0,function*(){const b=new l(v);return yield b.init(),b})}init(){return c.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(v,b){this.events.on(v,b)}once(v,b){this.events.once(v,b)}off(v,b){this.events.off(v,b)}removeListener(v,b){this.events.removeListener(v,b)}initialize(){return c.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),i.toMiliseconds(this.interval))})}pulse(){this.events.emit(o.HEARTBEAT_EVENTS.pulse)}}return Ls.HeartBeat=l,Ls}(function(c){Object.defineProperty(c,"__esModule",{value:!0});const r=ds;r.__exportStar(S1(),c),r.__exportStar(kl(),c),r.__exportStar(Kl(),c)})(gs);var Re={},Ja,Uh;function P1(){if(Uh)return Ja;Uh=1;function c(i){try{return JSON.stringify(i)}catch{return'"[Circular]"'}}Ja=r;function r(i,n,o){var l=o&&o.stringify||c,d=1;if(typeof i=="object"&&i!==null){var v=n.length+d;if(v===1)return i;var b=new Array(v);b[0]=l(i);for(var m=1;m<v;m++)b[m]=l(n[m]);return b.join(" ")}if(typeof i!="string")return i;var S=n.length;if(S===0)return i;for(var O="",F=1-d,z=-1,R=i&&i.length||0,K=0;K<R;){if(i.charCodeAt(K)===37&&K+1<R){switch(z=z>-1?z:0,i.charCodeAt(K+1)){case 100:case 102:if(F>=S||n[F]==null)break;z<K&&(O+=i.slice(z,K)),O+=Number(n[F]),z=K+2,K++;break;case 105:if(F>=S||n[F]==null)break;z<K&&(O+=i.slice(z,K)),O+=Math.floor(Number(n[F])),z=K+2,K++;break;case 79:case 111:case 106:if(F>=S||n[F]===void 0)break;z<K&&(O+=i.slice(z,K));var re=typeof n[F];if(re==="string"){O+="'"+n[F]+"'",z=K+2,K++;break}if(re==="function"){O+=n[F].name||"<anonymous>",z=K+2,K++;break}O+=l(n[F]),z=K+2,K++;break;case 115:if(F>=S)break;z<K&&(O+=i.slice(z,K)),O+=String(n[F]),z=K+2,K++;break;case 37:z<K&&(O+=i.slice(z,K)),O+="%",z=K+2,K++,F--;break}++F}++K}return z===-1?i:(z<R&&(O+=i.slice(z)),O)}return Ja}var Ya,qh;function A1(){if(qh)return Ya;qh=1;const c=P1();Ya=o;const r=de().console||{},i={mapHttpRequest:R,mapHttpResponse:R,wrapRequestSerializer:K,wrapResponseSerializer:K,wrapErrorSerializer:K,req:R,res:R,err:F};function n(L,q){return Array.isArray(L)?L.filter(function(ve){return ve!=="!stdSerializers.err"}):L===!0?Object.keys(q):!1}function o(L){L=L||{},L.browser=L.browser||{};const q=L.browser.transmit;if(q&&typeof q.send!="function")throw Error("pino: transmit option must have a send function");const W=L.browser.write||r;L.browser.write&&(L.browser.asObject=!0);const ve=L.serializers||{},ie=n(L.browser.serialize,ve);let ue=L.browser.serialize;Array.isArray(L.browser.serialize)&&L.browser.serialize.indexOf("!stdSerializers.err")>-1&&(ue=!1);const Te=["error","fatal","warn","info","debug","trace"];typeof W=="function"&&(W.error=W.fatal=W.warn=W.info=W.debug=W.trace=W),L.enabled===!1&&(L.level="silent");const Ue=L.level||"info",y=Object.create(W);y.log||(y.log=re),Object.defineProperty(y,"levelVal",{get:X}),Object.defineProperty(y,"level",{get:ce,set:V});const I={transmit:q,serialize:ie,asObject:L.browser.asObject,levels:Te,timestamp:z(L)};y.levels=o.levels,y.level=Ue,y.setMaxListeners=y.getMaxListeners=y.emit=y.addListener=y.on=y.prependListener=y.once=y.prependOnceListener=y.removeListener=y.removeAllListeners=y.listeners=y.listenerCount=y.eventNames=y.write=y.flush=re,y.serializers=ve,y._serialize=ie,y._stdErrSerialize=ue,y.child=B,q&&(y._logEvent=O());function X(){return this.level==="silent"?1/0:this.levels.values[this.level]}function ce(){return this._level}function V(k){if(k!=="silent"&&!this.levels.values[k])throw Error("unknown level "+k);this._level=k,l(I,y,"error","log"),l(I,y,"fatal","error"),l(I,y,"warn","error"),l(I,y,"info","log"),l(I,y,"debug","log"),l(I,y,"trace","log")}function B(k,G){if(!k)throw new Error("missing bindings for child Pino");G=G||{},ie&&k.serializers&&(G.serializers=k.serializers);const Je=G.serializers;if(ie&&Je){var He=Object.assign({},ve,Je),jr=L.browser.serialize===!0?Object.keys(He):ie;delete k.serializers,b([k],jr,He,this._stdErrSerialize)}function Ie(xt){this._childLevel=(xt._childLevel|0)+1,this.error=m(xt,k,"error"),this.fatal=m(xt,k,"fatal"),this.warn=m(xt,k,"warn"),this.info=m(xt,k,"info"),this.debug=m(xt,k,"debug"),this.trace=m(xt,k,"trace"),He&&(this.serializers=He,this._serialize=jr),q&&(this._logEvent=O([].concat(xt._logEvent.bindings,k)))}return Ie.prototype=this,new Ie(this)}return y}o.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},o.stdSerializers=i,o.stdTimeFunctions=Object.assign({},{nullTime:he,epochTime:le,unixTime:fe,isoTime:pe});function l(L,q,W,ve){const ie=Object.getPrototypeOf(q);q[W]=q.levelVal>q.levels.values[W]?re:ie[W]?ie[W]:r[W]||r[ve]||re,d(L,q,W)}function d(L,q,W){!L.transmit&&q[W]===re||(q[W]=function(ve){return function(){const ue=L.timestamp(),Te=new Array(arguments.length),Ue=Object.getPrototypeOf&&Object.getPrototypeOf(this)===r?r:this;for(var y=0;y<Te.length;y++)Te[y]=arguments[y];if(L.serialize&&!L.asObject&&b(Te,this._serialize,this.serializers,this._stdErrSerialize),L.asObject?ve.call(Ue,v(this,W,Te,ue)):ve.apply(Ue,Te),L.transmit){const I=L.transmit.level||q.level,X=o.levels.values[I],ce=o.levels.values[W];if(ce<X)return;S(this,{ts:ue,methodLevel:W,methodValue:ce,transmitLevel:I,transmitValue:o.levels.values[L.transmit.level||q.level],send:L.transmit.send,val:q.levelVal},Te)}}}(q[W]))}function v(L,q,W,ve){L._serialize&&b(W,L._serialize,L.serializers,L._stdErrSerialize);const ie=W.slice();let ue=ie[0];const Te={};ve&&(Te.time=ve),Te.level=o.levels.values[q];let Ue=(L._childLevel|0)+1;if(Ue<1&&(Ue=1),ue!==null&&typeof ue=="object"){for(;Ue--&&typeof ie[0]=="object";)Object.assign(Te,ie.shift());ue=ie.length?c(ie.shift(),ie):void 0}else typeof ue=="string"&&(ue=c(ie.shift(),ie));return ue!==void 0&&(Te.msg=ue),Te}function b(L,q,W,ve){for(const ie in L)if(ve&&L[ie]instanceof Error)L[ie]=o.stdSerializers.err(L[ie]);else if(typeof L[ie]=="object"&&!Array.isArray(L[ie]))for(const ue in L[ie])q&&q.indexOf(ue)>-1&&ue in W&&(L[ie][ue]=W[ue](L[ie][ue]))}function m(L,q,W){return function(){const ve=new Array(1+arguments.length);ve[0]=q;for(var ie=1;ie<ve.length;ie++)ve[ie]=arguments[ie-1];return L[W].apply(this,ve)}}function S(L,q,W){const ve=q.send,ie=q.ts,ue=q.methodLevel,Te=q.methodValue,Ue=q.val,y=L._logEvent.bindings;b(W,L._serialize||Object.keys(L.serializers),L.serializers,L._stdErrSerialize===void 0?!0:L._stdErrSerialize),L._logEvent.ts=ie,L._logEvent.messages=W.filter(function(I){return y.indexOf(I)===-1}),L._logEvent.level.label=ue,L._logEvent.level.value=Te,ve(ue,L._logEvent,Ue),L._logEvent=O(y)}function O(L){return{ts:0,messages:[],bindings:L||[],level:{label:"",value:0}}}function F(L){const q={type:L.constructor.name,msg:L.message,stack:L.stack};for(const W in L)q[W]===void 0&&(q[W]=L[W]);return q}function z(L){return typeof L.timestamp=="function"?L.timestamp:L.timestamp===!1?he:le}function R(){return{}}function K(L){return L}function re(){}function he(){return!1}function le(){return Date.now()}function fe(){return Math.round(Date.now()/1e3)}function pe(){return new Date(Date.now()).toISOString()}function de(){function L(q){return typeof q<"u"&&q}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return L(self)||L(window)||L(this)||{}}}return Ya}var zi={},Bh;function Vl(){return Bh||(Bh=1,Object.defineProperty(zi,"__esModule",{value:!0}),zi.PINO_CUSTOM_CONTEXT_KEY=zi.PINO_LOGGER_DEFAULTS=void 0,zi.PINO_LOGGER_DEFAULTS={level:"info"},zi.PINO_CUSTOM_CONTEXT_KEY="custom_context"),zi}var er={},Hh;function C1(){if(Hh)return er;Hh=1,Object.defineProperty(er,"__esModule",{value:!0}),er.generateChildLogger=er.formatChildLoggerContext=er.getLoggerContext=er.setBrowserLoggerContext=er.getBrowserLoggerContext=er.getDefaultLoggerOptions=void 0;const c=Vl();function r(v){return Object.assign(Object.assign({},v),{level:(v==null?void 0:v.level)||c.PINO_LOGGER_DEFAULTS.level})}er.getDefaultLoggerOptions=r;function i(v,b=c.PINO_CUSTOM_CONTEXT_KEY){return v[b]||""}er.getBrowserLoggerContext=i;function n(v,b,m=c.PINO_CUSTOM_CONTEXT_KEY){return v[m]=b,v}er.setBrowserLoggerContext=n;function o(v,b=c.PINO_CUSTOM_CONTEXT_KEY){let m="";return typeof v.bindings>"u"?m=i(v,b):m=v.bindings().context||"",m}er.getLoggerContext=o;function l(v,b,m=c.PINO_CUSTOM_CONTEXT_KEY){const S=o(v,m);return S.trim()?`${S}/${b}`:b}er.formatChildLoggerContext=l;function d(v,b,m=c.PINO_CUSTOM_CONTEXT_KEY){const S=l(v,b,m),O=v.child({context:S});return n(O,S,m)}return er.generateChildLogger=d,er}(function(c){Object.defineProperty(c,"__esModule",{value:!0}),c.pino=void 0;const r=ds,i=r.__importDefault(A1());Object.defineProperty(c,"pino",{enumerable:!0,get:function(){return i.default}}),r.__exportStar(Vl(),c),r.__exportStar(C1(),c)})(Re);class O1 extends Bi{constructor(r){super(),this.opts=r,this.protocol="wc",this.version=2}}class R1 extends Bi{constructor(r,i){super(),this.core=r,this.logger=i,this.records=new Map}}class T1{constructor(r,i){this.logger=r,this.core=i}}let N1=class extends Bi{constructor(r,i){super(),this.relayer=r,this.logger=i}},D1=class extends Bi{constructor(r){super()}},F1=class{constructor(r,i,n,o){this.core=r,this.logger=i,this.name=n}};class L1 extends Bi{constructor(r,i){super(),this.relayer=r,this.logger=i}}let $1=class extends Bi{constructor(r,i){super(),this.core=r,this.logger=i}},M1=class{constructor(r,i){this.projectId=r,this.logger=i}},j1=class{constructor(r){this.opts=r,this.protocol="wc",this.version=2}},z1=class{constructor(r){this.client=r}};var mc={},Gl={};(function(c){Object.defineProperty(c,"__esModule",{value:!0});var r=sm,i=Dl;c.DIGEST_LENGTH=64,c.BLOCK_SIZE=128;var n=function(){function v(){this.digestLength=c.DIGEST_LENGTH,this.blockSize=c.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return v.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},v.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},v.prototype.clean=function(){i.wipe(this._buffer),i.wipe(this._tempHi),i.wipe(this._tempLo),this.reset()},v.prototype.update=function(b,m){if(m===void 0&&(m=b.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var S=0;if(this._bytesHashed+=m,this._bufferLength>0){for(;this._bufferLength<c.BLOCK_SIZE&&m>0;)this._buffer[this._bufferLength++]=b[S++],m--;this._bufferLength===this.blockSize&&(l(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(m>=this.blockSize&&(S=l(this._tempHi,this._tempLo,this._stateHi,this._stateLo,b,S,m),m%=this.blockSize);m>0;)this._buffer[this._bufferLength++]=b[S++],m--;return this},v.prototype.finish=function(b){if(!this._finished){var m=this._bytesHashed,S=this._bufferLength,O=m/536870912|0,F=m<<3,z=m%128<112?128:256;this._buffer[S]=128;for(var R=S+1;R<z-8;R++)this._buffer[R]=0;r.writeUint32BE(O,this._buffer,z-8),r.writeUint32BE(F,this._buffer,z-4),l(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,z),this._finished=!0}for(var R=0;R<this.digestLength/8;R++)r.writeUint32BE(this._stateHi[R],b,R*8),r.writeUint32BE(this._stateLo[R],b,R*8+4);return this},v.prototype.digest=function(){var b=new Uint8Array(this.digestLength);return this.finish(b),b},v.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},v.prototype.restoreState=function(b){return this._stateHi.set(b.stateHi),this._stateLo.set(b.stateLo),this._bufferLength=b.bufferLength,b.buffer&&this._buffer.set(b.buffer),this._bytesHashed=b.bytesHashed,this._finished=!1,this},v.prototype.cleanSavedState=function(b){i.wipe(b.stateHi),i.wipe(b.stateLo),b.buffer&&i.wipe(b.buffer),b.bufferLength=0,b.bytesHashed=0},v}();c.SHA512=n;var o=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function l(v,b,m,S,O,F,z){for(var R=m[0],K=m[1],re=m[2],he=m[3],le=m[4],fe=m[5],pe=m[6],de=m[7],L=S[0],q=S[1],W=S[2],ve=S[3],ie=S[4],ue=S[5],Te=S[6],Ue=S[7],y,I,X,ce,V,B,k,G;z>=128;){for(var Je=0;Je<16;Je++){var He=8*Je+F;v[Je]=r.readUint32BE(O,He),b[Je]=r.readUint32BE(O,He+4)}for(var Je=0;Je<80;Je++){var jr=R,Ie=K,xt=re,D=he,N=le,C=fe,u=pe,E=de,ee=L,ge=q,be=W,Ne=ve,Fe=ie,Pe=ue,St=Te,mt=Ue;if(y=de,I=Ue,V=I&65535,B=I>>>16,k=y&65535,G=y>>>16,y=(le>>>14|ie<<32-14)^(le>>>18|ie<<32-18)^(ie>>>41-32|le<<32-(41-32)),I=(ie>>>14|le<<32-14)^(ie>>>18|le<<32-18)^(le>>>41-32|ie<<32-(41-32)),V+=I&65535,B+=I>>>16,k+=y&65535,G+=y>>>16,y=le&fe^~le&pe,I=ie&ue^~ie&Te,V+=I&65535,B+=I>>>16,k+=y&65535,G+=y>>>16,y=o[Je*2],I=o[Je*2+1],V+=I&65535,B+=I>>>16,k+=y&65535,G+=y>>>16,y=v[Je%16],I=b[Je%16],V+=I&65535,B+=I>>>16,k+=y&65535,G+=y>>>16,B+=V>>>16,k+=B>>>16,G+=k>>>16,X=k&65535|G<<16,ce=V&65535|B<<16,y=X,I=ce,V=I&65535,B=I>>>16,k=y&65535,G=y>>>16,y=(R>>>28|L<<32-28)^(L>>>34-32|R<<32-(34-32))^(L>>>39-32|R<<32-(39-32)),I=(L>>>28|R<<32-28)^(R>>>34-32|L<<32-(34-32))^(R>>>39-32|L<<32-(39-32)),V+=I&65535,B+=I>>>16,k+=y&65535,G+=y>>>16,y=R&K^R&re^K&re,I=L&q^L&W^q&W,V+=I&65535,B+=I>>>16,k+=y&65535,G+=y>>>16,B+=V>>>16,k+=B>>>16,G+=k>>>16,E=k&65535|G<<16,mt=V&65535|B<<16,y=D,I=Ne,V=I&65535,B=I>>>16,k=y&65535,G=y>>>16,y=X,I=ce,V+=I&65535,B+=I>>>16,k+=y&65535,G+=y>>>16,B+=V>>>16,k+=B>>>16,G+=k>>>16,D=k&65535|G<<16,Ne=V&65535|B<<16,K=jr,re=Ie,he=xt,le=D,fe=N,pe=C,de=u,R=E,q=ee,W=ge,ve=be,ie=Ne,ue=Fe,Te=Pe,Ue=St,L=mt,Je%16===15)for(var He=0;He<16;He++)y=v[He],I=b[He],V=I&65535,B=I>>>16,k=y&65535,G=y>>>16,y=v[(He+9)%16],I=b[(He+9)%16],V+=I&65535,B+=I>>>16,k+=y&65535,G+=y>>>16,X=v[(He+1)%16],ce=b[(He+1)%16],y=(X>>>1|ce<<32-1)^(X>>>8|ce<<32-8)^X>>>7,I=(ce>>>1|X<<32-1)^(ce>>>8|X<<32-8)^(ce>>>7|X<<32-7),V+=I&65535,B+=I>>>16,k+=y&65535,G+=y>>>16,X=v[(He+14)%16],ce=b[(He+14)%16],y=(X>>>19|ce<<32-19)^(ce>>>61-32|X<<32-(61-32))^X>>>6,I=(ce>>>19|X<<32-19)^(X>>>61-32|ce<<32-(61-32))^(ce>>>6|X<<32-6),V+=I&65535,B+=I>>>16,k+=y&65535,G+=y>>>16,B+=V>>>16,k+=B>>>16,G+=k>>>16,v[He]=k&65535|G<<16,b[He]=V&65535|B<<16}y=R,I=L,V=I&65535,B=I>>>16,k=y&65535,G=y>>>16,y=m[0],I=S[0],V+=I&65535,B+=I>>>16,k+=y&65535,G+=y>>>16,B+=V>>>16,k+=B>>>16,G+=k>>>16,m[0]=R=k&65535|G<<16,S[0]=L=V&65535|B<<16,y=K,I=q,V=I&65535,B=I>>>16,k=y&65535,G=y>>>16,y=m[1],I=S[1],V+=I&65535,B+=I>>>16,k+=y&65535,G+=y>>>16,B+=V>>>16,k+=B>>>16,G+=k>>>16,m[1]=K=k&65535|G<<16,S[1]=q=V&65535|B<<16,y=re,I=W,V=I&65535,B=I>>>16,k=y&65535,G=y>>>16,y=m[2],I=S[2],V+=I&65535,B+=I>>>16,k+=y&65535,G+=y>>>16,B+=V>>>16,k+=B>>>16,G+=k>>>16,m[2]=re=k&65535|G<<16,S[2]=W=V&65535|B<<16,y=he,I=ve,V=I&65535,B=I>>>16,k=y&65535,G=y>>>16,y=m[3],I=S[3],V+=I&65535,B+=I>>>16,k+=y&65535,G+=y>>>16,B+=V>>>16,k+=B>>>16,G+=k>>>16,m[3]=he=k&65535|G<<16,S[3]=ve=V&65535|B<<16,y=le,I=ie,V=I&65535,B=I>>>16,k=y&65535,G=y>>>16,y=m[4],I=S[4],V+=I&65535,B+=I>>>16,k+=y&65535,G+=y>>>16,B+=V>>>16,k+=B>>>16,G+=k>>>16,m[4]=le=k&65535|G<<16,S[4]=ie=V&65535|B<<16,y=fe,I=ue,V=I&65535,B=I>>>16,k=y&65535,G=y>>>16,y=m[5],I=S[5],V+=I&65535,B+=I>>>16,k+=y&65535,G+=y>>>16,B+=V>>>16,k+=B>>>16,G+=k>>>16,m[5]=fe=k&65535|G<<16,S[5]=ue=V&65535|B<<16,y=pe,I=Te,V=I&65535,B=I>>>16,k=y&65535,G=y>>>16,y=m[6],I=S[6],V+=I&65535,B+=I>>>16,k+=y&65535,G+=y>>>16,B+=V>>>16,k+=B>>>16,G+=k>>>16,m[6]=pe=k&65535|G<<16,S[6]=Te=V&65535|B<<16,y=de,I=Ue,V=I&65535,B=I>>>16,k=y&65535,G=y>>>16,y=m[7],I=S[7],V+=I&65535,B+=I>>>16,k+=y&65535,G+=y>>>16,B+=V>>>16,k+=B>>>16,G+=k>>>16,m[7]=de=k&65535|G<<16,S[7]=Ue=V&65535|B<<16,F+=128,z-=128}return F}function d(v){var b=new n;b.update(v);var m=b.digest();return b.clean(),m}c.hash=d})(Gl);(function(c){Object.defineProperty(c,"__esModule",{value:!0}),c.convertSecretKeyToX25519=c.convertPublicKeyToX25519=c.verify=c.sign=c.extractPublicKeyFromSecretKey=c.generateKeyPair=c.generateKeyPairFromSeed=c.SEED_LENGTH=c.SECRET_KEY_LENGTH=c.PUBLIC_KEY_LENGTH=c.SIGNATURE_LENGTH=void 0;const r=Fl,i=Gl,n=Dl;c.SIGNATURE_LENGTH=64,c.PUBLIC_KEY_LENGTH=32,c.SECRET_KEY_LENGTH=64,c.SEED_LENGTH=32;function o(D){const N=new Float64Array(16);if(D)for(let C=0;C<D.length;C++)N[C]=D[C];return N}const l=new Uint8Array(32);l[0]=9;const d=o(),v=o([1]),b=o([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),m=o([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),S=o([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),O=o([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),F=o([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function z(D,N){for(let C=0;C<16;C++)D[C]=N[C]|0}function R(D){let N=1;for(let C=0;C<16;C++){let u=D[C]+N+65535;N=Math.floor(u/65536),D[C]=u-N*65536}D[0]+=N-1+37*(N-1)}function K(D,N,C){const u=~(C-1);for(let E=0;E<16;E++){const ee=u&(D[E]^N[E]);D[E]^=ee,N[E]^=ee}}function re(D,N){const C=o(),u=o();for(let E=0;E<16;E++)u[E]=N[E];R(u),R(u),R(u);for(let E=0;E<2;E++){C[0]=u[0]-65517;for(let ge=1;ge<15;ge++)C[ge]=u[ge]-65535-(C[ge-1]>>16&1),C[ge-1]&=65535;C[15]=u[15]-32767-(C[14]>>16&1);const ee=C[15]>>16&1;C[14]&=65535,K(u,C,1-ee)}for(let E=0;E<16;E++)D[2*E]=u[E]&255,D[2*E+1]=u[E]>>8}function he(D,N){let C=0;for(let u=0;u<32;u++)C|=D[u]^N[u];return(1&C-1>>>8)-1}function le(D,N){const C=new Uint8Array(32),u=new Uint8Array(32);return re(C,D),re(u,N),he(C,u)}function fe(D){const N=new Uint8Array(32);return re(N,D),N[0]&1}function pe(D,N){for(let C=0;C<16;C++)D[C]=N[2*C]+(N[2*C+1]<<8);D[15]&=32767}function de(D,N,C){for(let u=0;u<16;u++)D[u]=N[u]+C[u]}function L(D,N,C){for(let u=0;u<16;u++)D[u]=N[u]-C[u]}function q(D,N,C){let u,E,ee=0,ge=0,be=0,Ne=0,Fe=0,Pe=0,St=0,mt=0,nt=0,$e=0,Xe=0,Ze=0,ot=0,qe=0,Qe=0,De=0,ke=0,ut=0,je=0,Pt=0,Lt=0,Bt=0,Ht=0,jt=0,Wt=0,rr=0,zr=0,Jt=0,Gr=0,ci=0,xi=0,ht=C[0],rt=C[1],lt=C[2],ft=C[3],at=C[4],it=C[5],At=C[6],Ct=C[7],pt=C[8],Ot=C[9],dt=C[10],wt=C[11],gt=C[12],Ye=C[13],Rt=C[14],Tt=C[15];u=N[0],ee+=u*ht,ge+=u*rt,be+=u*lt,Ne+=u*ft,Fe+=u*at,Pe+=u*it,St+=u*At,mt+=u*Ct,nt+=u*pt,$e+=u*Ot,Xe+=u*dt,Ze+=u*wt,ot+=u*gt,qe+=u*Ye,Qe+=u*Rt,De+=u*Tt,u=N[1],ge+=u*ht,be+=u*rt,Ne+=u*lt,Fe+=u*ft,Pe+=u*at,St+=u*it,mt+=u*At,nt+=u*Ct,$e+=u*pt,Xe+=u*Ot,Ze+=u*dt,ot+=u*wt,qe+=u*gt,Qe+=u*Ye,De+=u*Rt,ke+=u*Tt,u=N[2],be+=u*ht,Ne+=u*rt,Fe+=u*lt,Pe+=u*ft,St+=u*at,mt+=u*it,nt+=u*At,$e+=u*Ct,Xe+=u*pt,Ze+=u*Ot,ot+=u*dt,qe+=u*wt,Qe+=u*gt,De+=u*Ye,ke+=u*Rt,ut+=u*Tt,u=N[3],Ne+=u*ht,Fe+=u*rt,Pe+=u*lt,St+=u*ft,mt+=u*at,nt+=u*it,$e+=u*At,Xe+=u*Ct,Ze+=u*pt,ot+=u*Ot,qe+=u*dt,Qe+=u*wt,De+=u*gt,ke+=u*Ye,ut+=u*Rt,je+=u*Tt,u=N[4],Fe+=u*ht,Pe+=u*rt,St+=u*lt,mt+=u*ft,nt+=u*at,$e+=u*it,Xe+=u*At,Ze+=u*Ct,ot+=u*pt,qe+=u*Ot,Qe+=u*dt,De+=u*wt,ke+=u*gt,ut+=u*Ye,je+=u*Rt,Pt+=u*Tt,u=N[5],Pe+=u*ht,St+=u*rt,mt+=u*lt,nt+=u*ft,$e+=u*at,Xe+=u*it,Ze+=u*At,ot+=u*Ct,qe+=u*pt,Qe+=u*Ot,De+=u*dt,ke+=u*wt,ut+=u*gt,je+=u*Ye,Pt+=u*Rt,Lt+=u*Tt,u=N[6],St+=u*ht,mt+=u*rt,nt+=u*lt,$e+=u*ft,Xe+=u*at,Ze+=u*it,ot+=u*At,qe+=u*Ct,Qe+=u*pt,De+=u*Ot,ke+=u*dt,ut+=u*wt,je+=u*gt,Pt+=u*Ye,Lt+=u*Rt,Bt+=u*Tt,u=N[7],mt+=u*ht,nt+=u*rt,$e+=u*lt,Xe+=u*ft,Ze+=u*at,ot+=u*it,qe+=u*At,Qe+=u*Ct,De+=u*pt,ke+=u*Ot,ut+=u*dt,je+=u*wt,Pt+=u*gt,Lt+=u*Ye,Bt+=u*Rt,Ht+=u*Tt,u=N[8],nt+=u*ht,$e+=u*rt,Xe+=u*lt,Ze+=u*ft,ot+=u*at,qe+=u*it,Qe+=u*At,De+=u*Ct,ke+=u*pt,ut+=u*Ot,je+=u*dt,Pt+=u*wt,Lt+=u*gt,Bt+=u*Ye,Ht+=u*Rt,jt+=u*Tt,u=N[9],$e+=u*ht,Xe+=u*rt,Ze+=u*lt,ot+=u*ft,qe+=u*at,Qe+=u*it,De+=u*At,ke+=u*Ct,ut+=u*pt,je+=u*Ot,Pt+=u*dt,Lt+=u*wt,Bt+=u*gt,Ht+=u*Ye,jt+=u*Rt,Wt+=u*Tt,u=N[10],Xe+=u*ht,Ze+=u*rt,ot+=u*lt,qe+=u*ft,Qe+=u*at,De+=u*it,ke+=u*At,ut+=u*Ct,je+=u*pt,Pt+=u*Ot,Lt+=u*dt,Bt+=u*wt,Ht+=u*gt,jt+=u*Ye,Wt+=u*Rt,rr+=u*Tt,u=N[11],Ze+=u*ht,ot+=u*rt,qe+=u*lt,Qe+=u*ft,De+=u*at,ke+=u*it,ut+=u*At,je+=u*Ct,Pt+=u*pt,Lt+=u*Ot,Bt+=u*dt,Ht+=u*wt,jt+=u*gt,Wt+=u*Ye,rr+=u*Rt,zr+=u*Tt,u=N[12],ot+=u*ht,qe+=u*rt,Qe+=u*lt,De+=u*ft,ke+=u*at,ut+=u*it,je+=u*At,Pt+=u*Ct,Lt+=u*pt,Bt+=u*Ot,Ht+=u*dt,jt+=u*wt,Wt+=u*gt,rr+=u*Ye,zr+=u*Rt,Jt+=u*Tt,u=N[13],qe+=u*ht,Qe+=u*rt,De+=u*lt,ke+=u*ft,ut+=u*at,je+=u*it,Pt+=u*At,Lt+=u*Ct,Bt+=u*pt,Ht+=u*Ot,jt+=u*dt,Wt+=u*wt,rr+=u*gt,zr+=u*Ye,Jt+=u*Rt,Gr+=u*Tt,u=N[14],Qe+=u*ht,De+=u*rt,ke+=u*lt,ut+=u*ft,je+=u*at,Pt+=u*it,Lt+=u*At,Bt+=u*Ct,Ht+=u*pt,jt+=u*Ot,Wt+=u*dt,rr+=u*wt,zr+=u*gt,Jt+=u*Ye,Gr+=u*Rt,ci+=u*Tt,u=N[15],De+=u*ht,ke+=u*rt,ut+=u*lt,je+=u*ft,Pt+=u*at,Lt+=u*it,Bt+=u*At,Ht+=u*Ct,jt+=u*pt,Wt+=u*Ot,rr+=u*dt,zr+=u*wt,Jt+=u*gt,Gr+=u*Ye,ci+=u*Rt,xi+=u*Tt,ee+=38*ke,ge+=38*ut,be+=38*je,Ne+=38*Pt,Fe+=38*Lt,Pe+=38*Bt,St+=38*Ht,mt+=38*jt,nt+=38*Wt,$e+=38*rr,Xe+=38*zr,Ze+=38*Jt,ot+=38*Gr,qe+=38*ci,Qe+=38*xi,E=1,u=ee+E+65535,E=Math.floor(u/65536),ee=u-E*65536,u=ge+E+65535,E=Math.floor(u/65536),ge=u-E*65536,u=be+E+65535,E=Math.floor(u/65536),be=u-E*65536,u=Ne+E+65535,E=Math.floor(u/65536),Ne=u-E*65536,u=Fe+E+65535,E=Math.floor(u/65536),Fe=u-E*65536,u=Pe+E+65535,E=Math.floor(u/65536),Pe=u-E*65536,u=St+E+65535,E=Math.floor(u/65536),St=u-E*65536,u=mt+E+65535,E=Math.floor(u/65536),mt=u-E*65536,u=nt+E+65535,E=Math.floor(u/65536),nt=u-E*65536,u=$e+E+65535,E=Math.floor(u/65536),$e=u-E*65536,u=Xe+E+65535,E=Math.floor(u/65536),Xe=u-E*65536,u=Ze+E+65535,E=Math.floor(u/65536),Ze=u-E*65536,u=ot+E+65535,E=Math.floor(u/65536),ot=u-E*65536,u=qe+E+65535,E=Math.floor(u/65536),qe=u-E*65536,u=Qe+E+65535,E=Math.floor(u/65536),Qe=u-E*65536,u=De+E+65535,E=Math.floor(u/65536),De=u-E*65536,ee+=E-1+37*(E-1),E=1,u=ee+E+65535,E=Math.floor(u/65536),ee=u-E*65536,u=ge+E+65535,E=Math.floor(u/65536),ge=u-E*65536,u=be+E+65535,E=Math.floor(u/65536),be=u-E*65536,u=Ne+E+65535,E=Math.floor(u/65536),Ne=u-E*65536,u=Fe+E+65535,E=Math.floor(u/65536),Fe=u-E*65536,u=Pe+E+65535,E=Math.floor(u/65536),Pe=u-E*65536,u=St+E+65535,E=Math.floor(u/65536),St=u-E*65536,u=mt+E+65535,E=Math.floor(u/65536),mt=u-E*65536,u=nt+E+65535,E=Math.floor(u/65536),nt=u-E*65536,u=$e+E+65535,E=Math.floor(u/65536),$e=u-E*65536,u=Xe+E+65535,E=Math.floor(u/65536),Xe=u-E*65536,u=Ze+E+65535,E=Math.floor(u/65536),Ze=u-E*65536,u=ot+E+65535,E=Math.floor(u/65536),ot=u-E*65536,u=qe+E+65535,E=Math.floor(u/65536),qe=u-E*65536,u=Qe+E+65535,E=Math.floor(u/65536),Qe=u-E*65536,u=De+E+65535,E=Math.floor(u/65536),De=u-E*65536,ee+=E-1+37*(E-1),D[0]=ee,D[1]=ge,D[2]=be,D[3]=Ne,D[4]=Fe,D[5]=Pe,D[6]=St,D[7]=mt,D[8]=nt,D[9]=$e,D[10]=Xe,D[11]=Ze,D[12]=ot,D[13]=qe,D[14]=Qe,D[15]=De}function W(D,N){q(D,N,N)}function ve(D,N){const C=o();let u;for(u=0;u<16;u++)C[u]=N[u];for(u=253;u>=0;u--)W(C,C),u!==2&&u!==4&&q(C,C,N);for(u=0;u<16;u++)D[u]=C[u]}function ie(D,N){const C=o();let u;for(u=0;u<16;u++)C[u]=N[u];for(u=250;u>=0;u--)W(C,C),u!==1&&q(C,C,N);for(u=0;u<16;u++)D[u]=C[u]}function ue(D,N){const C=o(),u=o(),E=o(),ee=o(),ge=o(),be=o(),Ne=o(),Fe=o(),Pe=o();L(C,D[1],D[0]),L(Pe,N[1],N[0]),q(C,C,Pe),de(u,D[0],D[1]),de(Pe,N[0],N[1]),q(u,u,Pe),q(E,D[3],N[3]),q(E,E,m),q(ee,D[2],N[2]),de(ee,ee,ee),L(ge,u,C),L(be,ee,E),de(Ne,ee,E),de(Fe,u,C),q(D[0],ge,be),q(D[1],Fe,Ne),q(D[2],Ne,be),q(D[3],ge,Fe)}function Te(D,N,C){for(let u=0;u<4;u++)K(D[u],N[u],C)}function Ue(D,N){const C=o(),u=o(),E=o();ve(E,N[2]),q(C,N[0],E),q(u,N[1],E),re(D,u),D[31]^=fe(C)<<7}function y(D,N,C){z(D[0],d),z(D[1],v),z(D[2],v),z(D[3],d);for(let u=255;u>=0;--u){const E=C[u/8|0]>>(u&7)&1;Te(D,N,E),ue(N,D),ue(D,D),Te(D,N,E)}}function I(D,N){const C=[o(),o(),o(),o()];z(C[0],S),z(C[1],O),z(C[2],v),q(C[3],S,O),y(D,C,N)}function X(D){if(D.length!==c.SEED_LENGTH)throw new Error(`ed25519: seed must be ${c.SEED_LENGTH} bytes`);const N=(0,i.hash)(D);N[0]&=248,N[31]&=127,N[31]|=64;const C=new Uint8Array(32),u=[o(),o(),o(),o()];I(u,N),Ue(C,u);const E=new Uint8Array(64);return E.set(D),E.set(C,32),{publicKey:C,secretKey:E}}c.generateKeyPairFromSeed=X;function ce(D){const N=(0,r.randomBytes)(32,D),C=X(N);return(0,n.wipe)(N),C}c.generateKeyPair=ce;function V(D){if(D.length!==c.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${c.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(D.subarray(32))}c.extractPublicKeyFromSecretKey=V;const B=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function k(D,N){let C,u,E,ee;for(u=63;u>=32;--u){for(C=0,E=u-32,ee=u-12;E<ee;++E)N[E]+=C-16*N[u]*B[E-(u-32)],C=Math.floor((N[E]+128)/256),N[E]-=C*256;N[E]+=C,N[u]=0}for(C=0,E=0;E<32;E++)N[E]+=C-(N[31]>>4)*B[E],C=N[E]>>8,N[E]&=255;for(E=0;E<32;E++)N[E]-=C*B[E];for(u=0;u<32;u++)N[u+1]+=N[u]>>8,D[u]=N[u]&255}function G(D){const N=new Float64Array(64);for(let C=0;C<64;C++)N[C]=D[C];for(let C=0;C<64;C++)D[C]=0;k(D,N)}function Je(D,N){const C=new Float64Array(64),u=[o(),o(),o(),o()],E=(0,i.hash)(D.subarray(0,32));E[0]&=248,E[31]&=127,E[31]|=64;const ee=new Uint8Array(64);ee.set(E.subarray(32),32);const ge=new i.SHA512;ge.update(ee.subarray(32)),ge.update(N);const be=ge.digest();ge.clean(),G(be),I(u,be),Ue(ee,u),ge.reset(),ge.update(ee.subarray(0,32)),ge.update(D.subarray(32)),ge.update(N);const Ne=ge.digest();G(Ne);for(let Fe=0;Fe<32;Fe++)C[Fe]=be[Fe];for(let Fe=0;Fe<32;Fe++)for(let Pe=0;Pe<32;Pe++)C[Fe+Pe]+=Ne[Fe]*E[Pe];return k(ee.subarray(32),C),ee}c.sign=Je;function He(D,N){const C=o(),u=o(),E=o(),ee=o(),ge=o(),be=o(),Ne=o();return z(D[2],v),pe(D[1],N),W(E,D[1]),q(ee,E,b),L(E,E,D[2]),de(ee,D[2],ee),W(ge,ee),W(be,ge),q(Ne,be,ge),q(C,Ne,E),q(C,C,ee),ie(C,C),q(C,C,E),q(C,C,ee),q(C,C,ee),q(D[0],C,ee),W(u,D[0]),q(u,u,ee),le(u,E)&&q(D[0],D[0],F),W(u,D[0]),q(u,u,ee),le(u,E)?-1:(fe(D[0])===N[31]>>7&&L(D[0],d,D[0]),q(D[3],D[0],D[1]),0)}function jr(D,N,C){const u=new Uint8Array(32),E=[o(),o(),o(),o()],ee=[o(),o(),o(),o()];if(C.length!==c.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${c.SIGNATURE_LENGTH} bytes`);if(He(ee,D))return!1;const ge=new i.SHA512;ge.update(C.subarray(0,32)),ge.update(D),ge.update(N);const be=ge.digest();return G(be),y(E,ee,be),I(ee,C.subarray(32)),ue(E,ee),Ue(u,E),!he(C,u)}c.verify=jr;function Ie(D){let N=[o(),o(),o(),o()];if(He(N,D))throw new Error("Ed25519: invalid public key");let C=o(),u=o(),E=N[1];de(C,v,E),L(u,v,E),ve(u,u),q(C,C,u);let ee=new Uint8Array(32);return re(ee,C),ee}c.convertPublicKeyToX25519=Ie;function xt(D){const N=(0,i.hash)(D.subarray(0,32));N[0]&=248,N[31]&=127,N[31]|=64;const C=new Uint8Array(N.subarray(0,32));return(0,n.wipe)(N),C}c.convertSecretKeyToX25519=xt})(mc);const U1="EdDSA",q1="JWT",Wl=".",Jl="base64url",B1="utf8",H1="utf8",k1=":",K1="did",V1="key",kh="base58btc",G1="z",W1="K36",J1=32;function uo(c){return fo(yc(Ui(c),B1),Jl)}function Yl(c){const r=yc(W1,kh),i=G1+fo(nm([r,c]),kh);return[K1,V1,i].join(k1)}function Y1(c){return fo(c,Jl)}function X1(c){return yc([uo(c.header),uo(c.payload)].join(Wl),H1)}function Z1(c){return[uo(c.header),uo(c.payload),Y1(c.signature)].join(Wl)}function Kh(c=Fl.randomBytes(J1)){return mc.generateKeyPairFromSeed(c)}async function Q1(c,r,i,n,o=ne.fromMiliseconds(Date.now())){const l={alg:U1,typ:q1},d=Yl(n.publicKey),v=o+i,b={iss:d,sub:c,aud:r,iat:o,exp:v},m=X1({header:l,payload:b}),S=mc.sign(n.secretKey,m);return Z1({header:l,payload:b,signature:S})}const ew="PARSE_ERROR",tw="INVALID_REQUEST",rw="METHOD_NOT_FOUND",iw="INVALID_PARAMS",Xl="INTERNAL_ERROR",wc="SERVER_ERROR",sw=[-32700,-32600,-32601,-32602,-32603],Hs={[ew]:{code:-32700,message:"Parse error"},[tw]:{code:-32600,message:"Invalid Request"},[rw]:{code:-32601,message:"Method not found"},[iw]:{code:-32602,message:"Invalid params"},[Xl]:{code:-32603,message:"Internal error"},[wc]:{code:-32e3,message:"Server error"}},Zl=wc;function nw(c){return sw.includes(c)}function Vh(c){return Object.keys(Hs).includes(c)?Hs[c]:Hs[Zl]}function ow(c){const r=Object.values(Hs).find(i=>i.code===c);return r||Hs[Zl]}function Ql(c,r,i){return c.message.includes("getaddrinfo ENOTFOUND")||c.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${i} RPC url at ${r}`):c}var ef={},ni={},Gh;function aw(){if(Gh)return ni;Gh=1,Object.defineProperty(ni,"__esModule",{value:!0}),ni.isBrowserCryptoAvailable=ni.getSubtleCrypto=ni.getBrowerCrypto=void 0;function c(){return(Mr===null||Mr===void 0?void 0:Mr.crypto)||(Mr===null||Mr===void 0?void 0:Mr.msCrypto)||{}}ni.getBrowerCrypto=c;function r(){const n=c();return n.subtle||n.webkitSubtle}ni.getSubtleCrypto=r;function i(){return!!c()&&!!r()}return ni.isBrowserCryptoAvailable=i,ni}var oi={},Wh;function cw(){if(Wh)return oi;Wh=1,Object.defineProperty(oi,"__esModule",{value:!0}),oi.isBrowser=oi.isNode=oi.isReactNative=void 0;function c(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}oi.isReactNative=c;function r(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}oi.isNode=r;function i(){return!c()&&!r()}return oi.isBrowser=i,oi}(function(c){Object.defineProperty(c,"__esModule",{value:!0});const r=ds;r.__exportStar(aw(),c),r.__exportStar(cw(),c)})(ef);function tf(c=3){const r=Date.now()*Math.pow(10,c),i=Math.floor(Math.random()*Math.pow(10,c));return r+i}function _c(c=6){return BigInt(tf(c))}function po(c,r,i){return{id:i||tf(),jsonrpc:"2.0",method:c,params:r}}function bc(c,r){return{id:c,jsonrpc:"2.0",result:r}}function go(c,r,i){return{id:c,jsonrpc:"2.0",error:uw(r,i)}}function uw(c,r){return typeof c>"u"?Vh(Xl):(typeof c=="string"&&(c=Object.assign(Object.assign({},Vh(wc)),{message:c})),typeof r<"u"&&(c.data=r),nw(c.code)&&(c=ow(c.code)),c)}class hw{}class lw extends hw{constructor(){super()}}class fw extends lw{constructor(r){super()}}const pw="^https?:",dw="^wss?:";function gw(c){const r=c.match(new RegExp(/^\w+:/,"gi"));if(!(!r||!r.length))return r[0]}function rf(c,r){const i=gw(c);return typeof i>"u"?!1:new RegExp(r).test(i)}function Jh(c){return rf(c,pw)}function Yh(c){return rf(c,dw)}function yw(c){return new RegExp("wss?://localhost(:d{2,5})?").test(c)}function sf(c){return typeof c=="object"&&"id"in c&&"jsonrpc"in c&&c.jsonrpc==="2.0"}function Ec(c){return sf(c)&&"method"in c}function yo(c){return sf(c)&&(ai(c)||$r(c))}function ai(c){return"result"in c}function $r(c){return"error"in c}class Ei extends fw{constructor(r){super(r),this.events=new Cr.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(r),this.connection.connected&&this.registerEventListeners()}async connect(r=this.connection){await this.open(r)}async disconnect(){await this.close()}on(r,i){this.events.on(r,i)}once(r,i){this.events.once(r,i)}off(r,i){this.events.off(r,i)}removeListener(r,i){this.events.removeListener(r,i)}async request(r,i){return this.requestStrict(po(r.method,r.params||[],r.id||_c().toString()),i)}async requestStrict(r,i){return new Promise(async(n,o)=>{if(!this.connection.connected)try{await this.open()}catch(l){o(l)}this.events.on(`${r.id}`,l=>{$r(l)?o(l.error):n(l.result)});try{await this.connection.send(r,i)}catch(l){o(l)}})}setConnection(r=this.connection){return r}onPayload(r){this.events.emit("payload",r),yo(r)?this.events.emit(`${r.id}`,r):this.events.emit("message",{type:r.method,data:r.params})}onClose(r){r&&r.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${r.code} ${r.reason?`(${r.reason})`:""}`)),this.events.emit("disconnect")}async open(r=this.connection){this.connection===r&&this.connection.connected||(this.connection.connected&&this.close(),typeof r=="string"&&(await this.connection.open(r),r=this.connection),this.connection=this.setConnection(r),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",r=>this.onPayload(r)),this.connection.on("close",r=>this.onClose(r)),this.connection.on("error",r=>this.events.emit("error",r)),this.connection.on("register_error",r=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const vw=()=>typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:require("ws"),mw=()=>typeof window<"u",Xh=c=>c.split("?")[0],Zh=10,ww=vw();class _w{constructor(r){if(this.url=r,this.events=new Cr.EventEmitter,this.registering=!1,!Yh(r))throw new Error(`Provided URL is not compatible with WebSocket connection: ${r}`);this.url=r}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(r,i){this.events.on(r,i)}once(r,i){this.events.once(r,i)}off(r,i){this.events.off(r,i)}removeListener(r,i){this.events.removeListener(r,i)}async open(r=this.url){await this.register(r)}async close(){return new Promise((r,i)=>{if(typeof this.socket>"u"){i(new Error("Connection already closed"));return}this.socket.onclose=n=>{this.onClose(n),r()},this.socket.close()})}async send(r,i){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(Ui(r))}catch(n){this.onError(r.id,n)}}register(r=this.url){if(!Yh(r))throw new Error(`Provided URL is not compatible with WebSocket connection: ${r}`);if(this.registering){const i=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=i||this.events.listenerCount("open")>=i)&&this.events.setMaxListeners(i+1),new Promise((n,o)=>{this.events.once("register_error",l=>{this.resetMaxListeners(),o(l)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return o(new Error("WebSocket connection is missing or invalid"));n(this.socket)})})}return this.url=r,this.registering=!0,new Promise((i,n)=>{const o=ef.isReactNative()?void 0:{rejectUnauthorized:!yw(r)},l=new ww(r,[],o);mw()?l.onerror=d=>{const v=d;n(this.emitError(v.error))}:l.on("error",d=>{n(this.emitError(d))}),l.onopen=()=>{this.onOpen(l),i(l)}})}onOpen(r){r.onmessage=i=>this.onPayload(i),r.onclose=i=>this.onClose(i),this.socket=r,this.registering=!1,this.events.emit("open")}onClose(r){this.socket=void 0,this.registering=!1,this.events.emit("close",r)}onPayload(r){if(typeof r.data>"u")return;const i=typeof r.data=="string"?Ks(r.data):r.data;this.events.emit("payload",i)}onError(r,i){const n=this.parseError(i),o=n.message||n.toString(),l=go(r,o);this.events.emit("payload",l)}parseError(r,i=this.url){return Ql(r,Xh(i),"WS")}resetMaxListeners(){this.events.getMaxListeners()>Zh&&this.events.setMaxListeners(Zh)}emitError(r){const i=this.parseError(new Error((r==null?void 0:r.message)||`WebSocket connection failed for host: ${Xh(this.url)}`));return this.events.emit("register_error",i),i}}var ho={exports:{}};ho.exports;(function(c,r){var i=200,n="__lodash_hash_undefined__",o=1,l=2,d=9007199254740991,v="[object Arguments]",b="[object Array]",m="[object AsyncFunction]",S="[object Boolean]",O="[object Date]",F="[object Error]",z="[object Function]",R="[object GeneratorFunction]",K="[object Map]",re="[object Number]",he="[object Null]",le="[object Object]",fe="[object Promise]",pe="[object Proxy]",de="[object RegExp]",L="[object Set]",q="[object String]",W="[object Symbol]",ve="[object Undefined]",ie="[object WeakMap]",ue="[object ArrayBuffer]",Te="[object DataView]",Ue="[object Float32Array]",y="[object Float64Array]",I="[object Int8Array]",X="[object Int16Array]",ce="[object Int32Array]",V="[object Uint8Array]",B="[object Uint8ClampedArray]",k="[object Uint16Array]",G="[object Uint32Array]",Je=/[\\^$.*+?()[\]{}|]/g,He=/^\[object .+?Constructor\]$/,jr=/^(?:0|[1-9]\d*)$/,Ie={};Ie[Ue]=Ie[y]=Ie[I]=Ie[X]=Ie[ce]=Ie[V]=Ie[B]=Ie[k]=Ie[G]=!0,Ie[v]=Ie[b]=Ie[ue]=Ie[S]=Ie[Te]=Ie[O]=Ie[F]=Ie[z]=Ie[K]=Ie[re]=Ie[le]=Ie[de]=Ie[L]=Ie[q]=Ie[ie]=!1;var xt=typeof Mr=="object"&&Mr&&Mr.Object===Object&&Mr,D=typeof self=="object"&&self&&self.Object===Object&&self,N=xt||D||Function("return this")(),C=r&&!r.nodeType&&r,u=C&&!0&&c&&!c.nodeType&&c,E=u&&u.exports===C,ee=E&&xt.process,ge=function(){try{return ee&&ee.binding&&ee.binding("util")}catch{}}(),be=ge&&ge.isTypedArray;function Ne(g,x){for(var U=-1,Y=g==null?0:g.length,Ve=0,me=[];++U<Y;){var et=g[U];x(et,U,g)&&(me[Ve++]=et)}return me}function Fe(g,x){for(var U=-1,Y=x.length,Ve=g.length;++U<Y;)g[Ve+U]=x[U];return g}function Pe(g,x){for(var U=-1,Y=g==null?0:g.length;++U<Y;)if(x(g[U],U,g))return!0;return!1}function St(g,x){for(var U=-1,Y=Array(g);++U<g;)Y[U]=x(U);return Y}function mt(g){return function(x){return g(x)}}function nt(g,x){return g.has(x)}function $e(g,x){return g==null?void 0:g[x]}function Xe(g){var x=-1,U=Array(g.size);return g.forEach(function(Y,Ve){U[++x]=[Ve,Y]}),U}function Ze(g,x){return function(U){return g(x(U))}}function ot(g){var x=-1,U=Array(g.size);return g.forEach(function(Y){U[++x]=Y}),U}var qe=Array.prototype,Qe=Function.prototype,De=Object.prototype,ke=N["__core-js_shared__"],ut=Qe.toString,je=De.hasOwnProperty,Pt=function(){var g=/[^.]+$/.exec(ke&&ke.keys&&ke.keys.IE_PROTO||"");return g?"Symbol(src)_1."+g:""}(),Lt=De.toString,Bt=RegExp("^"+ut.call(je).replace(Je,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ht=E?N.Buffer:void 0,jt=N.Symbol,Wt=N.Uint8Array,rr=De.propertyIsEnumerable,zr=qe.splice,Jt=jt?jt.toStringTag:void 0,Gr=Object.getOwnPropertySymbols,ci=Ht?Ht.isBuffer:void 0,xi=Ze(Object.keys,Object),ht=hr(N,"DataView"),rt=hr(N,"Map"),lt=hr(N,"Promise"),ft=hr(N,"Set"),at=hr(N,"WeakMap"),it=hr(Object,"create"),At=Jr(ht),Ct=Jr(rt),pt=Jr(lt),Ot=Jr(ft),dt=Jr(at),wt=jt?jt.prototype:void 0,gt=wt?wt.valueOf:void 0;function Ye(g){var x=-1,U=g==null?0:g.length;for(this.clear();++x<U;){var Y=g[x];this.set(Y[0],Y[1])}}function Rt(){this.__data__=it?it(null):{},this.size=0}function Tt(g){var x=this.has(g)&&delete this.__data__[g];return this.size-=x?1:0,x}function wo(g){var x=this.__data__;if(it){var U=x[g];return U===n?void 0:U}return je.call(x,g)?x[g]:void 0}function _o(g){var x=this.__data__;return it?x[g]!==void 0:je.call(x,g)}function bo(g,x){var U=this.__data__;return this.size+=this.has(g)?0:1,U[g]=it&&x===void 0?n:x,this}Ye.prototype.clear=Rt,Ye.prototype.delete=Tt,Ye.prototype.get=wo,Ye.prototype.has=_o,Ye.prototype.set=bo;function yr(g){var x=-1,U=g==null?0:g.length;for(this.clear();++x<U;){var Y=g[x];this.set(Y[0],Y[1])}}function Eo(){this.__data__=[],this.size=0}function Io(g){var x=this.__data__,U=Si(x,g);if(U<0)return!1;var Y=x.length-1;return U==Y?x.pop():zr.call(x,U,1),--this.size,!0}function xo(g){var x=this.__data__,U=Si(x,g);return U<0?void 0:x[U][1]}function So(g){return Si(this.__data__,g)>-1}function Po(g,x){var U=this.__data__,Y=Si(U,g);return Y<0?(++this.size,U.push([g,x])):U[Y][1]=x,this}yr.prototype.clear=Eo,yr.prototype.delete=Io,yr.prototype.get=xo,yr.prototype.has=So,yr.prototype.set=Po;function Wr(g){var x=-1,U=g==null?0:g.length;for(this.clear();++x<U;){var Y=g[x];this.set(Y[0],Y[1])}}function ki(){this.size=0,this.__data__={hash:new Ye,map:new(rt||yr),string:new Ye}}function Ao(g){var x=ui(this,g).delete(g);return this.size-=x?1:0,x}function Ki(g){return ui(this,g).get(g)}function Co(g){return ui(this,g).has(g)}function Oo(g,x){var U=ui(this,g),Y=U.size;return U.set(g,x),this.size+=U.size==Y?0:1,this}Wr.prototype.clear=ki,Wr.prototype.delete=Ao,Wr.prototype.get=Ki,Wr.prototype.has=Co,Wr.prototype.set=Oo;function Vi(g){var x=-1,U=g==null?0:g.length;for(this.__data__=new Wr;++x<U;)this.add(g[x])}function Gs(g){return this.__data__.set(g,n),this}function Ws(g){return this.__data__.has(g)}Vi.prototype.add=Vi.prototype.push=Gs,Vi.prototype.has=Ws;function Or(g){var x=this.__data__=new yr(g);this.size=x.size}function Ro(){this.__data__=new yr,this.size=0}function To(g){var x=this.__data__,U=x.delete(g);return this.size=x.size,U}function No(g){return this.__data__.get(g)}function Do(g){return this.__data__.has(g)}function Js(g,x){var U=this.__data__;if(U instanceof yr){var Y=U.__data__;if(!rt||Y.length<i-1)return Y.push([g,x]),this.size=++U.size,this;U=this.__data__=new Wr(Y)}return U.set(g,x),this.size=U.size,this}Or.prototype.clear=Ro,Or.prototype.delete=To,Or.prototype.get=No,Or.prototype.has=Do,Or.prototype.set=Js;function Ys(g,x){var U=Ji(g),Y=!U&&un(g),Ve=!U&&!Y&&ms(g),me=!U&&!Y&&!Ve&&fn(g),et=U||Y||Ve||me,Nt=et?St(g.length,String):[],Ce=Nt.length;for(var Ge in g)(x||je.call(g,Ge))&&!(et&&(Ge=="length"||Ve&&(Ge=="offset"||Ge=="parent")||me&&(Ge=="buffer"||Ge=="byteLength"||Ge=="byteOffset")||sn(Ge,Ce)))&&Nt.push(Ge);return Nt}function Si(g,x){for(var U=g.length;U--;)if(cn(g[U][0],x))return U;return-1}function ys(g,x,U){var Y=x(g);return Ji(g)?Y:Fe(Y,U(g))}function Pi(g){return g==null?g===void 0?ve:he:Jt&&Jt in Object(g)?tn(g):$o(g)}function vs(g){return Ci(g)&&Pi(g)==v}function Ai(g,x,U,Y,Ve){return g===x?!0:g==null||x==null||!Ci(g)&&!Ci(x)?g!==g&&x!==x:Xs(g,x,U,Y,Ai,Ve)}function Xs(g,x,U,Y,Ve,me){var et=Ji(g),Nt=Ji(x),Ce=et?b:Ur(g),Ge=Nt?b:Ur(x);Ce=Ce==v?le:Ce,Ge=Ge==v?le:Ge;var _t=Ce==le,ir=Ge==le,Dt=Ce==Ge;if(Dt&&ms(g)){if(!ms(x))return!1;et=!0,_t=!1}if(Dt&&!_t)return me||(me=new Or),et||fn(g)?Gi(g,x,U,Y,Ve,me):Lo(g,x,Ce,U,Y,Ve,me);if(!(U&o)){var tt=_t&&je.call(g,"__wrapped__"),Yt=ir&&je.call(x,"__wrapped__");if(tt||Yt){var Rr=tt?g.value():g,vr=Yt?x.value():x;return me||(me=new Or),Ve(Rr,vr,U,Y,me)}}return Dt?(me||(me=new Or),en(g,x,U,Y,Ve,me)):!1}function Fo(g){if(!ln(g)||on(g))return!1;var x=Yi(g)?Bt:He;return x.test(Jr(g))}function Zs(g){return Ci(g)&&hn(g.length)&&!!Ie[Pi(g)]}function Qs(g){if(!an(g))return xi(g);var x=[];for(var U in Object(g))je.call(g,U)&&U!="constructor"&&x.push(U);return x}function Gi(g,x,U,Y,Ve,me){var et=U&o,Nt=g.length,Ce=x.length;if(Nt!=Ce&&!(et&&Ce>Nt))return!1;var Ge=me.get(g);if(Ge&&me.get(x))return Ge==x;var _t=-1,ir=!0,Dt=U&l?new Vi:void 0;for(me.set(g,x),me.set(x,g);++_t<Nt;){var tt=g[_t],Yt=x[_t];if(Y)var Rr=et?Y(Yt,tt,_t,x,g,me):Y(tt,Yt,_t,g,x,me);if(Rr!==void 0){if(Rr)continue;ir=!1;break}if(Dt){if(!Pe(x,function(vr,qr){if(!nt(Dt,qr)&&(tt===vr||Ve(tt,vr,U,Y,me)))return Dt.push(qr)})){ir=!1;break}}else if(!(tt===Yt||Ve(tt,Yt,U,Y,me))){ir=!1;break}}return me.delete(g),me.delete(x),ir}function Lo(g,x,U,Y,Ve,me,et){switch(U){case Te:if(g.byteLength!=x.byteLength||g.byteOffset!=x.byteOffset)return!1;g=g.buffer,x=x.buffer;case ue:return!(g.byteLength!=x.byteLength||!me(new Wt(g),new Wt(x)));case S:case O:case re:return cn(+g,+x);case F:return g.name==x.name&&g.message==x.message;case de:case q:return g==x+"";case K:var Nt=Xe;case L:var Ce=Y&o;if(Nt||(Nt=ot),g.size!=x.size&&!Ce)return!1;var Ge=et.get(g);if(Ge)return Ge==x;Y|=l,et.set(g,x);var _t=Gi(Nt(g),Nt(x),Y,Ve,me,et);return et.delete(g),_t;case W:if(gt)return gt.call(g)==gt.call(x)}return!1}function en(g,x,U,Y,Ve,me){var et=U&o,Nt=Wi(g),Ce=Nt.length,Ge=Wi(x),_t=Ge.length;if(Ce!=_t&&!et)return!1;for(var ir=Ce;ir--;){var Dt=Nt[ir];if(!(et?Dt in x:je.call(x,Dt)))return!1}var tt=me.get(g);if(tt&&me.get(x))return tt==x;var Yt=!0;me.set(g,x),me.set(x,g);for(var Rr=et;++ir<Ce;){Dt=Nt[ir];var vr=g[Dt],qr=x[Dt];if(Y)var ws=et?Y(qr,vr,Dt,x,g,me):Y(vr,qr,Dt,g,x,me);if(!(ws===void 0?vr===qr||Ve(vr,qr,U,Y,me):ws)){Yt=!1;break}Rr||(Rr=Dt=="constructor")}if(Yt&&!Rr){var Oi=g.constructor,zt=x.constructor;Oi!=zt&&"constructor"in g&&"constructor"in x&&!(typeof Oi=="function"&&Oi instanceof Oi&&typeof zt=="function"&&zt instanceof zt)&&(Yt=!1)}return me.delete(g),me.delete(x),Yt}function Wi(g){return ys(g,zo,rn)}function ui(g,x){var U=g.__data__;return nn(x)?U[typeof x=="string"?"string":"hash"]:U.map}function hr(g,x){var U=$e(g,x);return Fo(U)?U:void 0}function tn(g){var x=je.call(g,Jt),U=g[Jt];try{g[Jt]=void 0;var Y=!0}catch{}var Ve=Lt.call(g);return Y&&(x?g[Jt]=U:delete g[Jt]),Ve}var rn=Gr?function(g){return g==null?[]:(g=Object(g),Ne(Gr(g),function(x){return rr.call(g,x)}))}:Ke,Ur=Pi;(ht&&Ur(new ht(new ArrayBuffer(1)))!=Te||rt&&Ur(new rt)!=K||lt&&Ur(lt.resolve())!=fe||ft&&Ur(new ft)!=L||at&&Ur(new at)!=ie)&&(Ur=function(g){var x=Pi(g),U=x==le?g.constructor:void 0,Y=U?Jr(U):"";if(Y)switch(Y){case At:return Te;case Ct:return K;case pt:return fe;case Ot:return L;case dt:return ie}return x});function sn(g,x){return x=x??d,!!x&&(typeof g=="number"||jr.test(g))&&g>-1&&g%1==0&&g<x}function nn(g){var x=typeof g;return x=="string"||x=="number"||x=="symbol"||x=="boolean"?g!=="__proto__":g===null}function on(g){return!!Pt&&Pt in g}function an(g){var x=g&&g.constructor,U=typeof x=="function"&&x.prototype||De;return g===U}function $o(g){return Lt.call(g)}function Jr(g){if(g!=null){try{return ut.call(g)}catch{}try{return g+""}catch{}}return""}function cn(g,x){return g===x||g!==g&&x!==x}var un=vs(function(){return arguments}())?vs:function(g){return Ci(g)&&je.call(g,"callee")&&!rr.call(g,"callee")},Ji=Array.isArray;function Mo(g){return g!=null&&hn(g.length)&&!Yi(g)}var ms=ci||Be;function jo(g,x){return Ai(g,x)}function Yi(g){if(!ln(g))return!1;var x=Pi(g);return x==z||x==R||x==m||x==pe}function hn(g){return typeof g=="number"&&g>-1&&g%1==0&&g<=d}function ln(g){var x=typeof g;return g!=null&&(x=="object"||x=="function")}function Ci(g){return g!=null&&typeof g=="object"}var fn=be?mt(be):Zs;function zo(g){return Mo(g)?Ys(g):Qs(g)}function Ke(){return[]}function Be(){return!1}c.exports=jo})(ho,ho.exports);var bw=ho.exports;const Ew=Ll(bw);function Iw(c,r){if(c.length>=255)throw new TypeError("Alphabet too long");for(var i=new Uint8Array(256),n=0;n<i.length;n++)i[n]=255;for(var o=0;o<c.length;o++){var l=c.charAt(o),d=l.charCodeAt(0);if(i[d]!==255)throw new TypeError(l+" is ambiguous");i[d]=o}var v=c.length,b=c.charAt(0),m=Math.log(v)/Math.log(256),S=Math.log(256)/Math.log(v);function O(R){if(R instanceof Uint8Array||(ArrayBuffer.isView(R)?R=new Uint8Array(R.buffer,R.byteOffset,R.byteLength):Array.isArray(R)&&(R=Uint8Array.from(R))),!(R instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(R.length===0)return"";for(var K=0,re=0,he=0,le=R.length;he!==le&&R[he]===0;)he++,K++;for(var fe=(le-he)*S+1>>>0,pe=new Uint8Array(fe);he!==le;){for(var de=R[he],L=0,q=fe-1;(de!==0||L<re)&&q!==-1;q--,L++)de+=256*pe[q]>>>0,pe[q]=de%v>>>0,de=de/v>>>0;if(de!==0)throw new Error("Non-zero carry");re=L,he++}for(var W=fe-re;W!==fe&&pe[W]===0;)W++;for(var ve=b.repeat(K);W<fe;++W)ve+=c.charAt(pe[W]);return ve}function F(R){if(typeof R!="string")throw new TypeError("Expected String");if(R.length===0)return new Uint8Array;var K=0;if(R[K]!==" "){for(var re=0,he=0;R[K]===b;)re++,K++;for(var le=(R.length-K)*m+1>>>0,fe=new Uint8Array(le);R[K];){var pe=i[R.charCodeAt(K)];if(pe===255)return;for(var de=0,L=le-1;(pe!==0||de<he)&&L!==-1;L--,de++)pe+=v*fe[L]>>>0,fe[L]=pe%256>>>0,pe=pe/256>>>0;if(pe!==0)throw new Error("Non-zero carry");he=de,K++}if(R[K]!==" "){for(var q=le-he;q!==le&&fe[q]===0;)q++;for(var W=new Uint8Array(re+(le-q)),ve=re;q!==le;)W[ve++]=fe[q++];return W}}}function z(R){var K=F(R);if(K)return K;throw new Error(`Non-${r} character`)}return{encode:O,decodeUnsafe:F,decode:z}}var xw=Iw,Sw=xw;const nf=c=>{if(c instanceof Uint8Array&&c.constructor.name==="Uint8Array")return c;if(c instanceof ArrayBuffer)return new Uint8Array(c);if(ArrayBuffer.isView(c))return new Uint8Array(c.buffer,c.byteOffset,c.byteLength);throw new Error("Unknown type, must be binary type")},Pw=c=>new TextEncoder().encode(c),Aw=c=>new TextDecoder().decode(c);class Cw{constructor(r,i,n){this.name=r,this.prefix=i,this.baseEncode=n}encode(r){if(r instanceof Uint8Array)return`${this.prefix}${this.baseEncode(r)}`;throw Error("Unknown type, must be binary type")}}class Ow{constructor(r,i,n){if(this.name=r,this.prefix=i,i.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=i.codePointAt(0),this.baseDecode=n}decode(r){if(typeof r=="string"){if(r.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(r)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(r.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(r){return of(this,r)}}class Rw{constructor(r){this.decoders=r}or(r){return of(this,r)}decode(r){const i=r[0],n=this.decoders[i];if(n)return n.decode(r);throw RangeError(`Unable to decode multibase string ${JSON.stringify(r)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const of=(c,r)=>new Rw({...c.decoders||{[c.prefix]:c},...r.decoders||{[r.prefix]:r}});class Tw{constructor(r,i,n,o){this.name=r,this.prefix=i,this.baseEncode=n,this.baseDecode=o,this.encoder=new Cw(r,i,n),this.decoder=new Ow(r,i,o)}encode(r){return this.encoder.encode(r)}decode(r){return this.decoder.decode(r)}}const vo=({name:c,prefix:r,encode:i,decode:n})=>new Tw(c,r,i,n),Vs=({prefix:c,name:r,alphabet:i})=>{const{encode:n,decode:o}=Sw(i,r);return vo({prefix:c,name:r,encode:n,decode:l=>nf(o(l))})},Nw=(c,r,i,n)=>{const o={};for(let S=0;S<r.length;++S)o[r[S]]=S;let l=c.length;for(;c[l-1]==="=";)--l;const d=new Uint8Array(l*i/8|0);let v=0,b=0,m=0;for(let S=0;S<l;++S){const O=o[c[S]];if(O===void 0)throw new SyntaxError(`Non-${n} character`);b=b<<i|O,v+=i,v>=8&&(v-=8,d[m++]=255&b>>v)}if(v>=i||255&b<<8-v)throw new SyntaxError("Unexpected end of data");return d},Dw=(c,r,i)=>{const n=r[r.length-1]==="=",o=(1<<i)-1;let l="",d=0,v=0;for(let b=0;b<c.length;++b)for(v=v<<8|c[b],d+=8;d>i;)d-=i,l+=r[o&v>>d];if(d&&(l+=r[o&v<<i-d]),n)for(;l.length*i&7;)l+="=";return l},Kt=({name:c,prefix:r,bitsPerChar:i,alphabet:n})=>vo({prefix:r,name:c,encode(o){return Dw(o,n,i)},decode(o){return Nw(o,n,i,c)}}),Fw=vo({prefix:"\0",name:"identity",encode:c=>Aw(c),decode:c=>Pw(c)});var Lw=Object.freeze({__proto__:null,identity:Fw});const $w=Kt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Mw=Object.freeze({__proto__:null,base2:$w});const jw=Kt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var zw=Object.freeze({__proto__:null,base8:jw});const Uw=Vs({prefix:"9",name:"base10",alphabet:"0123456789"});var qw=Object.freeze({__proto__:null,base10:Uw});const Bw=Kt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Hw=Kt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var kw=Object.freeze({__proto__:null,base16:Bw,base16upper:Hw});const Kw=Kt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Vw=Kt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Gw=Kt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Ww=Kt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Jw=Kt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Yw=Kt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Xw=Kt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Zw=Kt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Qw=Kt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var e_=Object.freeze({__proto__:null,base32:Kw,base32upper:Vw,base32pad:Gw,base32padupper:Ww,base32hex:Jw,base32hexupper:Yw,base32hexpad:Xw,base32hexpadupper:Zw,base32z:Qw});const t_=Vs({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),r_=Vs({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var i_=Object.freeze({__proto__:null,base36:t_,base36upper:r_});const s_=Vs({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),n_=Vs({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var o_=Object.freeze({__proto__:null,base58btc:s_,base58flickr:n_});const a_=Kt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),c_=Kt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),u_=Kt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),h_=Kt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var l_=Object.freeze({__proto__:null,base64:a_,base64pad:c_,base64url:u_,base64urlpad:h_});const af=Array.from(""),f_=af.reduce((c,r,i)=>(c[i]=r,c),[]),p_=af.reduce((c,r,i)=>(c[r.codePointAt(0)]=i,c),[]);function d_(c){return c.reduce((r,i)=>(r+=f_[i],r),"")}function g_(c){const r=[];for(const i of c){const n=p_[i.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${i}`);r.push(n)}return new Uint8Array(r)}const y_=vo({prefix:"",name:"base256emoji",encode:d_,decode:g_});var v_=Object.freeze({__proto__:null,base256emoji:y_}),m_=cf,Qh=128,w_=127,__=~w_,b_=Math.pow(2,31);function cf(c,r,i){r=r||[],i=i||0;for(var n=i;c>=b_;)r[i++]=c&255|Qh,c/=128;for(;c&__;)r[i++]=c&255|Qh,c>>>=7;return r[i]=c|0,cf.bytes=i-n+1,r}var E_=uc,I_=128,el=127;function uc(c,n){var i=0,n=n||0,o=0,l=n,d,v=c.length;do{if(l>=v)throw uc.bytes=0,new RangeError("Could not decode varint");d=c[l++],i+=o<28?(d&el)<<o:(d&el)*Math.pow(2,o),o+=7}while(d>=I_);return uc.bytes=l-n,i}var x_=Math.pow(2,7),S_=Math.pow(2,14),P_=Math.pow(2,21),A_=Math.pow(2,28),C_=Math.pow(2,35),O_=Math.pow(2,42),R_=Math.pow(2,49),T_=Math.pow(2,56),N_=Math.pow(2,63),D_=function(c){return c<x_?1:c<S_?2:c<P_?3:c<A_?4:c<C_?5:c<O_?6:c<R_?7:c<T_?8:c<N_?9:10},F_={encode:m_,decode:E_,encodingLength:D_},uf=F_;const tl=(c,r,i=0)=>(uf.encode(c,r,i),r),rl=c=>uf.encodingLength(c),hc=(c,r)=>{const i=r.byteLength,n=rl(c),o=n+rl(i),l=new Uint8Array(o+i);return tl(c,l,0),tl(i,l,n),l.set(r,o),new L_(c,i,r,l)};class L_{constructor(r,i,n,o){this.code=r,this.size=i,this.digest=n,this.bytes=o}}const hf=({name:c,code:r,encode:i})=>new $_(c,r,i);class $_{constructor(r,i,n){this.name=r,this.code=i,this.encode=n}digest(r){if(r instanceof Uint8Array){const i=this.encode(r);return i instanceof Uint8Array?hc(this.code,i):i.then(n=>hc(this.code,n))}else throw Error("Unknown type, must be binary type")}}const lf=c=>async r=>new Uint8Array(await crypto.subtle.digest(c,r)),M_=hf({name:"sha2-256",code:18,encode:lf("SHA-256")}),j_=hf({name:"sha2-512",code:19,encode:lf("SHA-512")});var z_=Object.freeze({__proto__:null,sha256:M_,sha512:j_});const ff=0,U_="identity",pf=nf,q_=c=>hc(ff,pf(c)),B_={code:ff,name:U_,encode:pf,digest:q_};var H_=Object.freeze({__proto__:null,identity:B_});new TextEncoder,new TextDecoder;const il={...Lw,...Mw,...zw,...qw,...kw,...e_,...i_,...o_,...l_,...v_};({...z_,...H_});function df(c){return globalThis.Buffer!=null?new Uint8Array(c.buffer,c.byteOffset,c.byteLength):c}function k_(c=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?df(globalThis.Buffer.allocUnsafe(c)):new Uint8Array(c)}function gf(c,r,i,n){return{name:c,prefix:r,encoder:{name:c,prefix:r,encode:i},decoder:{decode:n}}}const sl=gf("utf8","u",c=>"u"+new TextDecoder("utf8").decode(c),c=>new TextEncoder().encode(c.substring(1))),Xa=gf("ascii","a",c=>{let r="a";for(let i=0;i<c.length;i++)r+=String.fromCharCode(c[i]);return r},c=>{c=c.substring(1);const r=k_(c.length);for(let i=0;i<c.length;i++)r[i]=c.charCodeAt(i);return r}),K_={utf8:sl,"utf-8":sl,hex:il.base16,latin1:Xa,ascii:Xa,binary:Xa,...il};function V_(c,r="utf8"){const i=K_[r];if(!i)throw new Error(`Unsupported encoding "${r}"`);return(r==="utf8"||r==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?df(globalThis.Buffer.from(c,"utf-8")):i.decoder.decode(`${i.prefix}${c}`)}const yf="wc",G_=2,Ic="core",bi=`${yf}@2:${Ic}:`,W_={name:Ic,logger:"error"},J_={database:":memory:"},Y_="crypto",nl="client_ed25519_seed",X_=ne.ONE_DAY,Z_="keychain",Q_="0.3",eb="messages",tb="0.3",rb=ne.SIX_HOURS,ib="publisher",vf="irn",sb="error",mf="wss://relay.walletconnect.com",ol="wss://relay.walletconnect.org",nb="relayer",vt={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},ob="_subscription",Ms={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},ab=ne.ONE_SECOND/2,cb="2.9.0",ub=1e4,hb="0.3",lb="WALLETCONNECT_CLIENT_ID",Vr={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},fb="subscription",pb="0.3",db=ne.FIVE_SECONDS*1e3,gb="pairing",yb="0.3",js={wc_pairingDelete:{req:{ttl:ne.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:ne.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:ne.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:ne.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:ne.ONE_DAY,prompt:!1,tag:0},res:{ttl:ne.ONE_DAY,prompt:!1,tag:0}}},Kr={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},vb="history",mb="0.3",wb="expirer",Pr={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},_b="0.3",Za="verify-api",al="https://verify.walletconnect.com";class bb{constructor(r,i){this.core=r,this.logger=i,this.keychain=new Map,this.name=Z_,this.version=Q_,this.initialized=!1,this.storagePrefix=bi,this.init=async()=>{if(!this.initialized){const n=await this.getKeyChain();typeof n<"u"&&(this.keychain=n),this.initialized=!0}},this.has=n=>(this.isInitialized(),this.keychain.has(n)),this.set=async(n,o)=>{this.isInitialized(),this.keychain.set(n,o),await this.persist()},this.get=n=>{this.isInitialized();const o=this.keychain.get(n);if(typeof o>"u"){const{message:l}=Q("NO_MATCHING_KEY",`${this.name}: ${n}`);throw new Error(l)}return o},this.del=async n=>{this.isInitialized(),this.keychain.delete(n),await this.persist()},this.core=r,this.logger=Re.generateChildLogger(i,this.name)}get context(){return Re.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setKeyChain(r){await this.core.storage.setItem(this.storageKey,zl(r))}async getKeyChain(){const r=await this.core.storage.getItem(this.storageKey);return typeof r<"u"?Ul(r):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:r}=Q("NOT_INITIALIZED",this.name);throw new Error(r)}}}class Eb{constructor(r,i,n){this.core=r,this.logger=i,this.name=Y_,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=o=>(this.isInitialized(),this.keychain.has(o)),this.getClientId=async()=>{this.isInitialized();const o=await this.getClientSeed(),l=Kh(o);return Yl(l.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const o=cm();return this.setPrivateKey(o.publicKey,o.privateKey)},this.signJWT=async o=>{this.isInitialized();const l=await this.getClientSeed(),d=Kh(l),v=oc();return await Q1(v,o,X_,d)},this.generateSharedKey=(o,l,d)=>{this.isInitialized();const v=this.getPrivateKey(o),b=um(v,l);return this.setSymKey(b,d)},this.setSymKey=async(o,l)=>{this.isInitialized();const d=l||hm(o);return await this.keychain.set(d,o),d},this.deleteKeyPair=async o=>{this.isInitialized(),await this.keychain.del(o)},this.deleteSymKey=async o=>{this.isInitialized(),await this.keychain.del(o)},this.encode=async(o,l,d)=>{this.isInitialized();const v=lm(d),b=Ui(l);if(Ah(v)){const F=v.senderPublicKey,z=v.receiverPublicKey;o=await this.generateSharedKey(F,z)}const m=this.getSymKey(o),{type:S,senderPublicKey:O}=v;return fm({type:S,symKey:m,message:b,senderPublicKey:O})},this.decode=async(o,l,d)=>{this.isInitialized();const v=pm(l,d);if(Ah(v)){const S=v.receiverPublicKey,O=v.senderPublicKey;o=await this.generateSharedKey(S,O)}const b=this.getSymKey(o),m=dm({symKey:b,encoded:l});return Ks(m)},this.getPayloadType=o=>{const l=Ch(o);return gm(l.type)},this.getPayloadSenderPublicKey=o=>{const l=Ch(o);return l.senderPublicKey?fo(l.senderPublicKey,ym):void 0},this.core=r,this.logger=Re.generateChildLogger(i,this.name),this.keychain=n||new bb(this.core,this.logger)}get context(){return Re.getLoggerContext(this.logger)}async setPrivateKey(r,i){return await this.keychain.set(r,i),r}getPrivateKey(r){return this.keychain.get(r)}async getClientSeed(){let r="";try{r=this.keychain.get(nl)}catch{r=oc(),await this.keychain.set(nl,r)}return V_(r,"base16")}getSymKey(r){return this.keychain.get(r)}isInitialized(){if(!this.initialized){const{message:r}=Q("NOT_INITIALIZED",this.name);throw new Error(r)}}}class Ib extends T1{constructor(r,i){super(r,i),this.logger=r,this.core=i,this.messages=new Map,this.name=eb,this.version=tb,this.initialized=!1,this.storagePrefix=bi,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const n=await this.getRelayerMessages();typeof n<"u"&&(this.messages=n),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(n){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(n)}finally{this.initialized=!0}}},this.set=async(n,o)=>{this.isInitialized();const l=fs(o);let d=this.messages.get(n);return typeof d>"u"&&(d={}),typeof d[l]<"u"||(d[l]=o,this.messages.set(n,d),await this.persist()),l},this.get=n=>{this.isInitialized();let o=this.messages.get(n);return typeof o>"u"&&(o={}),o},this.has=(n,o)=>{this.isInitialized();const l=this.get(n),d=fs(o);return typeof l[d]<"u"},this.del=async n=>{this.isInitialized(),this.messages.delete(n),await this.persist()},this.logger=Re.generateChildLogger(r,this.name),this.core=i}get context(){return Re.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setRelayerMessages(r){await this.core.storage.setItem(this.storageKey,zl(r))}async getRelayerMessages(){const r=await this.core.storage.getItem(this.storageKey);return typeof r<"u"?Ul(r):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:r}=Q("NOT_INITIALIZED",this.name);throw new Error(r)}}}class xb extends N1{constructor(r,i){super(r,i),this.relayer=r,this.logger=i,this.events=new Cr.EventEmitter,this.name=ib,this.queue=new Map,this.publishTimeout=ne.toMiliseconds(ne.TEN_SECONDS),this.queueTimeout=ne.toMiliseconds(ne.FIVE_SECONDS),this.needsTransportRestart=!1,this.publish=async(n,o,l)=>{this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:o,opts:l}});try{const d=(l==null?void 0:l.ttl)||rb,v=ac(l),b=(l==null?void 0:l.prompt)||!1,m=(l==null?void 0:l.tag)||0,S=(l==null?void 0:l.id)||_c().toString(),O={topic:n,message:o,opts:{ttl:d,relay:v,prompt:b,tag:m,id:S}},F=setTimeout(()=>this.queue.set(S,O),this.queueTimeout);try{await await co(this.rpcPublish(n,o,d,v,b,m,S),this.publishTimeout),clearTimeout(F),this.relayer.events.emit(vt.publish,O)}catch{this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0;return}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:o,opts:l}})}catch(d){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(d),d}},this.on=(n,o)=>{this.events.on(n,o)},this.once=(n,o)=>{this.events.once(n,o)},this.off=(n,o)=>{this.events.off(n,o)},this.removeListener=(n,o)=>{this.events.removeListener(n,o)},this.relayer=r,this.logger=Re.generateChildLogger(i,this.name),this.registerEventListeners()}get context(){return Re.getLoggerContext(this.logger)}rpcPublish(r,i,n,o,l,d,v){var b,m,S,O;const F={method:io(o.protocol).publish,params:{topic:r,message:i,ttl:n,prompt:l,tag:d},id:v};return _i((b=F.params)==null?void 0:b.prompt)&&((m=F.params)==null||delete m.prompt),_i((S=F.params)==null?void 0:S.tag)&&((O=F.params)==null||delete O.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:F}),this.relayer.request(F)}onPublish(r){this.queue.delete(r)}checkQueue(){this.queue.forEach(async r=>{const{topic:i,message:n,opts:o}=r;await this.publish(i,n,o)})}registerEventListeners(){this.relayer.core.heartbeat.on(gs.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(vt.connection_stalled);return}this.checkQueue()}),this.relayer.on(vt.message_ack,r=>{this.onPublish(r.id.toString())})}}class Sb{constructor(){this.map=new Map,this.set=(r,i)=>{const n=this.get(r);this.exists(r,i)||this.map.set(r,[...n,i])},this.get=r=>this.map.get(r)||[],this.exists=(r,i)=>this.get(r).includes(i),this.delete=(r,i)=>{if(typeof i>"u"){this.map.delete(r);return}if(!this.map.has(r))return;const n=this.get(r);if(!this.exists(r,i))return;const o=n.filter(l=>l!==i);if(!o.length){this.map.delete(r);return}this.map.set(r,o)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var Pb=Object.defineProperty,Ab=Object.defineProperties,Cb=Object.getOwnPropertyDescriptors,cl=Object.getOwnPropertySymbols,Ob=Object.prototype.hasOwnProperty,Rb=Object.prototype.propertyIsEnumerable,ul=(c,r,i)=>r in c?Pb(c,r,{enumerable:!0,configurable:!0,writable:!0,value:i}):c[r]=i,zs=(c,r)=>{for(var i in r||(r={}))Ob.call(r,i)&&ul(c,i,r[i]);if(cl)for(var i of cl(r))Rb.call(r,i)&&ul(c,i,r[i]);return c},Qa=(c,r)=>Ab(c,Cb(r));class Tb extends L1{constructor(r,i){super(r,i),this.relayer=r,this.logger=i,this.subscriptions=new Map,this.topicMap=new Sb,this.events=new Cr.EventEmitter,this.name=fb,this.version=pb,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=bi,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restart(),this.registerEventListeners(),this.onEnable(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(n,o)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:o}});try{const l=ac(o),d={topic:n,relay:l};this.pending.set(n,d);const v=await this.rpcSubscribe(n,l);return this.onSubscribe(v,d),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:o}}),v}catch(l){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(l),l}},this.unsubscribe=async(n,o)=>{await this.restartToComplete(),this.isInitialized(),typeof(o==null?void 0:o.id)<"u"?await this.unsubscribeById(n,o.id,o):await this.unsubscribeByTopic(n,o)},this.isSubscribed=async n=>this.topics.includes(n)?!0:await new Promise((o,l)=>{const d=new ne.Watch;d.start(this.pendingSubscriptionWatchLabel);const v=setInterval(()=>{!this.pending.has(n)&&this.topics.includes(n)&&(clearInterval(v),d.stop(this.pendingSubscriptionWatchLabel),o(!0)),d.elapsed(this.pendingSubscriptionWatchLabel)>=db&&(clearInterval(v),d.stop(this.pendingSubscriptionWatchLabel),l(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1),this.on=(n,o)=>{this.events.on(n,o)},this.once=(n,o)=>{this.events.once(n,o)},this.off=(n,o)=>{this.events.off(n,o)},this.removeListener=(n,o)=>{this.events.removeListener(n,o)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=r,this.logger=Re.generateChildLogger(i,this.name),this.clientId=""}get context(){return Re.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(r,i){let n=!1;try{n=this.getSubscription(r).topic===i}catch{}return n}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(r,i){const n=this.topicMap.get(r);await Promise.all(n.map(async o=>await this.unsubscribeById(r,o,i)))}async unsubscribeById(r,i,n){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:r,id:i,opts:n}});try{const o=ac(n);await this.rpcUnsubscribe(r,i,o);const l=tr("USER_DISCONNECTED",`${this.name}, ${r}`);await this.onUnsubscribe(r,i,l),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:r,id:i,opts:n}})}catch(o){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(o),o}}async rpcSubscribe(r,i){const n={method:io(i.protocol).subscribe,params:{topic:r}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{await await co(this.relayer.request(n),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(vt.connection_stalled)}return fs(r+this.clientId)}async rpcBatchSubscribe(r){if(!r.length)return;const i=r[0].relay,n={method:io(i.protocol).batchSubscribe,params:{topics:r.map(o=>o.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{return await await co(this.relayer.request(n),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(vt.connection_stalled)}}rpcUnsubscribe(r,i,n){const o={method:io(n.protocol).unsubscribe,params:{topic:r,id:i}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:o}),this.relayer.request(o)}onSubscribe(r,i){this.setSubscription(r,Qa(zs({},i),{id:r})),this.pending.delete(i.topic)}onBatchSubscribe(r){r.length&&r.forEach(i=>{this.setSubscription(i.id,zs({},i)),this.pending.delete(i.topic)})}async onUnsubscribe(r,i,n){this.events.removeAllListeners(i),this.hasSubscription(i,r)&&this.deleteSubscription(i,n),await this.relayer.messages.del(r)}async setRelayerSubscriptions(r){await this.relayer.core.storage.setItem(this.storageKey,r)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(r,i){this.subscriptions.has(r)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:r,subscription:i}),this.addSubscription(r,i))}addSubscription(r,i){this.subscriptions.set(r,zs({},i)),this.topicMap.set(i.topic,r),this.events.emit(Vr.created,i)}getSubscription(r){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:r});const i=this.subscriptions.get(r);if(!i){const{message:n}=Q("NO_MATCHING_KEY",`${this.name}: ${r}`);throw new Error(n)}return i}deleteSubscription(r,i){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:r,reason:i});const n=this.getSubscription(r);this.subscriptions.delete(r),this.topicMap.delete(n.topic,r),this.events.emit(Vr.deleted,Qa(zs({},n),{reason:i}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Vr.sync)}async reset(){if(this.cached.length){const r=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let i=0;i<r;i++){const n=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(n)}}this.events.emit(Vr.resubscribed)}async restore(){try{const r=await this.getRelayerSubscriptions();if(typeof r>"u"||!r.length)return;if(this.subscriptions.size){const{message:i}=Q("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(i),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(i)}this.cached=r,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(r){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(r)}}async batchSubscribe(r){if(!r.length)return;const i=await this.rpcBatchSubscribe(r);ps(i)&&this.onBatchSubscribe(i.map((n,o)=>Qa(zs({},r[o]),{id:n})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(this.relayer.transportExplicitlyClosed)return;const r=[];this.pending.forEach(i=>{r.push(i)}),await this.batchSubscribe(r)}registerEventListeners(){this.relayer.core.heartbeat.on(gs.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(vt.connect,async()=>{await this.onConnect()}),this.relayer.on(vt.disconnect,()=>{this.onDisconnect()}),this.events.on(Vr.created,async r=>{const i=Vr.created;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,data:r}),await this.persist()}),this.events.on(Vr.deleted,async r=>{const i=Vr.deleted;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,data:r}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:r}=Q("NOT_INITIALIZED",this.name);throw new Error(r)}}async restartToComplete(){this.restartInProgress&&await new Promise(r=>{const i=setInterval(()=>{this.restartInProgress||(clearInterval(i),r())},this.pollingInterval)})}}var Nb=Object.defineProperty,hl=Object.getOwnPropertySymbols,Db=Object.prototype.hasOwnProperty,Fb=Object.prototype.propertyIsEnumerable,ll=(c,r,i)=>r in c?Nb(c,r,{enumerable:!0,configurable:!0,writable:!0,value:i}):c[r]=i,Lb=(c,r)=>{for(var i in r||(r={}))Db.call(r,i)&&ll(c,i,r[i]);if(hl)for(var i of hl(r))Fb.call(r,i)&&ll(c,i,r[i]);return c};class $b extends D1{constructor(r){super(r),this.protocol="wc",this.version=2,this.events=new Cr.EventEmitter,this.name=nb,this.transportExplicitlyClosed=!1,this.initialized=!1,this.reconnecting=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.request=async i=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(i)}catch(n){throw this.logger.debug("Failed to Publish Request"),this.logger.error(n),n}},this.core=r.core,this.logger=typeof r.logger<"u"&&typeof r.logger!="string"?Re.generateChildLogger(r.logger,this.name):Re.pino(Re.getDefaultLoggerOptions({level:r.logger||sb})),this.messages=new Ib(this.logger,r.core),this.subscriber=new Tb(this,this.logger),this.publisher=new xb(this,this.logger),this.relayUrl=(r==null?void 0:r.relayUrl)||mf,this.projectId=r.projectId,this.provider={}}async init(){this.logger.trace("Initialized"),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${ol}...`),await this.restartTransport(ol)}this.registerEventListeners(),this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},ub)}get context(){return Re.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(r,i,n){this.isInitialized(),await this.publisher.publish(r,i,n),await this.recordMessageEvent({topic:r,message:i,publishedAt:Date.now()})}async subscribe(r,i){var n;this.isInitialized();let o=((n=this.subscriber.topicMap.get(r))==null?void 0:n[0])||"";return o||(await Promise.all([new Promise(l=>{this.subscriber.once(Vr.created,d=>{d.topic===r&&l()})}),new Promise(async l=>{o=await this.subscriber.subscribe(r,i),l()})]),o)}async unsubscribe(r,i){this.isInitialized(),await this.subscriber.unsubscribe(r,i)}on(r,i){this.events.on(r,i)}once(r,i){this.events.once(r,i)}off(r,i){this.events.off(r,i)}removeListener(r,i){this.events.removeListener(r,i)}async transportClose(){this.transportExplicitlyClosed=!0,this.connected&&(await this.provider.disconnect(),this.events.emit(vt.transport_closed))}async transportOpen(r){if(this.transportExplicitlyClosed=!1,!this.reconnecting){this.relayUrl=r||this.relayUrl,this.reconnecting=!0;try{await Promise.all([new Promise(i=>{this.initialized||i(),this.subscriber.once(Vr.resubscribed,()=>{i()})}),await Promise.race([new Promise(async(i,n)=>{await co(this.provider.connect(),5e3,`Socket stalled when trying to connect to ${this.relayUrl}`).catch(o=>n(o)).then(()=>i()).finally(()=>this.removeListener(vt.transport_closed,this.rejectTransportOpen))}),new Promise(i=>this.once(vt.transport_closed,this.rejectTransportOpen))])])}catch(i){this.logger.error(i);const n=i;if(!this.isConnectionStalled(n.message))throw i;this.events.emit(vt.transport_closed)}finally{this.reconnecting=!1}}}async restartTransport(r){this.transportExplicitlyClosed||this.reconnecting||(this.relayUrl=r||this.relayUrl,this.connected&&await Promise.all([new Promise(i=>{this.provider.once(Ms.disconnect,()=>{i()})}),this.transportClose()]),await this.createProvider(),await this.transportOpen())}isConnectionStalled(r){return this.staleConnectionErrors.some(i=>r.includes(i))}rejectTransportOpen(){throw new Error("Attempt to connect to relay via `transportOpen` has stalled. Retrying...")}async createProvider(){const r=await this.core.crypto.signJWT(this.relayUrl);this.provider=new Ei(new _w(vm({sdkVersion:cb,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:r,useOnCloseEvent:!0}))),this.registerProviderListeners()}async recordMessageEvent(r){const{topic:i,message:n}=r;await this.messages.set(i,n)}async shouldIgnoreMessageEvent(r){const{topic:i,message:n}=r;return await this.subscriber.isSubscribed(i)?this.messages.has(i,n):!0}async onProviderPayload(r){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:r}),Ec(r)){if(!r.method.endsWith(ob))return;const i=r.params,{topic:n,message:o,publishedAt:l}=i.data,d={topic:n,message:o,publishedAt:l};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(Lb({type:"event",event:i.id},d)),this.events.emit(i.id,d),await this.acknowledgePayload(r),await this.onMessageEvent(d)}else yo(r)&&this.events.emit(vt.message_ack,r)}async onMessageEvent(r){await this.shouldIgnoreMessageEvent(r)||(this.events.emit(vt.message,r),await this.recordMessageEvent(r))}async acknowledgePayload(r){const i=bc(r.id,!0);await this.provider.connection.send(i)}registerProviderListeners(){this.provider.on(Ms.payload,r=>this.onProviderPayload(r)),this.provider.on(Ms.connect,()=>{this.events.emit(vt.connect)}),this.provider.on(Ms.disconnect,()=>{this.onProviderDisconnect()}),this.provider.on(Ms.error,r=>{this.logger.error(r),this.events.emit(vt.error,r)})}registerEventListeners(){this.events.on(vt.connection_stalled,async()=>{await this.restartTransport()})}onProviderDisconnect(){this.events.emit(vt.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||setTimeout(async()=>{await this.restartTransport()},ne.toMiliseconds(ab))}isInitialized(){if(!this.initialized){const{message:r}=Q("NOT_INITIALIZED",this.name);throw new Error(r)}}async toEstablishConnection(){if(!this.connected){if(this.connecting)return await new Promise(r=>{const i=setInterval(()=>{this.connected&&(clearInterval(i),r())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var Mb=Object.defineProperty,fl=Object.getOwnPropertySymbols,jb=Object.prototype.hasOwnProperty,zb=Object.prototype.propertyIsEnumerable,pl=(c,r,i)=>r in c?Mb(c,r,{enumerable:!0,configurable:!0,writable:!0,value:i}):c[r]=i,dl=(c,r)=>{for(var i in r||(r={}))jb.call(r,i)&&pl(c,i,r[i]);if(fl)for(var i of fl(r))zb.call(r,i)&&pl(c,i,r[i]);return c};class mo extends F1{constructor(r,i,n,o=bi,l=void 0){super(r,i,n,o),this.core=r,this.logger=i,this.name=n,this.map=new Map,this.version=hb,this.cached=[],this.initialized=!1,this.storagePrefix=bi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(d=>{this.getKey&&d!==null&&!_i(d)?this.map.set(this.getKey(d),d):om(d)?this.map.set(d.id,d):am(d)&&this.map.set(d.topic,d)}),this.cached=[],this.initialized=!0)},this.set=async(d,v)=>{this.isInitialized(),this.map.has(d)?await this.update(d,v):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:d,value:v}),this.map.set(d,v),await this.persist())},this.get=d=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:d}),this.getData(d)),this.getAll=d=>(this.isInitialized(),d?this.values.filter(v=>Object.keys(d).every(b=>Ew(v[b],d[b]))):this.values),this.update=async(d,v)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:d,update:v});const b=dl(dl({},this.getData(d)),v);this.map.set(d,b),await this.persist()},this.delete=async(d,v)=>{this.isInitialized(),this.map.has(d)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:d,reason:v}),this.map.delete(d),await this.persist())},this.logger=Re.generateChildLogger(i,this.name),this.storagePrefix=o,this.getKey=l}get context(){return Re.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(r){await this.core.storage.setItem(this.storageKey,r)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(r){const i=this.map.get(r);if(!i){const{message:n}=Q("NO_MATCHING_KEY",`${this.name}: ${r}`);throw this.logger.error(n),new Error(n)}return i}async persist(){await this.setDataStore(this.values)}async restore(){try{const r=await this.getDataStore();if(typeof r>"u"||!r.length)return;if(this.map.size){const{message:i}=Q("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(i),new Error(i)}this.cached=r,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(r){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(r)}}isInitialized(){if(!this.initialized){const{message:r}=Q("NOT_INITIALIZED",this.name);throw new Error(r)}}}class Ub{constructor(r,i){this.core=r,this.logger=i,this.name=gb,this.version=yb,this.events=new vc,this.initialized=!1,this.storagePrefix=bi,this.ignoredPayloadTypes=[$l],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:n})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...n])]},this.create=async()=>{this.isInitialized();const n=oc(),o=await this.core.crypto.setSymKey(n),l=Lr(ne.FIVE_MINUTES),d={protocol:vf},v={topic:o,expiry:l,relay:d,active:!1},b=mm({protocol:this.core.protocol,version:this.core.version,topic:o,symKey:n,relay:d});return await this.pairings.set(o,v),await this.core.relayer.subscribe(o),this.core.expirer.set(o,l),{topic:o,uri:b}},this.pair=async n=>{this.isInitialized(),this.isValidPair(n);const{topic:o,symKey:l,relay:d}=wm(n.uri);if(this.pairings.keys.includes(o))throw new Error(`Pairing already exists: ${o}`);if(this.core.crypto.hasKeys(o))throw new Error(`Keychain already exists: ${o}`);const v=Lr(ne.FIVE_MINUTES),b={topic:o,relay:d,expiry:v,active:!1};return await this.pairings.set(o,b),await this.core.crypto.setSymKey(l,o),await this.core.relayer.subscribe(o,{relay:d}),this.core.expirer.set(o,v),n.activatePairing&&await this.activate({topic:o}),b},this.activate=async({topic:n})=>{this.isInitialized();const o=Lr(ne.THIRTY_DAYS);await this.pairings.update(n,{active:!0,expiry:o}),this.core.expirer.set(n,o)},this.ping=async n=>{this.isInitialized(),await this.isValidPing(n);const{topic:o}=n;if(this.pairings.keys.includes(o)){const l=await this.sendRequest(o,"wc_pairingPing",{}),{done:d,resolve:v,reject:b}=hs();this.events.once(Ft("pairing_ping",l),({error:m})=>{m?b(m):v()}),await d()}},this.updateExpiry=async({topic:n,expiry:o})=>{this.isInitialized(),await this.pairings.update(n,{expiry:o})},this.updateMetadata=async({topic:n,metadata:o})=>{this.isInitialized(),await this.pairings.update(n,{peerMetadata:o})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async n=>{this.isInitialized(),await this.isValidDisconnect(n);const{topic:o}=n;this.pairings.keys.includes(o)&&(await this.sendRequest(o,"wc_pairingDelete",tr("USER_DISCONNECTED")),await this.deletePairing(o))},this.sendRequest=async(n,o,l)=>{const d=po(o,l),v=await this.core.crypto.encode(n,d),b=js[o].req;return this.core.history.set(n,d),this.core.relayer.publish(n,v,b),d.id},this.sendResult=async(n,o,l)=>{const d=bc(n,l),v=await this.core.crypto.encode(o,d),b=await this.core.history.get(o,n),m=js[b.request.method].res;await this.core.relayer.publish(o,v,m),await this.core.history.resolve(d)},this.sendError=async(n,o,l)=>{const d=go(n,l),v=await this.core.crypto.encode(o,d),b=await this.core.history.get(o,n),m=js[b.request.method]?js[b.request.method].res:js.unregistered_method.res;await this.core.relayer.publish(o,v,m),await this.core.history.resolve(d)},this.deletePairing=async(n,o)=>{await this.core.relayer.unsubscribe(n),await Promise.all([this.pairings.delete(n,tr("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(n),o?Promise.resolve():this.core.expirer.del(n)])},this.cleanup=async()=>{const n=this.pairings.getAll().filter(o=>wi(o.expiry));await Promise.all(n.map(o=>this.deletePairing(o.topic)))},this.onRelayEventRequest=n=>{const{topic:o,payload:l}=n,d=l.method;if(this.pairings.keys.includes(o))switch(d){case"wc_pairingPing":return this.onPairingPingRequest(o,l);case"wc_pairingDelete":return this.onPairingDeleteRequest(o,l);default:return this.onUnknownRpcMethodRequest(o,l)}},this.onRelayEventResponse=async n=>{const{topic:o,payload:l}=n,d=(await this.core.history.get(o,l.id)).request.method;if(this.pairings.keys.includes(o))switch(d){case"wc_pairingPing":return this.onPairingPingResponse(o,l);default:return this.onUnknownRpcMethodResponse(d)}},this.onPairingPingRequest=async(n,o)=>{const{id:l}=o;try{this.isValidPing({topic:n}),await this.sendResult(l,n,!0),this.events.emit("pairing_ping",{id:l,topic:n})}catch(d){await this.sendError(l,n,d),this.logger.error(d)}},this.onPairingPingResponse=(n,o)=>{const{id:l}=o;setTimeout(()=>{ai(o)?this.events.emit(Ft("pairing_ping",l),{}):$r(o)&&this.events.emit(Ft("pairing_ping",l),{error:o.error})},500)},this.onPairingDeleteRequest=async(n,o)=>{const{id:l}=o;try{this.isValidDisconnect({topic:n}),await this.deletePairing(n),this.events.emit("pairing_delete",{id:l,topic:n})}catch(d){await this.sendError(l,n,d),this.logger.error(d)}},this.onUnknownRpcMethodRequest=async(n,o)=>{const{id:l,method:d}=o;try{if(this.registeredMethods.includes(d))return;const v=tr("WC_METHOD_UNSUPPORTED",d);await this.sendError(l,n,v),this.logger.error(v)}catch(v){await this.sendError(l,n,v),this.logger.error(v)}},this.onUnknownRpcMethodResponse=n=>{this.registeredMethods.includes(n)||this.logger.error(tr("WC_METHOD_UNSUPPORTED",n))},this.isValidPair=n=>{if(!ur(n)){const{message:o}=Q("MISSING_OR_INVALID",`pair() params: ${n}`);throw new Error(o)}if(!_m(n.uri)){const{message:o}=Q("MISSING_OR_INVALID",`pair() uri: ${n.uri}`);throw new Error(o)}},this.isValidPing=async n=>{if(!ur(n)){const{message:l}=Q("MISSING_OR_INVALID",`ping() params: ${n}`);throw new Error(l)}const{topic:o}=n;await this.isValidPairingTopic(o)},this.isValidDisconnect=async n=>{if(!ur(n)){const{message:l}=Q("MISSING_OR_INVALID",`disconnect() params: ${n}`);throw new Error(l)}const{topic:o}=n;await this.isValidPairingTopic(o)},this.isValidPairingTopic=async n=>{if(!ls(n,!1)){const{message:o}=Q("MISSING_OR_INVALID",`pairing topic should be a string: ${n}`);throw new Error(o)}if(!this.pairings.keys.includes(n)){const{message:o}=Q("NO_MATCHING_KEY",`pairing topic doesn't exist: ${n}`);throw new Error(o)}if(wi(this.pairings.get(n).expiry)){await this.deletePairing(n);const{message:o}=Q("EXPIRED",`pairing topic: ${n}`);throw new Error(o)}},this.core=r,this.logger=Re.generateChildLogger(i,this.name),this.pairings=new mo(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Re.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:r}=Q("NOT_INITIALIZED",this.name);throw new Error(r)}}registerRelayerEvents(){this.core.relayer.on(vt.message,async r=>{const{topic:i,message:n}=r;if(this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(n)))return;const o=await this.core.crypto.decode(i,n);Ec(o)?(this.core.history.set(i,o),this.onRelayEventRequest({topic:i,payload:o})):yo(o)&&(await this.core.history.resolve(o),await this.onRelayEventResponse({topic:i,payload:o}),this.core.history.delete(i,o.id))})}registerExpirerEvents(){this.core.expirer.on(Pr.expired,async r=>{const{topic:i}=Ml(r.target);i&&this.pairings.keys.includes(i)&&(await this.deletePairing(i,!0),this.events.emit("pairing_expire",{topic:i}))})}}class qb extends R1{constructor(r,i){super(r,i),this.core=r,this.logger=i,this.records=new Map,this.events=new Cr.EventEmitter,this.name=vb,this.version=mb,this.cached=[],this.initialized=!1,this.storagePrefix=bi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.records.set(n.id,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(n,o,l)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:n,request:o,chainId:l}),this.records.has(o.id))return;const d={id:o.id,topic:n,request:{method:o.method,params:o.params||null},chainId:l,expiry:Lr(ne.THIRTY_DAYS)};this.records.set(d.id,d),this.events.emit(Kr.created,d)},this.resolve=async n=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:n}),!this.records.has(n.id))return;const o=await this.getRecord(n.id);typeof o.response>"u"&&(o.response=$r(n)?{error:n.error}:{result:n.result},this.records.set(o.id,o),this.events.emit(Kr.updated,o))},this.get=async(n,o)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:n,id:o}),await this.getRecord(o)),this.delete=(n,o)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:o}),this.values.forEach(l=>{if(l.topic===n){if(typeof o<"u"&&l.id!==o)return;this.records.delete(l.id),this.events.emit(Kr.deleted,l)}})},this.exists=async(n,o)=>(this.isInitialized(),this.records.has(o)?(await this.getRecord(o)).topic===n:!1),this.on=(n,o)=>{this.events.on(n,o)},this.once=(n,o)=>{this.events.once(n,o)},this.off=(n,o)=>{this.events.off(n,o)},this.removeListener=(n,o)=>{this.events.removeListener(n,o)},this.logger=Re.generateChildLogger(i,this.name)}get context(){return Re.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const r=[];return this.values.forEach(i=>{if(typeof i.response<"u")return;const n={topic:i.topic,request:po(i.request.method,i.request.params,i.id),chainId:i.chainId};return r.push(n)}),r}async setJsonRpcRecords(r){await this.core.storage.setItem(this.storageKey,r)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(r){this.isInitialized();const i=this.records.get(r);if(!i){const{message:n}=Q("NO_MATCHING_KEY",`${this.name}: ${r}`);throw new Error(n)}return i}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Kr.sync)}async restore(){try{const r=await this.getJsonRpcRecords();if(typeof r>"u"||!r.length)return;if(this.records.size){const{message:i}=Q("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(i),new Error(i)}this.cached=r,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(r){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(r)}}registerEventListeners(){this.events.on(Kr.created,r=>{const i=Kr.created;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,record:r}),this.persist()}),this.events.on(Kr.updated,r=>{const i=Kr.updated;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,record:r}),this.persist()}),this.events.on(Kr.deleted,r=>{const i=Kr.deleted;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,record:r}),this.persist()}),this.core.heartbeat.on(gs.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach(r=>{ne.toMiliseconds(r.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${r.id}`),this.delete(r.topic,r.id))})}catch(r){this.logger.warn(r)}}isInitialized(){if(!this.initialized){const{message:r}=Q("NOT_INITIALIZED",this.name);throw new Error(r)}}}class Bb extends $1{constructor(r,i){super(r,i),this.core=r,this.logger=i,this.expirations=new Map,this.events=new Cr.EventEmitter,this.name=wb,this.version=_b,this.cached=[],this.initialized=!1,this.storagePrefix=bi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.expirations.set(n.target,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=n=>{try{const o=this.formatTarget(n);return typeof this.getExpiration(o)<"u"}catch{return!1}},this.set=(n,o)=>{this.isInitialized();const l=this.formatTarget(n),d={target:l,expiry:o};this.expirations.set(l,d),this.checkExpiry(l,d),this.events.emit(Pr.created,{target:l,expiration:d})},this.get=n=>{this.isInitialized();const o=this.formatTarget(n);return this.getExpiration(o)},this.del=n=>{if(this.isInitialized(),this.has(n)){const o=this.formatTarget(n),l=this.getExpiration(o);this.expirations.delete(o),this.events.emit(Pr.deleted,{target:o,expiration:l})}},this.on=(n,o)=>{this.events.on(n,o)},this.once=(n,o)=>{this.events.once(n,o)},this.off=(n,o)=>{this.events.off(n,o)},this.removeListener=(n,o)=>{this.events.removeListener(n,o)},this.logger=Re.generateChildLogger(i,this.name)}get context(){return Re.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(r){if(typeof r=="string")return bm(r);if(typeof r=="number")return Em(r);const{message:i}=Q("UNKNOWN_TYPE",`Target type: ${typeof r}`);throw new Error(i)}async setExpirations(r){await this.core.storage.setItem(this.storageKey,r)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Pr.sync)}async restore(){try{const r=await this.getExpirations();if(typeof r>"u"||!r.length)return;if(this.expirations.size){const{message:i}=Q("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(i),new Error(i)}this.cached=r,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(r){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(r)}}getExpiration(r){const i=this.expirations.get(r);if(!i){const{message:n}=Q("NO_MATCHING_KEY",`${this.name}: ${r}`);throw this.logger.error(n),new Error(n)}return i}checkExpiry(r,i){const{expiry:n}=i;ne.toMiliseconds(n)-Date.now()<=0&&this.expire(r,i)}expire(r,i){this.expirations.delete(r),this.events.emit(Pr.expired,{target:r,expiration:i})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((r,i)=>this.checkExpiry(i,r))}registerEventListeners(){this.core.heartbeat.on(gs.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(Pr.created,r=>{const i=Pr.created;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,data:r}),this.persist()}),this.events.on(Pr.expired,r=>{const i=Pr.expired;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,data:r}),this.persist()}),this.events.on(Pr.deleted,r=>{const i=Pr.deleted;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,data:r}),this.persist()})}isInitialized(){if(!this.initialized){const{message:r}=Q("NOT_INITIALIZED",this.name);throw new Error(r)}}}class Hb extends M1{constructor(r,i){super(r,i),this.projectId=r,this.logger=i,this.name=Za,this.initialized=!1,this.init=async n=>{Im()||!jl()||(this.verifyUrl=(n==null?void 0:n.verifyUrl)||al,await this.createIframe())},this.register=async n=>{var o;if(this.initialized||await this.init(),!!this.iframe)try{(o=this.iframe.contentWindow)==null||o.postMessage(n.attestationId,this.verifyUrl),this.logger.info(`postMessage sent: ${n.attestationId} ${this.verifyUrl}`)}catch{}},this.resolve=async n=>{var o;if(this.isDevEnv)return"";this.logger.info(`resolving attestation: ${n.attestationId}`);const l=this.startAbortTimer(ne.FIVE_SECONDS),d=await fetch(`${this.verifyUrl}/attestation/${n.attestationId}`,{signal:this.abortController.signal});return clearTimeout(l),d.status===200?(o=await d.json())==null?void 0:o.origin:""},this.createIframe=async()=>{try{await Promise.race([new Promise((n,o)=>{if(document.getElementById(Za))return n();const l=document.createElement("iframe");l.setAttribute("id",Za),l.setAttribute("src",`${this.verifyUrl}/${this.projectId}`),l.style.display="none",l.addEventListener("load",()=>{this.initialized=!0,n()}),l.addEventListener("error",d=>{o(d)}),document.body.append(l),this.iframe=l}),new Promise(n=>{setTimeout(()=>n("iframe load timeout"),ne.toMiliseconds(ne.ONE_SECOND/2))})])}catch(n){this.logger.error(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.error(n)}},this.logger=Re.generateChildLogger(i,this.name),this.verifyUrl=al,this.abortController=new AbortController,this.isDevEnv=xm()&&{}.IS_VITEST}get context(){return Re.getLoggerContext(this.logger)}startAbortTimer(r){return setTimeout(()=>this.abortController.abort(),ne.toMiliseconds(r))}}var kb=Object.defineProperty,gl=Object.getOwnPropertySymbols,Kb=Object.prototype.hasOwnProperty,Vb=Object.prototype.propertyIsEnumerable,yl=(c,r,i)=>r in c?kb(c,r,{enumerable:!0,configurable:!0,writable:!0,value:i}):c[r]=i,vl=(c,r)=>{for(var i in r||(r={}))Kb.call(r,i)&&yl(c,i,r[i]);if(gl)for(var i of gl(r))Vb.call(r,i)&&yl(c,i,r[i]);return c};class xc extends O1{constructor(r){super(r),this.protocol=yf,this.version=G_,this.name=Ic,this.events=new Cr.EventEmitter,this.initialized=!1,this.on=(n,o)=>this.events.on(n,o),this.once=(n,o)=>this.events.once(n,o),this.off=(n,o)=>this.events.off(n,o),this.removeListener=(n,o)=>this.events.removeListener(n,o),this.projectId=r==null?void 0:r.projectId,this.relayUrl=(r==null?void 0:r.relayUrl)||mf;const i=typeof(r==null?void 0:r.logger)<"u"&&typeof(r==null?void 0:r.logger)!="string"?r.logger:Re.pino(Re.getDefaultLoggerOptions({level:(r==null?void 0:r.logger)||W_.logger}));this.logger=Re.generateChildLogger(i,this.name),this.heartbeat=new gs.HeartBeat,this.crypto=new Eb(this,this.logger,r==null?void 0:r.keychain),this.history=new qb(this,this.logger),this.expirer=new Bb(this,this.logger),this.storage=r!=null&&r.storage?r.storage:new _1(vl(vl({},J_),r==null?void 0:r.storageOptions)),this.relayer=new $b({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new Ub(this,this.logger),this.verify=new Hb(this.projectId||"",this.logger)}static async init(r){const i=new xc(r);await i.initialize();const n=await i.crypto.getClientId();return await i.storage.setItem(lb,n),i}get context(){return Re.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(r){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,r),this.logger.error(r.message),r}}}const Gb=xc,wf="wc",_f=2,bf="client",Sc=`${wf}@${_f}:${bf}:`,ec={name:bf,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},Wb="WALLETCONNECT_DEEPLINK_CHOICE",Jb="proposal",Ef="Proposal expired",Yb="session",eo=ne.SEVEN_DAYS,Xb="engine",Us={wc_sessionPropose:{req:{ttl:ne.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:ne.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:ne.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:ne.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:ne.ONE_DAY,prompt:!1,tag:1104},res:{ttl:ne.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:ne.ONE_DAY,prompt:!1,tag:1106},res:{ttl:ne.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:ne.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:ne.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:ne.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:ne.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:ne.ONE_DAY,prompt:!1,tag:1112},res:{ttl:ne.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:ne.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:ne.THIRTY_SECONDS,prompt:!1,tag:1115}}},tc={min:ne.FIVE_MINUTES,max:ne.SEVEN_DAYS},Zb="request",Qb=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var eE=Object.defineProperty,tE=Object.defineProperties,rE=Object.getOwnPropertyDescriptors,ml=Object.getOwnPropertySymbols,iE=Object.prototype.hasOwnProperty,sE=Object.prototype.propertyIsEnumerable,wl=(c,r,i)=>r in c?eE(c,r,{enumerable:!0,configurable:!0,writable:!0,value:i}):c[r]=i,Sr=(c,r)=>{for(var i in r||(r={}))iE.call(r,i)&&wl(c,i,r[i]);if(ml)for(var i of ml(r))sE.call(r,i)&&wl(c,i,r[i]);return c},rc=(c,r)=>tE(c,rE(r));class nE extends z1{constructor(r){super(r),this.name=Xb,this.events=new vc,this.initialized=!1,this.ignoredPayloadTypes=[$l],this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.client.core.pairing.register({methods:Object.keys(Us)}),this.initialized=!0)},this.connect=async i=>{this.isInitialized();const n=rc(Sr({},i),{requiredNamespaces:i.requiredNamespaces||{},optionalNamespaces:i.optionalNamespaces||{}});await this.isValidConnect(n);const{pairingTopic:o,requiredNamespaces:l,optionalNamespaces:d,sessionProperties:v,relays:b}=n;let m=o,S,O=!1;if(m&&(O=this.client.core.pairing.pairings.get(m).active),!m||!O){const{topic:fe,uri:pe}=await this.client.core.pairing.create();m=fe,S=pe}const F=await this.client.core.crypto.generateKeyPair(),z=Sr({requiredNamespaces:l,optionalNamespaces:d,relays:b??[{protocol:vf}],proposer:{publicKey:F,metadata:this.client.metadata}},v&&{sessionProperties:v}),{reject:R,resolve:K,done:re}=hs(ne.FIVE_MINUTES,Ef);if(this.events.once(Ft("session_connect"),async({error:fe,session:pe})=>{if(fe)R(fe);else if(pe){pe.self.publicKey=F;const de=rc(Sr({},pe),{requiredNamespaces:pe.requiredNamespaces,optionalNamespaces:pe.optionalNamespaces});await this.client.session.set(pe.topic,de),await this.setExpiry(pe.topic,pe.expiry),m&&await this.client.core.pairing.updateMetadata({topic:m,metadata:pe.peer.metadata}),K(de)}}),!m){const{message:fe}=Q("NO_MATCHING_KEY",`connect() pairing topic: ${m}`);throw new Error(fe)}const he=await this.sendRequest(m,"wc_sessionPropose",z),le=Lr(ne.FIVE_MINUTES);return await this.setProposal(he,Sr({id:he,expiry:le},z)),{uri:S,approval:re}},this.pair=async i=>(this.isInitialized(),await this.client.core.pairing.pair(i)),this.approve=async i=>{this.isInitialized(),await this.isValidApprove(i);const{id:n,relayProtocol:o,namespaces:l,sessionProperties:d}=i,v=this.client.proposal.get(n);let{pairingTopic:b,proposer:m,requiredNamespaces:S,optionalNamespaces:O}=v;b=b||"",so(S)||(S=Pm(l,"approve()"));const F=await this.client.core.crypto.generateKeyPair(),z=m.publicKey,R=await this.client.core.crypto.generateSharedKey(F,z);b&&n&&(await this.client.core.pairing.updateMetadata({topic:b,metadata:m.metadata}),await this.sendResult(n,b,{relay:{protocol:o??"irn"},responderPublicKey:F}),await this.client.proposal.delete(n,tr("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:b}));const K=Sr({relay:{protocol:o??"irn"},namespaces:l,requiredNamespaces:S,optionalNamespaces:O,pairingTopic:b,controller:{publicKey:F,metadata:this.client.metadata},expiry:Lr(eo)},d&&{sessionProperties:d});await this.client.core.relayer.subscribe(R),await this.sendRequest(R,"wc_sessionSettle",K);const re=rc(Sr({},K),{topic:R,pairingTopic:b,acknowledged:!1,self:K.controller,peer:{publicKey:m.publicKey,metadata:m.metadata},controller:F});return await this.client.session.set(R,re),await this.setExpiry(R,Lr(eo)),{topic:R,acknowledged:()=>new Promise(he=>setTimeout(()=>he(this.client.session.get(R)),500))}},this.reject=async i=>{this.isInitialized(),await this.isValidReject(i);const{id:n,reason:o}=i,{pairingTopic:l}=this.client.proposal.get(n);l&&(await this.sendError(n,l,o),await this.client.proposal.delete(n,tr("USER_DISCONNECTED")))},this.update=async i=>{this.isInitialized(),await this.isValidUpdate(i);const{topic:n,namespaces:o}=i,l=await this.sendRequest(n,"wc_sessionUpdate",{namespaces:o}),{done:d,resolve:v,reject:b}=hs();return this.events.once(Ft("session_update",l),({error:m})=>{m?b(m):v()}),await this.client.session.update(n,{namespaces:o}),{acknowledged:d}},this.extend=async i=>{this.isInitialized(),await this.isValidExtend(i);const{topic:n}=i,o=await this.sendRequest(n,"wc_sessionExtend",{}),{done:l,resolve:d,reject:v}=hs();return this.events.once(Ft("session_extend",o),({error:b})=>{b?v(b):d()}),await this.setExpiry(n,Lr(eo)),{acknowledged:l}},this.request=async i=>{this.isInitialized(),await this.isValidRequest(i);const{chainId:n,request:o,topic:l,expiry:d}=i,v=await this.sendRequest(l,"wc_sessionRequest",{request:o,chainId:n},d),{done:b,resolve:m,reject:S}=hs(d);this.events.once(Ft("session_request",v),({error:F,result:z})=>{F?S(F):m(z)}),this.client.events.emit("session_request_sent",{topic:l,request:o,chainId:n,id:v});const O=await this.client.core.storage.getItem(Wb);return Am({id:v,topic:l,wcDeepLink:O}),await b()},this.respond=async i=>{this.isInitialized(),await this.isValidRespond(i);const{topic:n,response:o}=i,{id:l}=o;ai(o)?await this.sendResult(l,n,o.result):$r(o)&&await this.sendError(l,n,o.error),this.deletePendingSessionRequest(i.response.id,{message:"fulfilled",code:0})},this.ping=async i=>{this.isInitialized(),await this.isValidPing(i);const{topic:n}=i;if(this.client.session.keys.includes(n)){const o=await this.sendRequest(n,"wc_sessionPing",{}),{done:l,resolve:d,reject:v}=hs();this.events.once(Ft("session_ping",o),({error:b})=>{b?v(b):d()}),await l()}else this.client.core.pairing.pairings.keys.includes(n)&&await this.client.core.pairing.ping({topic:n})},this.emit=async i=>{this.isInitialized(),await this.isValidEmit(i);const{topic:n,event:o,chainId:l}=i;await this.sendRequest(n,"wc_sessionEvent",{event:o,chainId:l})},this.disconnect=async i=>{this.isInitialized(),await this.isValidDisconnect(i);const{topic:n}=i;if(this.client.session.keys.includes(n)){const o=_c().toString();let l;const d=v=>{(v==null?void 0:v.id.toString())===o&&(this.client.core.relayer.events.removeListener(vt.message_ack,d),l())};await Promise.all([new Promise(v=>{l=v,this.client.core.relayer.on(vt.message_ack,d)}),this.sendRequest(n,"wc_sessionDelete",tr("USER_DISCONNECTED"),void 0,o)]),await this.deleteSession(n)}else await this.client.core.pairing.disconnect({topic:n})},this.find=i=>(this.isInitialized(),this.client.session.getAll().filter(n=>Cm(n,i))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=async i=>{if(i.pairingTopic)try{const n=this.client.core.pairing.pairings.get(i.pairingTopic),o=this.client.core.pairing.pairings.getAll().filter(l=>{var d,v;return((d=l.peerMetadata)==null?void 0:d.url)&&((v=l.peerMetadata)==null?void 0:v.url)===i.peer.metadata.url&&l.topic&&l.topic!==n.topic});if(o.length===0)return;this.client.logger.info(`Cleaning up ${o.length} duplicate pairing(s)`),await Promise.all(o.map(l=>this.client.core.pairing.disconnect({topic:l.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(n){this.client.logger.error(n)}},this.deleteSession=async(i,n)=>{const{self:o}=this.client.session.get(i);await this.client.core.relayer.unsubscribe(i),this.client.session.delete(i,tr("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(o.publicKey)&&await this.client.core.crypto.deleteKeyPair(o.publicKey),this.client.core.crypto.keychain.has(i)&&await this.client.core.crypto.deleteSymKey(i),n||this.client.core.expirer.del(i)},this.deleteProposal=async(i,n)=>{await Promise.all([this.client.proposal.delete(i,tr("USER_DISCONNECTED")),n?Promise.resolve():this.client.core.expirer.del(i)])},this.deletePendingSessionRequest=async(i,n,o=!1)=>{await Promise.all([this.client.pendingRequest.delete(i,n),o?Promise.resolve():this.client.core.expirer.del(i)])},this.setExpiry=async(i,n)=>{this.client.session.keys.includes(i)&&await this.client.session.update(i,{expiry:n}),this.client.core.expirer.set(i,n)},this.setProposal=async(i,n)=>{await this.client.proposal.set(i,n),this.client.core.expirer.set(i,n.expiry)},this.setPendingSessionRequest=async i=>{const n=Us.wc_sessionRequest.req.ttl,{id:o,topic:l,params:d}=i;await this.client.pendingRequest.set(o,{id:o,topic:l,params:d}),n&&this.client.core.expirer.set(o,Lr(n))},this.sendRequest=async(i,n,o,l,d)=>{const v=po(n,o);if(jl()&&Qb.includes(n)){const S=fs(JSON.stringify(v));await this.client.core.verify.register({attestationId:S})}const b=await this.client.core.crypto.encode(i,v),m=Us[n].req;return l&&(m.ttl=l),d&&(m.id=d),this.client.core.history.set(i,v),this.client.core.relayer.publish(i,b,m),v.id},this.sendResult=async(i,n,o)=>{const l=bc(i,o),d=await this.client.core.crypto.encode(n,l),v=await this.client.core.history.get(n,i),b=Us[v.request.method].res;this.client.core.relayer.publish(n,d,b),await this.client.core.history.resolve(l)},this.sendError=async(i,n,o)=>{const l=go(i,o),d=await this.client.core.crypto.encode(n,l),v=await this.client.core.history.get(n,i),b=Us[v.request.method].res;this.client.core.relayer.publish(n,d,b),await this.client.core.history.resolve(l)},this.cleanup=async()=>{const i=[],n=[];this.client.session.getAll().forEach(o=>{wi(o.expiry)&&i.push(o.topic)}),this.client.proposal.getAll().forEach(o=>{wi(o.expiry)&&n.push(o.id)}),await Promise.all([...i.map(o=>this.deleteSession(o)),...n.map(o=>this.deleteProposal(o))])},this.onRelayEventRequest=i=>{const{topic:n,payload:o}=i,l=o.method;switch(l){case"wc_sessionPropose":return this.onSessionProposeRequest(n,o);case"wc_sessionSettle":return this.onSessionSettleRequest(n,o);case"wc_sessionUpdate":return this.onSessionUpdateRequest(n,o);case"wc_sessionExtend":return this.onSessionExtendRequest(n,o);case"wc_sessionPing":return this.onSessionPingRequest(n,o);case"wc_sessionDelete":return this.onSessionDeleteRequest(n,o);case"wc_sessionRequest":return this.onSessionRequest(n,o);case"wc_sessionEvent":return this.onSessionEventRequest(n,o);default:return this.client.logger.info(`Unsupported request method ${l}`)}},this.onRelayEventResponse=async i=>{const{topic:n,payload:o}=i,l=(await this.client.core.history.get(n,o.id)).request.method;switch(l){case"wc_sessionPropose":return this.onSessionProposeResponse(n,o);case"wc_sessionSettle":return this.onSessionSettleResponse(n,o);case"wc_sessionUpdate":return this.onSessionUpdateResponse(n,o);case"wc_sessionExtend":return this.onSessionExtendResponse(n,o);case"wc_sessionPing":return this.onSessionPingResponse(n,o);case"wc_sessionRequest":return this.onSessionRequestResponse(n,o);default:return this.client.logger.info(`Unsupported response method ${l}`)}},this.onRelayEventUnknownPayload=i=>{const{topic:n}=i,{message:o}=Q("MISSING_OR_INVALID",`Decoded payload on topic ${n} is not identifiable as a JSON-RPC request or a response.`);throw new Error(o)},this.onSessionProposeRequest=async(i,n)=>{const{params:o,id:l}=n;try{this.isValidConnect(Sr({},n.params));const d=Lr(ne.FIVE_MINUTES),v=Sr({id:l,pairingTopic:i,expiry:d},o);await this.setProposal(l,v);const b=fs(JSON.stringify(n)),m=await this.getVerifyContext(b,v.proposer.metadata);this.client.events.emit("session_proposal",{id:l,params:v,verifyContext:m})}catch(d){await this.sendError(l,i,d),this.client.logger.error(d)}},this.onSessionProposeResponse=async(i,n)=>{const{id:o}=n;if(ai(n)){const{result:l}=n;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:l});const d=this.client.proposal.get(o);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:d});const v=d.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:v});const b=l.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:b});const m=await this.client.core.crypto.generateSharedKey(v,b);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:m});const S=await this.client.core.relayer.subscribe(m);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:S}),await this.client.core.pairing.activate({topic:i})}else $r(n)&&(await this.client.proposal.delete(o,tr("USER_DISCONNECTED")),this.events.emit(Ft("session_connect"),{error:n.error}))},this.onSessionSettleRequest=async(i,n)=>{const{id:o,params:l}=n;try{this.isValidSessionSettleRequest(l);const{relay:d,controller:v,expiry:b,namespaces:m,requiredNamespaces:S,optionalNamespaces:O,sessionProperties:F,pairingTopic:z}=n.params,R=Sr({topic:i,relay:d,expiry:b,namespaces:m,acknowledged:!0,pairingTopic:z,requiredNamespaces:S,optionalNamespaces:O,controller:v.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:v.publicKey,metadata:v.metadata}},F&&{sessionProperties:F});await this.sendResult(n.id,i,!0),this.events.emit(Ft("session_connect"),{session:R}),this.cleanupDuplicatePairings(R)}catch(d){await this.sendError(o,i,d),this.client.logger.error(d)}},this.onSessionSettleResponse=async(i,n)=>{const{id:o}=n;ai(n)?(await this.client.session.update(i,{acknowledged:!0}),this.events.emit(Ft("session_approve",o),{})):$r(n)&&(await this.client.session.delete(i,tr("USER_DISCONNECTED")),this.events.emit(Ft("session_approve",o),{error:n.error}))},this.onSessionUpdateRequest=async(i,n)=>{const{params:o,id:l}=n;try{this.isValidUpdate(Sr({topic:i},o)),await this.client.session.update(i,{namespaces:o.namespaces}),await this.sendResult(l,i,!0),this.client.events.emit("session_update",{id:l,topic:i,params:o})}catch(d){await this.sendError(l,i,d),this.client.logger.error(d)}},this.onSessionUpdateResponse=(i,n)=>{const{id:o}=n;ai(n)?this.events.emit(Ft("session_update",o),{}):$r(n)&&this.events.emit(Ft("session_update",o),{error:n.error})},this.onSessionExtendRequest=async(i,n)=>{const{id:o}=n;try{this.isValidExtend({topic:i}),await this.setExpiry(i,Lr(eo)),await this.sendResult(o,i,!0),this.client.events.emit("session_extend",{id:o,topic:i})}catch(l){await this.sendError(o,i,l),this.client.logger.error(l)}},this.onSessionExtendResponse=(i,n)=>{const{id:o}=n;ai(n)?this.events.emit(Ft("session_extend",o),{}):$r(n)&&this.events.emit(Ft("session_extend",o),{error:n.error})},this.onSessionPingRequest=async(i,n)=>{const{id:o}=n;try{this.isValidPing({topic:i}),await this.sendResult(o,i,!0),this.client.events.emit("session_ping",{id:o,topic:i})}catch(l){await this.sendError(o,i,l),this.client.logger.error(l)}},this.onSessionPingResponse=(i,n)=>{const{id:o}=n;setTimeout(()=>{ai(n)?this.events.emit(Ft("session_ping",o),{}):$r(n)&&this.events.emit(Ft("session_ping",o),{error:n.error})},500)},this.onSessionDeleteRequest=async(i,n)=>{const{id:o}=n;try{this.isValidDisconnect({topic:i,reason:n.params}),await Promise.all([new Promise(l=>{this.client.core.relayer.once(vt.publish,async()=>{l(await this.deleteSession(i))})}),this.sendResult(o,i,!0)]),this.client.events.emit("session_delete",{id:o,topic:i})}catch(l){this.client.logger.error(l)}},this.onSessionRequest=async(i,n)=>{const{id:o,params:l}=n;try{this.isValidRequest(Sr({topic:i},l)),await this.setPendingSessionRequest({id:o,topic:i,params:l});const d=fs(JSON.stringify(n)),v=this.client.session.get(i),b=await this.getVerifyContext(d,v.peer.metadata);this.client.events.emit("session_request",{id:o,topic:i,params:l,verifyContext:b})}catch(d){await this.sendError(o,i,d),this.client.logger.error(d)}},this.onSessionRequestResponse=(i,n)=>{const{id:o}=n;ai(n)?this.events.emit(Ft("session_request",o),{result:n.result}):$r(n)&&this.events.emit(Ft("session_request",o),{error:n.error})},this.onSessionEventRequest=async(i,n)=>{const{id:o,params:l}=n;try{this.isValidEmit(Sr({topic:i},l)),this.client.events.emit("session_event",{id:o,topic:i,params:l})}catch(d){await this.sendError(o,i,d),this.client.logger.error(d)}},this.isValidConnect=async i=>{if(!ur(i)){const{message:b}=Q("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(i)}`);throw new Error(b)}const{pairingTopic:n,requiredNamespaces:o,optionalNamespaces:l,sessionProperties:d,relays:v}=i;if(_i(n)||await this.isValidPairingTopic(n),!Om(v,!0)){const{message:b}=Q("MISSING_OR_INVALID",`connect() relays: ${v}`);throw new Error(b)}!_i(o)&&so(o)!==0&&this.validateNamespaces(o,"requiredNamespaces"),!_i(l)&&so(l)!==0&&this.validateNamespaces(l,"optionalNamespaces"),_i(d)||this.validateSessionProps(d,"sessionProperties")},this.validateNamespaces=(i,n)=>{const o=Rm(i,"connect()",n);if(o)throw new Error(o.message)},this.isValidApprove=async i=>{if(!ur(i))throw new Error(Q("MISSING_OR_INVALID",`approve() params: ${i}`).message);const{id:n,namespaces:o,relayProtocol:l,sessionProperties:d}=i;await this.isValidProposalId(n);const v=this.client.proposal.get(n),b=Ha(o,"approve()");if(b)throw new Error(b.message);const m=Oh(v.requiredNamespaces,o,"approve()");if(m)throw new Error(m.message);if(!ls(l,!0)){const{message:S}=Q("MISSING_OR_INVALID",`approve() relayProtocol: ${l}`);throw new Error(S)}_i(d)||this.validateSessionProps(d,"sessionProperties")},this.isValidReject=async i=>{if(!ur(i)){const{message:l}=Q("MISSING_OR_INVALID",`reject() params: ${i}`);throw new Error(l)}const{id:n,reason:o}=i;if(await this.isValidProposalId(n),!Tm(o)){const{message:l}=Q("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(o)}`);throw new Error(l)}},this.isValidSessionSettleRequest=i=>{if(!ur(i)){const{message:m}=Q("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${i}`);throw new Error(m)}const{relay:n,controller:o,namespaces:l,expiry:d}=i;if(!Nm(n)){const{message:m}=Q("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(m)}const v=Dm(o,"onSessionSettleRequest()");if(v)throw new Error(v.message);const b=Ha(l,"onSessionSettleRequest()");if(b)throw new Error(b.message);if(wi(d)){const{message:m}=Q("EXPIRED","onSessionSettleRequest()");throw new Error(m)}},this.isValidUpdate=async i=>{if(!ur(i)){const{message:b}=Q("MISSING_OR_INVALID",`update() params: ${i}`);throw new Error(b)}const{topic:n,namespaces:o}=i;await this.isValidSessionTopic(n);const l=this.client.session.get(n),d=Ha(o,"update()");if(d)throw new Error(d.message);const v=Oh(l.requiredNamespaces,o,"update()");if(v)throw new Error(v.message)},this.isValidExtend=async i=>{if(!ur(i)){const{message:o}=Q("MISSING_OR_INVALID",`extend() params: ${i}`);throw new Error(o)}const{topic:n}=i;await this.isValidSessionTopic(n)},this.isValidRequest=async i=>{if(!ur(i)){const{message:b}=Q("MISSING_OR_INVALID",`request() params: ${i}`);throw new Error(b)}const{topic:n,request:o,chainId:l,expiry:d}=i;await this.isValidSessionTopic(n);const{namespaces:v}=this.client.session.get(n);if(!Rh(v,l)){const{message:b}=Q("MISSING_OR_INVALID",`request() chainId: ${l}`);throw new Error(b)}if(!Fm(o)){const{message:b}=Q("MISSING_OR_INVALID",`request() ${JSON.stringify(o)}`);throw new Error(b)}if(!Lm(v,l,o.method)){const{message:b}=Q("MISSING_OR_INVALID",`request() method: ${o.method}`);throw new Error(b)}if(d&&!$m(d,tc)){const{message:b}=Q("MISSING_OR_INVALID",`request() expiry: ${d}. Expiry must be a number (in seconds) between ${tc.min} and ${tc.max}`);throw new Error(b)}},this.isValidRespond=async i=>{if(!ur(i)){const{message:l}=Q("MISSING_OR_INVALID",`respond() params: ${i}`);throw new Error(l)}const{topic:n,response:o}=i;if(await this.isValidSessionTopic(n),!Mm(o)){const{message:l}=Q("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(o)}`);throw new Error(l)}},this.isValidPing=async i=>{if(!ur(i)){const{message:o}=Q("MISSING_OR_INVALID",`ping() params: ${i}`);throw new Error(o)}const{topic:n}=i;await this.isValidSessionOrPairingTopic(n)},this.isValidEmit=async i=>{if(!ur(i)){const{message:v}=Q("MISSING_OR_INVALID",`emit() params: ${i}`);throw new Error(v)}const{topic:n,event:o,chainId:l}=i;await this.isValidSessionTopic(n);const{namespaces:d}=this.client.session.get(n);if(!Rh(d,l)){const{message:v}=Q("MISSING_OR_INVALID",`emit() chainId: ${l}`);throw new Error(v)}if(!jm(o)){const{message:v}=Q("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(v)}if(!zm(d,l,o.name)){const{message:v}=Q("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(v)}},this.isValidDisconnect=async i=>{if(!ur(i)){const{message:o}=Q("MISSING_OR_INVALID",`disconnect() params: ${i}`);throw new Error(o)}const{topic:n}=i;await this.isValidSessionOrPairingTopic(n)},this.getVerifyContext=async(i,n)=>{const o={verified:{verifyUrl:n.verifyUrl||"",validation:"UNKNOWN",origin:n.url||""}};try{const l=await this.client.core.verify.resolve({attestationId:i,verifyUrl:n.verifyUrl});l&&(o.verified.origin=l,o.verified.validation=l===n.url?"VALID":"INVALID")}catch(l){this.client.logger.error(l)}return this.client.logger.info(`Verify context: ${JSON.stringify(o)}`),o},this.validateSessionProps=(i,n)=>{Object.values(i).forEach(o=>{if(!ls(o,!1)){const{message:l}=Q("MISSING_OR_INVALID",`${n} must be in Record<string, string> format. Received: ${JSON.stringify(o)}`);throw new Error(l)}})}}isInitialized(){if(!this.initialized){const{message:r}=Q("NOT_INITIALIZED",this.name);throw new Error(r)}}registerRelayerEvents(){this.client.core.relayer.on(vt.message,async r=>{const{topic:i,message:n}=r;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(n)))return;const o=await this.client.core.crypto.decode(i,n);Ec(o)?(this.client.core.history.set(i,o),this.onRelayEventRequest({topic:i,payload:o})):yo(o)?(await this.client.core.history.resolve(o),await this.onRelayEventResponse({topic:i,payload:o}),this.client.core.history.delete(i,o.id)):this.onRelayEventUnknownPayload({topic:i,payload:o})})}registerExpirerEvents(){this.client.core.expirer.on(Pr.expired,async r=>{const{topic:i,id:n}=Ml(r.target);if(n&&this.client.pendingRequest.keys.includes(n))return await this.deletePendingSessionRequest(n,Q("EXPIRED"),!0);i?this.client.session.keys.includes(i)&&(await this.deleteSession(i,!0),this.client.events.emit("session_expire",{topic:i})):n&&(await this.deleteProposal(n,!0),this.client.events.emit("proposal_expire",{id:n}))})}isValidPairingTopic(r){if(!ls(r,!1)){const{message:i}=Q("MISSING_OR_INVALID",`pairing topic should be a string: ${r}`);throw new Error(i)}if(!this.client.core.pairing.pairings.keys.includes(r)){const{message:i}=Q("NO_MATCHING_KEY",`pairing topic doesn't exist: ${r}`);throw new Error(i)}if(wi(this.client.core.pairing.pairings.get(r).expiry)){const{message:i}=Q("EXPIRED",`pairing topic: ${r}`);throw new Error(i)}}async isValidSessionTopic(r){if(!ls(r,!1)){const{message:i}=Q("MISSING_OR_INVALID",`session topic should be a string: ${r}`);throw new Error(i)}if(!this.client.session.keys.includes(r)){const{message:i}=Q("NO_MATCHING_KEY",`session topic doesn't exist: ${r}`);throw new Error(i)}if(wi(this.client.session.get(r).expiry)){await this.deleteSession(r);const{message:i}=Q("EXPIRED",`session topic: ${r}`);throw new Error(i)}}async isValidSessionOrPairingTopic(r){if(this.client.session.keys.includes(r))await this.isValidSessionTopic(r);else if(this.client.core.pairing.pairings.keys.includes(r))this.isValidPairingTopic(r);else if(ls(r,!1)){const{message:i}=Q("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${r}`);throw new Error(i)}else{const{message:i}=Q("MISSING_OR_INVALID",`session or pairing topic should be a string: ${r}`);throw new Error(i)}}async isValidProposalId(r){if(!Um(r)){const{message:i}=Q("MISSING_OR_INVALID",`proposal id should be a number: ${r}`);throw new Error(i)}if(!this.client.proposal.keys.includes(r)){const{message:i}=Q("NO_MATCHING_KEY",`proposal id doesn't exist: ${r}`);throw new Error(i)}if(wi(this.client.proposal.get(r).expiry)){await this.deleteProposal(r);const{message:i}=Q("EXPIRED",`proposal id: ${r}`);throw new Error(i)}}}class oE extends mo{constructor(r,i){super(r,i,Jb,Sc),this.core=r,this.logger=i}}class aE extends mo{constructor(r,i){super(r,i,Yb,Sc),this.core=r,this.logger=i}}class cE extends mo{constructor(r,i){super(r,i,Zb,Sc,n=>n.id),this.core=r,this.logger=i}}let uE=class If extends j1{constructor(r){super(r),this.protocol=wf,this.version=_f,this.name=ec.name,this.events=new Cr.EventEmitter,this.on=(n,o)=>this.events.on(n,o),this.once=(n,o)=>this.events.once(n,o),this.off=(n,o)=>this.events.off(n,o),this.removeListener=(n,o)=>this.events.removeListener(n,o),this.removeAllListeners=n=>this.events.removeAllListeners(n),this.connect=async n=>{try{return await this.engine.connect(n)}catch(o){throw this.logger.error(o.message),o}},this.pair=async n=>{try{return await this.engine.pair(n)}catch(o){throw this.logger.error(o.message),o}},this.approve=async n=>{try{return await this.engine.approve(n)}catch(o){throw this.logger.error(o.message),o}},this.reject=async n=>{try{return await this.engine.reject(n)}catch(o){throw this.logger.error(o.message),o}},this.update=async n=>{try{return await this.engine.update(n)}catch(o){throw this.logger.error(o.message),o}},this.extend=async n=>{try{return await this.engine.extend(n)}catch(o){throw this.logger.error(o.message),o}},this.request=async n=>{try{return await this.engine.request(n)}catch(o){throw this.logger.error(o.message),o}},this.respond=async n=>{try{return await this.engine.respond(n)}catch(o){throw this.logger.error(o.message),o}},this.ping=async n=>{try{return await this.engine.ping(n)}catch(o){throw this.logger.error(o.message),o}},this.emit=async n=>{try{return await this.engine.emit(n)}catch(o){throw this.logger.error(o.message),o}},this.disconnect=async n=>{try{return await this.engine.disconnect(n)}catch(o){throw this.logger.error(o.message),o}},this.find=n=>{try{return this.engine.find(n)}catch(o){throw this.logger.error(o.message),o}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(n){throw this.logger.error(n.message),n}},this.name=(r==null?void 0:r.name)||ec.name,this.metadata=(r==null?void 0:r.metadata)||Sm();const i=typeof(r==null?void 0:r.logger)<"u"&&typeof(r==null?void 0:r.logger)!="string"?r.logger:Re.pino(Re.getDefaultLoggerOptions({level:(r==null?void 0:r.logger)||ec.logger}));this.core=(r==null?void 0:r.core)||new Gb(r),this.logger=Re.generateChildLogger(i,this.name),this.session=new aE(this.core,this.logger),this.proposal=new oE(this.core,this.logger),this.pendingRequest=new cE(this.core,this.logger),this.engine=new nE(this)}static async init(r){const i=new If(r);return await i.initialize(),i}get context(){return Re.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(r){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(r.message),r}}};var lc={exports:{}};(function(c,r){var i=typeof self<"u"?self:Mr,n=function(){function l(){this.fetch=!1,this.DOMException=i.DOMException}return l.prototype=i,new l}();(function(l){(function(d){var v={searchParams:"URLSearchParams"in l,iterable:"Symbol"in l&&"iterator"in Symbol,blob:"FileReader"in l&&"Blob"in l&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in l,arrayBuffer:"ArrayBuffer"in l};function b(y){return y&&DataView.prototype.isPrototypeOf(y)}if(v.arrayBuffer)var m=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],S=ArrayBuffer.isView||function(y){return y&&m.indexOf(Object.prototype.toString.call(y))>-1};function O(y){if(typeof y!="string"&&(y=String(y)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(y))throw new TypeError("Invalid character in header field name");return y.toLowerCase()}function F(y){return typeof y!="string"&&(y=String(y)),y}function z(y){var I={next:function(){var X=y.shift();return{done:X===void 0,value:X}}};return v.iterable&&(I[Symbol.iterator]=function(){return I}),I}function R(y){this.map={},y instanceof R?y.forEach(function(I,X){this.append(X,I)},this):Array.isArray(y)?y.forEach(function(I){this.append(I[0],I[1])},this):y&&Object.getOwnPropertyNames(y).forEach(function(I){this.append(I,y[I])},this)}R.prototype.append=function(y,I){y=O(y),I=F(I);var X=this.map[y];this.map[y]=X?X+", "+I:I},R.prototype.delete=function(y){delete this.map[O(y)]},R.prototype.get=function(y){return y=O(y),this.has(y)?this.map[y]:null},R.prototype.has=function(y){return this.map.hasOwnProperty(O(y))},R.prototype.set=function(y,I){this.map[O(y)]=F(I)},R.prototype.forEach=function(y,I){for(var X in this.map)this.map.hasOwnProperty(X)&&y.call(I,this.map[X],X,this)},R.prototype.keys=function(){var y=[];return this.forEach(function(I,X){y.push(X)}),z(y)},R.prototype.values=function(){var y=[];return this.forEach(function(I){y.push(I)}),z(y)},R.prototype.entries=function(){var y=[];return this.forEach(function(I,X){y.push([X,I])}),z(y)},v.iterable&&(R.prototype[Symbol.iterator]=R.prototype.entries);function K(y){if(y.bodyUsed)return Promise.reject(new TypeError("Already read"));y.bodyUsed=!0}function re(y){return new Promise(function(I,X){y.onload=function(){I(y.result)},y.onerror=function(){X(y.error)}})}function he(y){var I=new FileReader,X=re(I);return I.readAsArrayBuffer(y),X}function le(y){var I=new FileReader,X=re(I);return I.readAsText(y),X}function fe(y){for(var I=new Uint8Array(y),X=new Array(I.length),ce=0;ce<I.length;ce++)X[ce]=String.fromCharCode(I[ce]);return X.join("")}function pe(y){if(y.slice)return y.slice(0);var I=new Uint8Array(y.byteLength);return I.set(new Uint8Array(y)),I.buffer}function de(){return this.bodyUsed=!1,this._initBody=function(y){this._bodyInit=y,y?typeof y=="string"?this._bodyText=y:v.blob&&Blob.prototype.isPrototypeOf(y)?this._bodyBlob=y:v.formData&&FormData.prototype.isPrototypeOf(y)?this._bodyFormData=y:v.searchParams&&URLSearchParams.prototype.isPrototypeOf(y)?this._bodyText=y.toString():v.arrayBuffer&&v.blob&&b(y)?(this._bodyArrayBuffer=pe(y.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):v.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(y)||S(y))?this._bodyArrayBuffer=pe(y):this._bodyText=y=Object.prototype.toString.call(y):this._bodyText="",this.headers.get("content-type")||(typeof y=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):v.searchParams&&URLSearchParams.prototype.isPrototypeOf(y)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},v.blob&&(this.blob=function(){var y=K(this);if(y)return y;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?K(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(he)}),this.text=function(){var y=K(this);if(y)return y;if(this._bodyBlob)return le(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(fe(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},v.formData&&(this.formData=function(){return this.text().then(ve)}),this.json=function(){return this.text().then(JSON.parse)},this}var L=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function q(y){var I=y.toUpperCase();return L.indexOf(I)>-1?I:y}function W(y,I){I=I||{};var X=I.body;if(y instanceof W){if(y.bodyUsed)throw new TypeError("Already read");this.url=y.url,this.credentials=y.credentials,I.headers||(this.headers=new R(y.headers)),this.method=y.method,this.mode=y.mode,this.signal=y.signal,!X&&y._bodyInit!=null&&(X=y._bodyInit,y.bodyUsed=!0)}else this.url=String(y);if(this.credentials=I.credentials||this.credentials||"same-origin",(I.headers||!this.headers)&&(this.headers=new R(I.headers)),this.method=q(I.method||this.method||"GET"),this.mode=I.mode||this.mode||null,this.signal=I.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&X)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(X)}W.prototype.clone=function(){return new W(this,{body:this._bodyInit})};function ve(y){var I=new FormData;return y.trim().split("&").forEach(function(X){if(X){var ce=X.split("="),V=ce.shift().replace(/\+/g," "),B=ce.join("=").replace(/\+/g," ");I.append(decodeURIComponent(V),decodeURIComponent(B))}}),I}function ie(y){var I=new R,X=y.replace(/\r?\n[\t ]+/g," ");return X.split(/\r?\n/).forEach(function(ce){var V=ce.split(":"),B=V.shift().trim();if(B){var k=V.join(":").trim();I.append(B,k)}}),I}de.call(W.prototype);function ue(y,I){I||(I={}),this.type="default",this.status=I.status===void 0?200:I.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in I?I.statusText:"OK",this.headers=new R(I.headers),this.url=I.url||"",this._initBody(y)}de.call(ue.prototype),ue.prototype.clone=function(){return new ue(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new R(this.headers),url:this.url})},ue.error=function(){var y=new ue(null,{status:0,statusText:""});return y.type="error",y};var Te=[301,302,303,307,308];ue.redirect=function(y,I){if(Te.indexOf(I)===-1)throw new RangeError("Invalid status code");return new ue(null,{status:I,headers:{location:y}})},d.DOMException=l.DOMException;try{new d.DOMException}catch{d.DOMException=function(I,X){this.message=I,this.name=X;var ce=Error(I);this.stack=ce.stack},d.DOMException.prototype=Object.create(Error.prototype),d.DOMException.prototype.constructor=d.DOMException}function Ue(y,I){return new Promise(function(X,ce){var V=new W(y,I);if(V.signal&&V.signal.aborted)return ce(new d.DOMException("Aborted","AbortError"));var B=new XMLHttpRequest;function k(){B.abort()}B.onload=function(){var G={status:B.status,statusText:B.statusText,headers:ie(B.getAllResponseHeaders()||"")};G.url="responseURL"in B?B.responseURL:G.headers.get("X-Request-URL");var Je="response"in B?B.response:B.responseText;X(new ue(Je,G))},B.onerror=function(){ce(new TypeError("Network request failed"))},B.ontimeout=function(){ce(new TypeError("Network request failed"))},B.onabort=function(){ce(new d.DOMException("Aborted","AbortError"))},B.open(V.method,V.url,!0),V.credentials==="include"?B.withCredentials=!0:V.credentials==="omit"&&(B.withCredentials=!1),"responseType"in B&&v.blob&&(B.responseType="blob"),V.headers.forEach(function(G,Je){B.setRequestHeader(Je,G)}),V.signal&&(V.signal.addEventListener("abort",k),B.onreadystatechange=function(){B.readyState===4&&V.signal.removeEventListener("abort",k)}),B.send(typeof V._bodyInit>"u"?null:V._bodyInit)})}return Ue.polyfill=!0,l.fetch||(l.fetch=Ue,l.Headers=R,l.Request=W,l.Response=ue),d.Headers=R,d.Request=W,d.Response=ue,d.fetch=Ue,Object.defineProperty(d,"__esModule",{value:!0}),d})({})})(n),n.fetch.ponyfill=!0,delete n.fetch.polyfill;var o=n;r=o.fetch,r.default=o.fetch,r.fetch=o.fetch,r.Headers=o.Headers,r.Request=o.Request,r.Response=o.Response,c.exports=r})(lc,lc.exports);var hE=lc.exports;const _l=Ll(hE),lE={Accept:"application/json","Content-Type":"application/json"},fE="POST",bl={headers:lE,method:fE},El=10;class Hi{constructor(r,i=!1){if(this.url=r,this.disableProviderPing=i,this.events=new Cr.EventEmitter,this.isAvailable=!1,this.registering=!1,!Jh(r))throw new Error(`Provided URL is not compatible with HTTP connection: ${r}`);this.url=r,this.disableProviderPing=i}get connected(){return this.isAvailable}get connecting(){return this.registering}on(r,i){this.events.on(r,i)}once(r,i){this.events.once(r,i)}off(r,i){this.events.off(r,i)}removeListener(r,i){this.events.removeListener(r,i)}async open(r=this.url){await this.register(r)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(r,i){this.isAvailable||await this.register();try{const n=Ui(r),l=await(await _l(this.url,Object.assign(Object.assign({},bl),{body:n}))).json();this.onPayload({data:l})}catch(n){this.onError(r.id,n)}}async register(r=this.url){if(!Jh(r))throw new Error(`Provided URL is not compatible with HTTP connection: ${r}`);if(this.registering){const i=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=i||this.events.listenerCount("open")>=i)&&this.events.setMaxListeners(i+1),new Promise((n,o)=>{this.events.once("register_error",l=>{this.resetMaxListeners(),o(l)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return o(new Error("HTTP connection is missing or invalid"));n()})})}this.url=r,this.registering=!0;try{if(!this.disableProviderPing){const i=Ui({id:1,jsonrpc:"2.0",method:"test",params:[]});await _l(r,Object.assign(Object.assign({},bl),{body:i}))}this.onOpen()}catch(i){const n=this.parseError(i);throw this.events.emit("register_error",n),this.onClose(),n}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(r){if(typeof r.data>"u")return;const i=typeof r.data=="string"?Ks(r.data):r.data;this.events.emit("payload",i)}onError(r,i){const n=this.parseError(i),o=n.message||n.toString(),l=go(r,o);this.events.emit("payload",l)}parseError(r,i=this.url){return Ql(r,i,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>El&&this.events.setMaxListeners(El)}}const Il="error",pE="wss://relay.walletconnect.com",dE="wc",gE="universal_provider",xl=`${dE}@2:${gE}:`,yE="https://rpc.walletconnect.com/v1",Ii={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var qs=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},fc={exports:{}};/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(c,r){(function(){var i,n="4.17.21",o=200,l="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",d="Expected a function",v="Invalid `variable` option passed into `_.template`",b="__lodash_hash_undefined__",m=500,S="__lodash_placeholder__",O=1,F=2,z=4,R=1,K=2,re=1,he=2,le=4,fe=8,pe=16,de=32,L=64,q=128,W=256,ve=512,ie=30,ue="...",Te=800,Ue=16,y=1,I=2,X=3,ce=1/0,V=9007199254740991,B=17976931348623157e292,k=0/0,G=4294967295,Je=G-1,He=G>>>1,jr=[["ary",q],["bind",re],["bindKey",he],["curry",fe],["curryRight",pe],["flip",ve],["partial",de],["partialRight",L],["rearg",W]],Ie="[object Arguments]",xt="[object Array]",D="[object AsyncFunction]",N="[object Boolean]",C="[object Date]",u="[object DOMException]",E="[object Error]",ee="[object Function]",ge="[object GeneratorFunction]",be="[object Map]",Ne="[object Number]",Fe="[object Null]",Pe="[object Object]",St="[object Promise]",mt="[object Proxy]",nt="[object RegExp]",$e="[object Set]",Xe="[object String]",Ze="[object Symbol]",ot="[object Undefined]",qe="[object WeakMap]",Qe="[object WeakSet]",De="[object ArrayBuffer]",ke="[object DataView]",ut="[object Float32Array]",je="[object Float64Array]",Pt="[object Int8Array]",Lt="[object Int16Array]",Bt="[object Int32Array]",Ht="[object Uint8Array]",jt="[object Uint8ClampedArray]",Wt="[object Uint16Array]",rr="[object Uint32Array]",zr=/\b__p \+= '';/g,Jt=/\b(__p \+=) '' \+/g,Gr=/(__e\(.*?\)|\b__t\)) \+\n'';/g,ci=/&(?:amp|lt|gt|quot|#39);/g,xi=/[&<>"']/g,ht=RegExp(ci.source),rt=RegExp(xi.source),lt=/<%-([\s\S]+?)%>/g,ft=/<%([\s\S]+?)%>/g,at=/<%=([\s\S]+?)%>/g,it=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,At=/^\w*$/,Ct=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,pt=/[\\^$.*+?()[\]{}|]/g,Ot=RegExp(pt.source),dt=/^\s+/,wt=/\s/,gt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Ye=/\{\n\/\* \[wrapped with (.+)\] \*/,Rt=/,? & /,Tt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,wo=/[()=,{}\[\]\/\s]/,_o=/\\(\\)?/g,bo=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,yr=/\w*$/,Eo=/^[-+]0x[0-9a-f]+$/i,Io=/^0b[01]+$/i,xo=/^\[object .+?Constructor\]$/,So=/^0o[0-7]+$/i,Po=/^(?:0|[1-9]\d*)$/,Wr=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,ki=/($^)/,Ao=/['\n\r\u2028\u2029\\]/g,Ki="\\ud800-\\udfff",Co="\\u0300-\\u036f",Oo="\\ufe20-\\ufe2f",Vi="\\u20d0-\\u20ff",Gs=Co+Oo+Vi,Ws="\\u2700-\\u27bf",Or="a-z\\xdf-\\xf6\\xf8-\\xff",Ro="\\xac\\xb1\\xd7\\xf7",To="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",No="\\u2000-\\u206f",Do=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Js="A-Z\\xc0-\\xd6\\xd8-\\xde",Ys="\\ufe0e\\ufe0f",Si=Ro+To+No+Do,ys="[']",Pi="["+Ki+"]",vs="["+Si+"]",Ai="["+Gs+"]",Xs="\\d+",Fo="["+Ws+"]",Zs="["+Or+"]",Qs="[^"+Ki+Si+Xs+Ws+Or+Js+"]",Gi="\\ud83c[\\udffb-\\udfff]",Lo="(?:"+Ai+"|"+Gi+")",en="[^"+Ki+"]",Wi="(?:\\ud83c[\\udde6-\\uddff]){2}",ui="[\\ud800-\\udbff][\\udc00-\\udfff]",hr="["+Js+"]",tn="\\u200d",rn="(?:"+Zs+"|"+Qs+")",Ur="(?:"+hr+"|"+Qs+")",sn="(?:"+ys+"(?:d|ll|m|re|s|t|ve))?",nn="(?:"+ys+"(?:D|LL|M|RE|S|T|VE))?",on=Lo+"?",an="["+Ys+"]?",$o="(?:"+tn+"(?:"+[en,Wi,ui].join("|")+")"+an+on+")*",Jr="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",cn="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",un=an+on+$o,Ji="(?:"+[Fo,Wi,ui].join("|")+")"+un,Mo="(?:"+[en+Ai+"?",Ai,Wi,ui,Pi].join("|")+")",ms=RegExp(ys,"g"),jo=RegExp(Ai,"g"),Yi=RegExp(Gi+"(?="+Gi+")|"+Mo+un,"g"),hn=RegExp([hr+"?"+Zs+"+"+sn+"(?="+[vs,hr,"$"].join("|")+")",Ur+"+"+nn+"(?="+[vs,hr+rn,"$"].join("|")+")",hr+"?"+rn+"+"+sn,hr+"+"+nn,cn,Jr,Xs,Ji].join("|"),"g"),ln=RegExp("["+tn+Ki+Gs+Ys+"]"),Ci=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,fn=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],zo=-1,Ke={};Ke[ut]=Ke[je]=Ke[Pt]=Ke[Lt]=Ke[Bt]=Ke[Ht]=Ke[jt]=Ke[Wt]=Ke[rr]=!0,Ke[Ie]=Ke[xt]=Ke[De]=Ke[N]=Ke[ke]=Ke[C]=Ke[E]=Ke[ee]=Ke[be]=Ke[Ne]=Ke[Pe]=Ke[nt]=Ke[$e]=Ke[Xe]=Ke[qe]=!1;var Be={};Be[Ie]=Be[xt]=Be[De]=Be[ke]=Be[N]=Be[C]=Be[ut]=Be[je]=Be[Pt]=Be[Lt]=Be[Bt]=Be[be]=Be[Ne]=Be[Pe]=Be[nt]=Be[$e]=Be[Xe]=Be[Ze]=Be[Ht]=Be[jt]=Be[Wt]=Be[rr]=!0,Be[E]=Be[ee]=Be[qe]=!1;var g={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},x={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},U={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Y={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Ve=parseFloat,me=parseInt,et=typeof qs=="object"&&qs&&qs.Object===Object&&qs,Nt=typeof self=="object"&&self&&self.Object===Object&&self,Ce=et||Nt||Function("return this")(),Ge=r&&!r.nodeType&&r,_t=Ge&&!0&&c&&!c.nodeType&&c,ir=_t&&_t.exports===Ge,Dt=ir&&et.process,tt=function(){try{var P=_t&&_t.require&&_t.require("util").types;return P||Dt&&Dt.binding&&Dt.binding("util")}catch{}}(),Yt=tt&&tt.isArrayBuffer,Rr=tt&&tt.isDate,vr=tt&&tt.isMap,qr=tt&&tt.isRegExp,ws=tt&&tt.isSet,Oi=tt&&tt.isTypedArray;function zt(P,$,T){switch(T.length){case 0:return P.call($);case 1:return P.call($,T[0]);case 2:return P.call($,T[0],T[1]);case 3:return P.call($,T[0],T[1],T[2])}return P.apply($,T)}function Pf(P,$,T,Z){for(var ye=-1,Le=P==null?0:P.length;++ye<Le;){var $t=P[ye];$(Z,$t,T($t),P)}return Z}function mr(P,$){for(var T=-1,Z=P==null?0:P.length;++T<Z&&$(P[T],T,P)!==!1;);return P}function Af(P,$){for(var T=P==null?0:P.length;T--&&$(P[T],T,P)!==!1;);return P}function Cc(P,$){for(var T=-1,Z=P==null?0:P.length;++T<Z;)if(!$(P[T],T,P))return!1;return!0}function hi(P,$){for(var T=-1,Z=P==null?0:P.length,ye=0,Le=[];++T<Z;){var $t=P[T];$($t,T,P)&&(Le[ye++]=$t)}return Le}function pn(P,$){var T=P==null?0:P.length;return!!T&&Xi(P,$,0)>-1}function Uo(P,$,T){for(var Z=-1,ye=P==null?0:P.length;++Z<ye;)if(T($,P[Z]))return!0;return!1}function st(P,$){for(var T=-1,Z=P==null?0:P.length,ye=Array(Z);++T<Z;)ye[T]=$(P[T],T,P);return ye}function li(P,$){for(var T=-1,Z=$.length,ye=P.length;++T<Z;)P[ye+T]=$[T];return P}function qo(P,$,T,Z){var ye=-1,Le=P==null?0:P.length;for(Z&&Le&&(T=P[++ye]);++ye<Le;)T=$(T,P[ye],ye,P);return T}function Cf(P,$,T,Z){var ye=P==null?0:P.length;for(Z&&ye&&(T=P[--ye]);ye--;)T=$(T,P[ye],ye,P);return T}function Bo(P,$){for(var T=-1,Z=P==null?0:P.length;++T<Z;)if($(P[T],T,P))return!0;return!1}var Of=Ho("length");function Rf(P){return P.split("")}function Tf(P){return P.match(Tt)||[]}function Oc(P,$,T){var Z;return T(P,function(ye,Le,$t){if($(ye,Le,$t))return Z=Le,!1}),Z}function dn(P,$,T,Z){for(var ye=P.length,Le=T+(Z?1:-1);Z?Le--:++Le<ye;)if($(P[Le],Le,P))return Le;return-1}function Xi(P,$,T){return $===$?Hf(P,$,T):dn(P,Rc,T)}function Nf(P,$,T,Z){for(var ye=T-1,Le=P.length;++ye<Le;)if(Z(P[ye],$))return ye;return-1}function Rc(P){return P!==P}function Tc(P,$){var T=P==null?0:P.length;return T?Ko(P,$)/T:k}function Ho(P){return function($){return $==null?i:$[P]}}function ko(P){return function($){return P==null?i:P[$]}}function Nc(P,$,T,Z,ye){return ye(P,function(Le,$t,We){T=Z?(Z=!1,Le):$(T,Le,$t,We)}),T}function Df(P,$){var T=P.length;for(P.sort($);T--;)P[T]=P[T].value;return P}function Ko(P,$){for(var T,Z=-1,ye=P.length;++Z<ye;){var Le=$(P[Z]);Le!==i&&(T=T===i?Le:T+Le)}return T}function Vo(P,$){for(var T=-1,Z=Array(P);++T<P;)Z[T]=$(T);return Z}function Ff(P,$){return st($,function(T){return[T,P[T]]})}function Dc(P){return P&&P.slice(0,Mc(P)+1).replace(dt,"")}function lr(P){return function($){return P($)}}function Go(P,$){return st($,function(T){return P[T]})}function _s(P,$){return P.has($)}function Fc(P,$){for(var T=-1,Z=P.length;++T<Z&&Xi($,P[T],0)>-1;);return T}function Lc(P,$){for(var T=P.length;T--&&Xi($,P[T],0)>-1;);return T}function Lf(P,$){for(var T=P.length,Z=0;T--;)P[T]===$&&++Z;return Z}var $f=ko(g),Mf=ko(x);function jf(P){return"\\"+Y[P]}function zf(P,$){return P==null?i:P[$]}function Zi(P){return ln.test(P)}function Uf(P){return Ci.test(P)}function qf(P){for(var $,T=[];!($=P.next()).done;)T.push($.value);return T}function Wo(P){var $=-1,T=Array(P.size);return P.forEach(function(Z,ye){T[++$]=[ye,Z]}),T}function $c(P,$){return function(T){return P($(T))}}function fi(P,$){for(var T=-1,Z=P.length,ye=0,Le=[];++T<Z;){var $t=P[T];($t===$||$t===S)&&(P[T]=S,Le[ye++]=T)}return Le}function gn(P){var $=-1,T=Array(P.size);return P.forEach(function(Z){T[++$]=Z}),T}function Bf(P){var $=-1,T=Array(P.size);return P.forEach(function(Z){T[++$]=[Z,Z]}),T}function Hf(P,$,T){for(var Z=T-1,ye=P.length;++Z<ye;)if(P[Z]===$)return Z;return-1}function kf(P,$,T){for(var Z=T+1;Z--;)if(P[Z]===$)return Z;return Z}function Qi(P){return Zi(P)?Vf(P):Of(P)}function Tr(P){return Zi(P)?Gf(P):Rf(P)}function Mc(P){for(var $=P.length;$--&&wt.test(P.charAt($)););return $}var Kf=ko(U);function Vf(P){for(var $=Yi.lastIndex=0;Yi.test(P);)++$;return $}function Gf(P){return P.match(Yi)||[]}function Wf(P){return P.match(hn)||[]}var Jf=function P($){$=$==null?Ce:es.defaults(Ce.Object(),$,es.pick(Ce,fn));var T=$.Array,Z=$.Date,ye=$.Error,Le=$.Function,$t=$.Math,We=$.Object,Jo=$.RegExp,Yf=$.String,wr=$.TypeError,yn=T.prototype,Xf=Le.prototype,ts=We.prototype,vn=$["__core-js_shared__"],mn=Xf.toString,ze=ts.hasOwnProperty,Zf=0,jc=function(){var e=/[^.]+$/.exec(vn&&vn.keys&&vn.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),wn=ts.toString,Qf=mn.call(We),ep=Ce._,tp=Jo("^"+mn.call(ze).replace(pt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),_n=ir?$.Buffer:i,pi=$.Symbol,bn=$.Uint8Array,zc=_n?_n.allocUnsafe:i,En=$c(We.getPrototypeOf,We),Uc=We.create,qc=ts.propertyIsEnumerable,In=yn.splice,Bc=pi?pi.isConcatSpreadable:i,bs=pi?pi.iterator:i,Ri=pi?pi.toStringTag:i,xn=function(){try{var e=Li(We,"defineProperty");return e({},"",{}),e}catch{}}(),rp=$.clearTimeout!==Ce.clearTimeout&&$.clearTimeout,ip=Z&&Z.now!==Ce.Date.now&&Z.now,sp=$.setTimeout!==Ce.setTimeout&&$.setTimeout,Sn=$t.ceil,Pn=$t.floor,Yo=We.getOwnPropertySymbols,np=_n?_n.isBuffer:i,Hc=$.isFinite,op=yn.join,ap=$c(We.keys,We),Mt=$t.max,Vt=$t.min,cp=Z.now,up=$.parseInt,kc=$t.random,hp=yn.reverse,Xo=Li($,"DataView"),Es=Li($,"Map"),Zo=Li($,"Promise"),rs=Li($,"Set"),Is=Li($,"WeakMap"),xs=Li(We,"create"),An=Is&&new Is,is={},lp=$i(Xo),fp=$i(Es),pp=$i(Zo),dp=$i(rs),gp=$i(Is),Cn=pi?pi.prototype:i,Ss=Cn?Cn.valueOf:i,Kc=Cn?Cn.toString:i;function f(e){if(yt(e)&&!we(e)&&!(e instanceof Ae)){if(e instanceof _r)return e;if(ze.call(e,"__wrapped__"))return Vu(e)}return new _r(e)}var ss=function(){function e(){}return function(t){if(!ct(t))return{};if(Uc)return Uc(t);e.prototype=t;var s=new e;return e.prototype=i,s}}();function On(){}function _r(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=i}f.templateSettings={escape:lt,evaluate:ft,interpolate:at,variable:"",imports:{_:f}},f.prototype=On.prototype,f.prototype.constructor=f,_r.prototype=ss(On.prototype),_r.prototype.constructor=_r;function Ae(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=G,this.__views__=[]}function yp(){var e=new Ae(this.__wrapped__);return e.__actions__=sr(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=sr(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=sr(this.__views__),e}function vp(){if(this.__filtered__){var e=new Ae(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function mp(){var e=this.__wrapped__.value(),t=this.__dir__,s=we(e),a=t<0,h=s?e.length:0,p=Rd(0,h,this.__views__),w=p.start,_=p.end,A=_-w,M=a?_:w-1,j=this.__iteratees__,H=j.length,J=0,te=Vt(A,this.__takeCount__);if(!s||!a&&h==A&&te==A)return gu(e,this.__actions__);var oe=[];e:for(;A--&&J<te;){M+=t;for(var Ee=-1,ae=e[M];++Ee<H;){var Se=j[Ee],Oe=Se.iteratee,dr=Se.type,Qt=Oe(ae);if(dr==I)ae=Qt;else if(!Qt){if(dr==y)continue e;break e}}oe[J++]=ae}return oe}Ae.prototype=ss(On.prototype),Ae.prototype.constructor=Ae;function Ti(e){var t=-1,s=e==null?0:e.length;for(this.clear();++t<s;){var a=e[t];this.set(a[0],a[1])}}function wp(){this.__data__=xs?xs(null):{},this.size=0}function _p(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}function bp(e){var t=this.__data__;if(xs){var s=t[e];return s===b?i:s}return ze.call(t,e)?t[e]:i}function Ep(e){var t=this.__data__;return xs?t[e]!==i:ze.call(t,e)}function Ip(e,t){var s=this.__data__;return this.size+=this.has(e)?0:1,s[e]=xs&&t===i?b:t,this}Ti.prototype.clear=wp,Ti.prototype.delete=_p,Ti.prototype.get=bp,Ti.prototype.has=Ep,Ti.prototype.set=Ip;function Yr(e){var t=-1,s=e==null?0:e.length;for(this.clear();++t<s;){var a=e[t];this.set(a[0],a[1])}}function xp(){this.__data__=[],this.size=0}function Sp(e){var t=this.__data__,s=Rn(t,e);if(s<0)return!1;var a=t.length-1;return s==a?t.pop():In.call(t,s,1),--this.size,!0}function Pp(e){var t=this.__data__,s=Rn(t,e);return s<0?i:t[s][1]}function Ap(e){return Rn(this.__data__,e)>-1}function Cp(e,t){var s=this.__data__,a=Rn(s,e);return a<0?(++this.size,s.push([e,t])):s[a][1]=t,this}Yr.prototype.clear=xp,Yr.prototype.delete=Sp,Yr.prototype.get=Pp,Yr.prototype.has=Ap,Yr.prototype.set=Cp;function Xr(e){var t=-1,s=e==null?0:e.length;for(this.clear();++t<s;){var a=e[t];this.set(a[0],a[1])}}function Op(){this.size=0,this.__data__={hash:new Ti,map:new(Es||Yr),string:new Ti}}function Rp(e){var t=Bn(this,e).delete(e);return this.size-=t?1:0,t}function Tp(e){return Bn(this,e).get(e)}function Np(e){return Bn(this,e).has(e)}function Dp(e,t){var s=Bn(this,e),a=s.size;return s.set(e,t),this.size+=s.size==a?0:1,this}Xr.prototype.clear=Op,Xr.prototype.delete=Rp,Xr.prototype.get=Tp,Xr.prototype.has=Np,Xr.prototype.set=Dp;function Ni(e){var t=-1,s=e==null?0:e.length;for(this.__data__=new Xr;++t<s;)this.add(e[t])}function Fp(e){return this.__data__.set(e,b),this}function Lp(e){return this.__data__.has(e)}Ni.prototype.add=Ni.prototype.push=Fp,Ni.prototype.has=Lp;function Nr(e){var t=this.__data__=new Yr(e);this.size=t.size}function $p(){this.__data__=new Yr,this.size=0}function Mp(e){var t=this.__data__,s=t.delete(e);return this.size=t.size,s}function jp(e){return this.__data__.get(e)}function zp(e){return this.__data__.has(e)}function Up(e,t){var s=this.__data__;if(s instanceof Yr){var a=s.__data__;if(!Es||a.length<o-1)return a.push([e,t]),this.size=++s.size,this;s=this.__data__=new Xr(a)}return s.set(e,t),this.size=s.size,this}Nr.prototype.clear=$p,Nr.prototype.delete=Mp,Nr.prototype.get=jp,Nr.prototype.has=zp,Nr.prototype.set=Up;function Vc(e,t){var s=we(e),a=!s&&Mi(e),h=!s&&!a&&mi(e),p=!s&&!a&&!h&&cs(e),w=s||a||h||p,_=w?Vo(e.length,Yf):[],A=_.length;for(var M in e)(t||ze.call(e,M))&&!(w&&(M=="length"||h&&(M=="offset"||M=="parent")||p&&(M=="buffer"||M=="byteLength"||M=="byteOffset")||ti(M,A)))&&_.push(M);return _}function Gc(e){var t=e.length;return t?e[ua(0,t-1)]:i}function qp(e,t){return Hn(sr(e),Di(t,0,e.length))}function Bp(e){return Hn(sr(e))}function Qo(e,t,s){(s!==i&&!Dr(e[t],s)||s===i&&!(t in e))&&Zr(e,t,s)}function Ps(e,t,s){var a=e[t];(!(ze.call(e,t)&&Dr(a,s))||s===i&&!(t in e))&&Zr(e,t,s)}function Rn(e,t){for(var s=e.length;s--;)if(Dr(e[s][0],t))return s;return-1}function Hp(e,t,s,a){return di(e,function(h,p,w){t(a,h,s(h),w)}),a}function Wc(e,t){return e&&Hr(t,Ut(t),e)}function kp(e,t){return e&&Hr(t,or(t),e)}function Zr(e,t,s){t=="__proto__"&&xn?xn(e,t,{configurable:!0,enumerable:!0,value:s,writable:!0}):e[t]=s}function ea(e,t){for(var s=-1,a=t.length,h=T(a),p=e==null;++s<a;)h[s]=p?i:Fa(e,t[s]);return h}function Di(e,t,s){return e===e&&(s!==i&&(e=e<=s?e:s),t!==i&&(e=e>=t?e:t)),e}function br(e,t,s,a,h,p){var w,_=t&O,A=t&F,M=t&z;if(s&&(w=h?s(e,a,h,p):s(e)),w!==i)return w;if(!ct(e))return e;var j=we(e);if(j){if(w=Nd(e),!_)return sr(e,w)}else{var H=Gt(e),J=H==ee||H==ge;if(mi(e))return mu(e,_);if(H==Pe||H==Ie||J&&!h){if(w=A||J?{}:Mu(e),!_)return A?bd(e,kp(w,e)):_d(e,Wc(w,e))}else{if(!Be[H])return h?e:{};w=Dd(e,H,_)}}p||(p=new Nr);var te=p.get(e);if(te)return te;p.set(e,w),fh(e)?e.forEach(function(ae){w.add(br(ae,t,s,ae,e,p))}):hh(e)&&e.forEach(function(ae,Se){w.set(Se,br(ae,t,s,Se,e,p))});var oe=M?A?_a:wa:A?or:Ut,Ee=j?i:oe(e);return mr(Ee||e,function(ae,Se){Ee&&(Se=ae,ae=e[Se]),Ps(w,Se,br(ae,t,s,Se,e,p))}),w}function Kp(e){var t=Ut(e);return function(s){return Jc(s,e,t)}}function Jc(e,t,s){var a=s.length;if(e==null)return!a;for(e=We(e);a--;){var h=s[a],p=t[h],w=e[h];if(w===i&&!(h in e)||!p(w))return!1}return!0}function Yc(e,t,s){if(typeof e!="function")throw new wr(d);return Ds(function(){e.apply(i,s)},t)}function As(e,t,s,a){var h=-1,p=pn,w=!0,_=e.length,A=[],M=t.length;if(!_)return A;s&&(t=st(t,lr(s))),a?(p=Uo,w=!1):t.length>=o&&(p=_s,w=!1,t=new Ni(t));e:for(;++h<_;){var j=e[h],H=s==null?j:s(j);if(j=a||j!==0?j:0,w&&H===H){for(var J=M;J--;)if(t[J]===H)continue e;A.push(j)}else p(t,H,a)||A.push(j)}return A}var di=Iu(Br),Xc=Iu(ra,!0);function Vp(e,t){var s=!0;return di(e,function(a,h,p){return s=!!t(a,h,p),s}),s}function Tn(e,t,s){for(var a=-1,h=e.length;++a<h;){var p=e[a],w=t(p);if(w!=null&&(_===i?w===w&&!pr(w):s(w,_)))var _=w,A=p}return A}function Gp(e,t,s,a){var h=e.length;for(s=_e(s),s<0&&(s=-s>h?0:h+s),a=a===i||a>h?h:_e(a),a<0&&(a+=h),a=s>a?0:dh(a);s<a;)e[s++]=t;return e}function Zc(e,t){var s=[];return di(e,function(a,h,p){t(a,h,p)&&s.push(a)}),s}function kt(e,t,s,a,h){var p=-1,w=e.length;for(s||(s=Ld),h||(h=[]);++p<w;){var _=e[p];t>0&&s(_)?t>1?kt(_,t-1,s,a,h):li(h,_):a||(h[h.length]=_)}return h}var ta=xu(),Qc=xu(!0);function Br(e,t){return e&&ta(e,t,Ut)}function ra(e,t){return e&&Qc(e,t,Ut)}function Nn(e,t){return hi(t,function(s){return ri(e[s])})}function Fi(e,t){t=yi(t,e);for(var s=0,a=t.length;e!=null&&s<a;)e=e[kr(t[s++])];return s&&s==a?e:i}function eu(e,t,s){var a=t(e);return we(e)?a:li(a,s(e))}function Xt(e){return e==null?e===i?ot:Fe:Ri&&Ri in We(e)?Od(e):Bd(e)}function ia(e,t){return e>t}function Wp(e,t){return e!=null&&ze.call(e,t)}function Jp(e,t){return e!=null&&t in We(e)}function Yp(e,t,s){return e>=Vt(t,s)&&e<Mt(t,s)}function sa(e,t,s){for(var a=s?Uo:pn,h=e[0].length,p=e.length,w=p,_=T(p),A=1/0,M=[];w--;){var j=e[w];w&&t&&(j=st(j,lr(t))),A=Vt(j.length,A),_[w]=!s&&(t||h>=120&&j.length>=120)?new Ni(w&&j):i}j=e[0];var H=-1,J=_[0];e:for(;++H<h&&M.length<A;){var te=j[H],oe=t?t(te):te;if(te=s||te!==0?te:0,!(J?_s(J,oe):a(M,oe,s))){for(w=p;--w;){var Ee=_[w];if(!(Ee?_s(Ee,oe):a(e[w],oe,s)))continue e}J&&J.push(oe),M.push(te)}}return M}function Xp(e,t,s,a){return Br(e,function(h,p,w){t(a,s(h),p,w)}),a}function Cs(e,t,s){t=yi(t,e),e=qu(e,t);var a=e==null?e:e[kr(Ir(t))];return a==null?i:zt(a,e,s)}function tu(e){return yt(e)&&Xt(e)==Ie}function Zp(e){return yt(e)&&Xt(e)==De}function Qp(e){return yt(e)&&Xt(e)==C}function Os(e,t,s,a,h){return e===t?!0:e==null||t==null||!yt(e)&&!yt(t)?e!==e&&t!==t:ed(e,t,s,a,Os,h)}function ed(e,t,s,a,h,p){var w=we(e),_=we(t),A=w?xt:Gt(e),M=_?xt:Gt(t);A=A==Ie?Pe:A,M=M==Ie?Pe:M;var j=A==Pe,H=M==Pe,J=A==M;if(J&&mi(e)){if(!mi(t))return!1;w=!0,j=!1}if(J&&!j)return p||(p=new Nr),w||cs(e)?Fu(e,t,s,a,h,p):Ad(e,t,A,s,a,h,p);if(!(s&R)){var te=j&&ze.call(e,"__wrapped__"),oe=H&&ze.call(t,"__wrapped__");if(te||oe){var Ee=te?e.value():e,ae=oe?t.value():t;return p||(p=new Nr),h(Ee,ae,s,a,p)}}return J?(p||(p=new Nr),Cd(e,t,s,a,h,p)):!1}function td(e){return yt(e)&&Gt(e)==be}function na(e,t,s,a){var h=s.length,p=h,w=!a;if(e==null)return!p;for(e=We(e);h--;){var _=s[h];if(w&&_[2]?_[1]!==e[_[0]]:!(_[0]in e))return!1}for(;++h<p;){_=s[h];var A=_[0],M=e[A],j=_[1];if(w&&_[2]){if(M===i&&!(A in e))return!1}else{var H=new Nr;if(a)var J=a(M,j,A,e,t,H);if(!(J===i?Os(j,M,R|K,a,H):J))return!1}}return!0}function ru(e){if(!ct(e)||Md(e))return!1;var t=ri(e)?tp:xo;return t.test($i(e))}function rd(e){return yt(e)&&Xt(e)==nt}function id(e){return yt(e)&&Gt(e)==$e}function sd(e){return yt(e)&&Jn(e.length)&&!!Ke[Xt(e)]}function iu(e){return typeof e=="function"?e:e==null?ar:typeof e=="object"?we(e)?ou(e[0],e[1]):nu(e):Sh(e)}function oa(e){if(!Ns(e))return ap(e);var t=[];for(var s in We(e))ze.call(e,s)&&s!="constructor"&&t.push(s);return t}function nd(e){if(!ct(e))return qd(e);var t=Ns(e),s=[];for(var a in e)a=="constructor"&&(t||!ze.call(e,a))||s.push(a);return s}function aa(e,t){return e<t}function su(e,t){var s=-1,a=nr(e)?T(e.length):[];return di(e,function(h,p,w){a[++s]=t(h,p,w)}),a}function nu(e){var t=Ea(e);return t.length==1&&t[0][2]?zu(t[0][0],t[0][1]):function(s){return s===e||na(s,e,t)}}function ou(e,t){return xa(e)&&ju(t)?zu(kr(e),t):function(s){var a=Fa(s,e);return a===i&&a===t?La(s,e):Os(t,a,R|K)}}function Dn(e,t,s,a,h){e!==t&&ta(t,function(p,w){if(h||(h=new Nr),ct(p))od(e,t,w,s,Dn,a,h);else{var _=a?a(Pa(e,w),p,w+"",e,t,h):i;_===i&&(_=p),Qo(e,w,_)}},or)}function od(e,t,s,a,h,p,w){var _=Pa(e,s),A=Pa(t,s),M=w.get(A);if(M){Qo(e,s,M);return}var j=p?p(_,A,s+"",e,t,w):i,H=j===i;if(H){var J=we(A),te=!J&&mi(A),oe=!J&&!te&&cs(A);j=A,J||te||oe?we(_)?j=_:bt(_)?j=sr(_):te?(H=!1,j=mu(A,!0)):oe?(H=!1,j=wu(A,!0)):j=[]:Fs(A)||Mi(A)?(j=_,Mi(_)?j=gh(_):(!ct(_)||ri(_))&&(j=Mu(A))):H=!1}H&&(w.set(A,j),h(j,A,a,p,w),w.delete(A)),Qo(e,s,j)}function au(e,t){var s=e.length;if(s)return t+=t<0?s:0,ti(t,s)?e[t]:i}function cu(e,t,s){t.length?t=st(t,function(p){return we(p)?function(w){return Fi(w,p.length===1?p[0]:p)}:p}):t=[ar];var a=-1;t=st(t,lr(se()));var h=su(e,function(p,w,_){var A=st(t,function(M){return M(p)});return{criteria:A,index:++a,value:p}});return Df(h,function(p,w){return wd(p,w,s)})}function ad(e,t){return uu(e,t,function(s,a){return La(e,a)})}function uu(e,t,s){for(var a=-1,h=t.length,p={};++a<h;){var w=t[a],_=Fi(e,w);s(_,w)&&Rs(p,yi(w,e),_)}return p}function cd(e){return function(t){return Fi(t,e)}}function ca(e,t,s,a){var h=a?Nf:Xi,p=-1,w=t.length,_=e;for(e===t&&(t=sr(t)),s&&(_=st(e,lr(s)));++p<w;)for(var A=0,M=t[p],j=s?s(M):M;(A=h(_,j,A,a))>-1;)_!==e&&In.call(_,A,1),In.call(e,A,1);return e}function hu(e,t){for(var s=e?t.length:0,a=s-1;s--;){var h=t[s];if(s==a||h!==p){var p=h;ti(h)?In.call(e,h,1):fa(e,h)}}return e}function ua(e,t){return e+Pn(kc()*(t-e+1))}function ud(e,t,s,a){for(var h=-1,p=Mt(Sn((t-e)/(s||1)),0),w=T(p);p--;)w[a?p:++h]=e,e+=s;return w}function ha(e,t){var s="";if(!e||t<1||t>V)return s;do t%2&&(s+=e),t=Pn(t/2),t&&(e+=e);while(t);return s}function xe(e,t){return Aa(Uu(e,t,ar),e+"")}function hd(e){return Gc(us(e))}function ld(e,t){var s=us(e);return Hn(s,Di(t,0,s.length))}function Rs(e,t,s,a){if(!ct(e))return e;t=yi(t,e);for(var h=-1,p=t.length,w=p-1,_=e;_!=null&&++h<p;){var A=kr(t[h]),M=s;if(A==="__proto__"||A==="constructor"||A==="prototype")return e;if(h!=w){var j=_[A];M=a?a(j,A,_):i,M===i&&(M=ct(j)?j:ti(t[h+1])?[]:{})}Ps(_,A,M),_=_[A]}return e}var lu=An?function(e,t){return An.set(e,t),e}:ar,fd=xn?function(e,t){return xn(e,"toString",{configurable:!0,enumerable:!1,value:Ma(t),writable:!0})}:ar;function pd(e){return Hn(us(e))}function Er(e,t,s){var a=-1,h=e.length;t<0&&(t=-t>h?0:h+t),s=s>h?h:s,s<0&&(s+=h),h=t>s?0:s-t>>>0,t>>>=0;for(var p=T(h);++a<h;)p[a]=e[a+t];return p}function dd(e,t){var s;return di(e,function(a,h,p){return s=t(a,h,p),!s}),!!s}function Fn(e,t,s){var a=0,h=e==null?a:e.length;if(typeof t=="number"&&t===t&&h<=He){for(;a<h;){var p=a+h>>>1,w=e[p];w!==null&&!pr(w)&&(s?w<=t:w<t)?a=p+1:h=p}return h}return la(e,t,ar,s)}function la(e,t,s,a){var h=0,p=e==null?0:e.length;if(p===0)return 0;t=s(t);for(var w=t!==t,_=t===null,A=pr(t),M=t===i;h<p;){var j=Pn((h+p)/2),H=s(e[j]),J=H!==i,te=H===null,oe=H===H,Ee=pr(H);if(w)var ae=a||oe;else M?ae=oe&&(a||J):_?ae=oe&&J&&(a||!te):A?ae=oe&&J&&!te&&(a||!Ee):te||Ee?ae=!1:ae=a?H<=t:H<t;ae?h=j+1:p=j}return Vt(p,Je)}function fu(e,t){for(var s=-1,a=e.length,h=0,p=[];++s<a;){var w=e[s],_=t?t(w):w;if(!s||!Dr(_,A)){var A=_;p[h++]=w===0?0:w}}return p}function pu(e){return typeof e=="number"?e:pr(e)?k:+e}function fr(e){if(typeof e=="string")return e;if(we(e))return st(e,fr)+"";if(pr(e))return Kc?Kc.call(e):"";var t=e+"";return t=="0"&&1/e==-ce?"-0":t}function gi(e,t,s){var a=-1,h=pn,p=e.length,w=!0,_=[],A=_;if(s)w=!1,h=Uo;else if(p>=o){var M=t?null:Sd(e);if(M)return gn(M);w=!1,h=_s,A=new Ni}else A=t?[]:_;e:for(;++a<p;){var j=e[a],H=t?t(j):j;if(j=s||j!==0?j:0,w&&H===H){for(var J=A.length;J--;)if(A[J]===H)continue e;t&&A.push(H),_.push(j)}else h(A,H,s)||(A!==_&&A.push(H),_.push(j))}return _}function fa(e,t){return t=yi(t,e),e=qu(e,t),e==null||delete e[kr(Ir(t))]}function du(e,t,s,a){return Rs(e,t,s(Fi(e,t)),a)}function Ln(e,t,s,a){for(var h=e.length,p=a?h:-1;(a?p--:++p<h)&&t(e[p],p,e););return s?Er(e,a?0:p,a?p+1:h):Er(e,a?p+1:0,a?h:p)}function gu(e,t){var s=e;return s instanceof Ae&&(s=s.value()),qo(t,function(a,h){return h.func.apply(h.thisArg,li([a],h.args))},s)}function pa(e,t,s){var a=e.length;if(a<2)return a?gi(e[0]):[];for(var h=-1,p=T(a);++h<a;)for(var w=e[h],_=-1;++_<a;)_!=h&&(p[h]=As(p[h]||w,e[_],t,s));return gi(kt(p,1),t,s)}function yu(e,t,s){for(var a=-1,h=e.length,p=t.length,w={};++a<h;){var _=a<p?t[a]:i;s(w,e[a],_)}return w}function da(e){return bt(e)?e:[]}function ga(e){return typeof e=="function"?e:ar}function yi(e,t){return we(e)?e:xa(e,t)?[e]:Ku(Me(e))}var gd=xe;function vi(e,t,s){var a=e.length;return s=s===i?a:s,!t&&s>=a?e:Er(e,t,s)}var vu=rp||function(e){return Ce.clearTimeout(e)};function mu(e,t){if(t)return e.slice();var s=e.length,a=zc?zc(s):new e.constructor(s);return e.copy(a),a}function ya(e){var t=new e.constructor(e.byteLength);return new bn(t).set(new bn(e)),t}function yd(e,t){var s=t?ya(e.buffer):e.buffer;return new e.constructor(s,e.byteOffset,e.byteLength)}function vd(e){var t=new e.constructor(e.source,yr.exec(e));return t.lastIndex=e.lastIndex,t}function md(e){return Ss?We(Ss.call(e)):{}}function wu(e,t){var s=t?ya(e.buffer):e.buffer;return new e.constructor(s,e.byteOffset,e.length)}function _u(e,t){if(e!==t){var s=e!==i,a=e===null,h=e===e,p=pr(e),w=t!==i,_=t===null,A=t===t,M=pr(t);if(!_&&!M&&!p&&e>t||p&&w&&A&&!_&&!M||a&&w&&A||!s&&A||!h)return 1;if(!a&&!p&&!M&&e<t||M&&s&&h&&!a&&!p||_&&s&&h||!w&&h||!A)return-1}return 0}function wd(e,t,s){for(var a=-1,h=e.criteria,p=t.criteria,w=h.length,_=s.length;++a<w;){var A=_u(h[a],p[a]);if(A){if(a>=_)return A;var M=s[a];return A*(M=="desc"?-1:1)}}return e.index-t.index}function bu(e,t,s,a){for(var h=-1,p=e.length,w=s.length,_=-1,A=t.length,M=Mt(p-w,0),j=T(A+M),H=!a;++_<A;)j[_]=t[_];for(;++h<w;)(H||h<p)&&(j[s[h]]=e[h]);for(;M--;)j[_++]=e[h++];return j}function Eu(e,t,s,a){for(var h=-1,p=e.length,w=-1,_=s.length,A=-1,M=t.length,j=Mt(p-_,0),H=T(j+M),J=!a;++h<j;)H[h]=e[h];for(var te=h;++A<M;)H[te+A]=t[A];for(;++w<_;)(J||h<p)&&(H[te+s[w]]=e[h++]);return H}function sr(e,t){var s=-1,a=e.length;for(t||(t=T(a));++s<a;)t[s]=e[s];return t}function Hr(e,t,s,a){var h=!s;s||(s={});for(var p=-1,w=t.length;++p<w;){var _=t[p],A=a?a(s[_],e[_],_,s,e):i;A===i&&(A=e[_]),h?Zr(s,_,A):Ps(s,_,A)}return s}function _d(e,t){return Hr(e,Ia(e),t)}function bd(e,t){return Hr(e,Lu(e),t)}function $n(e,t){return function(s,a){var h=we(s)?Pf:Hp,p=t?t():{};return h(s,e,se(a,2),p)}}function ns(e){return xe(function(t,s){var a=-1,h=s.length,p=h>1?s[h-1]:i,w=h>2?s[2]:i;for(p=e.length>3&&typeof p=="function"?(h--,p):i,w&&Zt(s[0],s[1],w)&&(p=h<3?i:p,h=1),t=We(t);++a<h;){var _=s[a];_&&e(t,_,a,p)}return t})}function Iu(e,t){return function(s,a){if(s==null)return s;if(!nr(s))return e(s,a);for(var h=s.length,p=t?h:-1,w=We(s);(t?p--:++p<h)&&a(w[p],p,w)!==!1;);return s}}function xu(e){return function(t,s,a){for(var h=-1,p=We(t),w=a(t),_=w.length;_--;){var A=w[e?_:++h];if(s(p[A],A,p)===!1)break}return t}}function Ed(e,t,s){var a=t&re,h=Ts(e);function p(){var w=this&&this!==Ce&&this instanceof p?h:e;return w.apply(a?s:this,arguments)}return p}function Su(e){return function(t){t=Me(t);var s=Zi(t)?Tr(t):i,a=s?s[0]:t.charAt(0),h=s?vi(s,1).join(""):t.slice(1);return a[e]()+h}}function os(e){return function(t){return qo(Ih(Eh(t).replace(ms,"")),e,"")}}function Ts(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var s=ss(e.prototype),a=e.apply(s,t);return ct(a)?a:s}}function Id(e,t,s){var a=Ts(e);function h(){for(var p=arguments.length,w=T(p),_=p,A=as(h);_--;)w[_]=arguments[_];var M=p<3&&w[0]!==A&&w[p-1]!==A?[]:fi(w,A);if(p-=M.length,p<s)return Ru(e,t,Mn,h.placeholder,i,w,M,i,i,s-p);var j=this&&this!==Ce&&this instanceof h?a:e;return zt(j,this,w)}return h}function Pu(e){return function(t,s,a){var h=We(t);if(!nr(t)){var p=se(s,3);t=Ut(t),s=function(_){return p(h[_],_,h)}}var w=e(t,s,a);return w>-1?h[p?t[w]:w]:i}}function Au(e){return ei(function(t){var s=t.length,a=s,h=_r.prototype.thru;for(e&&t.reverse();a--;){var p=t[a];if(typeof p!="function")throw new wr(d);if(h&&!w&&qn(p)=="wrapper")var w=new _r([],!0)}for(a=w?a:s;++a<s;){p=t[a];var _=qn(p),A=_=="wrapper"?ba(p):i;A&&Sa(A[0])&&A[1]==(q|fe|de|W)&&!A[4].length&&A[9]==1?w=w[qn(A[0])].apply(w,A[3]):w=p.length==1&&Sa(p)?w[_]():w.thru(p)}return function(){var M=arguments,j=M[0];if(w&&M.length==1&&we(j))return w.plant(j).value();for(var H=0,J=s?t[H].apply(this,M):j;++H<s;)J=t[H].call(this,J);return J}})}function Mn(e,t,s,a,h,p,w,_,A,M){var j=t&q,H=t&re,J=t&he,te=t&(fe|pe),oe=t&ve,Ee=J?i:Ts(e);function ae(){for(var Se=arguments.length,Oe=T(Se),dr=Se;dr--;)Oe[dr]=arguments[dr];if(te)var Qt=as(ae),gr=Lf(Oe,Qt);if(a&&(Oe=bu(Oe,a,h,te)),p&&(Oe=Eu(Oe,p,w,te)),Se-=gr,te&&Se<M){var Et=fi(Oe,Qt);return Ru(e,t,Mn,ae.placeholder,s,Oe,Et,_,A,M-Se)}var Fr=H?s:this,si=J?Fr[e]:e;return Se=Oe.length,_?Oe=Hd(Oe,_):oe&&Se>1&&Oe.reverse(),j&&A<Se&&(Oe.length=A),this&&this!==Ce&&this instanceof ae&&(si=Ee||Ts(si)),si.apply(Fr,Oe)}return ae}function Cu(e,t){return function(s,a){return Xp(s,e,t(a),{})}}function jn(e,t){return function(s,a){var h;if(s===i&&a===i)return t;if(s!==i&&(h=s),a!==i){if(h===i)return a;typeof s=="string"||typeof a=="string"?(s=fr(s),a=fr(a)):(s=pu(s),a=pu(a)),h=e(s,a)}return h}}function va(e){return ei(function(t){return t=st(t,lr(se())),xe(function(s){var a=this;return e(t,function(h){return zt(h,a,s)})})})}function zn(e,t){t=t===i?" ":fr(t);var s=t.length;if(s<2)return s?ha(t,e):t;var a=ha(t,Sn(e/Qi(t)));return Zi(t)?vi(Tr(a),0,e).join(""):a.slice(0,e)}function xd(e,t,s,a){var h=t&re,p=Ts(e);function w(){for(var _=-1,A=arguments.length,M=-1,j=a.length,H=T(j+A),J=this&&this!==Ce&&this instanceof w?p:e;++M<j;)H[M]=a[M];for(;A--;)H[M++]=arguments[++_];return zt(J,h?s:this,H)}return w}function Ou(e){return function(t,s,a){return a&&typeof a!="number"&&Zt(t,s,a)&&(s=a=i),t=ii(t),s===i?(s=t,t=0):s=ii(s),a=a===i?t<s?1:-1:ii(a),ud(t,s,a,e)}}function Un(e){return function(t,s){return typeof t=="string"&&typeof s=="string"||(t=xr(t),s=xr(s)),e(t,s)}}function Ru(e,t,s,a,h,p,w,_,A,M){var j=t&fe,H=j?w:i,J=j?i:w,te=j?p:i,oe=j?i:p;t|=j?de:L,t&=~(j?L:de),t&le||(t&=~(re|he));var Ee=[e,t,h,te,H,oe,J,_,A,M],ae=s.apply(i,Ee);return Sa(e)&&Bu(ae,Ee),ae.placeholder=a,Hu(ae,e,t)}function ma(e){var t=$t[e];return function(s,a){if(s=xr(s),a=a==null?0:Vt(_e(a),292),a&&Hc(s)){var h=(Me(s)+"e").split("e"),p=t(h[0]+"e"+(+h[1]+a));return h=(Me(p)+"e").split("e"),+(h[0]+"e"+(+h[1]-a))}return t(s)}}var Sd=rs&&1/gn(new rs([,-0]))[1]==ce?function(e){return new rs(e)}:Ua;function Tu(e){return function(t){var s=Gt(t);return s==be?Wo(t):s==$e?Bf(t):Ff(t,e(t))}}function Qr(e,t,s,a,h,p,w,_){var A=t&he;if(!A&&typeof e!="function")throw new wr(d);var M=a?a.length:0;if(M||(t&=~(de|L),a=h=i),w=w===i?w:Mt(_e(w),0),_=_===i?_:_e(_),M-=h?h.length:0,t&L){var j=a,H=h;a=h=i}var J=A?i:ba(e),te=[e,t,s,a,h,j,H,p,w,_];if(J&&Ud(te,J),e=te[0],t=te[1],s=te[2],a=te[3],h=te[4],_=te[9]=te[9]===i?A?0:e.length:Mt(te[9]-M,0),!_&&t&(fe|pe)&&(t&=~(fe|pe)),!t||t==re)var oe=Ed(e,t,s);else t==fe||t==pe?oe=Id(e,t,_):(t==de||t==(re|de))&&!h.length?oe=xd(e,t,s,a):oe=Mn.apply(i,te);var Ee=J?lu:Bu;return Hu(Ee(oe,te),e,t)}function Nu(e,t,s,a){return e===i||Dr(e,ts[s])&&!ze.call(a,s)?t:e}function Du(e,t,s,a,h,p){return ct(e)&&ct(t)&&(p.set(t,e),Dn(e,t,i,Du,p),p.delete(t)),e}function Pd(e){return Fs(e)?i:e}function Fu(e,t,s,a,h,p){var w=s&R,_=e.length,A=t.length;if(_!=A&&!(w&&A>_))return!1;var M=p.get(e),j=p.get(t);if(M&&j)return M==t&&j==e;var H=-1,J=!0,te=s&K?new Ni:i;for(p.set(e,t),p.set(t,e);++H<_;){var oe=e[H],Ee=t[H];if(a)var ae=w?a(Ee,oe,H,t,e,p):a(oe,Ee,H,e,t,p);if(ae!==i){if(ae)continue;J=!1;break}if(te){if(!Bo(t,function(Se,Oe){if(!_s(te,Oe)&&(oe===Se||h(oe,Se,s,a,p)))return te.push(Oe)})){J=!1;break}}else if(!(oe===Ee||h(oe,Ee,s,a,p))){J=!1;break}}return p.delete(e),p.delete(t),J}function Ad(e,t,s,a,h,p,w){switch(s){case ke:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case De:return!(e.byteLength!=t.byteLength||!p(new bn(e),new bn(t)));case N:case C:case Ne:return Dr(+e,+t);case E:return e.name==t.name&&e.message==t.message;case nt:case Xe:return e==t+"";case be:var _=Wo;case $e:var A=a&R;if(_||(_=gn),e.size!=t.size&&!A)return!1;var M=w.get(e);if(M)return M==t;a|=K,w.set(e,t);var j=Fu(_(e),_(t),a,h,p,w);return w.delete(e),j;case Ze:if(Ss)return Ss.call(e)==Ss.call(t)}return!1}function Cd(e,t,s,a,h,p){var w=s&R,_=wa(e),A=_.length,M=wa(t),j=M.length;if(A!=j&&!w)return!1;for(var H=A;H--;){var J=_[H];if(!(w?J in t:ze.call(t,J)))return!1}var te=p.get(e),oe=p.get(t);if(te&&oe)return te==t&&oe==e;var Ee=!0;p.set(e,t),p.set(t,e);for(var ae=w;++H<A;){J=_[H];var Se=e[J],Oe=t[J];if(a)var dr=w?a(Oe,Se,J,t,e,p):a(Se,Oe,J,e,t,p);if(!(dr===i?Se===Oe||h(Se,Oe,s,a,p):dr)){Ee=!1;break}ae||(ae=J=="constructor")}if(Ee&&!ae){var Qt=e.constructor,gr=t.constructor;Qt!=gr&&"constructor"in e&&"constructor"in t&&!(typeof Qt=="function"&&Qt instanceof Qt&&typeof gr=="function"&&gr instanceof gr)&&(Ee=!1)}return p.delete(e),p.delete(t),Ee}function ei(e){return Aa(Uu(e,i,Ju),e+"")}function wa(e){return eu(e,Ut,Ia)}function _a(e){return eu(e,or,Lu)}var ba=An?function(e){return An.get(e)}:Ua;function qn(e){for(var t=e.name+"",s=is[t],a=ze.call(is,t)?s.length:0;a--;){var h=s[a],p=h.func;if(p==null||p==e)return h.name}return t}function as(e){var t=ze.call(f,"placeholder")?f:e;return t.placeholder}function se(){var e=f.iteratee||ja;return e=e===ja?iu:e,arguments.length?e(arguments[0],arguments[1]):e}function Bn(e,t){var s=e.__data__;return $d(t)?s[typeof t=="string"?"string":"hash"]:s.map}function Ea(e){for(var t=Ut(e),s=t.length;s--;){var a=t[s],h=e[a];t[s]=[a,h,ju(h)]}return t}function Li(e,t){var s=zf(e,t);return ru(s)?s:i}function Od(e){var t=ze.call(e,Ri),s=e[Ri];try{e[Ri]=i;var a=!0}catch{}var h=wn.call(e);return a&&(t?e[Ri]=s:delete e[Ri]),h}var Ia=Yo?function(e){return e==null?[]:(e=We(e),hi(Yo(e),function(t){return qc.call(e,t)}))}:qa,Lu=Yo?function(e){for(var t=[];e;)li(t,Ia(e)),e=En(e);return t}:qa,Gt=Xt;(Xo&&Gt(new Xo(new ArrayBuffer(1)))!=ke||Es&&Gt(new Es)!=be||Zo&&Gt(Zo.resolve())!=St||rs&&Gt(new rs)!=$e||Is&&Gt(new Is)!=qe)&&(Gt=function(e){var t=Xt(e),s=t==Pe?e.constructor:i,a=s?$i(s):"";if(a)switch(a){case lp:return ke;case fp:return be;case pp:return St;case dp:return $e;case gp:return qe}return t});function Rd(e,t,s){for(var a=-1,h=s.length;++a<h;){var p=s[a],w=p.size;switch(p.type){case"drop":e+=w;break;case"dropRight":t-=w;break;case"take":t=Vt(t,e+w);break;case"takeRight":e=Mt(e,t-w);break}}return{start:e,end:t}}function Td(e){var t=e.match(Ye);return t?t[1].split(Rt):[]}function $u(e,t,s){t=yi(t,e);for(var a=-1,h=t.length,p=!1;++a<h;){var w=kr(t[a]);if(!(p=e!=null&&s(e,w)))break;e=e[w]}return p||++a!=h?p:(h=e==null?0:e.length,!!h&&Jn(h)&&ti(w,h)&&(we(e)||Mi(e)))}function Nd(e){var t=e.length,s=new e.constructor(t);return t&&typeof e[0]=="string"&&ze.call(e,"index")&&(s.index=e.index,s.input=e.input),s}function Mu(e){return typeof e.constructor=="function"&&!Ns(e)?ss(En(e)):{}}function Dd(e,t,s){var a=e.constructor;switch(t){case De:return ya(e);case N:case C:return new a(+e);case ke:return yd(e,s);case ut:case je:case Pt:case Lt:case Bt:case Ht:case jt:case Wt:case rr:return wu(e,s);case be:return new a;case Ne:case Xe:return new a(e);case nt:return vd(e);case $e:return new a;case Ze:return md(e)}}function Fd(e,t){var s=t.length;if(!s)return e;var a=s-1;return t[a]=(s>1?"& ":"")+t[a],t=t.join(s>2?", ":" "),e.replace(gt,`{
/* [wrapped with `+t+`] */
`)}function Ld(e){return we(e)||Mi(e)||!!(Bc&&e&&e[Bc])}function ti(e,t){var s=typeof e;return t=t??V,!!t&&(s=="number"||s!="symbol"&&Po.test(e))&&e>-1&&e%1==0&&e<t}function Zt(e,t,s){if(!ct(s))return!1;var a=typeof t;return(a=="number"?nr(s)&&ti(t,s.length):a=="string"&&t in s)?Dr(s[t],e):!1}function xa(e,t){if(we(e))return!1;var s=typeof e;return s=="number"||s=="symbol"||s=="boolean"||e==null||pr(e)?!0:At.test(e)||!it.test(e)||t!=null&&e in We(t)}function $d(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function Sa(e){var t=qn(e),s=f[t];if(typeof s!="function"||!(t in Ae.prototype))return!1;if(e===s)return!0;var a=ba(s);return!!a&&e===a[0]}function Md(e){return!!jc&&jc in e}var jd=vn?ri:Ba;function Ns(e){var t=e&&e.constructor,s=typeof t=="function"&&t.prototype||ts;return e===s}function ju(e){return e===e&&!ct(e)}function zu(e,t){return function(s){return s==null?!1:s[e]===t&&(t!==i||e in We(s))}}function zd(e){var t=Gn(e,function(a){return s.size===m&&s.clear(),a}),s=t.cache;return t}function Ud(e,t){var s=e[1],a=t[1],h=s|a,p=h<(re|he|q),w=a==q&&s==fe||a==q&&s==W&&e[7].length<=t[8]||a==(q|W)&&t[7].length<=t[8]&&s==fe;if(!(p||w))return e;a&re&&(e[2]=t[2],h|=s&re?0:le);var _=t[3];if(_){var A=e[3];e[3]=A?bu(A,_,t[4]):_,e[4]=A?fi(e[3],S):t[4]}return _=t[5],_&&(A=e[5],e[5]=A?Eu(A,_,t[6]):_,e[6]=A?fi(e[5],S):t[6]),_=t[7],_&&(e[7]=_),a&q&&(e[8]=e[8]==null?t[8]:Vt(e[8],t[8])),e[9]==null&&(e[9]=t[9]),e[0]=t[0],e[1]=h,e}function qd(e){var t=[];if(e!=null)for(var s in We(e))t.push(s);return t}function Bd(e){return wn.call(e)}function Uu(e,t,s){return t=Mt(t===i?e.length-1:t,0),function(){for(var a=arguments,h=-1,p=Mt(a.length-t,0),w=T(p);++h<p;)w[h]=a[t+h];h=-1;for(var _=T(t+1);++h<t;)_[h]=a[h];return _[t]=s(w),zt(e,this,_)}}function qu(e,t){return t.length<2?e:Fi(e,Er(t,0,-1))}function Hd(e,t){for(var s=e.length,a=Vt(t.length,s),h=sr(e);a--;){var p=t[a];e[a]=ti(p,s)?h[p]:i}return e}function Pa(e,t){if(!(t==="constructor"&&typeof e[t]=="function")&&t!="__proto__")return e[t]}var Bu=ku(lu),Ds=sp||function(e,t){return Ce.setTimeout(e,t)},Aa=ku(fd);function Hu(e,t,s){var a=t+"";return Aa(e,Fd(a,kd(Td(a),s)))}function ku(e){var t=0,s=0;return function(){var a=cp(),h=Ue-(a-s);if(s=a,h>0){if(++t>=Te)return arguments[0]}else t=0;return e.apply(i,arguments)}}function Hn(e,t){var s=-1,a=e.length,h=a-1;for(t=t===i?a:t;++s<t;){var p=ua(s,h),w=e[p];e[p]=e[s],e[s]=w}return e.length=t,e}var Ku=zd(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(Ct,function(s,a,h,p){t.push(h?p.replace(_o,"$1"):a||s)}),t});function kr(e){if(typeof e=="string"||pr(e))return e;var t=e+"";return t=="0"&&1/e==-ce?"-0":t}function $i(e){if(e!=null){try{return mn.call(e)}catch{}try{return e+""}catch{}}return""}function kd(e,t){return mr(jr,function(s){var a="_."+s[0];t&s[1]&&!pn(e,a)&&e.push(a)}),e.sort()}function Vu(e){if(e instanceof Ae)return e.clone();var t=new _r(e.__wrapped__,e.__chain__);return t.__actions__=sr(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}function Kd(e,t,s){(s?Zt(e,t,s):t===i)?t=1:t=Mt(_e(t),0);var a=e==null?0:e.length;if(!a||t<1)return[];for(var h=0,p=0,w=T(Sn(a/t));h<a;)w[p++]=Er(e,h,h+=t);return w}function Vd(e){for(var t=-1,s=e==null?0:e.length,a=0,h=[];++t<s;){var p=e[t];p&&(h[a++]=p)}return h}function Gd(){var e=arguments.length;if(!e)return[];for(var t=T(e-1),s=arguments[0],a=e;a--;)t[a-1]=arguments[a];return li(we(s)?sr(s):[s],kt(t,1))}var Wd=xe(function(e,t){return bt(e)?As(e,kt(t,1,bt,!0)):[]}),Jd=xe(function(e,t){var s=Ir(t);return bt(s)&&(s=i),bt(e)?As(e,kt(t,1,bt,!0),se(s,2)):[]}),Yd=xe(function(e,t){var s=Ir(t);return bt(s)&&(s=i),bt(e)?As(e,kt(t,1,bt,!0),i,s):[]});function Xd(e,t,s){var a=e==null?0:e.length;return a?(t=s||t===i?1:_e(t),Er(e,t<0?0:t,a)):[]}function Zd(e,t,s){var a=e==null?0:e.length;return a?(t=s||t===i?1:_e(t),t=a-t,Er(e,0,t<0?0:t)):[]}function Qd(e,t){return e&&e.length?Ln(e,se(t,3),!0,!0):[]}function eg(e,t){return e&&e.length?Ln(e,se(t,3),!0):[]}function tg(e,t,s,a){var h=e==null?0:e.length;return h?(s&&typeof s!="number"&&Zt(e,t,s)&&(s=0,a=h),Gp(e,t,s,a)):[]}function Gu(e,t,s){var a=e==null?0:e.length;if(!a)return-1;var h=s==null?0:_e(s);return h<0&&(h=Mt(a+h,0)),dn(e,se(t,3),h)}function Wu(e,t,s){var a=e==null?0:e.length;if(!a)return-1;var h=a-1;return s!==i&&(h=_e(s),h=s<0?Mt(a+h,0):Vt(h,a-1)),dn(e,se(t,3),h,!0)}function Ju(e){var t=e==null?0:e.length;return t?kt(e,1):[]}function rg(e){var t=e==null?0:e.length;return t?kt(e,ce):[]}function ig(e,t){var s=e==null?0:e.length;return s?(t=t===i?1:_e(t),kt(e,t)):[]}function sg(e){for(var t=-1,s=e==null?0:e.length,a={};++t<s;){var h=e[t];a[h[0]]=h[1]}return a}function Yu(e){return e&&e.length?e[0]:i}function ng(e,t,s){var a=e==null?0:e.length;if(!a)return-1;var h=s==null?0:_e(s);return h<0&&(h=Mt(a+h,0)),Xi(e,t,h)}function og(e){var t=e==null?0:e.length;return t?Er(e,0,-1):[]}var ag=xe(function(e){var t=st(e,da);return t.length&&t[0]===e[0]?sa(t):[]}),cg=xe(function(e){var t=Ir(e),s=st(e,da);return t===Ir(s)?t=i:s.pop(),s.length&&s[0]===e[0]?sa(s,se(t,2)):[]}),ug=xe(function(e){var t=Ir(e),s=st(e,da);return t=typeof t=="function"?t:i,t&&s.pop(),s.length&&s[0]===e[0]?sa(s,i,t):[]});function hg(e,t){return e==null?"":op.call(e,t)}function Ir(e){var t=e==null?0:e.length;return t?e[t-1]:i}function lg(e,t,s){var a=e==null?0:e.length;if(!a)return-1;var h=a;return s!==i&&(h=_e(s),h=h<0?Mt(a+h,0):Vt(h,a-1)),t===t?kf(e,t,h):dn(e,Rc,h,!0)}function fg(e,t){return e&&e.length?au(e,_e(t)):i}var pg=xe(Xu);function Xu(e,t){return e&&e.length&&t&&t.length?ca(e,t):e}function dg(e,t,s){return e&&e.length&&t&&t.length?ca(e,t,se(s,2)):e}function gg(e,t,s){return e&&e.length&&t&&t.length?ca(e,t,i,s):e}var yg=ei(function(e,t){var s=e==null?0:e.length,a=ea(e,t);return hu(e,st(t,function(h){return ti(h,s)?+h:h}).sort(_u)),a});function vg(e,t){var s=[];if(!(e&&e.length))return s;var a=-1,h=[],p=e.length;for(t=se(t,3);++a<p;){var w=e[a];t(w,a,e)&&(s.push(w),h.push(a))}return hu(e,h),s}function Ca(e){return e==null?e:hp.call(e)}function mg(e,t,s){var a=e==null?0:e.length;return a?(s&&typeof s!="number"&&Zt(e,t,s)?(t=0,s=a):(t=t==null?0:_e(t),s=s===i?a:_e(s)),Er(e,t,s)):[]}function wg(e,t){return Fn(e,t)}function _g(e,t,s){return la(e,t,se(s,2))}function bg(e,t){var s=e==null?0:e.length;if(s){var a=Fn(e,t);if(a<s&&Dr(e[a],t))return a}return-1}function Eg(e,t){return Fn(e,t,!0)}function Ig(e,t,s){return la(e,t,se(s,2),!0)}function xg(e,t){var s=e==null?0:e.length;if(s){var a=Fn(e,t,!0)-1;if(Dr(e[a],t))return a}return-1}function Sg(e){return e&&e.length?fu(e):[]}function Pg(e,t){return e&&e.length?fu(e,se(t,2)):[]}function Ag(e){var t=e==null?0:e.length;return t?Er(e,1,t):[]}function Cg(e,t,s){return e&&e.length?(t=s||t===i?1:_e(t),Er(e,0,t<0?0:t)):[]}function Og(e,t,s){var a=e==null?0:e.length;return a?(t=s||t===i?1:_e(t),t=a-t,Er(e,t<0?0:t,a)):[]}function Rg(e,t){return e&&e.length?Ln(e,se(t,3),!1,!0):[]}function Tg(e,t){return e&&e.length?Ln(e,se(t,3)):[]}var Ng=xe(function(e){return gi(kt(e,1,bt,!0))}),Dg=xe(function(e){var t=Ir(e);return bt(t)&&(t=i),gi(kt(e,1,bt,!0),se(t,2))}),Fg=xe(function(e){var t=Ir(e);return t=typeof t=="function"?t:i,gi(kt(e,1,bt,!0),i,t)});function Lg(e){return e&&e.length?gi(e):[]}function $g(e,t){return e&&e.length?gi(e,se(t,2)):[]}function Mg(e,t){return t=typeof t=="function"?t:i,e&&e.length?gi(e,i,t):[]}function Oa(e){if(!(e&&e.length))return[];var t=0;return e=hi(e,function(s){if(bt(s))return t=Mt(s.length,t),!0}),Vo(t,function(s){return st(e,Ho(s))})}function Zu(e,t){if(!(e&&e.length))return[];var s=Oa(e);return t==null?s:st(s,function(a){return zt(t,i,a)})}var jg=xe(function(e,t){return bt(e)?As(e,t):[]}),zg=xe(function(e){return pa(hi(e,bt))}),Ug=xe(function(e){var t=Ir(e);return bt(t)&&(t=i),pa(hi(e,bt),se(t,2))}),qg=xe(function(e){var t=Ir(e);return t=typeof t=="function"?t:i,pa(hi(e,bt),i,t)}),Bg=xe(Oa);function Hg(e,t){return yu(e||[],t||[],Ps)}function kg(e,t){return yu(e||[],t||[],Rs)}var Kg=xe(function(e){var t=e.length,s=t>1?e[t-1]:i;return s=typeof s=="function"?(e.pop(),s):i,Zu(e,s)});function Qu(e){var t=f(e);return t.__chain__=!0,t}function Vg(e,t){return t(e),e}function kn(e,t){return t(e)}var Gg=ei(function(e){var t=e.length,s=t?e[0]:0,a=this.__wrapped__,h=function(p){return ea(p,e)};return t>1||this.__actions__.length||!(a instanceof Ae)||!ti(s)?this.thru(h):(a=a.slice(s,+s+(t?1:0)),a.__actions__.push({func:kn,args:[h],thisArg:i}),new _r(a,this.__chain__).thru(function(p){return t&&!p.length&&p.push(i),p}))});function Wg(){return Qu(this)}function Jg(){return new _r(this.value(),this.__chain__)}function Yg(){this.__values__===i&&(this.__values__=ph(this.value()));var e=this.__index__>=this.__values__.length,t=e?i:this.__values__[this.__index__++];return{done:e,value:t}}function Xg(){return this}function Zg(e){for(var t,s=this;s instanceof On;){var a=Vu(s);a.__index__=0,a.__values__=i,t?h.__wrapped__=a:t=a;var h=a;s=s.__wrapped__}return h.__wrapped__=e,t}function Qg(){var e=this.__wrapped__;if(e instanceof Ae){var t=e;return this.__actions__.length&&(t=new Ae(this)),t=t.reverse(),t.__actions__.push({func:kn,args:[Ca],thisArg:i}),new _r(t,this.__chain__)}return this.thru(Ca)}function ey(){return gu(this.__wrapped__,this.__actions__)}var ty=$n(function(e,t,s){ze.call(e,s)?++e[s]:Zr(e,s,1)});function ry(e,t,s){var a=we(e)?Cc:Vp;return s&&Zt(e,t,s)&&(t=i),a(e,se(t,3))}function iy(e,t){var s=we(e)?hi:Zc;return s(e,se(t,3))}var sy=Pu(Gu),ny=Pu(Wu);function oy(e,t){return kt(Kn(e,t),1)}function ay(e,t){return kt(Kn(e,t),ce)}function cy(e,t,s){return s=s===i?1:_e(s),kt(Kn(e,t),s)}function eh(e,t){var s=we(e)?mr:di;return s(e,se(t,3))}function th(e,t){var s=we(e)?Af:Xc;return s(e,se(t,3))}var uy=$n(function(e,t,s){ze.call(e,s)?e[s].push(t):Zr(e,s,[t])});function hy(e,t,s,a){e=nr(e)?e:us(e),s=s&&!a?_e(s):0;var h=e.length;return s<0&&(s=Mt(h+s,0)),Yn(e)?s<=h&&e.indexOf(t,s)>-1:!!h&&Xi(e,t,s)>-1}var ly=xe(function(e,t,s){var a=-1,h=typeof t=="function",p=nr(e)?T(e.length):[];return di(e,function(w){p[++a]=h?zt(t,w,s):Cs(w,t,s)}),p}),fy=$n(function(e,t,s){Zr(e,s,t)});function Kn(e,t){var s=we(e)?st:su;return s(e,se(t,3))}function py(e,t,s,a){return e==null?[]:(we(t)||(t=t==null?[]:[t]),s=a?i:s,we(s)||(s=s==null?[]:[s]),cu(e,t,s))}var dy=$n(function(e,t,s){e[s?0:1].push(t)},function(){return[[],[]]});function gy(e,t,s){var a=we(e)?qo:Nc,h=arguments.length<3;return a(e,se(t,4),s,h,di)}function yy(e,t,s){var a=we(e)?Cf:Nc,h=arguments.length<3;return a(e,se(t,4),s,h,Xc)}function vy(e,t){var s=we(e)?hi:Zc;return s(e,Wn(se(t,3)))}function my(e){var t=we(e)?Gc:hd;return t(e)}function wy(e,t,s){(s?Zt(e,t,s):t===i)?t=1:t=_e(t);var a=we(e)?qp:ld;return a(e,t)}function _y(e){var t=we(e)?Bp:pd;return t(e)}function by(e){if(e==null)return 0;if(nr(e))return Yn(e)?Qi(e):e.length;var t=Gt(e);return t==be||t==$e?e.size:oa(e).length}function Ey(e,t,s){var a=we(e)?Bo:dd;return s&&Zt(e,t,s)&&(t=i),a(e,se(t,3))}var Iy=xe(function(e,t){if(e==null)return[];var s=t.length;return s>1&&Zt(e,t[0],t[1])?t=[]:s>2&&Zt(t[0],t[1],t[2])&&(t=[t[0]]),cu(e,kt(t,1),[])}),Vn=ip||function(){return Ce.Date.now()};function xy(e,t){if(typeof t!="function")throw new wr(d);return e=_e(e),function(){if(--e<1)return t.apply(this,arguments)}}function rh(e,t,s){return t=s?i:t,t=e&&t==null?e.length:t,Qr(e,q,i,i,i,i,t)}function ih(e,t){var s;if(typeof t!="function")throw new wr(d);return e=_e(e),function(){return--e>0&&(s=t.apply(this,arguments)),e<=1&&(t=i),s}}var Ra=xe(function(e,t,s){var a=re;if(s.length){var h=fi(s,as(Ra));a|=de}return Qr(e,a,t,s,h)}),sh=xe(function(e,t,s){var a=re|he;if(s.length){var h=fi(s,as(sh));a|=de}return Qr(t,a,e,s,h)});function nh(e,t,s){t=s?i:t;var a=Qr(e,fe,i,i,i,i,i,t);return a.placeholder=nh.placeholder,a}function oh(e,t,s){t=s?i:t;var a=Qr(e,pe,i,i,i,i,i,t);return a.placeholder=oh.placeholder,a}function ah(e,t,s){var a,h,p,w,_,A,M=0,j=!1,H=!1,J=!0;if(typeof e!="function")throw new wr(d);t=xr(t)||0,ct(s)&&(j=!!s.leading,H="maxWait"in s,p=H?Mt(xr(s.maxWait)||0,t):p,J="trailing"in s?!!s.trailing:J);function te(Et){var Fr=a,si=h;return a=h=i,M=Et,w=e.apply(si,Fr),w}function oe(Et){return M=Et,_=Ds(Se,t),j?te(Et):w}function Ee(Et){var Fr=Et-A,si=Et-M,Ph=t-Fr;return H?Vt(Ph,p-si):Ph}function ae(Et){var Fr=Et-A,si=Et-M;return A===i||Fr>=t||Fr<0||H&&si>=p}function Se(){var Et=Vn();if(ae(Et))return Oe(Et);_=Ds(Se,Ee(Et))}function Oe(Et){return _=i,J&&a?te(Et):(a=h=i,w)}function dr(){_!==i&&vu(_),M=0,a=A=h=_=i}function Qt(){return _===i?w:Oe(Vn())}function gr(){var Et=Vn(),Fr=ae(Et);if(a=arguments,h=this,A=Et,Fr){if(_===i)return oe(A);if(H)return vu(_),_=Ds(Se,t),te(A)}return _===i&&(_=Ds(Se,t)),w}return gr.cancel=dr,gr.flush=Qt,gr}var Sy=xe(function(e,t){return Yc(e,1,t)}),Py=xe(function(e,t,s){return Yc(e,xr(t)||0,s)});function Ay(e){return Qr(e,ve)}function Gn(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new wr(d);var s=function(){var a=arguments,h=t?t.apply(this,a):a[0],p=s.cache;if(p.has(h))return p.get(h);var w=e.apply(this,a);return s.cache=p.set(h,w)||p,w};return s.cache=new(Gn.Cache||Xr),s}Gn.Cache=Xr;function Wn(e){if(typeof e!="function")throw new wr(d);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}function Cy(e){return ih(2,e)}var Oy=gd(function(e,t){t=t.length==1&&we(t[0])?st(t[0],lr(se())):st(kt(t,1),lr(se()));var s=t.length;return xe(function(a){for(var h=-1,p=Vt(a.length,s);++h<p;)a[h]=t[h].call(this,a[h]);return zt(e,this,a)})}),Ta=xe(function(e,t){var s=fi(t,as(Ta));return Qr(e,de,i,t,s)}),ch=xe(function(e,t){var s=fi(t,as(ch));return Qr(e,L,i,t,s)}),Ry=ei(function(e,t){return Qr(e,W,i,i,i,t)});function Ty(e,t){if(typeof e!="function")throw new wr(d);return t=t===i?t:_e(t),xe(e,t)}function Ny(e,t){if(typeof e!="function")throw new wr(d);return t=t==null?0:Mt(_e(t),0),xe(function(s){var a=s[t],h=vi(s,0,t);return a&&li(h,a),zt(e,this,h)})}function Dy(e,t,s){var a=!0,h=!0;if(typeof e!="function")throw new wr(d);return ct(s)&&(a="leading"in s?!!s.leading:a,h="trailing"in s?!!s.trailing:h),ah(e,t,{leading:a,maxWait:t,trailing:h})}function Fy(e){return rh(e,1)}function Ly(e,t){return Ta(ga(t),e)}function $y(){if(!arguments.length)return[];var e=arguments[0];return we(e)?e:[e]}function My(e){return br(e,z)}function jy(e,t){return t=typeof t=="function"?t:i,br(e,z,t)}function zy(e){return br(e,O|z)}function Uy(e,t){return t=typeof t=="function"?t:i,br(e,O|z,t)}function qy(e,t){return t==null||Jc(e,t,Ut(t))}function Dr(e,t){return e===t||e!==e&&t!==t}var By=Un(ia),Hy=Un(function(e,t){return e>=t}),Mi=tu(function(){return arguments}())?tu:function(e){return yt(e)&&ze.call(e,"callee")&&!qc.call(e,"callee")},we=T.isArray,ky=Yt?lr(Yt):Zp;function nr(e){return e!=null&&Jn(e.length)&&!ri(e)}function bt(e){return yt(e)&&nr(e)}function Ky(e){return e===!0||e===!1||yt(e)&&Xt(e)==N}var mi=np||Ba,Vy=Rr?lr(Rr):Qp;function Gy(e){return yt(e)&&e.nodeType===1&&!Fs(e)}function Wy(e){if(e==null)return!0;if(nr(e)&&(we(e)||typeof e=="string"||typeof e.splice=="function"||mi(e)||cs(e)||Mi(e)))return!e.length;var t=Gt(e);if(t==be||t==$e)return!e.size;if(Ns(e))return!oa(e).length;for(var s in e)if(ze.call(e,s))return!1;return!0}function Jy(e,t){return Os(e,t)}function Yy(e,t,s){s=typeof s=="function"?s:i;var a=s?s(e,t):i;return a===i?Os(e,t,i,s):!!a}function Na(e){if(!yt(e))return!1;var t=Xt(e);return t==E||t==u||typeof e.message=="string"&&typeof e.name=="string"&&!Fs(e)}function Xy(e){return typeof e=="number"&&Hc(e)}function ri(e){if(!ct(e))return!1;var t=Xt(e);return t==ee||t==ge||t==D||t==mt}function uh(e){return typeof e=="number"&&e==_e(e)}function Jn(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=V}function ct(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}function yt(e){return e!=null&&typeof e=="object"}var hh=vr?lr(vr):td;function Zy(e,t){return e===t||na(e,t,Ea(t))}function Qy(e,t,s){return s=typeof s=="function"?s:i,na(e,t,Ea(t),s)}function e0(e){return lh(e)&&e!=+e}function t0(e){if(jd(e))throw new ye(l);return ru(e)}function r0(e){return e===null}function i0(e){return e==null}function lh(e){return typeof e=="number"||yt(e)&&Xt(e)==Ne}function Fs(e){if(!yt(e)||Xt(e)!=Pe)return!1;var t=En(e);if(t===null)return!0;var s=ze.call(t,"constructor")&&t.constructor;return typeof s=="function"&&s instanceof s&&mn.call(s)==Qf}var Da=qr?lr(qr):rd;function s0(e){return uh(e)&&e>=-V&&e<=V}var fh=ws?lr(ws):id;function Yn(e){return typeof e=="string"||!we(e)&&yt(e)&&Xt(e)==Xe}function pr(e){return typeof e=="symbol"||yt(e)&&Xt(e)==Ze}var cs=Oi?lr(Oi):sd;function n0(e){return e===i}function o0(e){return yt(e)&&Gt(e)==qe}function a0(e){return yt(e)&&Xt(e)==Qe}var c0=Un(aa),u0=Un(function(e,t){return e<=t});function ph(e){if(!e)return[];if(nr(e))return Yn(e)?Tr(e):sr(e);if(bs&&e[bs])return qf(e[bs]());var t=Gt(e),s=t==be?Wo:t==$e?gn:us;return s(e)}function ii(e){if(!e)return e===0?e:0;if(e=xr(e),e===ce||e===-ce){var t=e<0?-1:1;return t*B}return e===e?e:0}function _e(e){var t=ii(e),s=t%1;return t===t?s?t-s:t:0}function dh(e){return e?Di(_e(e),0,G):0}function xr(e){if(typeof e=="number")return e;if(pr(e))return k;if(ct(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=ct(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=Dc(e);var s=Io.test(e);return s||So.test(e)?me(e.slice(2),s?2:8):Eo.test(e)?k:+e}function gh(e){return Hr(e,or(e))}function h0(e){return e?Di(_e(e),-V,V):e===0?e:0}function Me(e){return e==null?"":fr(e)}var l0=ns(function(e,t){if(Ns(t)||nr(t)){Hr(t,Ut(t),e);return}for(var s in t)ze.call(t,s)&&Ps(e,s,t[s])}),yh=ns(function(e,t){Hr(t,or(t),e)}),Xn=ns(function(e,t,s,a){Hr(t,or(t),e,a)}),f0=ns(function(e,t,s,a){Hr(t,Ut(t),e,a)}),p0=ei(ea);function d0(e,t){var s=ss(e);return t==null?s:Wc(s,t)}var g0=xe(function(e,t){e=We(e);var s=-1,a=t.length,h=a>2?t[2]:i;for(h&&Zt(t[0],t[1],h)&&(a=1);++s<a;)for(var p=t[s],w=or(p),_=-1,A=w.length;++_<A;){var M=w[_],j=e[M];(j===i||Dr(j,ts[M])&&!ze.call(e,M))&&(e[M]=p[M])}return e}),y0=xe(function(e){return e.push(i,Du),zt(vh,i,e)});function v0(e,t){return Oc(e,se(t,3),Br)}function m0(e,t){return Oc(e,se(t,3),ra)}function w0(e,t){return e==null?e:ta(e,se(t,3),or)}function _0(e,t){return e==null?e:Qc(e,se(t,3),or)}function b0(e,t){return e&&Br(e,se(t,3))}function E0(e,t){return e&&ra(e,se(t,3))}function I0(e){return e==null?[]:Nn(e,Ut(e))}function x0(e){return e==null?[]:Nn(e,or(e))}function Fa(e,t,s){var a=e==null?i:Fi(e,t);return a===i?s:a}function S0(e,t){return e!=null&&$u(e,t,Wp)}function La(e,t){return e!=null&&$u(e,t,Jp)}var P0=Cu(function(e,t,s){t!=null&&typeof t.toString!="function"&&(t=wn.call(t)),e[t]=s},Ma(ar)),A0=Cu(function(e,t,s){t!=null&&typeof t.toString!="function"&&(t=wn.call(t)),ze.call(e,t)?e[t].push(s):e[t]=[s]},se),C0=xe(Cs);function Ut(e){return nr(e)?Vc(e):oa(e)}function or(e){return nr(e)?Vc(e,!0):nd(e)}function O0(e,t){var s={};return t=se(t,3),Br(e,function(a,h,p){Zr(s,t(a,h,p),a)}),s}function R0(e,t){var s={};return t=se(t,3),Br(e,function(a,h,p){Zr(s,h,t(a,h,p))}),s}var T0=ns(function(e,t,s){Dn(e,t,s)}),vh=ns(function(e,t,s,a){Dn(e,t,s,a)}),N0=ei(function(e,t){var s={};if(e==null)return s;var a=!1;t=st(t,function(p){return p=yi(p,e),a||(a=p.length>1),p}),Hr(e,_a(e),s),a&&(s=br(s,O|F|z,Pd));for(var h=t.length;h--;)fa(s,t[h]);return s});function D0(e,t){return mh(e,Wn(se(t)))}var F0=ei(function(e,t){return e==null?{}:ad(e,t)});function mh(e,t){if(e==null)return{};var s=st(_a(e),function(a){return[a]});return t=se(t),uu(e,s,function(a,h){return t(a,h[0])})}function L0(e,t,s){t=yi(t,e);var a=-1,h=t.length;for(h||(h=1,e=i);++a<h;){var p=e==null?i:e[kr(t[a])];p===i&&(a=h,p=s),e=ri(p)?p.call(e):p}return e}function $0(e,t,s){return e==null?e:Rs(e,t,s)}function M0(e,t,s,a){return a=typeof a=="function"?a:i,e==null?e:Rs(e,t,s,a)}var wh=Tu(Ut),_h=Tu(or);function j0(e,t,s){var a=we(e),h=a||mi(e)||cs(e);if(t=se(t,4),s==null){var p=e&&e.constructor;h?s=a?new p:[]:ct(e)?s=ri(p)?ss(En(e)):{}:s={}}return(h?mr:Br)(e,function(w,_,A){return t(s,w,_,A)}),s}function z0(e,t){return e==null?!0:fa(e,t)}function U0(e,t,s){return e==null?e:du(e,t,ga(s))}function q0(e,t,s,a){return a=typeof a=="function"?a:i,e==null?e:du(e,t,ga(s),a)}function us(e){return e==null?[]:Go(e,Ut(e))}function B0(e){return e==null?[]:Go(e,or(e))}function H0(e,t,s){return s===i&&(s=t,t=i),s!==i&&(s=xr(s),s=s===s?s:0),t!==i&&(t=xr(t),t=t===t?t:0),Di(xr(e),t,s)}function k0(e,t,s){return t=ii(t),s===i?(s=t,t=0):s=ii(s),e=xr(e),Yp(e,t,s)}function K0(e,t,s){if(s&&typeof s!="boolean"&&Zt(e,t,s)&&(t=s=i),s===i&&(typeof t=="boolean"?(s=t,t=i):typeof e=="boolean"&&(s=e,e=i)),e===i&&t===i?(e=0,t=1):(e=ii(e),t===i?(t=e,e=0):t=ii(t)),e>t){var a=e;e=t,t=a}if(s||e%1||t%1){var h=kc();return Vt(e+h*(t-e+Ve("1e-"+((h+"").length-1))),t)}return ua(e,t)}var V0=os(function(e,t,s){return t=t.toLowerCase(),e+(s?bh(t):t)});function bh(e){return $a(Me(e).toLowerCase())}function Eh(e){return e=Me(e),e&&e.replace(Wr,$f).replace(jo,"")}function G0(e,t,s){e=Me(e),t=fr(t);var a=e.length;s=s===i?a:Di(_e(s),0,a);var h=s;return s-=t.length,s>=0&&e.slice(s,h)==t}function W0(e){return e=Me(e),e&&rt.test(e)?e.replace(xi,Mf):e}function J0(e){return e=Me(e),e&&Ot.test(e)?e.replace(pt,"\\$&"):e}var Y0=os(function(e,t,s){return e+(s?"-":"")+t.toLowerCase()}),X0=os(function(e,t,s){return e+(s?" ":"")+t.toLowerCase()}),Z0=Su("toLowerCase");function Q0(e,t,s){e=Me(e),t=_e(t);var a=t?Qi(e):0;if(!t||a>=t)return e;var h=(t-a)/2;return zn(Pn(h),s)+e+zn(Sn(h),s)}function ev(e,t,s){e=Me(e),t=_e(t);var a=t?Qi(e):0;return t&&a<t?e+zn(t-a,s):e}function tv(e,t,s){e=Me(e),t=_e(t);var a=t?Qi(e):0;return t&&a<t?zn(t-a,s)+e:e}function rv(e,t,s){return s||t==null?t=0:t&&(t=+t),up(Me(e).replace(dt,""),t||0)}function iv(e,t,s){return(s?Zt(e,t,s):t===i)?t=1:t=_e(t),ha(Me(e),t)}function sv(){var e=arguments,t=Me(e[0]);return e.length<3?t:t.replace(e[1],e[2])}var nv=os(function(e,t,s){return e+(s?"_":"")+t.toLowerCase()});function ov(e,t,s){return s&&typeof s!="number"&&Zt(e,t,s)&&(t=s=i),s=s===i?G:s>>>0,s?(e=Me(e),e&&(typeof t=="string"||t!=null&&!Da(t))&&(t=fr(t),!t&&Zi(e))?vi(Tr(e),0,s):e.split(t,s)):[]}var av=os(function(e,t,s){return e+(s?" ":"")+$a(t)});function cv(e,t,s){return e=Me(e),s=s==null?0:Di(_e(s),0,e.length),t=fr(t),e.slice(s,s+t.length)==t}function uv(e,t,s){var a=f.templateSettings;s&&Zt(e,t,s)&&(t=i),e=Me(e),t=Xn({},t,a,Nu);var h=Xn({},t.imports,a.imports,Nu),p=Ut(h),w=Go(h,p),_,A,M=0,j=t.interpolate||ki,H="__p += '",J=Jo((t.escape||ki).source+"|"+j.source+"|"+(j===at?bo:ki).source+"|"+(t.evaluate||ki).source+"|$","g"),te="//# sourceURL="+(ze.call(t,"sourceURL")?(t.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++zo+"]")+`
`;e.replace(J,function(ae,Se,Oe,dr,Qt,gr){return Oe||(Oe=dr),H+=e.slice(M,gr).replace(Ao,jf),Se&&(_=!0,H+=`' +
__e(`+Se+`) +
'`),Qt&&(A=!0,H+=`';
`+Qt+`;
__p += '`),Oe&&(H+=`' +
((__t = (`+Oe+`)) == null ? '' : __t) +
'`),M=gr+ae.length,ae}),H+=`';
`;var oe=ze.call(t,"variable")&&t.variable;if(!oe)H=`with (obj) {
`+H+`
}
`;else if(wo.test(oe))throw new ye(v);H=(A?H.replace(zr,""):H).replace(Jt,"$1").replace(Gr,"$1;"),H="function("+(oe||"obj")+`) {
`+(oe?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(_?", __e = _.escape":"")+(A?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+H+`return __p
}`;var Ee=xh(function(){return Le(p,te+"return "+H).apply(i,w)});if(Ee.source=H,Na(Ee))throw Ee;return Ee}function hv(e){return Me(e).toLowerCase()}function lv(e){return Me(e).toUpperCase()}function fv(e,t,s){if(e=Me(e),e&&(s||t===i))return Dc(e);if(!e||!(t=fr(t)))return e;var a=Tr(e),h=Tr(t),p=Fc(a,h),w=Lc(a,h)+1;return vi(a,p,w).join("")}function pv(e,t,s){if(e=Me(e),e&&(s||t===i))return e.slice(0,Mc(e)+1);if(!e||!(t=fr(t)))return e;var a=Tr(e),h=Lc(a,Tr(t))+1;return vi(a,0,h).join("")}function dv(e,t,s){if(e=Me(e),e&&(s||t===i))return e.replace(dt,"");if(!e||!(t=fr(t)))return e;var a=Tr(e),h=Fc(a,Tr(t));return vi(a,h).join("")}function gv(e,t){var s=ie,a=ue;if(ct(t)){var h="separator"in t?t.separator:h;s="length"in t?_e(t.length):s,a="omission"in t?fr(t.omission):a}e=Me(e);var p=e.length;if(Zi(e)){var w=Tr(e);p=w.length}if(s>=p)return e;var _=s-Qi(a);if(_<1)return a;var A=w?vi(w,0,_).join(""):e.slice(0,_);if(h===i)return A+a;if(w&&(_+=A.length-_),Da(h)){if(e.slice(_).search(h)){var M,j=A;for(h.global||(h=Jo(h.source,Me(yr.exec(h))+"g")),h.lastIndex=0;M=h.exec(j);)var H=M.index;A=A.slice(0,H===i?_:H)}}else if(e.indexOf(fr(h),_)!=_){var J=A.lastIndexOf(h);J>-1&&(A=A.slice(0,J))}return A+a}function yv(e){return e=Me(e),e&&ht.test(e)?e.replace(ci,Kf):e}var vv=os(function(e,t,s){return e+(s?" ":"")+t.toUpperCase()}),$a=Su("toUpperCase");function Ih(e,t,s){return e=Me(e),t=s?i:t,t===i?Uf(e)?Wf(e):Tf(e):e.match(t)||[]}var xh=xe(function(e,t){try{return zt(e,i,t)}catch(s){return Na(s)?s:new ye(s)}}),mv=ei(function(e,t){return mr(t,function(s){s=kr(s),Zr(e,s,Ra(e[s],e))}),e});function wv(e){var t=e==null?0:e.length,s=se();return e=t?st(e,function(a){if(typeof a[1]!="function")throw new wr(d);return[s(a[0]),a[1]]}):[],xe(function(a){for(var h=-1;++h<t;){var p=e[h];if(zt(p[0],this,a))return zt(p[1],this,a)}})}function _v(e){return Kp(br(e,O))}function Ma(e){return function(){return e}}function bv(e,t){return e==null||e!==e?t:e}var Ev=Au(),Iv=Au(!0);function ar(e){return e}function ja(e){return iu(typeof e=="function"?e:br(e,O))}function xv(e){return nu(br(e,O))}function Sv(e,t){return ou(e,br(t,O))}var Pv=xe(function(e,t){return function(s){return Cs(s,e,t)}}),Av=xe(function(e,t){return function(s){return Cs(e,s,t)}});function za(e,t,s){var a=Ut(t),h=Nn(t,a);s==null&&!(ct(t)&&(h.length||!a.length))&&(s=t,t=e,e=this,h=Nn(t,Ut(t)));var p=!(ct(s)&&"chain"in s)||!!s.chain,w=ri(e);return mr(h,function(_){var A=t[_];e[_]=A,w&&(e.prototype[_]=function(){var M=this.__chain__;if(p||M){var j=e(this.__wrapped__),H=j.__actions__=sr(this.__actions__);return H.push({func:A,args:arguments,thisArg:e}),j.__chain__=M,j}return A.apply(e,li([this.value()],arguments))})}),e}function Cv(){return Ce._===this&&(Ce._=ep),this}function Ua(){}function Ov(e){return e=_e(e),xe(function(t){return au(t,e)})}var Rv=va(st),Tv=va(Cc),Nv=va(Bo);function Sh(e){return xa(e)?Ho(kr(e)):cd(e)}function Dv(e){return function(t){return e==null?i:Fi(e,t)}}var Fv=Ou(),Lv=Ou(!0);function qa(){return[]}function Ba(){return!1}function $v(){return{}}function Mv(){return""}function jv(){return!0}function zv(e,t){if(e=_e(e),e<1||e>V)return[];var s=G,a=Vt(e,G);t=se(t),e-=G;for(var h=Vo(a,t);++s<e;)t(s);return h}function Uv(e){return we(e)?st(e,kr):pr(e)?[e]:sr(Ku(Me(e)))}function qv(e){var t=++Zf;return Me(e)+t}var Bv=jn(function(e,t){return e+t},0),Hv=ma("ceil"),kv=jn(function(e,t){return e/t},1),Kv=ma("floor");function Vv(e){return e&&e.length?Tn(e,ar,ia):i}function Gv(e,t){return e&&e.length?Tn(e,se(t,2),ia):i}function Wv(e){return Tc(e,ar)}function Jv(e,t){return Tc(e,se(t,2))}function Yv(e){return e&&e.length?Tn(e,ar,aa):i}function Xv(e,t){return e&&e.length?Tn(e,se(t,2),aa):i}var Zv=jn(function(e,t){return e*t},1),Qv=ma("round"),em=jn(function(e,t){return e-t},0);function tm(e){return e&&e.length?Ko(e,ar):0}function rm(e,t){return e&&e.length?Ko(e,se(t,2)):0}return f.after=xy,f.ary=rh,f.assign=l0,f.assignIn=yh,f.assignInWith=Xn,f.assignWith=f0,f.at=p0,f.before=ih,f.bind=Ra,f.bindAll=mv,f.bindKey=sh,f.castArray=$y,f.chain=Qu,f.chunk=Kd,f.compact=Vd,f.concat=Gd,f.cond=wv,f.conforms=_v,f.constant=Ma,f.countBy=ty,f.create=d0,f.curry=nh,f.curryRight=oh,f.debounce=ah,f.defaults=g0,f.defaultsDeep=y0,f.defer=Sy,f.delay=Py,f.difference=Wd,f.differenceBy=Jd,f.differenceWith=Yd,f.drop=Xd,f.dropRight=Zd,f.dropRightWhile=Qd,f.dropWhile=eg,f.fill=tg,f.filter=iy,f.flatMap=oy,f.flatMapDeep=ay,f.flatMapDepth=cy,f.flatten=Ju,f.flattenDeep=rg,f.flattenDepth=ig,f.flip=Ay,f.flow=Ev,f.flowRight=Iv,f.fromPairs=sg,f.functions=I0,f.functionsIn=x0,f.groupBy=uy,f.initial=og,f.intersection=ag,f.intersectionBy=cg,f.intersectionWith=ug,f.invert=P0,f.invertBy=A0,f.invokeMap=ly,f.iteratee=ja,f.keyBy=fy,f.keys=Ut,f.keysIn=or,f.map=Kn,f.mapKeys=O0,f.mapValues=R0,f.matches=xv,f.matchesProperty=Sv,f.memoize=Gn,f.merge=T0,f.mergeWith=vh,f.method=Pv,f.methodOf=Av,f.mixin=za,f.negate=Wn,f.nthArg=Ov,f.omit=N0,f.omitBy=D0,f.once=Cy,f.orderBy=py,f.over=Rv,f.overArgs=Oy,f.overEvery=Tv,f.overSome=Nv,f.partial=Ta,f.partialRight=ch,f.partition=dy,f.pick=F0,f.pickBy=mh,f.property=Sh,f.propertyOf=Dv,f.pull=pg,f.pullAll=Xu,f.pullAllBy=dg,f.pullAllWith=gg,f.pullAt=yg,f.range=Fv,f.rangeRight=Lv,f.rearg=Ry,f.reject=vy,f.remove=vg,f.rest=Ty,f.reverse=Ca,f.sampleSize=wy,f.set=$0,f.setWith=M0,f.shuffle=_y,f.slice=mg,f.sortBy=Iy,f.sortedUniq=Sg,f.sortedUniqBy=Pg,f.split=ov,f.spread=Ny,f.tail=Ag,f.take=Cg,f.takeRight=Og,f.takeRightWhile=Rg,f.takeWhile=Tg,f.tap=Vg,f.throttle=Dy,f.thru=kn,f.toArray=ph,f.toPairs=wh,f.toPairsIn=_h,f.toPath=Uv,f.toPlainObject=gh,f.transform=j0,f.unary=Fy,f.union=Ng,f.unionBy=Dg,f.unionWith=Fg,f.uniq=Lg,f.uniqBy=$g,f.uniqWith=Mg,f.unset=z0,f.unzip=Oa,f.unzipWith=Zu,f.update=U0,f.updateWith=q0,f.values=us,f.valuesIn=B0,f.without=jg,f.words=Ih,f.wrap=Ly,f.xor=zg,f.xorBy=Ug,f.xorWith=qg,f.zip=Bg,f.zipObject=Hg,f.zipObjectDeep=kg,f.zipWith=Kg,f.entries=wh,f.entriesIn=_h,f.extend=yh,f.extendWith=Xn,za(f,f),f.add=Bv,f.attempt=xh,f.camelCase=V0,f.capitalize=bh,f.ceil=Hv,f.clamp=H0,f.clone=My,f.cloneDeep=zy,f.cloneDeepWith=Uy,f.cloneWith=jy,f.conformsTo=qy,f.deburr=Eh,f.defaultTo=bv,f.divide=kv,f.endsWith=G0,f.eq=Dr,f.escape=W0,f.escapeRegExp=J0,f.every=ry,f.find=sy,f.findIndex=Gu,f.findKey=v0,f.findLast=ny,f.findLastIndex=Wu,f.findLastKey=m0,f.floor=Kv,f.forEach=eh,f.forEachRight=th,f.forIn=w0,f.forInRight=_0,f.forOwn=b0,f.forOwnRight=E0,f.get=Fa,f.gt=By,f.gte=Hy,f.has=S0,f.hasIn=La,f.head=Yu,f.identity=ar,f.includes=hy,f.indexOf=ng,f.inRange=k0,f.invoke=C0,f.isArguments=Mi,f.isArray=we,f.isArrayBuffer=ky,f.isArrayLike=nr,f.isArrayLikeObject=bt,f.isBoolean=Ky,f.isBuffer=mi,f.isDate=Vy,f.isElement=Gy,f.isEmpty=Wy,f.isEqual=Jy,f.isEqualWith=Yy,f.isError=Na,f.isFinite=Xy,f.isFunction=ri,f.isInteger=uh,f.isLength=Jn,f.isMap=hh,f.isMatch=Zy,f.isMatchWith=Qy,f.isNaN=e0,f.isNative=t0,f.isNil=i0,f.isNull=r0,f.isNumber=lh,f.isObject=ct,f.isObjectLike=yt,f.isPlainObject=Fs,f.isRegExp=Da,f.isSafeInteger=s0,f.isSet=fh,f.isString=Yn,f.isSymbol=pr,f.isTypedArray=cs,f.isUndefined=n0,f.isWeakMap=o0,f.isWeakSet=a0,f.join=hg,f.kebabCase=Y0,f.last=Ir,f.lastIndexOf=lg,f.lowerCase=X0,f.lowerFirst=Z0,f.lt=c0,f.lte=u0,f.max=Vv,f.maxBy=Gv,f.mean=Wv,f.meanBy=Jv,f.min=Yv,f.minBy=Xv,f.stubArray=qa,f.stubFalse=Ba,f.stubObject=$v,f.stubString=Mv,f.stubTrue=jv,f.multiply=Zv,f.nth=fg,f.noConflict=Cv,f.noop=Ua,f.now=Vn,f.pad=Q0,f.padEnd=ev,f.padStart=tv,f.parseInt=rv,f.random=K0,f.reduce=gy,f.reduceRight=yy,f.repeat=iv,f.replace=sv,f.result=L0,f.round=Qv,f.runInContext=P,f.sample=my,f.size=by,f.snakeCase=nv,f.some=Ey,f.sortedIndex=wg,f.sortedIndexBy=_g,f.sortedIndexOf=bg,f.sortedLastIndex=Eg,f.sortedLastIndexBy=Ig,f.sortedLastIndexOf=xg,f.startCase=av,f.startsWith=cv,f.subtract=em,f.sum=tm,f.sumBy=rm,f.template=uv,f.times=zv,f.toFinite=ii,f.toInteger=_e,f.toLength=dh,f.toLower=hv,f.toNumber=xr,f.toSafeInteger=h0,f.toString=Me,f.toUpper=lv,f.trim=fv,f.trimEnd=pv,f.trimStart=dv,f.truncate=gv,f.unescape=yv,f.uniqueId=qv,f.upperCase=vv,f.upperFirst=$a,f.each=eh,f.eachRight=th,f.first=Yu,za(f,function(){var e={};return Br(f,function(t,s){ze.call(f.prototype,s)||(e[s]=t)}),e}(),{chain:!1}),f.VERSION=n,mr(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){f[e].placeholder=f}),mr(["drop","take"],function(e,t){Ae.prototype[e]=function(s){s=s===i?1:Mt(_e(s),0);var a=this.__filtered__&&!t?new Ae(this):this.clone();return a.__filtered__?a.__takeCount__=Vt(s,a.__takeCount__):a.__views__.push({size:Vt(s,G),type:e+(a.__dir__<0?"Right":"")}),a},Ae.prototype[e+"Right"]=function(s){return this.reverse()[e](s).reverse()}}),mr(["filter","map","takeWhile"],function(e,t){var s=t+1,a=s==y||s==X;Ae.prototype[e]=function(h){var p=this.clone();return p.__iteratees__.push({iteratee:se(h,3),type:s}),p.__filtered__=p.__filtered__||a,p}}),mr(["head","last"],function(e,t){var s="take"+(t?"Right":"");Ae.prototype[e]=function(){return this[s](1).value()[0]}}),mr(["initial","tail"],function(e,t){var s="drop"+(t?"":"Right");Ae.prototype[e]=function(){return this.__filtered__?new Ae(this):this[s](1)}}),Ae.prototype.compact=function(){return this.filter(ar)},Ae.prototype.find=function(e){return this.filter(e).head()},Ae.prototype.findLast=function(e){return this.reverse().find(e)},Ae.prototype.invokeMap=xe(function(e,t){return typeof e=="function"?new Ae(this):this.map(function(s){return Cs(s,e,t)})}),Ae.prototype.reject=function(e){return this.filter(Wn(se(e)))},Ae.prototype.slice=function(e,t){e=_e(e);var s=this;return s.__filtered__&&(e>0||t<0)?new Ae(s):(e<0?s=s.takeRight(-e):e&&(s=s.drop(e)),t!==i&&(t=_e(t),s=t<0?s.dropRight(-t):s.take(t-e)),s)},Ae.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Ae.prototype.toArray=function(){return this.take(G)},Br(Ae.prototype,function(e,t){var s=/^(?:filter|find|map|reject)|While$/.test(t),a=/^(?:head|last)$/.test(t),h=f[a?"take"+(t=="last"?"Right":""):t],p=a||/^find/.test(t);h&&(f.prototype[t]=function(){var w=this.__wrapped__,_=a?[1]:arguments,A=w instanceof Ae,M=_[0],j=A||we(w),H=function(Se){var Oe=h.apply(f,li([Se],_));return a&&J?Oe[0]:Oe};j&&s&&typeof M=="function"&&M.length!=1&&(A=j=!1);var J=this.__chain__,te=!!this.__actions__.length,oe=p&&!J,Ee=A&&!te;if(!p&&j){w=Ee?w:new Ae(this);var ae=e.apply(w,_);return ae.__actions__.push({func:kn,args:[H],thisArg:i}),new _r(ae,J)}return oe&&Ee?e.apply(this,_):(ae=this.thru(H),oe?a?ae.value()[0]:ae.value():ae)})}),mr(["pop","push","shift","sort","splice","unshift"],function(e){var t=yn[e],s=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",a=/^(?:pop|shift)$/.test(e);f.prototype[e]=function(){var h=arguments;if(a&&!this.__chain__){var p=this.value();return t.apply(we(p)?p:[],h)}return this[s](function(w){return t.apply(we(w)?w:[],h)})}}),Br(Ae.prototype,function(e,t){var s=f[t];if(s){var a=s.name+"";ze.call(is,a)||(is[a]=[]),is[a].push({name:t,func:s})}}),is[Mn(i,he).name]=[{name:"wrapper",func:i}],Ae.prototype.clone=yp,Ae.prototype.reverse=vp,Ae.prototype.value=mp,f.prototype.at=Gg,f.prototype.chain=Wg,f.prototype.commit=Jg,f.prototype.next=Yg,f.prototype.plant=Zg,f.prototype.reverse=Qg,f.prototype.toJSON=f.prototype.valueOf=f.prototype.value=ey,f.prototype.first=f.prototype.head,bs&&(f.prototype[bs]=Xg),f},es=Jf();_t?((_t.exports=es)._=es,Ge._=es):Ce._=es}).call(qs)})(fc,fc.exports);var vE=Object.defineProperty,mE=Object.defineProperties,wE=Object.getOwnPropertyDescriptors,Sl=Object.getOwnPropertySymbols,_E=Object.prototype.hasOwnProperty,bE=Object.prototype.propertyIsEnumerable,Pl=(c,r,i)=>r in c?vE(c,r,{enumerable:!0,configurable:!0,writable:!0,value:i}):c[r]=i,to=(c,r)=>{for(var i in r||(r={}))_E.call(r,i)&&Pl(c,i,r[i]);if(Sl)for(var i of Sl(r))bE.call(r,i)&&Pl(c,i,r[i]);return c},EE=(c,r)=>mE(c,wE(r));function Ar(c,r,i){let n;const o=pc(c);return r.rpcMap&&(n=r.rpcMap[o]),n||(n=`${yE}?chainId=eip155:${o}&projectId=${i}`),n}function pc(c){return c.includes("eip155")?Number(c.split(":")[1]):Number(c)}function xf(c){return c.map(r=>`${r.split(":")[0]}:${r.split(":")[1]}`)}function IE(c,r){const i=Object.keys(r.namespaces).filter(o=>o.includes(c));if(!i.length)return[];const n=[];return i.forEach(o=>{const l=r.namespaces[o].accounts;n.push(...l)}),n}function xE(c={},r={}){const i=Al(c),n=Al(r);return fc.exports.merge(i,n)}function Al(c){var r,i,n,o;const l={};if(!so(c))return l;for(const[d,v]of Object.entries(c)){const b=ql(d)?[d]:v.chains,m=v.methods||[],S=v.events||[],O=v.rpcMap||{},F=no(d);l[F]=EE(to(to({},l[F]),v),{chains:ka(b,(r=l[F])==null?void 0:r.chains),methods:ka(m,(i=l[F])==null?void 0:i.methods),events:ka(S,(n=l[F])==null?void 0:n.events),rpcMap:to(to({},O),(o=l[F])==null?void 0:o.rpcMap)})}return l}function SE(c){return c.includes(":")?c.split(":")[2]:c}function PE(c){const r={};for(const[i,n]of Object.entries(c)){const o=n.methods||[],l=n.events||[],d=n.accounts||[],v=ql(i)?[i]:n.chains?n.chains:xf(n.accounts);r[i]={chains:v,methods:o,events:l,accounts:d}}return r}const Sf={},It=c=>Sf[c],ic=(c,r)=>{Sf[c]=r};class AE{constructor(r){this.name="polkadot",this.namespace=r.namespace,this.events=It("events"),this.client=It("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}request(r){return this.namespace.methods.includes(r.request.method)?this.client.request(r):this.getHttpProvider().request(r.request)}setDefaultChain(r,i){if(this.chainId=r,!this.httpProviders[r]){const n=i||Ar(`${this.name}:${r}`,this.namespace);if(!n)throw new Error(`No RPC url provided for chainId: ${r}`);this.setHttpProvider(r,n)}this.events.emit(Ii.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const r=this.namespace.accounts;return r?r.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2])||[]:[]}createHttpProviders(){const r={};return this.namespace.chains.forEach(i=>{var n;r[i]=this.createHttpProvider(i,(n=this.namespace.rpcMap)==null?void 0:n[i])}),r}getHttpProvider(){const r=`${this.name}:${this.chainId}`,i=this.httpProviders[r];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return i}setHttpProvider(r,i){const n=this.createHttpProvider(r,i);n&&(this.httpProviders[r]=n)}createHttpProvider(r,i){const n=i||Ar(r,this.namespace);return typeof n>"u"?void 0:new Ei(new Hi(n,It("disableProviderPing")))}}class CE{constructor(r){this.name="eip155",this.namespace=r.namespace,this.events=It("events"),this.client=It("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(r){switch(r.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(r);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(r.request.method)?await this.client.request(r):this.getHttpProvider().request(r.request)}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}setDefaultChain(r,i){const n=pc(r);if(!this.httpProviders[n]){const o=i||Ar(`${this.name}:${n}`,this.namespace,this.client.core.projectId);if(!o)throw new Error(`No RPC url provided for chainId: ${n}`);this.setHttpProvider(n,o)}this.chainId=n,this.events.emit(Ii.DEFAULT_CHAIN_CHANGED,`${this.name}:${n}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}createHttpProvider(r,i){const n=i||Ar(`${this.name}:${r}`,this.namespace,this.client.core.projectId);return typeof n>"u"?void 0:new Ei(new Hi(n,It("disableProviderPing")))}setHttpProvider(r,i){const n=this.createHttpProvider(r,i);n&&(this.httpProviders[r]=n)}createHttpProviders(){const r={};return this.namespace.chains.forEach(i=>{var n;const o=pc(i);r[o]=this.createHttpProvider(o,(n=this.namespace.rpcMap)==null?void 0:n[i])}),r}getAccounts(){const r=this.namespace.accounts;return r?[...new Set(r.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}getHttpProvider(){const r=this.chainId,i=this.httpProviders[r];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return i}async handleSwitchChain(r){var i,n;let o=r.request.params?(i=r.request.params[0])==null?void 0:i.chainId:"0x0";o=o.startsWith("0x")?o:`0x${o}`;const l=parseInt(o,16);if(this.isChainApproved(l))this.setDefaultChain(`${l}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:r.topic,request:{method:r.request.method,params:[{chainId:o}]},chainId:(n=this.namespace.chains)==null?void 0:n[0]}),this.setDefaultChain(`${l}`);else throw new Error(`Failed to switch to chain 'eip155:${l}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(r){return this.namespace.chains.includes(`${this.name}:${r}`)}}class OE{constructor(r){this.name="solana",this.namespace=r.namespace,this.events=It("events"),this.client=It("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}requestAccounts(){return this.getAccounts()}request(r){return this.namespace.methods.includes(r.request.method)?this.client.request(r):this.getHttpProvider().request(r.request)}setDefaultChain(r,i){if(!this.httpProviders[r]){const n=i||Ar(`${this.name}:${r}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${r}`);this.setHttpProvider(r,n)}this.chainId=r,this.events.emit(Ii.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}getAccounts(){const r=this.namespace.accounts;return r?[...new Set(r.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){const r={};return this.namespace.chains.forEach(i=>{var n;r[i]=this.createHttpProvider(i,(n=this.namespace.rpcMap)==null?void 0:n[i])}),r}getHttpProvider(){const r=`${this.name}:${this.chainId}`,i=this.httpProviders[r];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return i}setHttpProvider(r,i){const n=this.createHttpProvider(r,i);n&&(this.httpProviders[r]=n)}createHttpProvider(r,i){const n=i||Ar(r,this.namespace,this.client.core.projectId);return typeof n>"u"?void 0:new Ei(new Hi(n,It("disableProviderPing")))}}class RE{constructor(r){this.name="cosmos",this.namespace=r.namespace,this.events=It("events"),this.client=It("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}request(r){return this.namespace.methods.includes(r.request.method)?this.client.request(r):this.getHttpProvider().request(r.request)}setDefaultChain(r,i){if(this.chainId=r,!this.httpProviders[r]){const n=i||Ar(`${this.name}:${r}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${r}`);this.setHttpProvider(r,n)}this.events.emit(Ii.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const r=this.namespace.accounts;return r?[...new Set(r.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){const r={};return this.namespace.chains.forEach(i=>{var n;r[i]=this.createHttpProvider(i,(n=this.namespace.rpcMap)==null?void 0:n[i])}),r}getHttpProvider(){const r=`${this.name}:${this.chainId}`,i=this.httpProviders[r];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return i}setHttpProvider(r,i){const n=this.createHttpProvider(r,i);n&&(this.httpProviders[r]=n)}createHttpProvider(r,i){const n=i||Ar(r,this.namespace,this.client.core.projectId);return typeof n>"u"?void 0:new Ei(new Hi(n,It("disableProviderPing")))}}class TE{constructor(r){this.name="cip34",this.namespace=r.namespace,this.events=It("events"),this.client=It("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}request(r){return this.namespace.methods.includes(r.request.method)?this.client.request(r):this.getHttpProvider().request(r.request)}setDefaultChain(r,i){if(this.chainId=r,!this.httpProviders[r]){const n=i||this.getCardanoRPCUrl(r);if(!n)throw new Error(`No RPC url provided for chainId: ${r}`);this.setHttpProvider(r,n)}this.events.emit(Ii.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const r=this.namespace.accounts;return r?[...new Set(r.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){const r={};return this.namespace.chains.forEach(i=>{const n=this.getCardanoRPCUrl(i);r[i]=this.createHttpProvider(i,n)}),r}getHttpProvider(){const r=`${this.name}:${this.chainId}`,i=this.httpProviders[r];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return i}getCardanoRPCUrl(r){const i=this.namespace.rpcMap;if(i)return i[r]}setHttpProvider(r,i){const n=this.createHttpProvider(r,i);n&&(this.httpProviders[r]=n)}createHttpProvider(r,i){const n=i||this.getCardanoRPCUrl(r);return typeof n>"u"?void 0:new Ei(new Hi(n,It("disableProviderPing")))}}class NE{constructor(r){this.name="elrond",this.namespace=r.namespace,this.events=It("events"),this.client=It("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}requestAccounts(){return this.getAccounts()}request(r){return this.namespace.methods.includes(r.request.method)?this.client.request(r):this.getHttpProvider().request(r.request)}setDefaultChain(r,i){if(!this.httpProviders[r]){const n=i||Ar(`${this.name}:${r}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${r}`);this.setHttpProvider(r,n)}this.chainId=r,this.events.emit(Ii.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}getAccounts(){const r=this.namespace.accounts;return r?[...new Set(r.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){const r={};return this.namespace.chains.forEach(i=>{var n;r[i]=this.createHttpProvider(i,(n=this.namespace.rpcMap)==null?void 0:n[i])}),r}getHttpProvider(){const r=`${this.name}:${this.chainId}`,i=this.httpProviders[r];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return i}setHttpProvider(r,i){const n=this.createHttpProvider(r,i);n&&(this.httpProviders[r]=n)}createHttpProvider(r,i){const n=i||Ar(r,this.namespace,this.client.core.projectId);return typeof n>"u"?void 0:new Ei(new Hi(n,It("disableProviderPing")))}}class DE{constructor(r){this.name="multiversx",this.namespace=r.namespace,this.events=It("events"),this.client=It("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}requestAccounts(){return this.getAccounts()}request(r){return this.namespace.methods.includes(r.request.method)?this.client.request(r):this.getHttpProvider().request(r.request)}setDefaultChain(r,i){if(!this.httpProviders[r]){const n=i||Ar(`${this.name}:${r}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${r}`);this.setHttpProvider(r,n)}this.chainId=r,this.events.emit(Ii.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}getAccounts(){const r=this.namespace.accounts;return r?[...new Set(r.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){const r={};return this.namespace.chains.forEach(i=>{var n;r[i]=this.createHttpProvider(i,(n=this.namespace.rpcMap)==null?void 0:n[i])}),r}getHttpProvider(){const r=`${this.name}:${this.chainId}`,i=this.httpProviders[r];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return i}setHttpProvider(r,i){const n=this.createHttpProvider(r,i);n&&(this.httpProviders[r]=n)}createHttpProvider(r,i){const n=i||Ar(r,this.namespace,this.client.core.projectId);return typeof n>"u"?void 0:new Ei(new Hi(n,It("disableProviderPing")))}}var FE=Object.defineProperty,LE=Object.defineProperties,$E=Object.getOwnPropertyDescriptors,Cl=Object.getOwnPropertySymbols,ME=Object.prototype.hasOwnProperty,jE=Object.prototype.propertyIsEnumerable,Ol=(c,r,i)=>r in c?FE(c,r,{enumerable:!0,configurable:!0,writable:!0,value:i}):c[r]=i,ro=(c,r)=>{for(var i in r||(r={}))ME.call(r,i)&&Ol(c,i,r[i]);if(Cl)for(var i of Cl(r))jE.call(r,i)&&Ol(c,i,r[i]);return c},sc=(c,r)=>LE(c,$E(r));class Pc{constructor(r){this.events=new vc,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=r,this.logger=typeof(r==null?void 0:r.logger)<"u"&&typeof(r==null?void 0:r.logger)!="string"?r.logger:Re.pino(Re.getDefaultLoggerOptions({level:(r==null?void 0:r.logger)||Il})),this.disableProviderPing=(r==null?void 0:r.disableProviderPing)||!1}static async init(r){const i=new Pc(r);return await i.initialize(),i}async request(r,i){const[n,o]=this.validateChain(i);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(n).request({request:ro({},r),chainId:`${n}:${o}`,topic:this.session.topic})}sendAsync(r,i,n){this.request(r,n).then(o=>i(null,o)).catch(o=>i(o,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var r;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(r=this.session)==null?void 0:r.topic,reason:tr("USER_DISCONNECTED")}),await this.cleanup()}async connect(r){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(r),await this.cleanupPendingPairings(),!r.skipPairing)return await this.pair(r.pairingTopic)}on(r,i){this.events.on(r,i)}once(r,i){this.events.once(r,i)}removeListener(r,i){this.events.removeListener(r,i)}off(r,i){this.events.off(r,i)}get isWalletConnect(){return!0}async pair(r){this.shouldAbortPairingAttempt=!1;let i=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(i>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:n,approval:o}=await this.client.connect({pairingTopic:r,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});n&&(this.uri=n,this.events.emit("display_uri",n)),await o().then(l=>{this.session=l,this.namespaces||(this.namespaces=PE(l.namespaces),this.persist("namespaces",this.namespaces))}).catch(l=>{if(l.message!==Ef)throw l;i++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(r,i){try{if(!this.session)return;const[n,o]=this.validateChain(r);this.getProvider(n).setDefaultChain(o,i)}catch(n){if(!/Please call connect/.test(n.message))throw n}}async cleanupPendingPairings(r={}){this.logger.info("Cleaning up inactive pairings...");const i=this.client.pairing.getAll();if(ps(i)){for(const n of i)r.deletePairings?this.client.core.expirer.set(n.topic,0):await this.client.core.relayer.subscriber.unsubscribe(n.topic);this.logger.info(`Inactive pairings cleared: ${i.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const r=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[r]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await uE.init({logger:this.providerOpts.logger||Il,relayUrl:this.providerOpts.relayUrl||pE,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const r=[...new Set(Object.keys(this.session.namespaces).map(i=>no(i)))];ic("client",this.client),ic("events",this.events),ic("disableProviderPing",this.disableProviderPing),r.forEach(i=>{if(!this.session)return;const n=IE(i,this.session),o=xf(n),l=xE(this.namespaces,this.optionalNamespaces),d=sc(ro({},l[i]),{accounts:n,chains:o});switch(i){case"eip155":this.rpcProviders[i]=new CE({namespace:d});break;case"solana":this.rpcProviders[i]=new OE({namespace:d});break;case"cosmos":this.rpcProviders[i]=new RE({namespace:d});break;case"polkadot":this.rpcProviders[i]=new AE({namespace:d});break;case"cip34":this.rpcProviders[i]=new TE({namespace:d});break;case"elrond":this.rpcProviders[i]=new NE({namespace:d});break;case"multiversx":this.rpcProviders[i]=new DE({namespace:d});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",r=>{this.events.emit("session_ping",r)}),this.client.on("session_event",r=>{const{params:i}=r,{event:n}=i;if(n.name==="accountsChanged"){const o=n.data;o&&ps(o)&&this.events.emit("accountsChanged",o.map(SE))}else n.name==="chainChanged"?this.onChainChanged(i.chainId):this.events.emit(n.name,n.data);this.events.emit("session_event",r)}),this.client.on("session_update",({topic:r,params:i})=>{var n;const{namespaces:o}=i,l=(n=this.client)==null?void 0:n.session.get(r);this.session=sc(ro({},l),{namespaces:o}),this.onSessionUpdate(),this.events.emit("session_update",{topic:r,params:i})}),this.client.on("session_delete",async r=>{await this.cleanup(),this.events.emit("session_delete",r),this.events.emit("disconnect",sc(ro({},tr("USER_DISCONNECTED")),{data:r.topic}))}),this.on(Ii.DEFAULT_CHAIN_CHANGED,r=>{this.onChainChanged(r,!0)})}getProvider(r){if(!this.rpcProviders[r])throw new Error(`Provider not found: ${r}`);return this.rpcProviders[r]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(r=>{var i;this.getProvider(r).updateNamespace((i=this.session)==null?void 0:i.namespaces[r])})}setNamespaces(r){const{namespaces:i,optionalNamespaces:n,sessionProperties:o}=r;i&&Object.keys(i).length&&(this.namespaces=i),n&&Object.keys(n).length&&(this.optionalNamespaces=n),this.sessionProperties=o,this.persist("namespaces",i),this.persist("optionalNamespaces",n)}validateChain(r){const[i,n]=(r==null?void 0:r.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[i,n];if(i&&!Object.keys(this.namespaces||{}).map(d=>no(d)).includes(i))throw new Error(`Namespace '${i}' is not configured. Please call connect() first with namespace config.`);if(i&&n)return[i,n];const o=no(Object.keys(this.namespaces)[0]),l=this.rpcProviders[o].getDefaultChain();return[o,l]}async requestAccounts(){const[r]=this.validateChain();return await this.getProvider(r).requestAccounts()}onChainChanged(r,i=!1){var n;if(!this.namespaces)return;const[o,l]=this.validateChain(r);i||this.getProvider(o).setDefaultChain(l),((n=this.namespaces[o])!=null?n:this.namespaces[`${o}:${l}`]).defaultChain=l,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",l)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(r,i){this.client.core.storage.setItem(`${xl}/${r}`,i)}async getFromStore(r){return await this.client.core.storage.getItem(`${xl}/${r}`)}}const zE=Pc,UE="wc",qE="ethereum_provider",BE=`${UE}@2:${qE}:`,HE="https://rpc.walletconnect.com/v1/",dc=["eth_sendTransaction","personal_sign"],kE=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],gc=["chainChanged","accountsChanged"],KE=["message","disconnect","connect"];var VE=Object.defineProperty,GE=Object.defineProperties,WE=Object.getOwnPropertyDescriptors,Rl=Object.getOwnPropertySymbols,JE=Object.prototype.hasOwnProperty,YE=Object.prototype.propertyIsEnumerable,Tl=(c,r,i)=>r in c?VE(c,r,{enumerable:!0,configurable:!0,writable:!0,value:i}):c[r]=i,Bs=(c,r)=>{for(var i in r||(r={}))JE.call(r,i)&&Tl(c,i,r[i]);if(Rl)for(var i of Rl(r))YE.call(r,i)&&Tl(c,i,r[i]);return c},Nl=(c,r)=>GE(c,WE(r));function lo(c){return Number(c[0].split(":")[1])}function nc(c){return`0x${c.toString(16)}`}function XE(c){const{chains:r,optionalChains:i,methods:n,optionalMethods:o,events:l,optionalEvents:d,rpcMap:v}=c;if(!ps(r))throw new Error("Invalid chains");const b={chains:r,methods:n||dc,events:l||gc,rpcMap:Bs({},r.length?{[lo(r)]:v[lo(r)]}:{})},m=l==null?void 0:l.filter(z=>!gc.includes(z)),S=n==null?void 0:n.filter(z=>!dc.includes(z));if(!i&&!d&&!o&&!(m!=null&&m.length)&&!(S!=null&&S.length))return{required:r.length?b:void 0};const O=(m==null?void 0:m.length)&&(S==null?void 0:S.length)||!i,F={chains:[...new Set(O?b.chains.concat(i||[]):i)],methods:[...new Set(b.methods.concat(o!=null&&o.length?o:kE))],events:[...new Set(b.events.concat(d||KE))],rpcMap:v};return{required:r.length?b:void 0,optional:i.length?F:void 0}}class Ac{constructor(){this.events=new Cr.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=BE,this.on=(r,i)=>(this.events.on(r,i),this),this.once=(r,i)=>(this.events.once(r,i),this),this.removeListener=(r,i)=>(this.events.removeListener(r,i),this),this.off=(r,i)=>(this.events.off(r,i),this),this.parseAccount=r=>this.isCompatibleChainId(r)?this.parseAccountId(r).address:r,this.signer={},this.rpc={}}static async init(r){const i=new Ac;return await i.initialize(r),i}async request(r){return await this.signer.request(r,this.formatChainId(this.chainId))}sendAsync(r,i){this.signer.sendAsync(r,i,this.formatChainId(this.chainId))}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(r){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(r);const{required:i,optional:n}=XE(this.rpc);try{const o=await new Promise(async(d,v)=>{var b;this.rpc.showQrModal&&((b=this.modal)==null||b.subscribeModal(m=>{!m.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),v(new Error("Connection request reset. Please try again.")))})),await this.signer.connect(Nl(Bs({namespaces:Bs({},i&&{[this.namespace]:i})},n&&{optionalNamespaces:{[this.namespace]:n}}),{pairingTopic:r==null?void 0:r.pairingTopic})).then(m=>{d(m)}).catch(m=>{v(new Error(m.message))})});if(!o)return;this.setChainIds(this.rpc.chains);const l=qm(o.namespaces,[this.namespace]);this.setAccounts(l),this.events.emit("connect",{chainId:nc(this.chainId)})}catch(o){throw this.signer.logger.error(o),o}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",r=>{const{params:i}=r,{event:n}=i;n.name==="accountsChanged"?(this.accounts=this.parseAccounts(n.data),this.events.emit("accountsChanged",this.accounts)):n.name==="chainChanged"?this.setChainId(this.formatChainId(n.data)):this.events.emit(n.name,n.data),this.events.emit("session_event",r)}),this.signer.on("chainChanged",r=>{const i=parseInt(r);this.chainId=i,this.events.emit("chainChanged",nc(this.chainId)),this.persist()}),this.signer.on("session_update",r=>{this.events.emit("session_update",r)}),this.signer.on("session_delete",r=>{this.reset(),this.events.emit("session_delete",r),this.events.emit("disconnect",Nl(Bs({},tr("USER_DISCONNECTED")),{data:r.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",r=>{var i,n;this.rpc.showQrModal&&((i=this.modal)==null||i.closeModal(),(n=this.modal)==null||n.openModal({uri:r})),this.events.emit("display_uri",r)})}switchEthereumChain(r){this.request({method:"wallet_switchEthereumChain",params:[{chainId:r.toString(16)}]})}isCompatibleChainId(r){return typeof r=="string"?r.startsWith(`${this.namespace}:`):!1}formatChainId(r){return`${this.namespace}:${r}`}parseChainId(r){return Number(r.split(":")[1])}setChainIds(r){const i=r.filter(n=>this.isCompatibleChainId(n)).map(n=>this.parseChainId(n));i.length&&(this.chainId=i[0],this.events.emit("chainChanged",nc(this.chainId)),this.persist())}setChainId(r){if(this.isCompatibleChainId(r)){const i=this.parseChainId(r);this.chainId=i,this.switchEthereumChain(i)}}parseAccountId(r){const[i,n,o]=r.split(":");return{chainId:`${i}:${n}`,address:o}}setAccounts(r){this.accounts=r.filter(i=>this.parseChainId(this.parseAccountId(i).chainId)===this.chainId).map(i=>this.parseAccountId(i).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(r){var i,n;const o=(i=r==null?void 0:r.chains)!=null?i:[],l=(n=r==null?void 0:r.optionalChains)!=null?n:[],d=o.concat(l);if(!d.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const v=o.length?(r==null?void 0:r.methods)||dc:[],b=o.length?(r==null?void 0:r.events)||gc:[],m=(r==null?void 0:r.optionalMethods)||[],S=(r==null?void 0:r.optionalEvents)||[],O=(r==null?void 0:r.rpcMap)||this.buildRpcMap(d,r.projectId),F=(r==null?void 0:r.qrModalOptions)||void 0;return{chains:o==null?void 0:o.map(z=>this.formatChainId(z)),optionalChains:l.map(z=>this.formatChainId(z)),methods:v,events:b,optionalMethods:m,optionalEvents:S,rpcMap:O,showQrModal:!!(r!=null&&r.showQrModal),qrModalOptions:F,projectId:r.projectId,metadata:r.metadata}}buildRpcMap(r,i){const n={};return r.forEach(o=>{n[o]=this.getRpcUrl(o,i)}),n}async initialize(r){if(this.rpc=this.getRpcConfig(r),this.chainId=this.rpc.chains.length?lo(this.rpc.chains):lo(this.rpc.optionalChains),this.signer=await zE.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:r.disableProviderPing,relayUrl:r.relayUrl,storageOptions:r.storageOptions}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let i;try{const{WalletConnectModal:n}=await Bm(()=>import("./index-f6657797.js").then(o=>o.a),["./index-f6657797.js","./index-1b4dc470.js","./index-f4824932.css","./index-cc134824.js"],import.meta.url);i=n}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(i)try{this.modal=new i(Bs({walletConnectVersion:2,projectId:this.rpc.projectId,standaloneChains:this.rpc.chains},this.rpc.qrModalOptions))}catch(n){throw this.signer.logger.error(n),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(r){if(!r)return;const{chains:i,optionalChains:n,rpcMap:o}=r;i&&ps(i)&&(this.rpc.chains=i.map(l=>this.formatChainId(l)),i.forEach(l=>{this.rpc.rpcMap[l]=(o==null?void 0:o[l])||this.getRpcUrl(l)})),n&&ps(n)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=n==null?void 0:n.map(l=>this.formatChainId(l)),n.forEach(l=>{this.rpc.rpcMap[l]=(o==null?void 0:o[l])||this.getRpcUrl(l)}))}getRpcUrl(r,i){var n;return((n=this.rpc.rpcMap)==null?void 0:n[r])||`${HE}?chainId=eip155:${r}&projectId=${i||this.rpc.projectId}`}async loadPersistedSession(){if(!this.session)return;const r=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),i=this.session.namespaces[`${this.namespace}:${r}`]?this.session.namespaces[`${this.namespace}:${r}`]:this.session.namespaces[this.namespace];this.setChainIds(r?[this.formatChainId(r)]:i==null?void 0:i.accounts),this.setAccounts(i==null?void 0:i.accounts)}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(r){return typeof r=="string"||r instanceof String?[this.parseAccount(r)]:r.map(i=>this.parseAccount(i))}}const lI=Ac;export{lI as EthereumProvider,KE as OPTIONAL_EVENTS,kE as OPTIONAL_METHODS,gc as REQUIRED_EVENTS,dc as REQUIRED_METHODS,Ac as default};
