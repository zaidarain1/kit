import{g as _c,a as mm,r as vn,c as se,b as wm,w as ql,d as Bl,f as bc,t as yo,e as _m,h as jr,I as bi,A as bm,U as Em,i as Q,j as Im,k as hc,l as xm,_ as Sm,P as Pm,V as Dh,m as Am,D as Cm,C as Om,Z as Lh,$ as Rm,n as Tm,o as lo,q as Nm,p as Hl,s as $r,y as Dm,u as Lm,X as fn,v as Ft,x as rr,z as _i,B as hr,E as Fm,F as pn,G as kl,H as $m,J as Mm,K as jm,L as Kl,M as zm,N as Vl,Y as Gl,O as dn,Q as lc,R as so,S as yn,T as Um,W as oo,a0 as qm,a1 as Bm,a2 as Hm,a3 as km,a4 as Km,a5 as Ga,a6 as Fh,a7 as Vm,a8 as Gm,a9 as Wm,aa as $h,ab as Jm,ac as Ym,ad as Xm,ae as Zm,af as Qm,ag as e1,ah as t1,ai as ao,aj as Wl,ak as Wa,al as r1,am as i1}from"./index-74b68cc3.js";var Ec={exports:{}},gn=typeof Reflect=="object"?Reflect:null,Mh=gn&&typeof gn.apply=="function"?gn.apply:function(t,i,s){return Function.prototype.apply.call(t,i,s)},co;gn&&typeof gn.ownKeys=="function"?co=gn.ownKeys:Object.getOwnPropertySymbols?co=function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:co=function(t){return Object.getOwnPropertyNames(t)};function n1(a){console&&console.warn&&console.warn(a)}var Jl=Number.isNaN||function(t){return t!==t};function He(){He.init.call(this)}Ec.exports=He;Ec.exports.once=c1;He.EventEmitter=He;He.prototype._events=void 0;He.prototype._eventsCount=0;He.prototype._maxListeners=void 0;var jh=10;function vo(a){if(typeof a!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof a)}Object.defineProperty(He,"defaultMaxListeners",{enumerable:!0,get:function(){return jh},set:function(a){if(typeof a!="number"||a<0||Jl(a))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+a+".");jh=a}});He.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};He.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||Jl(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this};function Yl(a){return a._maxListeners===void 0?He.defaultMaxListeners:a._maxListeners}He.prototype.getMaxListeners=function(){return Yl(this)};He.prototype.emit=function(t){for(var i=[],s=1;s<arguments.length;s++)i.push(arguments[s]);var o=t==="error",h=this._events;if(h!==void 0)o=o&&h.error===void 0;else if(!o)return!1;if(o){var p;if(i.length>0&&(p=i[0]),p instanceof Error)throw p;var g=new Error("Unhandled error."+(p?" ("+p.message+")":""));throw g.context=p,g}var _=h[t];if(_===void 0)return!1;if(typeof _=="function")Mh(_,this,i);else for(var m=_.length,x=tf(_,m),s=0;s<m;++s)Mh(x[s],this,i);return!0};function Xl(a,t,i,s){var o,h,p;if(vo(i),h=a._events,h===void 0?(h=a._events=Object.create(null),a._eventsCount=0):(h.newListener!==void 0&&(a.emit("newListener",t,i.listener?i.listener:i),h=a._events),p=h[t]),p===void 0)p=h[t]=i,++a._eventsCount;else if(typeof p=="function"?p=h[t]=s?[i,p]:[p,i]:s?p.unshift(i):p.push(i),o=Yl(a),o>0&&p.length>o&&!p.warned){p.warned=!0;var g=new Error("Possible EventEmitter memory leak detected. "+p.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");g.name="MaxListenersExceededWarning",g.emitter=a,g.type=t,g.count=p.length,n1(g)}return a}He.prototype.addListener=function(t,i){return Xl(this,t,i,!1)};He.prototype.on=He.prototype.addListener;He.prototype.prependListener=function(t,i){return Xl(this,t,i,!0)};function s1(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Zl(a,t,i){var s={fired:!1,wrapFn:void 0,target:a,type:t,listener:i},o=s1.bind(s);return o.listener=i,s.wrapFn=o,o}He.prototype.once=function(t,i){return vo(i),this.on(t,Zl(this,t,i)),this};He.prototype.prependOnceListener=function(t,i){return vo(i),this.prependListener(t,Zl(this,t,i)),this};He.prototype.removeListener=function(t,i){var s,o,h,p,g;if(vo(i),o=this._events,o===void 0)return this;if(s=o[t],s===void 0)return this;if(s===i||s.listener===i)--this._eventsCount===0?this._events=Object.create(null):(delete o[t],o.removeListener&&this.emit("removeListener",t,s.listener||i));else if(typeof s!="function"){for(h=-1,p=s.length-1;p>=0;p--)if(s[p]===i||s[p].listener===i){g=s[p].listener,h=p;break}if(h<0)return this;h===0?s.shift():o1(s,h),s.length===1&&(o[t]=s[0]),o.removeListener!==void 0&&this.emit("removeListener",t,g||i)}return this};He.prototype.off=He.prototype.removeListener;He.prototype.removeAllListeners=function(t){var i,s,o;if(s=this._events,s===void 0)return this;if(s.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):s[t]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete s[t]),this;if(arguments.length===0){var h=Object.keys(s),p;for(o=0;o<h.length;++o)p=h[o],p!=="removeListener"&&this.removeAllListeners(p);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(i=s[t],typeof i=="function")this.removeListener(t,i);else if(i!==void 0)for(o=i.length-1;o>=0;o--)this.removeListener(t,i[o]);return this};function Ql(a,t,i){var s=a._events;if(s===void 0)return[];var o=s[t];return o===void 0?[]:typeof o=="function"?i?[o.listener||o]:[o]:i?a1(o):tf(o,o.length)}He.prototype.listeners=function(t){return Ql(this,t,!0)};He.prototype.rawListeners=function(t){return Ql(this,t,!1)};He.listenerCount=function(a,t){return typeof a.listenerCount=="function"?a.listenerCount(t):ef.call(a,t)};He.prototype.listenerCount=ef;function ef(a){var t=this._events;if(t!==void 0){var i=t[a];if(typeof i=="function")return 1;if(i!==void 0)return i.length}return 0}He.prototype.eventNames=function(){return this._eventsCount>0?co(this._events):[]};function tf(a,t){for(var i=new Array(t),s=0;s<t;++s)i[s]=a[s];return i}function o1(a,t){for(;t+1<a.length;t++)a[t]=a[t+1];a.pop()}function a1(a){for(var t=new Array(a.length),i=0;i<t.length;++i)t[i]=a[i].listener||a[i];return t}function c1(a,t){return new Promise(function(i,s){function o(p){a.removeListener(t,h),s(p)}function h(){typeof a.removeListener=="function"&&a.removeListener("error",o),i([].slice.call(arguments))}rf(a,t,h,{once:!0}),t!=="error"&&u1(a,o,{once:!0})})}function u1(a,t,i){typeof a.on=="function"&&rf(a,"error",t,i)}function rf(a,t,i,s){if(typeof a.on=="function")s.once?a.once(t,i):a.on(t,i);else if(typeof a.addEventListener=="function")a.addEventListener(t,function o(h){s.once&&a.removeEventListener(t,o),i(h)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof a)}var vr=Ec.exports;const Ic=_c(vr),h1=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,l1=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,f1=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function p1(a,t){if(a==="__proto__"||a==="constructor"&&t&&typeof t=="object"&&"prototype"in t){d1(a);return}return t}function d1(a){console.warn(`[destr] Dropping "${a}" key to prevent prototype pollution.`)}function eo(a,t={}){if(typeof a!="string")return a;const i=a.trim();if(a[0]==='"'&&a.at(-1)==='"'&&!a.includes("\\"))return i.slice(1,-1);if(i.length<=9){const s=i.toLowerCase();if(s==="true")return!0;if(s==="false")return!1;if(s==="undefined")return;if(s==="null")return null;if(s==="nan")return Number.NaN;if(s==="infinity")return Number.POSITIVE_INFINITY;if(s==="-infinity")return Number.NEGATIVE_INFINITY}if(!f1.test(a)){if(t.strict)throw new SyntaxError("[destr] Invalid JSON");return a}try{if(h1.test(a)||l1.test(a)){if(t.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(a,p1)}return JSON.parse(a)}catch(s){if(t.strict)throw s;return a}}function g1(a){return!a||typeof a.then!="function"?Promise.resolve(a):a}function Bt(a,...t){try{return g1(a(...t))}catch(i){return Promise.reject(i)}}function y1(a){const t=typeof a;return a===null||t!=="object"&&t!=="function"}function v1(a){const t=Object.getPrototypeOf(a);return!t||t.isPrototypeOf(Object)}function uo(a){if(y1(a))return String(a);if(v1(a)||Array.isArray(a))return JSON.stringify(a);if(typeof a.toJSON=="function")return uo(a.toJSON());throw new Error("[unstorage] Cannot stringify value!")}function nf(){if(typeof Buffer===void 0)throw new TypeError("[unstorage] Buffer is not supported!")}const fc="base64:";function m1(a){if(typeof a=="string")return a;nf();const t=Buffer.from(a).toString("base64");return fc+t}function w1(a){return typeof a!="string"||!a.startsWith(fc)?a:(nf(),Buffer.from(a.slice(fc.length),"base64"))}function ur(a){return a?a.split("?")[0].replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""):""}function _1(...a){return ur(a.join(":"))}function to(a){return a=ur(a),a?a+":":""}const b1="memory",E1=()=>{const a=new Map;return{name:b1,options:{},hasItem(t){return a.has(t)},getItem(t){return a.get(t)??null},getItemRaw(t){return a.get(t)??null},setItem(t,i){a.set(t,i)},setItemRaw(t,i){a.set(t,i)},removeItem(t){a.delete(t)},getKeys(){return Array.from(a.keys())},clear(){a.clear()},dispose(){a.clear()}}};function I1(a={}){const t={mounts:{"":a.driver||E1()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},i=m=>{for(const x of t.mountpoints)if(m.startsWith(x))return{base:x,relativeKey:m.slice(x.length),driver:t.mounts[x]};return{base:"",relativeKey:m,driver:t.mounts[""]}},s=(m,x)=>t.mountpoints.filter(O=>O.startsWith(m)||x&&m.startsWith(O)).map(O=>({relativeBase:m.length>O.length?m.slice(O.length):void 0,mountpoint:O,driver:t.mounts[O]})),o=(m,x)=>{if(t.watching){x=ur(x);for(const O of t.watchListeners)O(m,x)}},h=async()=>{if(!t.watching){t.watching=!0;for(const m in t.mounts)t.unwatch[m]=await zh(t.mounts[m],o,m)}},p=async()=>{if(t.watching){for(const m in t.unwatch)await t.unwatch[m]();t.unwatch={},t.watching=!1}},g=(m,x,O)=>{const L=new Map,z=R=>{let K=L.get(R.base);return K||(K={driver:R.driver,base:R.base,items:[]},L.set(R.base,K)),K};for(const R of m){const K=typeof R=="string",re=ur(K?R:R.key),he=K?void 0:R.value,le=K||!R.options?x:{...x,...R.options},fe=i(re);z(fe).items.push({key:re,value:he,relativeKey:fe.relativeKey,options:le})}return Promise.all([...L.values()].map(R=>O(R))).then(R=>R.flat())},_={hasItem(m,x={}){m=ur(m);const{relativeKey:O,driver:L}=i(m);return Bt(L.hasItem,O,x)},getItem(m,x={}){m=ur(m);const{relativeKey:O,driver:L}=i(m);return Bt(L.getItem,O,x).then(z=>eo(z))},getItems(m,x){return g(m,x,O=>O.driver.getItems?Bt(O.driver.getItems,O.items.map(L=>({key:L.relativeKey,options:L.options})),x).then(L=>L.map(z=>({key:_1(O.base,z.key),value:eo(z.value)}))):Promise.all(O.items.map(L=>Bt(O.driver.getItem,L.relativeKey,L.options).then(z=>({key:L.key,value:eo(z)})))))},getItemRaw(m,x={}){m=ur(m);const{relativeKey:O,driver:L}=i(m);return L.getItemRaw?Bt(L.getItemRaw,O,x):Bt(L.getItem,O,x).then(z=>w1(z))},async setItem(m,x,O={}){if(x===void 0)return _.removeItem(m);m=ur(m);const{relativeKey:L,driver:z}=i(m);z.setItem&&(await Bt(z.setItem,L,uo(x),O),z.watch||o("update",m))},async setItems(m,x){await g(m,x,async O=>{O.driver.setItems&&await Bt(O.driver.setItems,O.items.map(L=>({key:L.relativeKey,value:uo(L.value),options:L.options})),x),O.driver.setItem&&await Promise.all(O.items.map(L=>Bt(O.driver.setItem,L.relativeKey,uo(L.value),L.options)))})},async setItemRaw(m,x,O={}){if(x===void 0)return _.removeItem(m,O);m=ur(m);const{relativeKey:L,driver:z}=i(m);if(z.setItemRaw)await Bt(z.setItemRaw,L,x,O);else if(z.setItem)await Bt(z.setItem,L,m1(x),O);else return;z.watch||o("update",m)},async removeItem(m,x={}){typeof x=="boolean"&&(x={removeMeta:x}),m=ur(m);const{relativeKey:O,driver:L}=i(m);L.removeItem&&(await Bt(L.removeItem,O,x),(x.removeMeta||x.removeMata)&&await Bt(L.removeItem,O+"$",x),L.watch||o("remove",m))},async getMeta(m,x={}){typeof x=="boolean"&&(x={nativeOnly:x}),m=ur(m);const{relativeKey:O,driver:L}=i(m),z=Object.create(null);if(L.getMeta&&Object.assign(z,await Bt(L.getMeta,O,x)),!x.nativeOnly){const R=await Bt(L.getItem,O+"$",x).then(K=>eo(K));R&&typeof R=="object"&&(typeof R.atime=="string"&&(R.atime=new Date(R.atime)),typeof R.mtime=="string"&&(R.mtime=new Date(R.mtime)),Object.assign(z,R))}return z},setMeta(m,x,O={}){return this.setItem(m+"$",x,O)},removeMeta(m,x={}){return this.removeItem(m+"$",x)},async getKeys(m,x={}){m=to(m);const O=s(m,!0);let L=[];const z=[];for(const R of O){const re=(await Bt(R.driver.getKeys,R.relativeBase,x)).map(he=>R.mountpoint+ur(he)).filter(he=>!L.some(le=>he.startsWith(le)));z.push(...re),L=[R.mountpoint,...L.filter(he=>!he.startsWith(R.mountpoint))]}return m?z.filter(R=>R.startsWith(m)&&!R.endsWith("$")):z.filter(R=>!R.endsWith("$"))},async clear(m,x={}){m=to(m),await Promise.all(s(m,!1).map(async O=>{if(O.driver.clear)return Bt(O.driver.clear,O.relativeBase,x);if(O.driver.removeItem){const L=await O.driver.getKeys(O.relativeBase||"",x);return Promise.all(L.map(z=>O.driver.removeItem(z,x)))}}))},async dispose(){await Promise.all(Object.values(t.mounts).map(m=>Uh(m)))},async watch(m){return await h(),t.watchListeners.push(m),async()=>{t.watchListeners=t.watchListeners.filter(x=>x!==m),t.watchListeners.length===0&&await p()}},async unwatch(){t.watchListeners=[],await p()},mount(m,x){if(m=to(m),m&&t.mounts[m])throw new Error(`already mounted at ${m}`);return m&&(t.mountpoints.push(m),t.mountpoints.sort((O,L)=>L.length-O.length)),t.mounts[m]=x,t.watching&&Promise.resolve(zh(x,o,m)).then(O=>{t.unwatch[m]=O}).catch(console.error),_},async unmount(m,x=!0){m=to(m),!(!m||!t.mounts[m])&&(t.watching&&m in t.unwatch&&(t.unwatch[m](),delete t.unwatch[m]),x&&await Uh(t.mounts[m]),t.mountpoints=t.mountpoints.filter(O=>O!==m),delete t.mounts[m])},getMount(m=""){m=ur(m)+":";const x=i(m);return{driver:x.driver,base:x.base}},getMounts(m="",x={}){return m=ur(m),s(m,x.parents).map(L=>({driver:L.driver,base:L.mountpoint}))}};return _}function zh(a,t,i){return a.watch?a.watch((s,o)=>t(s,i+o)):()=>{}}async function Uh(a){typeof a.dispose=="function"&&await Bt(a.dispose)}function Bi(a){return new Promise((t,i)=>{a.oncomplete=a.onsuccess=()=>t(a.result),a.onabort=a.onerror=()=>i(a.error)})}function sf(a,t){const i=indexedDB.open(a);i.onupgradeneeded=()=>i.result.createObjectStore(t);const s=Bi(i);return(o,h)=>s.then(p=>h(p.transaction(t,o).objectStore(t)))}let Ja;function Gn(){return Ja||(Ja=sf("keyval-store","keyval")),Ja}function qh(a,t=Gn()){return t("readonly",i=>Bi(i.get(a)))}function x1(a,t,i=Gn()){return i("readwrite",s=>(s.put(t,a),Bi(s.transaction)))}function S1(a,t=Gn()){return t("readwrite",i=>(i.delete(a),Bi(i.transaction)))}function P1(a=Gn()){return a("readwrite",t=>(t.clear(),Bi(t.transaction)))}function A1(a,t){return a.openCursor().onsuccess=function(){this.result&&(t(this.result),this.result.continue())},Bi(a.transaction)}function C1(a=Gn()){return a("readonly",t=>{if(t.getAllKeys)return Bi(t.getAllKeys());const i=[];return A1(t,s=>i.push(s.key)).then(()=>i)})}const O1=a=>JSON.stringify(a,(t,i)=>typeof i=="bigint"?i.toString()+"n":i),R1=a=>{const t=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,i=a.replace(t,'$1"$2n"$3');return JSON.parse(i,(s,o)=>typeof o=="string"&&o.match(/^\d+n$/)?BigInt(o.substring(0,o.length-1)):o)};function Wn(a){if(typeof a!="string")throw new Error(`Cannot safe json parse value of type ${typeof a}`);try{return R1(a)}catch{return a}}function qi(a){return typeof a=="string"?a:O1(a)||""}const T1="idb-keyval";var N1=(a={})=>{const t=a.base&&a.base.length>0?`${a.base}:`:"",i=o=>t+o;let s;return a.dbName&&a.storeName&&(s=sf(a.dbName,a.storeName)),{name:T1,options:a,async hasItem(o){return!(typeof await qh(i(o),s)>"u")},async getItem(o){return await qh(i(o),s)??null},setItem(o,h){return x1(i(o),h,s)},removeItem(o){return S1(i(o),s)},getKeys(){return C1(s)},clear(){return P1(s)}}};const D1="WALLET_CONNECT_V2_INDEXED_DB",L1="keyvaluestorage";let F1=class{constructor(){this.indexedDb=I1({driver:N1({dbName:D1,storeName:L1})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(t=>[t.key,t.value])}async getItem(t){const i=await this.indexedDb.getItem(t);if(i!==null)return i}async setItem(t,i){await this.indexedDb.setItem(t,qi(i))}async removeItem(t){await this.indexedDb.removeItem(t)}};var Ya=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ho={exports:{}};(function(){let a;function t(){}a=t,a.prototype.getItem=function(i){return this.hasOwnProperty(i)?String(this[i]):null},a.prototype.setItem=function(i,s){this[i]=String(s)},a.prototype.removeItem=function(i){delete this[i]},a.prototype.clear=function(){const i=this;Object.keys(i).forEach(function(s){i[s]=void 0,delete i[s]})},a.prototype.key=function(i){return i=i||0,Object.keys(this)[i]},a.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof Ya<"u"&&Ya.localStorage?ho.exports=Ya.localStorage:typeof window<"u"&&window.localStorage?ho.exports=window.localStorage:ho.exports=new t})();function $1(a){var t;return[a[0],Wn((t=a[1])!=null?t:"")]}let M1=class{constructor(){this.localStorage=ho.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map($1)}async getItem(t){const i=this.localStorage.getItem(t);if(i!==null)return Wn(i)}async setItem(t,i){this.localStorage.setItem(t,qi(i))}async removeItem(t){this.localStorage.removeItem(t)}};const j1="wc_storage_version",Bh=1,z1=async(a,t,i)=>{const s=j1,o=await t.getItem(s);if(o&&o>=Bh){i(t);return}const h=await a.getKeys();if(!h.length){i(t);return}const p=[];for(;h.length;){const g=h.shift();if(!g)continue;const _=g.toLowerCase();if(_.includes("wc@")||_.includes("walletconnect")||_.includes("wc_")||_.includes("wallet_connect")){const m=await a.getItem(g);await t.setItem(g,m),p.push(g)}}await t.setItem(s,Bh),i(t),U1(a,p)},U1=async(a,t)=>{t.length&&t.forEach(async i=>{await a.removeItem(i)})};let q1=class{constructor(){this.initialized=!1,this.setInitialized=i=>{this.storage=i,this.initialized=!0};const t=new M1;this.storage=t;try{const i=new F1;z1(t,i,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(t){return await this.initialize(),this.storage.getItem(t)}async setItem(t,i){return await this.initialize(),this.storage.setItem(t,i)}async removeItem(t){return await this.initialize(),this.storage.removeItem(t)}async initialize(){this.initialized||await new Promise(t=>{const i=setInterval(()=>{this.initialized&&(clearInterval(i),t())},20)})}};var mn={},jn={},Xa={},zn={};let Hi=class{};const B1=Object.freeze(Object.defineProperty({__proto__:null,IEvents:Hi},Symbol.toStringTag,{value:"Module"})),H1=mm(B1);var Hh;function k1(){if(Hh)return zn;Hh=1,Object.defineProperty(zn,"__esModule",{value:!0}),zn.IHeartBeat=void 0;const a=H1;class t extends a.IEvents{constructor(s){super()}}return zn.IHeartBeat=t,zn}var kh;function of(){return kh||(kh=1,function(a){Object.defineProperty(a,"__esModule",{value:!0}),vn.__exportStar(k1(),a)}(Xa)),Xa}var Za={},zi={},Kh;function K1(){if(Kh)return zi;Kh=1,Object.defineProperty(zi,"__esModule",{value:!0}),zi.HEARTBEAT_EVENTS=zi.HEARTBEAT_INTERVAL=void 0;const a=se;return zi.HEARTBEAT_INTERVAL=a.FIVE_SECONDS,zi.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},zi}var Vh;function af(){return Vh||(Vh=1,function(a){Object.defineProperty(a,"__esModule",{value:!0}),vn.__exportStar(K1(),a)}(Za)),Za}var Gh;function V1(){if(Gh)return jn;Gh=1,Object.defineProperty(jn,"__esModule",{value:!0}),jn.HeartBeat=void 0;const a=vn,t=vr,i=se,s=of(),o=af();class h extends s.IHeartBeat{constructor(g){super(g),this.events=new t.EventEmitter,this.interval=o.HEARTBEAT_INTERVAL,this.interval=(g==null?void 0:g.interval)||o.HEARTBEAT_INTERVAL}static init(g){return a.__awaiter(this,void 0,void 0,function*(){const _=new h(g);return yield _.init(),_})}init(){return a.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(g,_){this.events.on(g,_)}once(g,_){this.events.once(g,_)}off(g,_){this.events.off(g,_)}removeListener(g,_){this.events.removeListener(g,_)}initialize(){return a.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),i.toMiliseconds(this.interval))})}pulse(){this.events.emit(o.HEARTBEAT_EVENTS.pulse)}}return jn.HeartBeat=h,jn}(function(a){Object.defineProperty(a,"__esModule",{value:!0});const t=vn;t.__exportStar(V1(),a),t.__exportStar(of(),a),t.__exportStar(af(),a)})(mn);var Re={},Qa,Wh;function G1(){if(Wh)return Qa;Wh=1;function a(i){try{return JSON.stringify(i)}catch{return'"[Circular]"'}}Qa=t;function t(i,s,o){var h=o&&o.stringify||a,p=1;if(typeof i=="object"&&i!==null){var g=s.length+p;if(g===1)return i;var _=new Array(g);_[0]=h(i);for(var m=1;m<g;m++)_[m]=h(s[m]);return _.join(" ")}if(typeof i!="string")return i;var x=s.length;if(x===0)return i;for(var O="",L=1-p,z=-1,R=i&&i.length||0,K=0;K<R;){if(i.charCodeAt(K)===37&&K+1<R){switch(z=z>-1?z:0,i.charCodeAt(K+1)){case 100:case 102:if(L>=x||s[L]==null)break;z<K&&(O+=i.slice(z,K)),O+=Number(s[L]),z=K+2,K++;break;case 105:if(L>=x||s[L]==null)break;z<K&&(O+=i.slice(z,K)),O+=Math.floor(Number(s[L])),z=K+2,K++;break;case 79:case 111:case 106:if(L>=x||s[L]===void 0)break;z<K&&(O+=i.slice(z,K));var re=typeof s[L];if(re==="string"){O+="'"+s[L]+"'",z=K+2,K++;break}if(re==="function"){O+=s[L].name||"<anonymous>",z=K+2,K++;break}O+=h(s[L]),z=K+2,K++;break;case 115:if(L>=x)break;z<K&&(O+=i.slice(z,K)),O+=String(s[L]),z=K+2,K++;break;case 37:z<K&&(O+=i.slice(z,K)),O+="%",z=K+2,K++,L--;break}++L}++K}return z===-1?i:(z<R&&(O+=i.slice(z)),O)}return Qa}var ec,Jh;function W1(){if(Jh)return ec;Jh=1;const a=G1();ec=o;const t=de().console||{},i={mapHttpRequest:R,mapHttpResponse:R,wrapRequestSerializer:K,wrapResponseSerializer:K,wrapErrorSerializer:K,req:R,res:R,err:L};function s(F,q){return Array.isArray(F)?F.filter(function(ve){return ve!=="!stdSerializers.err"}):F===!0?Object.keys(q):!1}function o(F){F=F||{},F.browser=F.browser||{};const q=F.browser.transmit;if(q&&typeof q.send!="function")throw Error("pino: transmit option must have a send function");const W=F.browser.write||t;F.browser.write&&(F.browser.asObject=!0);const ve=F.serializers||{},ie=s(F.browser.serialize,ve);let ue=F.browser.serialize;Array.isArray(F.browser.serialize)&&F.browser.serialize.indexOf("!stdSerializers.err")>-1&&(ue=!1);const Te=["error","fatal","warn","info","debug","trace"];typeof W=="function"&&(W.error=W.fatal=W.warn=W.info=W.debug=W.trace=W),F.enabled===!1&&(F.level="silent");const Ue=F.level||"info",v=Object.create(W);v.log||(v.log=re),Object.defineProperty(v,"levelVal",{get:X}),Object.defineProperty(v,"level",{get:ce,set:V});const I={transmit:q,serialize:ie,asObject:F.browser.asObject,levels:Te,timestamp:z(F)};v.levels=o.levels,v.level=Ue,v.setMaxListeners=v.getMaxListeners=v.emit=v.addListener=v.on=v.prependListener=v.once=v.prependOnceListener=v.removeListener=v.removeAllListeners=v.listeners=v.listenerCount=v.eventNames=v.write=v.flush=re,v.serializers=ve,v._serialize=ie,v._stdErrSerialize=ue,v.child=B,q&&(v._logEvent=O());function X(){return this.level==="silent"?1/0:this.levels.values[this.level]}function ce(){return this._level}function V(k){if(k!=="silent"&&!this.levels.values[k])throw Error("unknown level "+k);this._level=k,h(I,v,"error","log"),h(I,v,"fatal","error"),h(I,v,"warn","error"),h(I,v,"info","log"),h(I,v,"debug","log"),h(I,v,"trace","log")}function B(k,G){if(!k)throw new Error("missing bindings for child Pino");G=G||{},ie&&k.serializers&&(G.serializers=k.serializers);const Ye=G.serializers;if(ie&&Ye){var ke=Object.assign({},ve,Ye),zr=F.browser.serialize===!0?Object.keys(ke):ie;delete k.serializers,_([k],zr,ke,this._stdErrSerialize)}function Ie(St){this._childLevel=(St._childLevel|0)+1,this.error=m(St,k,"error"),this.fatal=m(St,k,"fatal"),this.warn=m(St,k,"warn"),this.info=m(St,k,"info"),this.debug=m(St,k,"debug"),this.trace=m(St,k,"trace"),ke&&(this.serializers=ke,this._serialize=zr),q&&(this._logEvent=O([].concat(St._logEvent.bindings,k)))}return Ie.prototype=this,new Ie(this)}return v}o.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},o.stdSerializers=i,o.stdTimeFunctions=Object.assign({},{nullTime:he,epochTime:le,unixTime:fe,isoTime:pe});function h(F,q,W,ve){const ie=Object.getPrototypeOf(q);q[W]=q.levelVal>q.levels.values[W]?re:ie[W]?ie[W]:t[W]||t[ve]||re,p(F,q,W)}function p(F,q,W){!F.transmit&&q[W]===re||(q[W]=function(ve){return function(){const ue=F.timestamp(),Te=new Array(arguments.length),Ue=Object.getPrototypeOf&&Object.getPrototypeOf(this)===t?t:this;for(var v=0;v<Te.length;v++)Te[v]=arguments[v];if(F.serialize&&!F.asObject&&_(Te,this._serialize,this.serializers,this._stdErrSerialize),F.asObject?ve.call(Ue,g(this,W,Te,ue)):ve.apply(Ue,Te),F.transmit){const I=F.transmit.level||q.level,X=o.levels.values[I],ce=o.levels.values[W];if(ce<X)return;x(this,{ts:ue,methodLevel:W,methodValue:ce,transmitLevel:I,transmitValue:o.levels.values[F.transmit.level||q.level],send:F.transmit.send,val:q.levelVal},Te)}}}(q[W]))}function g(F,q,W,ve){F._serialize&&_(W,F._serialize,F.serializers,F._stdErrSerialize);const ie=W.slice();let ue=ie[0];const Te={};ve&&(Te.time=ve),Te.level=o.levels.values[q];let Ue=(F._childLevel|0)+1;if(Ue<1&&(Ue=1),ue!==null&&typeof ue=="object"){for(;Ue--&&typeof ie[0]=="object";)Object.assign(Te,ie.shift());ue=ie.length?a(ie.shift(),ie):void 0}else typeof ue=="string"&&(ue=a(ie.shift(),ie));return ue!==void 0&&(Te.msg=ue),Te}function _(F,q,W,ve){for(const ie in F)if(ve&&F[ie]instanceof Error)F[ie]=o.stdSerializers.err(F[ie]);else if(typeof F[ie]=="object"&&!Array.isArray(F[ie]))for(const ue in F[ie])q&&q.indexOf(ue)>-1&&ue in W&&(F[ie][ue]=W[ue](F[ie][ue]))}function m(F,q,W){return function(){const ve=new Array(1+arguments.length);ve[0]=q;for(var ie=1;ie<ve.length;ie++)ve[ie]=arguments[ie-1];return F[W].apply(this,ve)}}function x(F,q,W){const ve=q.send,ie=q.ts,ue=q.methodLevel,Te=q.methodValue,Ue=q.val,v=F._logEvent.bindings;_(W,F._serialize||Object.keys(F.serializers),F.serializers,F._stdErrSerialize===void 0?!0:F._stdErrSerialize),F._logEvent.ts=ie,F._logEvent.messages=W.filter(function(I){return v.indexOf(I)===-1}),F._logEvent.level.label=ue,F._logEvent.level.value=Te,ve(ue,F._logEvent,Ue),F._logEvent=O(v)}function O(F){return{ts:0,messages:[],bindings:F||[],level:{label:"",value:0}}}function L(F){const q={type:F.constructor.name,msg:F.message,stack:F.stack};for(const W in F)q[W]===void 0&&(q[W]=F[W]);return q}function z(F){return typeof F.timestamp=="function"?F.timestamp:F.timestamp===!1?he:le}function R(){return{}}function K(F){return F}function re(){}function he(){return!1}function le(){return Date.now()}function fe(){return Math.round(Date.now()/1e3)}function pe(){return new Date(Date.now()).toISOString()}function de(){function F(q){return typeof q<"u"&&q}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return F(self)||F(window)||F(this)||{}}}return ec}var Ui={},Yh;function cf(){return Yh||(Yh=1,Object.defineProperty(Ui,"__esModule",{value:!0}),Ui.PINO_CUSTOM_CONTEXT_KEY=Ui.PINO_LOGGER_DEFAULTS=void 0,Ui.PINO_LOGGER_DEFAULTS={level:"info"},Ui.PINO_CUSTOM_CONTEXT_KEY="custom_context"),Ui}var tr={},Xh;function J1(){if(Xh)return tr;Xh=1,Object.defineProperty(tr,"__esModule",{value:!0}),tr.generateChildLogger=tr.formatChildLoggerContext=tr.getLoggerContext=tr.setBrowserLoggerContext=tr.getBrowserLoggerContext=tr.getDefaultLoggerOptions=void 0;const a=cf();function t(g){return Object.assign(Object.assign({},g),{level:(g==null?void 0:g.level)||a.PINO_LOGGER_DEFAULTS.level})}tr.getDefaultLoggerOptions=t;function i(g,_=a.PINO_CUSTOM_CONTEXT_KEY){return g[_]||""}tr.getBrowserLoggerContext=i;function s(g,_,m=a.PINO_CUSTOM_CONTEXT_KEY){return g[m]=_,g}tr.setBrowserLoggerContext=s;function o(g,_=a.PINO_CUSTOM_CONTEXT_KEY){let m="";return typeof g.bindings>"u"?m=i(g,_):m=g.bindings().context||"",m}tr.getLoggerContext=o;function h(g,_,m=a.PINO_CUSTOM_CONTEXT_KEY){const x=o(g,m);return x.trim()?`${x}/${_}`:_}tr.formatChildLoggerContext=h;function p(g,_,m=a.PINO_CUSTOM_CONTEXT_KEY){const x=h(g,_,m),O=g.child({context:x});return s(O,x,m)}return tr.generateChildLogger=p,tr}(function(a){Object.defineProperty(a,"__esModule",{value:!0}),a.pino=void 0;const t=vn,i=t.__importDefault(W1());Object.defineProperty(a,"pino",{enumerable:!0,get:function(){return i.default}}),t.__exportStar(cf(),a),t.__exportStar(J1(),a)})(Re);class Y1 extends Hi{constructor(t){super(),this.opts=t,this.protocol="wc",this.version=2}}class X1 extends Hi{constructor(t,i){super(),this.core=t,this.logger=i,this.records=new Map}}class Z1{constructor(t,i){this.logger=t,this.core=i}}let Q1=class extends Hi{constructor(t,i){super(),this.relayer=t,this.logger=i}},ew=class extends Hi{constructor(t){super()}},tw=class{constructor(t,i,s,o){this.core=t,this.logger=i,this.name=s}};class rw extends Hi{constructor(t,i){super(),this.relayer=t,this.logger=i}}let iw=class extends Hi{constructor(t,i){super(),this.core=t,this.logger=i}},nw=class{constructor(t,i){this.projectId=t,this.logger=i}},sw=class{constructor(t){this.opts=t,this.protocol="wc",this.version=2}},ow=class{constructor(t){this.client=t}};var xc={},uf={};(function(a){Object.defineProperty(a,"__esModule",{value:!0});var t=wm,i=ql;a.DIGEST_LENGTH=64,a.BLOCK_SIZE=128;var s=function(){function g(){this.digestLength=a.DIGEST_LENGTH,this.blockSize=a.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return g.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},g.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},g.prototype.clean=function(){i.wipe(this._buffer),i.wipe(this._tempHi),i.wipe(this._tempLo),this.reset()},g.prototype.update=function(_,m){if(m===void 0&&(m=_.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var x=0;if(this._bytesHashed+=m,this._bufferLength>0){for(;this._bufferLength<a.BLOCK_SIZE&&m>0;)this._buffer[this._bufferLength++]=_[x++],m--;this._bufferLength===this.blockSize&&(h(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(m>=this.blockSize&&(x=h(this._tempHi,this._tempLo,this._stateHi,this._stateLo,_,x,m),m%=this.blockSize);m>0;)this._buffer[this._bufferLength++]=_[x++],m--;return this},g.prototype.finish=function(_){if(!this._finished){var m=this._bytesHashed,x=this._bufferLength,O=m/536870912|0,L=m<<3,z=m%128<112?128:256;this._buffer[x]=128;for(var R=x+1;R<z-8;R++)this._buffer[R]=0;t.writeUint32BE(O,this._buffer,z-8),t.writeUint32BE(L,this._buffer,z-4),h(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,z),this._finished=!0}for(var R=0;R<this.digestLength/8;R++)t.writeUint32BE(this._stateHi[R],_,R*8),t.writeUint32BE(this._stateLo[R],_,R*8+4);return this},g.prototype.digest=function(){var _=new Uint8Array(this.digestLength);return this.finish(_),_},g.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},g.prototype.restoreState=function(_){return this._stateHi.set(_.stateHi),this._stateLo.set(_.stateLo),this._bufferLength=_.bufferLength,_.buffer&&this._buffer.set(_.buffer),this._bytesHashed=_.bytesHashed,this._finished=!1,this},g.prototype.cleanSavedState=function(_){i.wipe(_.stateHi),i.wipe(_.stateLo),_.buffer&&i.wipe(_.buffer),_.bufferLength=0,_.bytesHashed=0},g}();a.SHA512=s;var o=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function h(g,_,m,x,O,L,z){for(var R=m[0],K=m[1],re=m[2],he=m[3],le=m[4],fe=m[5],pe=m[6],de=m[7],F=x[0],q=x[1],W=x[2],ve=x[3],ie=x[4],ue=x[5],Te=x[6],Ue=x[7],v,I,X,ce,V,B,k,G;z>=128;){for(var Ye=0;Ye<16;Ye++){var ke=8*Ye+L;g[Ye]=t.readUint32BE(O,ke),_[Ye]=t.readUint32BE(O,ke+4)}for(var Ye=0;Ye<80;Ye++){var zr=R,Ie=K,St=re,D=he,N=le,C=fe,u=pe,E=de,ee=F,ge=q,be=W,Ne=ve,Le=ie,Pe=ue,Pt=Te,wt=Ue;if(v=de,I=Ue,V=I&65535,B=I>>>16,k=v&65535,G=v>>>16,v=(le>>>14|ie<<32-14)^(le>>>18|ie<<32-18)^(ie>>>41-32|le<<32-(41-32)),I=(ie>>>14|le<<32-14)^(ie>>>18|le<<32-18)^(le>>>41-32|ie<<32-(41-32)),V+=I&65535,B+=I>>>16,k+=v&65535,G+=v>>>16,v=le&fe^~le&pe,I=ie&ue^~ie&Te,V+=I&65535,B+=I>>>16,k+=v&65535,G+=v>>>16,v=o[Ye*2],I=o[Ye*2+1],V+=I&65535,B+=I>>>16,k+=v&65535,G+=v>>>16,v=g[Ye%16],I=_[Ye%16],V+=I&65535,B+=I>>>16,k+=v&65535,G+=v>>>16,B+=V>>>16,k+=B>>>16,G+=k>>>16,X=k&65535|G<<16,ce=V&65535|B<<16,v=X,I=ce,V=I&65535,B=I>>>16,k=v&65535,G=v>>>16,v=(R>>>28|F<<32-28)^(F>>>34-32|R<<32-(34-32))^(F>>>39-32|R<<32-(39-32)),I=(F>>>28|R<<32-28)^(R>>>34-32|F<<32-(34-32))^(R>>>39-32|F<<32-(39-32)),V+=I&65535,B+=I>>>16,k+=v&65535,G+=v>>>16,v=R&K^R&re^K&re,I=F&q^F&W^q&W,V+=I&65535,B+=I>>>16,k+=v&65535,G+=v>>>16,B+=V>>>16,k+=B>>>16,G+=k>>>16,E=k&65535|G<<16,wt=V&65535|B<<16,v=D,I=Ne,V=I&65535,B=I>>>16,k=v&65535,G=v>>>16,v=X,I=ce,V+=I&65535,B+=I>>>16,k+=v&65535,G+=v>>>16,B+=V>>>16,k+=B>>>16,G+=k>>>16,D=k&65535|G<<16,Ne=V&65535|B<<16,K=zr,re=Ie,he=St,le=D,fe=N,pe=C,de=u,R=E,q=ee,W=ge,ve=be,ie=Ne,ue=Le,Te=Pe,Ue=Pt,F=wt,Ye%16===15)for(var ke=0;ke<16;ke++)v=g[ke],I=_[ke],V=I&65535,B=I>>>16,k=v&65535,G=v>>>16,v=g[(ke+9)%16],I=_[(ke+9)%16],V+=I&65535,B+=I>>>16,k+=v&65535,G+=v>>>16,X=g[(ke+1)%16],ce=_[(ke+1)%16],v=(X>>>1|ce<<32-1)^(X>>>8|ce<<32-8)^X>>>7,I=(ce>>>1|X<<32-1)^(ce>>>8|X<<32-8)^(ce>>>7|X<<32-7),V+=I&65535,B+=I>>>16,k+=v&65535,G+=v>>>16,X=g[(ke+14)%16],ce=_[(ke+14)%16],v=(X>>>19|ce<<32-19)^(ce>>>61-32|X<<32-(61-32))^X>>>6,I=(ce>>>19|X<<32-19)^(X>>>61-32|ce<<32-(61-32))^(ce>>>6|X<<32-6),V+=I&65535,B+=I>>>16,k+=v&65535,G+=v>>>16,B+=V>>>16,k+=B>>>16,G+=k>>>16,g[ke]=k&65535|G<<16,_[ke]=V&65535|B<<16}v=R,I=F,V=I&65535,B=I>>>16,k=v&65535,G=v>>>16,v=m[0],I=x[0],V+=I&65535,B+=I>>>16,k+=v&65535,G+=v>>>16,B+=V>>>16,k+=B>>>16,G+=k>>>16,m[0]=R=k&65535|G<<16,x[0]=F=V&65535|B<<16,v=K,I=q,V=I&65535,B=I>>>16,k=v&65535,G=v>>>16,v=m[1],I=x[1],V+=I&65535,B+=I>>>16,k+=v&65535,G+=v>>>16,B+=V>>>16,k+=B>>>16,G+=k>>>16,m[1]=K=k&65535|G<<16,x[1]=q=V&65535|B<<16,v=re,I=W,V=I&65535,B=I>>>16,k=v&65535,G=v>>>16,v=m[2],I=x[2],V+=I&65535,B+=I>>>16,k+=v&65535,G+=v>>>16,B+=V>>>16,k+=B>>>16,G+=k>>>16,m[2]=re=k&65535|G<<16,x[2]=W=V&65535|B<<16,v=he,I=ve,V=I&65535,B=I>>>16,k=v&65535,G=v>>>16,v=m[3],I=x[3],V+=I&65535,B+=I>>>16,k+=v&65535,G+=v>>>16,B+=V>>>16,k+=B>>>16,G+=k>>>16,m[3]=he=k&65535|G<<16,x[3]=ve=V&65535|B<<16,v=le,I=ie,V=I&65535,B=I>>>16,k=v&65535,G=v>>>16,v=m[4],I=x[4],V+=I&65535,B+=I>>>16,k+=v&65535,G+=v>>>16,B+=V>>>16,k+=B>>>16,G+=k>>>16,m[4]=le=k&65535|G<<16,x[4]=ie=V&65535|B<<16,v=fe,I=ue,V=I&65535,B=I>>>16,k=v&65535,G=v>>>16,v=m[5],I=x[5],V+=I&65535,B+=I>>>16,k+=v&65535,G+=v>>>16,B+=V>>>16,k+=B>>>16,G+=k>>>16,m[5]=fe=k&65535|G<<16,x[5]=ue=V&65535|B<<16,v=pe,I=Te,V=I&65535,B=I>>>16,k=v&65535,G=v>>>16,v=m[6],I=x[6],V+=I&65535,B+=I>>>16,k+=v&65535,G+=v>>>16,B+=V>>>16,k+=B>>>16,G+=k>>>16,m[6]=pe=k&65535|G<<16,x[6]=Te=V&65535|B<<16,v=de,I=Ue,V=I&65535,B=I>>>16,k=v&65535,G=v>>>16,v=m[7],I=x[7],V+=I&65535,B+=I>>>16,k+=v&65535,G+=v>>>16,B+=V>>>16,k+=B>>>16,G+=k>>>16,m[7]=de=k&65535|G<<16,x[7]=Ue=V&65535|B<<16,L+=128,z-=128}return L}function p(g){var _=new s;_.update(g);var m=_.digest();return _.clean(),m}a.hash=p})(uf);(function(a){Object.defineProperty(a,"__esModule",{value:!0}),a.convertSecretKeyToX25519=a.convertPublicKeyToX25519=a.verify=a.sign=a.extractPublicKeyFromSecretKey=a.generateKeyPair=a.generateKeyPairFromSeed=a.SEED_LENGTH=a.SECRET_KEY_LENGTH=a.PUBLIC_KEY_LENGTH=a.SIGNATURE_LENGTH=void 0;const t=Bl,i=uf,s=ql;a.SIGNATURE_LENGTH=64,a.PUBLIC_KEY_LENGTH=32,a.SECRET_KEY_LENGTH=64,a.SEED_LENGTH=32;function o(D){const N=new Float64Array(16);if(D)for(let C=0;C<D.length;C++)N[C]=D[C];return N}const h=new Uint8Array(32);h[0]=9;const p=o(),g=o([1]),_=o([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),m=o([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),x=o([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),O=o([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),L=o([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function z(D,N){for(let C=0;C<16;C++)D[C]=N[C]|0}function R(D){let N=1;for(let C=0;C<16;C++){let u=D[C]+N+65535;N=Math.floor(u/65536),D[C]=u-N*65536}D[0]+=N-1+37*(N-1)}function K(D,N,C){const u=~(C-1);for(let E=0;E<16;E++){const ee=u&(D[E]^N[E]);D[E]^=ee,N[E]^=ee}}function re(D,N){const C=o(),u=o();for(let E=0;E<16;E++)u[E]=N[E];R(u),R(u),R(u);for(let E=0;E<2;E++){C[0]=u[0]-65517;for(let ge=1;ge<15;ge++)C[ge]=u[ge]-65535-(C[ge-1]>>16&1),C[ge-1]&=65535;C[15]=u[15]-32767-(C[14]>>16&1);const ee=C[15]>>16&1;C[14]&=65535,K(u,C,1-ee)}for(let E=0;E<16;E++)D[2*E]=u[E]&255,D[2*E+1]=u[E]>>8}function he(D,N){let C=0;for(let u=0;u<32;u++)C|=D[u]^N[u];return(1&C-1>>>8)-1}function le(D,N){const C=new Uint8Array(32),u=new Uint8Array(32);return re(C,D),re(u,N),he(C,u)}function fe(D){const N=new Uint8Array(32);return re(N,D),N[0]&1}function pe(D,N){for(let C=0;C<16;C++)D[C]=N[2*C]+(N[2*C+1]<<8);D[15]&=32767}function de(D,N,C){for(let u=0;u<16;u++)D[u]=N[u]+C[u]}function F(D,N,C){for(let u=0;u<16;u++)D[u]=N[u]-C[u]}function q(D,N,C){let u,E,ee=0,ge=0,be=0,Ne=0,Le=0,Pe=0,Pt=0,wt=0,ot=0,$e=0,Ze=0,Qe=0,at=0,qe=0,et=0,De=0,Ke=0,ht=0,je=0,At=0,$t=0,Ht=0,kt=0,zt=0,Jt=0,ir=0,Ur=0,Yt=0,Wr=0,ui=0,Si=0,lt=C[0],it=C[1],ft=C[2],pt=C[3],ct=C[4],nt=C[5],Ct=C[6],Ot=C[7],dt=C[8],Rt=C[9],gt=C[10],_t=C[11],yt=C[12],Xe=C[13],Tt=C[14],Nt=C[15];u=N[0],ee+=u*lt,ge+=u*it,be+=u*ft,Ne+=u*pt,Le+=u*ct,Pe+=u*nt,Pt+=u*Ct,wt+=u*Ot,ot+=u*dt,$e+=u*Rt,Ze+=u*gt,Qe+=u*_t,at+=u*yt,qe+=u*Xe,et+=u*Tt,De+=u*Nt,u=N[1],ge+=u*lt,be+=u*it,Ne+=u*ft,Le+=u*pt,Pe+=u*ct,Pt+=u*nt,wt+=u*Ct,ot+=u*Ot,$e+=u*dt,Ze+=u*Rt,Qe+=u*gt,at+=u*_t,qe+=u*yt,et+=u*Xe,De+=u*Tt,Ke+=u*Nt,u=N[2],be+=u*lt,Ne+=u*it,Le+=u*ft,Pe+=u*pt,Pt+=u*ct,wt+=u*nt,ot+=u*Ct,$e+=u*Ot,Ze+=u*dt,Qe+=u*Rt,at+=u*gt,qe+=u*_t,et+=u*yt,De+=u*Xe,Ke+=u*Tt,ht+=u*Nt,u=N[3],Ne+=u*lt,Le+=u*it,Pe+=u*ft,Pt+=u*pt,wt+=u*ct,ot+=u*nt,$e+=u*Ct,Ze+=u*Ot,Qe+=u*dt,at+=u*Rt,qe+=u*gt,et+=u*_t,De+=u*yt,Ke+=u*Xe,ht+=u*Tt,je+=u*Nt,u=N[4],Le+=u*lt,Pe+=u*it,Pt+=u*ft,wt+=u*pt,ot+=u*ct,$e+=u*nt,Ze+=u*Ct,Qe+=u*Ot,at+=u*dt,qe+=u*Rt,et+=u*gt,De+=u*_t,Ke+=u*yt,ht+=u*Xe,je+=u*Tt,At+=u*Nt,u=N[5],Pe+=u*lt,Pt+=u*it,wt+=u*ft,ot+=u*pt,$e+=u*ct,Ze+=u*nt,Qe+=u*Ct,at+=u*Ot,qe+=u*dt,et+=u*Rt,De+=u*gt,Ke+=u*_t,ht+=u*yt,je+=u*Xe,At+=u*Tt,$t+=u*Nt,u=N[6],Pt+=u*lt,wt+=u*it,ot+=u*ft,$e+=u*pt,Ze+=u*ct,Qe+=u*nt,at+=u*Ct,qe+=u*Ot,et+=u*dt,De+=u*Rt,Ke+=u*gt,ht+=u*_t,je+=u*yt,At+=u*Xe,$t+=u*Tt,Ht+=u*Nt,u=N[7],wt+=u*lt,ot+=u*it,$e+=u*ft,Ze+=u*pt,Qe+=u*ct,at+=u*nt,qe+=u*Ct,et+=u*Ot,De+=u*dt,Ke+=u*Rt,ht+=u*gt,je+=u*_t,At+=u*yt,$t+=u*Xe,Ht+=u*Tt,kt+=u*Nt,u=N[8],ot+=u*lt,$e+=u*it,Ze+=u*ft,Qe+=u*pt,at+=u*ct,qe+=u*nt,et+=u*Ct,De+=u*Ot,Ke+=u*dt,ht+=u*Rt,je+=u*gt,At+=u*_t,$t+=u*yt,Ht+=u*Xe,kt+=u*Tt,zt+=u*Nt,u=N[9],$e+=u*lt,Ze+=u*it,Qe+=u*ft,at+=u*pt,qe+=u*ct,et+=u*nt,De+=u*Ct,Ke+=u*Ot,ht+=u*dt,je+=u*Rt,At+=u*gt,$t+=u*_t,Ht+=u*yt,kt+=u*Xe,zt+=u*Tt,Jt+=u*Nt,u=N[10],Ze+=u*lt,Qe+=u*it,at+=u*ft,qe+=u*pt,et+=u*ct,De+=u*nt,Ke+=u*Ct,ht+=u*Ot,je+=u*dt,At+=u*Rt,$t+=u*gt,Ht+=u*_t,kt+=u*yt,zt+=u*Xe,Jt+=u*Tt,ir+=u*Nt,u=N[11],Qe+=u*lt,at+=u*it,qe+=u*ft,et+=u*pt,De+=u*ct,Ke+=u*nt,ht+=u*Ct,je+=u*Ot,At+=u*dt,$t+=u*Rt,Ht+=u*gt,kt+=u*_t,zt+=u*yt,Jt+=u*Xe,ir+=u*Tt,Ur+=u*Nt,u=N[12],at+=u*lt,qe+=u*it,et+=u*ft,De+=u*pt,Ke+=u*ct,ht+=u*nt,je+=u*Ct,At+=u*Ot,$t+=u*dt,Ht+=u*Rt,kt+=u*gt,zt+=u*_t,Jt+=u*yt,ir+=u*Xe,Ur+=u*Tt,Yt+=u*Nt,u=N[13],qe+=u*lt,et+=u*it,De+=u*ft,Ke+=u*pt,ht+=u*ct,je+=u*nt,At+=u*Ct,$t+=u*Ot,Ht+=u*dt,kt+=u*Rt,zt+=u*gt,Jt+=u*_t,ir+=u*yt,Ur+=u*Xe,Yt+=u*Tt,Wr+=u*Nt,u=N[14],et+=u*lt,De+=u*it,Ke+=u*ft,ht+=u*pt,je+=u*ct,At+=u*nt,$t+=u*Ct,Ht+=u*Ot,kt+=u*dt,zt+=u*Rt,Jt+=u*gt,ir+=u*_t,Ur+=u*yt,Yt+=u*Xe,Wr+=u*Tt,ui+=u*Nt,u=N[15],De+=u*lt,Ke+=u*it,ht+=u*ft,je+=u*pt,At+=u*ct,$t+=u*nt,Ht+=u*Ct,kt+=u*Ot,zt+=u*dt,Jt+=u*Rt,ir+=u*gt,Ur+=u*_t,Yt+=u*yt,Wr+=u*Xe,ui+=u*Tt,Si+=u*Nt,ee+=38*Ke,ge+=38*ht,be+=38*je,Ne+=38*At,Le+=38*$t,Pe+=38*Ht,Pt+=38*kt,wt+=38*zt,ot+=38*Jt,$e+=38*ir,Ze+=38*Ur,Qe+=38*Yt,at+=38*Wr,qe+=38*ui,et+=38*Si,E=1,u=ee+E+65535,E=Math.floor(u/65536),ee=u-E*65536,u=ge+E+65535,E=Math.floor(u/65536),ge=u-E*65536,u=be+E+65535,E=Math.floor(u/65536),be=u-E*65536,u=Ne+E+65535,E=Math.floor(u/65536),Ne=u-E*65536,u=Le+E+65535,E=Math.floor(u/65536),Le=u-E*65536,u=Pe+E+65535,E=Math.floor(u/65536),Pe=u-E*65536,u=Pt+E+65535,E=Math.floor(u/65536),Pt=u-E*65536,u=wt+E+65535,E=Math.floor(u/65536),wt=u-E*65536,u=ot+E+65535,E=Math.floor(u/65536),ot=u-E*65536,u=$e+E+65535,E=Math.floor(u/65536),$e=u-E*65536,u=Ze+E+65535,E=Math.floor(u/65536),Ze=u-E*65536,u=Qe+E+65535,E=Math.floor(u/65536),Qe=u-E*65536,u=at+E+65535,E=Math.floor(u/65536),at=u-E*65536,u=qe+E+65535,E=Math.floor(u/65536),qe=u-E*65536,u=et+E+65535,E=Math.floor(u/65536),et=u-E*65536,u=De+E+65535,E=Math.floor(u/65536),De=u-E*65536,ee+=E-1+37*(E-1),E=1,u=ee+E+65535,E=Math.floor(u/65536),ee=u-E*65536,u=ge+E+65535,E=Math.floor(u/65536),ge=u-E*65536,u=be+E+65535,E=Math.floor(u/65536),be=u-E*65536,u=Ne+E+65535,E=Math.floor(u/65536),Ne=u-E*65536,u=Le+E+65535,E=Math.floor(u/65536),Le=u-E*65536,u=Pe+E+65535,E=Math.floor(u/65536),Pe=u-E*65536,u=Pt+E+65535,E=Math.floor(u/65536),Pt=u-E*65536,u=wt+E+65535,E=Math.floor(u/65536),wt=u-E*65536,u=ot+E+65535,E=Math.floor(u/65536),ot=u-E*65536,u=$e+E+65535,E=Math.floor(u/65536),$e=u-E*65536,u=Ze+E+65535,E=Math.floor(u/65536),Ze=u-E*65536,u=Qe+E+65535,E=Math.floor(u/65536),Qe=u-E*65536,u=at+E+65535,E=Math.floor(u/65536),at=u-E*65536,u=qe+E+65535,E=Math.floor(u/65536),qe=u-E*65536,u=et+E+65535,E=Math.floor(u/65536),et=u-E*65536,u=De+E+65535,E=Math.floor(u/65536),De=u-E*65536,ee+=E-1+37*(E-1),D[0]=ee,D[1]=ge,D[2]=be,D[3]=Ne,D[4]=Le,D[5]=Pe,D[6]=Pt,D[7]=wt,D[8]=ot,D[9]=$e,D[10]=Ze,D[11]=Qe,D[12]=at,D[13]=qe,D[14]=et,D[15]=De}function W(D,N){q(D,N,N)}function ve(D,N){const C=o();let u;for(u=0;u<16;u++)C[u]=N[u];for(u=253;u>=0;u--)W(C,C),u!==2&&u!==4&&q(C,C,N);for(u=0;u<16;u++)D[u]=C[u]}function ie(D,N){const C=o();let u;for(u=0;u<16;u++)C[u]=N[u];for(u=250;u>=0;u--)W(C,C),u!==1&&q(C,C,N);for(u=0;u<16;u++)D[u]=C[u]}function ue(D,N){const C=o(),u=o(),E=o(),ee=o(),ge=o(),be=o(),Ne=o(),Le=o(),Pe=o();F(C,D[1],D[0]),F(Pe,N[1],N[0]),q(C,C,Pe),de(u,D[0],D[1]),de(Pe,N[0],N[1]),q(u,u,Pe),q(E,D[3],N[3]),q(E,E,m),q(ee,D[2],N[2]),de(ee,ee,ee),F(ge,u,C),F(be,ee,E),de(Ne,ee,E),de(Le,u,C),q(D[0],ge,be),q(D[1],Le,Ne),q(D[2],Ne,be),q(D[3],ge,Le)}function Te(D,N,C){for(let u=0;u<4;u++)K(D[u],N[u],C)}function Ue(D,N){const C=o(),u=o(),E=o();ve(E,N[2]),q(C,N[0],E),q(u,N[1],E),re(D,u),D[31]^=fe(C)<<7}function v(D,N,C){z(D[0],p),z(D[1],g),z(D[2],g),z(D[3],p);for(let u=255;u>=0;--u){const E=C[u/8|0]>>(u&7)&1;Te(D,N,E),ue(N,D),ue(D,D),Te(D,N,E)}}function I(D,N){const C=[o(),o(),o(),o()];z(C[0],x),z(C[1],O),z(C[2],g),q(C[3],x,O),v(D,C,N)}function X(D){if(D.length!==a.SEED_LENGTH)throw new Error(`ed25519: seed must be ${a.SEED_LENGTH} bytes`);const N=(0,i.hash)(D);N[0]&=248,N[31]&=127,N[31]|=64;const C=new Uint8Array(32),u=[o(),o(),o(),o()];I(u,N),Ue(C,u);const E=new Uint8Array(64);return E.set(D),E.set(C,32),{publicKey:C,secretKey:E}}a.generateKeyPairFromSeed=X;function ce(D){const N=(0,t.randomBytes)(32,D),C=X(N);return(0,s.wipe)(N),C}a.generateKeyPair=ce;function V(D){if(D.length!==a.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${a.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(D.subarray(32))}a.extractPublicKeyFromSecretKey=V;const B=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function k(D,N){let C,u,E,ee;for(u=63;u>=32;--u){for(C=0,E=u-32,ee=u-12;E<ee;++E)N[E]+=C-16*N[u]*B[E-(u-32)],C=Math.floor((N[E]+128)/256),N[E]-=C*256;N[E]+=C,N[u]=0}for(C=0,E=0;E<32;E++)N[E]+=C-(N[31]>>4)*B[E],C=N[E]>>8,N[E]&=255;for(E=0;E<32;E++)N[E]-=C*B[E];for(u=0;u<32;u++)N[u+1]+=N[u]>>8,D[u]=N[u]&255}function G(D){const N=new Float64Array(64);for(let C=0;C<64;C++)N[C]=D[C];for(let C=0;C<64;C++)D[C]=0;k(D,N)}function Ye(D,N){const C=new Float64Array(64),u=[o(),o(),o(),o()],E=(0,i.hash)(D.subarray(0,32));E[0]&=248,E[31]&=127,E[31]|=64;const ee=new Uint8Array(64);ee.set(E.subarray(32),32);const ge=new i.SHA512;ge.update(ee.subarray(32)),ge.update(N);const be=ge.digest();ge.clean(),G(be),I(u,be),Ue(ee,u),ge.reset(),ge.update(ee.subarray(0,32)),ge.update(D.subarray(32)),ge.update(N);const Ne=ge.digest();G(Ne);for(let Le=0;Le<32;Le++)C[Le]=be[Le];for(let Le=0;Le<32;Le++)for(let Pe=0;Pe<32;Pe++)C[Le+Pe]+=Ne[Le]*E[Pe];return k(ee.subarray(32),C),ee}a.sign=Ye;function ke(D,N){const C=o(),u=o(),E=o(),ee=o(),ge=o(),be=o(),Ne=o();return z(D[2],g),pe(D[1],N),W(E,D[1]),q(ee,E,_),F(E,E,D[2]),de(ee,D[2],ee),W(ge,ee),W(be,ge),q(Ne,be,ge),q(C,Ne,E),q(C,C,ee),ie(C,C),q(C,C,E),q(C,C,ee),q(C,C,ee),q(D[0],C,ee),W(u,D[0]),q(u,u,ee),le(u,E)&&q(D[0],D[0],L),W(u,D[0]),q(u,u,ee),le(u,E)?-1:(fe(D[0])===N[31]>>7&&F(D[0],p,D[0]),q(D[3],D[0],D[1]),0)}function zr(D,N,C){const u=new Uint8Array(32),E=[o(),o(),o(),o()],ee=[o(),o(),o(),o()];if(C.length!==a.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${a.SIGNATURE_LENGTH} bytes`);if(ke(ee,D))return!1;const ge=new i.SHA512;ge.update(C.subarray(0,32)),ge.update(D),ge.update(N);const be=ge.digest();return G(be),v(E,ee,be),I(ee,C.subarray(32)),ue(E,ee),Ue(u,E),!he(C,u)}a.verify=zr;function Ie(D){let N=[o(),o(),o(),o()];if(ke(N,D))throw new Error("Ed25519: invalid public key");let C=o(),u=o(),E=N[1];de(C,g,E),F(u,g,E),ve(u,u),q(C,C,u);let ee=new Uint8Array(32);return re(ee,C),ee}a.convertPublicKeyToX25519=Ie;function St(D){const N=(0,i.hash)(D.subarray(0,32));N[0]&=248,N[31]&=127,N[31]|=64;const C=new Uint8Array(N.subarray(0,32));return(0,s.wipe)(N),C}a.convertSecretKeyToX25519=St})(xc);const aw="EdDSA",cw="JWT",hf=".",lf="base64url",uw="utf8",hw="utf8",lw=":",fw="did",pw="key",Zh="base58btc",dw="z",gw="K36",yw=32;function fo(a){return yo(bc(qi(a),uw),lf)}function ff(a){const t=bc(gw,Zh),i=dw+yo(_m([t,a]),Zh);return[fw,pw,i].join(lw)}function vw(a){return yo(a,lf)}function mw(a){return bc([fo(a.header),fo(a.payload)].join(hf),hw)}function ww(a){return[fo(a.header),fo(a.payload),vw(a.signature)].join(hf)}function Qh(a=Bl.randomBytes(yw)){return xc.generateKeyPairFromSeed(a)}async function _w(a,t,i,s,o=se.fromMiliseconds(Date.now())){const h={alg:aw,typ:cw},p=ff(s.publicKey),g=o+i,_={iss:p,sub:a,aud:t,iat:o,exp:g},m=mw({header:h,payload:_}),x=xc.sign(s.secretKey,m);return ww({header:h,payload:_,signature:x})}const bw="PARSE_ERROR",Ew="INVALID_REQUEST",Iw="METHOD_NOT_FOUND",xw="INVALID_PARAMS",pf="INTERNAL_ERROR",Sc="SERVER_ERROR",Sw=[-32700,-32600,-32601,-32602,-32603],Vn={[bw]:{code:-32700,message:"Parse error"},[Ew]:{code:-32600,message:"Invalid Request"},[Iw]:{code:-32601,message:"Method not found"},[xw]:{code:-32602,message:"Invalid params"},[pf]:{code:-32603,message:"Internal error"},[Sc]:{code:-32e3,message:"Server error"}},df=Sc;function Pw(a){return Sw.includes(a)}function el(a){return Object.keys(Vn).includes(a)?Vn[a]:Vn[df]}function Aw(a){const t=Object.values(Vn).find(i=>i.code===a);return t||Vn[df]}function gf(a,t,i){return a.message.includes("getaddrinfo ENOTFOUND")||a.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${i} RPC url at ${t}`):a}var yf={},oi={},tl;function Cw(){if(tl)return oi;tl=1,Object.defineProperty(oi,"__esModule",{value:!0}),oi.isBrowserCryptoAvailable=oi.getSubtleCrypto=oi.getBrowerCrypto=void 0;function a(){return(jr===null||jr===void 0?void 0:jr.crypto)||(jr===null||jr===void 0?void 0:jr.msCrypto)||{}}oi.getBrowerCrypto=a;function t(){const s=a();return s.subtle||s.webkitSubtle}oi.getSubtleCrypto=t;function i(){return!!a()&&!!t()}return oi.isBrowserCryptoAvailable=i,oi}var ai={},rl;function Ow(){if(rl)return ai;rl=1,Object.defineProperty(ai,"__esModule",{value:!0}),ai.isBrowser=ai.isNode=ai.isReactNative=void 0;function a(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}ai.isReactNative=a;function t(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}ai.isNode=t;function i(){return!a()&&!t()}return ai.isBrowser=i,ai}(function(a){Object.defineProperty(a,"__esModule",{value:!0});const t=vn;t.__exportStar(Cw(),a),t.__exportStar(Ow(),a)})(yf);function vf(a=3){const t=Date.now()*Math.pow(10,a),i=Math.floor(Math.random()*Math.pow(10,a));return t+i}function Pc(a=6){return BigInt(vf(a))}function mo(a,t,i){return{id:i||vf(),jsonrpc:"2.0",method:a,params:t}}function Ac(a,t){return{id:a,jsonrpc:"2.0",result:t}}function wo(a,t,i){return{id:a,jsonrpc:"2.0",error:Rw(t,i)}}function Rw(a,t){return typeof a>"u"?el(pf):(typeof a=="string"&&(a=Object.assign(Object.assign({},el(Sc)),{message:a})),typeof t<"u"&&(a.data=t),Pw(a.code)&&(a=Aw(a.code)),a)}class Tw{}class Nw extends Tw{constructor(){super()}}class Dw extends Nw{constructor(t){super()}}const Lw="^https?:",Fw="^wss?:";function $w(a){const t=a.match(new RegExp(/^\w+:/,"gi"));if(!(!t||!t.length))return t[0]}function mf(a,t){const i=$w(a);return typeof i>"u"?!1:new RegExp(t).test(i)}function il(a){return mf(a,Lw)}function nl(a){return mf(a,Fw)}function Mw(a){return new RegExp("wss?://localhost(:d{2,5})?").test(a)}function wf(a){return typeof a=="object"&&"id"in a&&"jsonrpc"in a&&a.jsonrpc==="2.0"}function Cc(a){return wf(a)&&"method"in a}function _o(a){return wf(a)&&(ci(a)||Mr(a))}function ci(a){return"result"in a}function Mr(a){return"error"in a}class Ii extends Dw{constructor(t){super(t),this.events=new vr.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(t),this.connection.connected&&this.registerEventListeners()}async connect(t=this.connection){await this.open(t)}async disconnect(){await this.close()}on(t,i){this.events.on(t,i)}once(t,i){this.events.once(t,i)}off(t,i){this.events.off(t,i)}removeListener(t,i){this.events.removeListener(t,i)}async request(t,i){return this.requestStrict(mo(t.method,t.params||[],t.id||Pc().toString()),i)}async requestStrict(t,i){return new Promise(async(s,o)=>{if(!this.connection.connected)try{await this.open()}catch(h){o(h)}this.events.on(`${t.id}`,h=>{Mr(h)?o(h.error):s(h.result)});try{await this.connection.send(t,i)}catch(h){o(h)}})}setConnection(t=this.connection){return t}onPayload(t){this.events.emit("payload",t),_o(t)?this.events.emit(`${t.id}`,t):this.events.emit("message",{type:t.method,data:t.params})}onClose(t){t&&t.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${t.code} ${t.reason?`(${t.reason})`:""}`)),this.events.emit("disconnect")}async open(t=this.connection){this.connection===t&&this.connection.connected||(this.connection.connected&&this.close(),typeof t=="string"&&(await this.connection.open(t),t=this.connection),this.connection=this.setConnection(t),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",t=>this.onPayload(t)),this.connection.on("close",t=>this.onClose(t)),this.connection.on("error",t=>this.events.emit("error",t)),this.connection.on("register_error",t=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const jw=()=>typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:require("ws"),zw=()=>typeof window<"u",sl=a=>a.split("?")[0],ol=10,Uw=jw();class qw{constructor(t){if(this.url=t,this.events=new vr.EventEmitter,this.registering=!1,!nl(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);this.url=t}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(t,i){this.events.on(t,i)}once(t,i){this.events.once(t,i)}off(t,i){this.events.off(t,i)}removeListener(t,i){this.events.removeListener(t,i)}async open(t=this.url){await this.register(t)}async close(){return new Promise((t,i)=>{if(typeof this.socket>"u"){i(new Error("Connection already closed"));return}this.socket.onclose=s=>{this.onClose(s),t()},this.socket.close()})}async send(t,i){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(qi(t))}catch(s){this.onError(t.id,s)}}register(t=this.url){if(!nl(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);if(this.registering){const i=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=i||this.events.listenerCount("open")>=i)&&this.events.setMaxListeners(i+1),new Promise((s,o)=>{this.events.once("register_error",h=>{this.resetMaxListeners(),o(h)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return o(new Error("WebSocket connection is missing or invalid"));s(this.socket)})})}return this.url=t,this.registering=!0,new Promise((i,s)=>{const o=yf.isReactNative()?void 0:{rejectUnauthorized:!Mw(t)},h=new Uw(t,[],o);zw()?h.onerror=p=>{const g=p;s(this.emitError(g.error))}:h.on("error",p=>{s(this.emitError(p))}),h.onopen=()=>{this.onOpen(h),i(h)}})}onOpen(t){t.onmessage=i=>this.onPayload(i),t.onclose=i=>this.onClose(i),this.socket=t,this.registering=!1,this.events.emit("open")}onClose(t){this.socket=void 0,this.registering=!1,this.events.emit("close",t)}onPayload(t){if(typeof t.data>"u")return;const i=typeof t.data=="string"?Wn(t.data):t.data;this.events.emit("payload",i)}onError(t,i){const s=this.parseError(i),o=s.message||s.toString(),h=wo(t,o);this.events.emit("payload",h)}parseError(t,i=this.url){return gf(t,sl(i),"WS")}resetMaxListeners(){this.events.getMaxListeners()>ol&&this.events.setMaxListeners(ol)}emitError(t){const i=this.parseError(new Error((t==null?void 0:t.message)||`WebSocket connection failed for host: ${sl(this.url)}`));return this.events.emit("register_error",i),i}}var po={exports:{}};po.exports;(function(a,t){var i=200,s="__lodash_hash_undefined__",o=1,h=2,p=9007199254740991,g="[object Arguments]",_="[object Array]",m="[object AsyncFunction]",x="[object Boolean]",O="[object Date]",L="[object Error]",z="[object Function]",R="[object GeneratorFunction]",K="[object Map]",re="[object Number]",he="[object Null]",le="[object Object]",fe="[object Promise]",pe="[object Proxy]",de="[object RegExp]",F="[object Set]",q="[object String]",W="[object Symbol]",ve="[object Undefined]",ie="[object WeakMap]",ue="[object ArrayBuffer]",Te="[object DataView]",Ue="[object Float32Array]",v="[object Float64Array]",I="[object Int8Array]",X="[object Int16Array]",ce="[object Int32Array]",V="[object Uint8Array]",B="[object Uint8ClampedArray]",k="[object Uint16Array]",G="[object Uint32Array]",Ye=/[\\^$.*+?()[\]{}|]/g,ke=/^\[object .+?Constructor\]$/,zr=/^(?:0|[1-9]\d*)$/,Ie={};Ie[Ue]=Ie[v]=Ie[I]=Ie[X]=Ie[ce]=Ie[V]=Ie[B]=Ie[k]=Ie[G]=!0,Ie[g]=Ie[_]=Ie[ue]=Ie[x]=Ie[Te]=Ie[O]=Ie[L]=Ie[z]=Ie[K]=Ie[re]=Ie[le]=Ie[de]=Ie[F]=Ie[q]=Ie[ie]=!1;var St=typeof jr=="object"&&jr&&jr.Object===Object&&jr,D=typeof self=="object"&&self&&self.Object===Object&&self,N=St||D||Function("return this")(),C=t&&!t.nodeType&&t,u=C&&!0&&a&&!a.nodeType&&a,E=u&&u.exports===C,ee=E&&St.process,ge=function(){try{return ee&&ee.binding&&ee.binding("util")}catch{}}(),be=ge&&ge.isTypedArray;function Ne(y,S){for(var U=-1,Y=y==null?0:y.length,Ge=0,me=[];++U<Y;){var tt=y[U];S(tt,U,y)&&(me[Ge++]=tt)}return me}function Le(y,S){for(var U=-1,Y=S.length,Ge=y.length;++U<Y;)y[Ge+U]=S[U];return y}function Pe(y,S){for(var U=-1,Y=y==null?0:y.length;++U<Y;)if(S(y[U],U,y))return!0;return!1}function Pt(y,S){for(var U=-1,Y=Array(y);++U<y;)Y[U]=S(U);return Y}function wt(y){return function(S){return y(S)}}function ot(y,S){return y.has(S)}function $e(y,S){return y==null?void 0:y[S]}function Ze(y){var S=-1,U=Array(y.size);return y.forEach(function(Y,Ge){U[++S]=[Ge,Y]}),U}function Qe(y,S){return function(U){return y(S(U))}}function at(y){var S=-1,U=Array(y.size);return y.forEach(function(Y){U[++S]=Y}),U}var qe=Array.prototype,et=Function.prototype,De=Object.prototype,Ke=N["__core-js_shared__"],ht=et.toString,je=De.hasOwnProperty,At=function(){var y=/[^.]+$/.exec(Ke&&Ke.keys&&Ke.keys.IE_PROTO||"");return y?"Symbol(src)_1."+y:""}(),$t=De.toString,Ht=RegExp("^"+ht.call(je).replace(Ye,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),kt=E?N.Buffer:void 0,zt=N.Symbol,Jt=N.Uint8Array,ir=De.propertyIsEnumerable,Ur=qe.splice,Yt=zt?zt.toStringTag:void 0,Wr=Object.getOwnPropertySymbols,ui=kt?kt.isBuffer:void 0,Si=Qe(Object.keys,Object),lt=lr(N,"DataView"),it=lr(N,"Map"),ft=lr(N,"Promise"),pt=lr(N,"Set"),ct=lr(N,"WeakMap"),nt=lr(Object,"create"),Ct=Yr(lt),Ot=Yr(it),dt=Yr(ft),Rt=Yr(pt),gt=Yr(ct),_t=zt?zt.prototype:void 0,yt=_t?_t.valueOf:void 0;function Xe(y){var S=-1,U=y==null?0:y.length;for(this.clear();++S<U;){var Y=y[S];this.set(Y[0],Y[1])}}function Tt(){this.__data__=nt?nt(null):{},this.size=0}function Nt(y){var S=this.has(y)&&delete this.__data__[y];return this.size-=S?1:0,S}function Io(y){var S=this.__data__;if(nt){var U=S[y];return U===s?void 0:U}return je.call(S,y)?S[y]:void 0}function xo(y){var S=this.__data__;return nt?S[y]!==void 0:je.call(S,y)}function So(y,S){var U=this.__data__;return this.size+=this.has(y)?0:1,U[y]=nt&&S===void 0?s:S,this}Xe.prototype.clear=Tt,Xe.prototype.delete=Nt,Xe.prototype.get=Io,Xe.prototype.has=xo,Xe.prototype.set=So;function mr(y){var S=-1,U=y==null?0:y.length;for(this.clear();++S<U;){var Y=y[S];this.set(Y[0],Y[1])}}function Po(){this.__data__=[],this.size=0}function Ao(y){var S=this.__data__,U=Pi(S,y);if(U<0)return!1;var Y=S.length-1;return U==Y?S.pop():Ur.call(S,U,1),--this.size,!0}function Co(y){var S=this.__data__,U=Pi(S,y);return U<0?void 0:S[U][1]}function Oo(y){return Pi(this.__data__,y)>-1}function Ro(y,S){var U=this.__data__,Y=Pi(U,y);return Y<0?(++this.size,U.push([y,S])):U[Y][1]=S,this}mr.prototype.clear=Po,mr.prototype.delete=Ao,mr.prototype.get=Co,mr.prototype.has=Oo,mr.prototype.set=Ro;function Jr(y){var S=-1,U=y==null?0:y.length;for(this.clear();++S<U;){var Y=y[S];this.set(Y[0],Y[1])}}function Ki(){this.size=0,this.__data__={hash:new Xe,map:new(it||mr),string:new Xe}}function To(y){var S=hi(this,y).delete(y);return this.size-=S?1:0,S}function Vi(y){return hi(this,y).get(y)}function No(y){return hi(this,y).has(y)}function Do(y,S){var U=hi(this,y),Y=U.size;return U.set(y,S),this.size+=U.size==Y?0:1,this}Jr.prototype.clear=Ki,Jr.prototype.delete=To,Jr.prototype.get=Vi,Jr.prototype.has=No,Jr.prototype.set=Do;function Gi(y){var S=-1,U=y==null?0:y.length;for(this.__data__=new Jr;++S<U;)this.add(y[S])}function Yn(y){return this.__data__.set(y,s),this}function Xn(y){return this.__data__.has(y)}Gi.prototype.add=Gi.prototype.push=Yn,Gi.prototype.has=Xn;function Rr(y){var S=this.__data__=new mr(y);this.size=S.size}function Lo(){this.__data__=new mr,this.size=0}function Fo(y){var S=this.__data__,U=S.delete(y);return this.size=S.size,U}function $o(y){return this.__data__.get(y)}function Mo(y){return this.__data__.has(y)}function Zn(y,S){var U=this.__data__;if(U instanceof mr){var Y=U.__data__;if(!it||Y.length<i-1)return Y.push([y,S]),this.size=++U.size,this;U=this.__data__=new Jr(Y)}return U.set(y,S),this.size=U.size,this}Rr.prototype.clear=Lo,Rr.prototype.delete=Fo,Rr.prototype.get=$o,Rr.prototype.has=Mo,Rr.prototype.set=Zn;function Qn(y,S){var U=Yi(y),Y=!U&&ls(y),Ge=!U&&!Y&&bn(y),me=!U&&!Y&&!Ge&&ds(y),tt=U||Y||Ge||me,Dt=tt?Pt(y.length,String):[],Ce=Dt.length;for(var We in y)(S||je.call(y,We))&&!(tt&&(We=="length"||Ge&&(We=="offset"||We=="parent")||me&&(We=="buffer"||We=="byteLength"||We=="byteOffset")||os(We,Ce)))&&Dt.push(We);return Dt}function Pi(y,S){for(var U=y.length;U--;)if(hs(y[U][0],S))return U;return-1}function wn(y,S,U){var Y=S(y);return Yi(y)?Y:Le(Y,U(y))}function Ai(y){return y==null?y===void 0?ve:he:Yt&&Yt in Object(y)?ns(y):Uo(y)}function _n(y){return Oi(y)&&Ai(y)==g}function Ci(y,S,U,Y,Ge){return y===S?!0:y==null||S==null||!Oi(y)&&!Oi(S)?y!==y&&S!==S:es(y,S,U,Y,Ci,Ge)}function es(y,S,U,Y,Ge,me){var tt=Yi(y),Dt=Yi(S),Ce=tt?_:qr(y),We=Dt?_:qr(S);Ce=Ce==g?le:Ce,We=We==g?le:We;var bt=Ce==le,nr=We==le,Lt=Ce==We;if(Lt&&bn(y)){if(!bn(S))return!1;tt=!0,bt=!1}if(Lt&&!bt)return me||(me=new Rr),tt||ds(y)?Wi(y,S,U,Y,Ge,me):zo(y,S,Ce,U,Y,Ge,me);if(!(U&o)){var rt=bt&&je.call(y,"__wrapped__"),Xt=nr&&je.call(S,"__wrapped__");if(rt||Xt){var Tr=rt?y.value():y,wr=Xt?S.value():S;return me||(me=new Rr),Ge(Tr,wr,U,Y,me)}}return Lt?(me||(me=new Rr),is(y,S,U,Y,Ge,me)):!1}function jo(y){if(!ps(y)||cs(y))return!1;var S=Xi(y)?Ht:ke;return S.test(Yr(y))}function ts(y){return Oi(y)&&fs(y.length)&&!!Ie[Ai(y)]}function rs(y){if(!us(y))return Si(y);var S=[];for(var U in Object(y))je.call(y,U)&&U!="constructor"&&S.push(U);return S}function Wi(y,S,U,Y,Ge,me){var tt=U&o,Dt=y.length,Ce=S.length;if(Dt!=Ce&&!(tt&&Ce>Dt))return!1;var We=me.get(y);if(We&&me.get(S))return We==S;var bt=-1,nr=!0,Lt=U&h?new Gi:void 0;for(me.set(y,S),me.set(S,y);++bt<Dt;){var rt=y[bt],Xt=S[bt];if(Y)var Tr=tt?Y(Xt,rt,bt,S,y,me):Y(rt,Xt,bt,y,S,me);if(Tr!==void 0){if(Tr)continue;nr=!1;break}if(Lt){if(!Pe(S,function(wr,Br){if(!ot(Lt,Br)&&(rt===wr||Ge(rt,wr,U,Y,me)))return Lt.push(Br)})){nr=!1;break}}else if(!(rt===Xt||Ge(rt,Xt,U,Y,me))){nr=!1;break}}return me.delete(y),me.delete(S),nr}function zo(y,S,U,Y,Ge,me,tt){switch(U){case Te:if(y.byteLength!=S.byteLength||y.byteOffset!=S.byteOffset)return!1;y=y.buffer,S=S.buffer;case ue:return!(y.byteLength!=S.byteLength||!me(new Jt(y),new Jt(S)));case x:case O:case re:return hs(+y,+S);case L:return y.name==S.name&&y.message==S.message;case de:case q:return y==S+"";case K:var Dt=Ze;case F:var Ce=Y&o;if(Dt||(Dt=at),y.size!=S.size&&!Ce)return!1;var We=tt.get(y);if(We)return We==S;Y|=h,tt.set(y,S);var bt=Wi(Dt(y),Dt(S),Y,Ge,me,tt);return tt.delete(y),bt;case W:if(yt)return yt.call(y)==yt.call(S)}return!1}function is(y,S,U,Y,Ge,me){var tt=U&o,Dt=Ji(y),Ce=Dt.length,We=Ji(S),bt=We.length;if(Ce!=bt&&!tt)return!1;for(var nr=Ce;nr--;){var Lt=Dt[nr];if(!(tt?Lt in S:je.call(S,Lt)))return!1}var rt=me.get(y);if(rt&&me.get(S))return rt==S;var Xt=!0;me.set(y,S),me.set(S,y);for(var Tr=tt;++nr<Ce;){Lt=Dt[nr];var wr=y[Lt],Br=S[Lt];if(Y)var En=tt?Y(Br,wr,Lt,S,y,me):Y(wr,Br,Lt,y,S,me);if(!(En===void 0?wr===Br||Ge(wr,Br,U,Y,me):En)){Xt=!1;break}Tr||(Tr=Lt=="constructor")}if(Xt&&!Tr){var Ri=y.constructor,Ut=S.constructor;Ri!=Ut&&"constructor"in y&&"constructor"in S&&!(typeof Ri=="function"&&Ri instanceof Ri&&typeof Ut=="function"&&Ut instanceof Ut)&&(Xt=!1)}return me.delete(y),me.delete(S),Xt}function Ji(y){return wn(y,Ho,ss)}function hi(y,S){var U=y.__data__;return as(S)?U[typeof S=="string"?"string":"hash"]:U.map}function lr(y,S){var U=$e(y,S);return jo(U)?U:void 0}function ns(y){var S=je.call(y,Yt),U=y[Yt];try{y[Yt]=void 0;var Y=!0}catch{}var Ge=$t.call(y);return Y&&(S?y[Yt]=U:delete y[Yt]),Ge}var ss=Wr?function(y){return y==null?[]:(y=Object(y),Ne(Wr(y),function(S){return ir.call(y,S)}))}:Ve,qr=Ai;(lt&&qr(new lt(new ArrayBuffer(1)))!=Te||it&&qr(new it)!=K||ft&&qr(ft.resolve())!=fe||pt&&qr(new pt)!=F||ct&&qr(new ct)!=ie)&&(qr=function(y){var S=Ai(y),U=S==le?y.constructor:void 0,Y=U?Yr(U):"";if(Y)switch(Y){case Ct:return Te;case Ot:return K;case dt:return fe;case Rt:return F;case gt:return ie}return S});function os(y,S){return S=S??p,!!S&&(typeof y=="number"||zr.test(y))&&y>-1&&y%1==0&&y<S}function as(y){var S=typeof y;return S=="string"||S=="number"||S=="symbol"||S=="boolean"?y!=="__proto__":y===null}function cs(y){return!!At&&At in y}function us(y){var S=y&&y.constructor,U=typeof S=="function"&&S.prototype||De;return y===U}function Uo(y){return $t.call(y)}function Yr(y){if(y!=null){try{return ht.call(y)}catch{}try{return y+""}catch{}}return""}function hs(y,S){return y===S||y!==y&&S!==S}var ls=_n(function(){return arguments}())?_n:function(y){return Oi(y)&&je.call(y,"callee")&&!ir.call(y,"callee")},Yi=Array.isArray;function qo(y){return y!=null&&fs(y.length)&&!Xi(y)}var bn=ui||Be;function Bo(y,S){return Ci(y,S)}function Xi(y){if(!ps(y))return!1;var S=Ai(y);return S==z||S==R||S==m||S==pe}function fs(y){return typeof y=="number"&&y>-1&&y%1==0&&y<=p}function ps(y){var S=typeof y;return y!=null&&(S=="object"||S=="function")}function Oi(y){return y!=null&&typeof y=="object"}var ds=be?wt(be):ts;function Ho(y){return qo(y)?Qn(y):rs(y)}function Ve(){return[]}function Be(){return!1}a.exports=Bo})(po,po.exports);var Bw=po.exports;const Hw=_c(Bw);function kw(a,t){if(a.length>=255)throw new TypeError("Alphabet too long");for(var i=new Uint8Array(256),s=0;s<i.length;s++)i[s]=255;for(var o=0;o<a.length;o++){var h=a.charAt(o),p=h.charCodeAt(0);if(i[p]!==255)throw new TypeError(h+" is ambiguous");i[p]=o}var g=a.length,_=a.charAt(0),m=Math.log(g)/Math.log(256),x=Math.log(256)/Math.log(g);function O(R){if(R instanceof Uint8Array||(ArrayBuffer.isView(R)?R=new Uint8Array(R.buffer,R.byteOffset,R.byteLength):Array.isArray(R)&&(R=Uint8Array.from(R))),!(R instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(R.length===0)return"";for(var K=0,re=0,he=0,le=R.length;he!==le&&R[he]===0;)he++,K++;for(var fe=(le-he)*x+1>>>0,pe=new Uint8Array(fe);he!==le;){for(var de=R[he],F=0,q=fe-1;(de!==0||F<re)&&q!==-1;q--,F++)de+=256*pe[q]>>>0,pe[q]=de%g>>>0,de=de/g>>>0;if(de!==0)throw new Error("Non-zero carry");re=F,he++}for(var W=fe-re;W!==fe&&pe[W]===0;)W++;for(var ve=_.repeat(K);W<fe;++W)ve+=a.charAt(pe[W]);return ve}function L(R){if(typeof R!="string")throw new TypeError("Expected String");if(R.length===0)return new Uint8Array;var K=0;if(R[K]!==" "){for(var re=0,he=0;R[K]===_;)re++,K++;for(var le=(R.length-K)*m+1>>>0,fe=new Uint8Array(le);R[K];){var pe=i[R.charCodeAt(K)];if(pe===255)return;for(var de=0,F=le-1;(pe!==0||de<he)&&F!==-1;F--,de++)pe+=g*fe[F]>>>0,fe[F]=pe%256>>>0,pe=pe/256>>>0;if(pe!==0)throw new Error("Non-zero carry");he=de,K++}if(R[K]!==" "){for(var q=le-he;q!==le&&fe[q]===0;)q++;for(var W=new Uint8Array(re+(le-q)),ve=re;q!==le;)W[ve++]=fe[q++];return W}}}function z(R){var K=L(R);if(K)return K;throw new Error(`Non-${t} character`)}return{encode:O,decodeUnsafe:L,decode:z}}var Kw=kw,Vw=Kw;const _f=a=>{if(a instanceof Uint8Array&&a.constructor.name==="Uint8Array")return a;if(a instanceof ArrayBuffer)return new Uint8Array(a);if(ArrayBuffer.isView(a))return new Uint8Array(a.buffer,a.byteOffset,a.byteLength);throw new Error("Unknown type, must be binary type")},Gw=a=>new TextEncoder().encode(a),Ww=a=>new TextDecoder().decode(a);class Jw{constructor(t,i,s){this.name=t,this.prefix=i,this.baseEncode=s}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class Yw{constructor(t,i,s){if(this.name=t,this.prefix=i,i.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=i.codePointAt(0),this.baseDecode=s}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return bf(this,t)}}class Xw{constructor(t){this.decoders=t}or(t){return bf(this,t)}decode(t){const i=t[0],s=this.decoders[i];if(s)return s.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const bf=(a,t)=>new Xw({...a.decoders||{[a.prefix]:a},...t.decoders||{[t.prefix]:t}});class Zw{constructor(t,i,s,o){this.name=t,this.prefix=i,this.baseEncode=s,this.baseDecode=o,this.encoder=new Jw(t,i,s),this.decoder=new Yw(t,i,o)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}const bo=({name:a,prefix:t,encode:i,decode:s})=>new Zw(a,t,i,s),Jn=({prefix:a,name:t,alphabet:i})=>{const{encode:s,decode:o}=Vw(i,t);return bo({prefix:a,name:t,encode:s,decode:h=>_f(o(h))})},Qw=(a,t,i,s)=>{const o={};for(let x=0;x<t.length;++x)o[t[x]]=x;let h=a.length;for(;a[h-1]==="=";)--h;const p=new Uint8Array(h*i/8|0);let g=0,_=0,m=0;for(let x=0;x<h;++x){const O=o[a[x]];if(O===void 0)throw new SyntaxError(`Non-${s} character`);_=_<<i|O,g+=i,g>=8&&(g-=8,p[m++]=255&_>>g)}if(g>=i||255&_<<8-g)throw new SyntaxError("Unexpected end of data");return p},e_=(a,t,i)=>{const s=t[t.length-1]==="=",o=(1<<i)-1;let h="",p=0,g=0;for(let _=0;_<a.length;++_)for(g=g<<8|a[_],p+=8;p>i;)p-=i,h+=t[o&g>>p];if(p&&(h+=t[o&g<<i-p]),s)for(;h.length*i&7;)h+="=";return h},Vt=({name:a,prefix:t,bitsPerChar:i,alphabet:s})=>bo({prefix:t,name:a,encode(o){return e_(o,s,i)},decode(o){return Qw(o,s,i,a)}}),t_=bo({prefix:"\0",name:"identity",encode:a=>Ww(a),decode:a=>Gw(a)});var r_=Object.freeze({__proto__:null,identity:t_});const i_=Vt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var n_=Object.freeze({__proto__:null,base2:i_});const s_=Vt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var o_=Object.freeze({__proto__:null,base8:s_});const a_=Jn({prefix:"9",name:"base10",alphabet:"0123456789"});var c_=Object.freeze({__proto__:null,base10:a_});const u_=Vt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),h_=Vt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var l_=Object.freeze({__proto__:null,base16:u_,base16upper:h_});const f_=Vt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),p_=Vt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),d_=Vt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),g_=Vt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),y_=Vt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),v_=Vt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),m_=Vt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),w_=Vt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),__=Vt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var b_=Object.freeze({__proto__:null,base32:f_,base32upper:p_,base32pad:d_,base32padupper:g_,base32hex:y_,base32hexupper:v_,base32hexpad:m_,base32hexpadupper:w_,base32z:__});const E_=Jn({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),I_=Jn({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var x_=Object.freeze({__proto__:null,base36:E_,base36upper:I_});const S_=Jn({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),P_=Jn({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var A_=Object.freeze({__proto__:null,base58btc:S_,base58flickr:P_});const C_=Vt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),O_=Vt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),R_=Vt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),T_=Vt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var N_=Object.freeze({__proto__:null,base64:C_,base64pad:O_,base64url:R_,base64urlpad:T_});const Ef=Array.from(""),D_=Ef.reduce((a,t,i)=>(a[i]=t,a),[]),L_=Ef.reduce((a,t,i)=>(a[t.codePointAt(0)]=i,a),[]);function F_(a){return a.reduce((t,i)=>(t+=D_[i],t),"")}function $_(a){const t=[];for(const i of a){const s=L_[i.codePointAt(0)];if(s===void 0)throw new Error(`Non-base256emoji character: ${i}`);t.push(s)}return new Uint8Array(t)}const M_=bo({prefix:"",name:"base256emoji",encode:F_,decode:$_});var j_=Object.freeze({__proto__:null,base256emoji:M_}),z_=If,al=128,U_=127,q_=~U_,B_=Math.pow(2,31);function If(a,t,i){t=t||[],i=i||0;for(var s=i;a>=B_;)t[i++]=a&255|al,a/=128;for(;a&q_;)t[i++]=a&255|al,a>>>=7;return t[i]=a|0,If.bytes=i-s+1,t}var H_=pc,k_=128,cl=127;function pc(a,s){var i=0,s=s||0,o=0,h=s,p,g=a.length;do{if(h>=g)throw pc.bytes=0,new RangeError("Could not decode varint");p=a[h++],i+=o<28?(p&cl)<<o:(p&cl)*Math.pow(2,o),o+=7}while(p>=k_);return pc.bytes=h-s,i}var K_=Math.pow(2,7),V_=Math.pow(2,14),G_=Math.pow(2,21),W_=Math.pow(2,28),J_=Math.pow(2,35),Y_=Math.pow(2,42),X_=Math.pow(2,49),Z_=Math.pow(2,56),Q_=Math.pow(2,63),eb=function(a){return a<K_?1:a<V_?2:a<G_?3:a<W_?4:a<J_?5:a<Y_?6:a<X_?7:a<Z_?8:a<Q_?9:10},tb={encode:z_,decode:H_,encodingLength:eb},xf=tb;const ul=(a,t,i=0)=>(xf.encode(a,t,i),t),hl=a=>xf.encodingLength(a),dc=(a,t)=>{const i=t.byteLength,s=hl(a),o=s+hl(i),h=new Uint8Array(o+i);return ul(a,h,0),ul(i,h,s),h.set(t,o),new rb(a,i,t,h)};class rb{constructor(t,i,s,o){this.code=t,this.size=i,this.digest=s,this.bytes=o}}const Sf=({name:a,code:t,encode:i})=>new ib(a,t,i);class ib{constructor(t,i,s){this.name=t,this.code=i,this.encode=s}digest(t){if(t instanceof Uint8Array){const i=this.encode(t);return i instanceof Uint8Array?dc(this.code,i):i.then(s=>dc(this.code,s))}else throw Error("Unknown type, must be binary type")}}const Pf=a=>async t=>new Uint8Array(await crypto.subtle.digest(a,t)),nb=Sf({name:"sha2-256",code:18,encode:Pf("SHA-256")}),sb=Sf({name:"sha2-512",code:19,encode:Pf("SHA-512")});var ob=Object.freeze({__proto__:null,sha256:nb,sha512:sb});const Af=0,ab="identity",Cf=_f,cb=a=>dc(Af,Cf(a)),ub={code:Af,name:ab,encode:Cf,digest:cb};var hb=Object.freeze({__proto__:null,identity:ub});new TextEncoder,new TextDecoder;const ll={...r_,...n_,...o_,...c_,...l_,...b_,...x_,...A_,...N_,...j_};({...ob,...hb});function Of(a){return globalThis.Buffer!=null?new Uint8Array(a.buffer,a.byteOffset,a.byteLength):a}function lb(a=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Of(globalThis.Buffer.allocUnsafe(a)):new Uint8Array(a)}function Rf(a,t,i,s){return{name:a,prefix:t,encoder:{name:a,prefix:t,encode:i},decoder:{decode:s}}}const fl=Rf("utf8","u",a=>"u"+new TextDecoder("utf8").decode(a),a=>new TextEncoder().encode(a.substring(1))),tc=Rf("ascii","a",a=>{let t="a";for(let i=0;i<a.length;i++)t+=String.fromCharCode(a[i]);return t},a=>{a=a.substring(1);const t=lb(a.length);for(let i=0;i<a.length;i++)t[i]=a.charCodeAt(i);return t}),fb={utf8:fl,"utf-8":fl,hex:ll.base16,latin1:tc,ascii:tc,binary:tc,...ll};function pb(a,t="utf8"){const i=fb[t];if(!i)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Of(globalThis.Buffer.from(a,"utf-8")):i.decoder.decode(`${i.prefix}${a}`)}const Tf="wc",db=2,Oc="core",Ei=`${Tf}@2:${Oc}:`,gb={name:Oc,logger:"error"},yb={database:":memory:"},vb="crypto",pl="client_ed25519_seed",mb=se.ONE_DAY,wb="keychain",_b="0.3",bb="messages",Eb="0.3",Ib=se.SIX_HOURS,xb="publisher",Nf="irn",Sb="error",Df="wss://relay.walletconnect.com",dl="wss://relay.walletconnect.org",Pb="relayer",mt={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},Ab="_subscription",Un={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},Cb=se.ONE_SECOND/2,Ob="2.9.0",Rb=1e4,Tb="0.3",Nb="WALLETCONNECT_CLIENT_ID",Gr={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},Db="subscription",Lb="0.3",Fb=se.FIVE_SECONDS*1e3,$b="pairing",Mb="0.3",qn={wc_pairingDelete:{req:{ttl:se.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:se.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:se.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:se.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:se.ONE_DAY,prompt:!1,tag:0},res:{ttl:se.ONE_DAY,prompt:!1,tag:0}}},Vr={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},jb="history",zb="0.3",Ub="expirer",Cr={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},qb="0.3",rc="verify-api",gl="https://verify.walletconnect.com";class Bb{constructor(t,i){this.core=t,this.logger=i,this.keychain=new Map,this.name=wb,this.version=_b,this.initialized=!1,this.storagePrefix=Ei,this.init=async()=>{if(!this.initialized){const s=await this.getKeyChain();typeof s<"u"&&(this.keychain=s),this.initialized=!0}},this.has=s=>(this.isInitialized(),this.keychain.has(s)),this.set=async(s,o)=>{this.isInitialized(),this.keychain.set(s,o),await this.persist()},this.get=s=>{this.isInitialized();const o=this.keychain.get(s);if(typeof o>"u"){const{message:h}=Q("NO_MATCHING_KEY",`${this.name}: ${s}`);throw new Error(h)}return o},this.del=async s=>{this.isInitialized(),this.keychain.delete(s),await this.persist()},this.core=t,this.logger=Re.generateChildLogger(i,this.name)}get context(){return Re.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setKeyChain(t){await this.core.storage.setItem(this.storageKey,Vl(t))}async getKeyChain(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?Gl(t):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:t}=Q("NOT_INITIALIZED",this.name);throw new Error(t)}}}class Hb{constructor(t,i,s){this.core=t,this.logger=i,this.name=vb,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=o=>(this.isInitialized(),this.keychain.has(o)),this.getClientId=async()=>{this.isInitialized();const o=await this.getClientSeed(),h=Qh(o);return ff(h.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const o=Im();return this.setPrivateKey(o.publicKey,o.privateKey)},this.signJWT=async o=>{this.isInitialized();const h=await this.getClientSeed(),p=Qh(h),g=hc();return await _w(g,o,mb,p)},this.generateSharedKey=(o,h,p)=>{this.isInitialized();const g=this.getPrivateKey(o),_=xm(g,h);return this.setSymKey(_,p)},this.setSymKey=async(o,h)=>{this.isInitialized();const p=h||Sm(o);return await this.keychain.set(p,o),p},this.deleteKeyPair=async o=>{this.isInitialized(),await this.keychain.del(o)},this.deleteSymKey=async o=>{this.isInitialized(),await this.keychain.del(o)},this.encode=async(o,h,p)=>{this.isInitialized();const g=Pm(p),_=qi(h);if(Dh(g)){const L=g.senderPublicKey,z=g.receiverPublicKey;o=await this.generateSharedKey(L,z)}const m=this.getSymKey(o),{type:x,senderPublicKey:O}=g;return Am({type:x,symKey:m,message:_,senderPublicKey:O})},this.decode=async(o,h,p)=>{this.isInitialized();const g=Cm(h,p);if(Dh(g)){const x=g.receiverPublicKey,O=g.senderPublicKey;o=await this.generateSharedKey(x,O)}const _=this.getSymKey(o),m=Om({symKey:_,encoded:h});return Wn(m)},this.getPayloadType=o=>{const h=Lh(o);return Rm(h.type)},this.getPayloadSenderPublicKey=o=>{const h=Lh(o);return h.senderPublicKey?yo(h.senderPublicKey,Tm):void 0},this.core=t,this.logger=Re.generateChildLogger(i,this.name),this.keychain=s||new Bb(this.core,this.logger)}get context(){return Re.getLoggerContext(this.logger)}async setPrivateKey(t,i){return await this.keychain.set(t,i),t}getPrivateKey(t){return this.keychain.get(t)}async getClientSeed(){let t="";try{t=this.keychain.get(pl)}catch{t=hc(),await this.keychain.set(pl,t)}return pb(t,"base16")}getSymKey(t){return this.keychain.get(t)}isInitialized(){if(!this.initialized){const{message:t}=Q("NOT_INITIALIZED",this.name);throw new Error(t)}}}class kb extends Z1{constructor(t,i){super(t,i),this.logger=t,this.core=i,this.messages=new Map,this.name=bb,this.version=Eb,this.initialized=!1,this.storagePrefix=Ei,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const s=await this.getRelayerMessages();typeof s<"u"&&(this.messages=s),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(s){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(s)}finally{this.initialized=!0}}},this.set=async(s,o)=>{this.isInitialized();const h=dn(o);let p=this.messages.get(s);return typeof p>"u"&&(p={}),typeof p[h]<"u"||(p[h]=o,this.messages.set(s,p),await this.persist()),h},this.get=s=>{this.isInitialized();let o=this.messages.get(s);return typeof o>"u"&&(o={}),o},this.has=(s,o)=>{this.isInitialized();const h=this.get(s),p=dn(o);return typeof h[p]<"u"},this.del=async s=>{this.isInitialized(),this.messages.delete(s),await this.persist()},this.logger=Re.generateChildLogger(t,this.name),this.core=i}get context(){return Re.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setRelayerMessages(t){await this.core.storage.setItem(this.storageKey,Vl(t))}async getRelayerMessages(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?Gl(t):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:t}=Q("NOT_INITIALIZED",this.name);throw new Error(t)}}}class Kb extends Q1{constructor(t,i){super(t,i),this.relayer=t,this.logger=i,this.events=new vr.EventEmitter,this.name=xb,this.queue=new Map,this.publishTimeout=se.toMiliseconds(se.TEN_SECONDS),this.queueTimeout=se.toMiliseconds(se.FIVE_SECONDS),this.needsTransportRestart=!1,this.publish=async(s,o,h)=>{this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:o,opts:h}});try{const p=(h==null?void 0:h.ttl)||Ib,g=lc(h),_=(h==null?void 0:h.prompt)||!1,m=(h==null?void 0:h.tag)||0,x=(h==null?void 0:h.id)||Pc().toString(),O={topic:s,message:o,opts:{ttl:p,relay:g,prompt:_,tag:m,id:x}},L=setTimeout(()=>this.queue.set(x,O),this.queueTimeout);try{await await lo(this.rpcPublish(s,o,p,g,_,m,x),this.publishTimeout),clearTimeout(L),this.relayer.events.emit(mt.publish,O)}catch{this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0;return}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:o,opts:h}})}catch(p){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(p),p}},this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.relayer=t,this.logger=Re.generateChildLogger(i,this.name),this.registerEventListeners()}get context(){return Re.getLoggerContext(this.logger)}rpcPublish(t,i,s,o,h,p,g){var _,m,x,O;const L={method:so(o.protocol).publish,params:{topic:t,message:i,ttl:s,prompt:h,tag:p},id:g};return bi((_=L.params)==null?void 0:_.prompt)&&((m=L.params)==null||delete m.prompt),bi((x=L.params)==null?void 0:x.tag)&&((O=L.params)==null||delete O.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:L}),this.relayer.request(L)}onPublish(t){this.queue.delete(t)}checkQueue(){this.queue.forEach(async t=>{const{topic:i,message:s,opts:o}=t;await this.publish(i,s,o)})}registerEventListeners(){this.relayer.core.heartbeat.on(mn.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(mt.connection_stalled);return}this.checkQueue()}),this.relayer.on(mt.message_ack,t=>{this.onPublish(t.id.toString())})}}class Vb{constructor(){this.map=new Map,this.set=(t,i)=>{const s=this.get(t);this.exists(t,i)||this.map.set(t,[...s,i])},this.get=t=>this.map.get(t)||[],this.exists=(t,i)=>this.get(t).includes(i),this.delete=(t,i)=>{if(typeof i>"u"){this.map.delete(t);return}if(!this.map.has(t))return;const s=this.get(t);if(!this.exists(t,i))return;const o=s.filter(h=>h!==i);if(!o.length){this.map.delete(t);return}this.map.set(t,o)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var Gb=Object.defineProperty,Wb=Object.defineProperties,Jb=Object.getOwnPropertyDescriptors,yl=Object.getOwnPropertySymbols,Yb=Object.prototype.hasOwnProperty,Xb=Object.prototype.propertyIsEnumerable,vl=(a,t,i)=>t in a?Gb(a,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[t]=i,Bn=(a,t)=>{for(var i in t||(t={}))Yb.call(t,i)&&vl(a,i,t[i]);if(yl)for(var i of yl(t))Xb.call(t,i)&&vl(a,i,t[i]);return a},ic=(a,t)=>Wb(a,Jb(t));class Zb extends rw{constructor(t,i){super(t,i),this.relayer=t,this.logger=i,this.subscriptions=new Map,this.topicMap=new Vb,this.events=new vr.EventEmitter,this.name=Db,this.version=Lb,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=Ei,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restart(),this.registerEventListeners(),this.onEnable(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(s,o)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:o}});try{const h=lc(o),p={topic:s,relay:h};this.pending.set(s,p);const g=await this.rpcSubscribe(s,h);return this.onSubscribe(g,p),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:o}}),g}catch(h){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(h),h}},this.unsubscribe=async(s,o)=>{await this.restartToComplete(),this.isInitialized(),typeof(o==null?void 0:o.id)<"u"?await this.unsubscribeById(s,o.id,o):await this.unsubscribeByTopic(s,o)},this.isSubscribed=async s=>this.topics.includes(s)?!0:await new Promise((o,h)=>{const p=new se.Watch;p.start(this.pendingSubscriptionWatchLabel);const g=setInterval(()=>{!this.pending.has(s)&&this.topics.includes(s)&&(clearInterval(g),p.stop(this.pendingSubscriptionWatchLabel),o(!0)),p.elapsed(this.pendingSubscriptionWatchLabel)>=Fb&&(clearInterval(g),p.stop(this.pendingSubscriptionWatchLabel),h(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1),this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=t,this.logger=Re.generateChildLogger(i,this.name),this.clientId=""}get context(){return Re.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(t,i){let s=!1;try{s=this.getSubscription(t).topic===i}catch{}return s}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(t,i){const s=this.topicMap.get(t);await Promise.all(s.map(async o=>await this.unsubscribeById(t,o,i)))}async unsubscribeById(t,i,s){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:i,opts:s}});try{const o=lc(s);await this.rpcUnsubscribe(t,i,o);const h=rr("USER_DISCONNECTED",`${this.name}, ${t}`);await this.onUnsubscribe(t,i,h),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:i,opts:s}})}catch(o){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(o),o}}async rpcSubscribe(t,i){const s={method:so(i.protocol).subscribe,params:{topic:t}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{await await lo(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(mt.connection_stalled)}return dn(t+this.clientId)}async rpcBatchSubscribe(t){if(!t.length)return;const i=t[0].relay,s={method:so(i.protocol).batchSubscribe,params:{topics:t.map(o=>o.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{return await await lo(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(mt.connection_stalled)}}rpcUnsubscribe(t,i,s){const o={method:so(s.protocol).unsubscribe,params:{topic:t,id:i}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:o}),this.relayer.request(o)}onSubscribe(t,i){this.setSubscription(t,ic(Bn({},i),{id:t})),this.pending.delete(i.topic)}onBatchSubscribe(t){t.length&&t.forEach(i=>{this.setSubscription(i.id,Bn({},i)),this.pending.delete(i.topic)})}async onUnsubscribe(t,i,s){this.events.removeAllListeners(i),this.hasSubscription(i,t)&&this.deleteSubscription(i,s),await this.relayer.messages.del(t)}async setRelayerSubscriptions(t){await this.relayer.core.storage.setItem(this.storageKey,t)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(t,i){this.subscriptions.has(t)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:t,subscription:i}),this.addSubscription(t,i))}addSubscription(t,i){this.subscriptions.set(t,Bn({},i)),this.topicMap.set(i.topic,t),this.events.emit(Gr.created,i)}getSubscription(t){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:t});const i=this.subscriptions.get(t);if(!i){const{message:s}=Q("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(s)}return i}deleteSubscription(t,i){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:t,reason:i});const s=this.getSubscription(t);this.subscriptions.delete(t),this.topicMap.delete(s.topic,t),this.events.emit(Gr.deleted,ic(Bn({},s),{reason:i}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Gr.sync)}async reset(){if(this.cached.length){const t=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let i=0;i<t;i++){const s=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(s)}}this.events.emit(Gr.resubscribed)}async restore(){try{const t=await this.getRelayerSubscriptions();if(typeof t>"u"||!t.length)return;if(this.subscriptions.size){const{message:i}=Q("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(i),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(i)}this.cached=t,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(t){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(t)}}async batchSubscribe(t){if(!t.length)return;const i=await this.rpcBatchSubscribe(t);yn(i)&&this.onBatchSubscribe(i.map((s,o)=>ic(Bn({},t[o]),{id:s})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(this.relayer.transportExplicitlyClosed)return;const t=[];this.pending.forEach(i=>{t.push(i)}),await this.batchSubscribe(t)}registerEventListeners(){this.relayer.core.heartbeat.on(mn.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(mt.connect,async()=>{await this.onConnect()}),this.relayer.on(mt.disconnect,()=>{this.onDisconnect()}),this.events.on(Gr.created,async t=>{const i=Gr.created;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,data:t}),await this.persist()}),this.events.on(Gr.deleted,async t=>{const i=Gr.deleted;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,data:t}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=Q("NOT_INITIALIZED",this.name);throw new Error(t)}}async restartToComplete(){this.restartInProgress&&await new Promise(t=>{const i=setInterval(()=>{this.restartInProgress||(clearInterval(i),t())},this.pollingInterval)})}}var Qb=Object.defineProperty,ml=Object.getOwnPropertySymbols,eE=Object.prototype.hasOwnProperty,tE=Object.prototype.propertyIsEnumerable,wl=(a,t,i)=>t in a?Qb(a,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[t]=i,rE=(a,t)=>{for(var i in t||(t={}))eE.call(t,i)&&wl(a,i,t[i]);if(ml)for(var i of ml(t))tE.call(t,i)&&wl(a,i,t[i]);return a};class iE extends ew{constructor(t){super(t),this.protocol="wc",this.version=2,this.events=new vr.EventEmitter,this.name=Pb,this.transportExplicitlyClosed=!1,this.initialized=!1,this.reconnecting=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.request=async i=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(i)}catch(s){throw this.logger.debug("Failed to Publish Request"),this.logger.error(s),s}},this.core=t.core,this.logger=typeof t.logger<"u"&&typeof t.logger!="string"?Re.generateChildLogger(t.logger,this.name):Re.pino(Re.getDefaultLoggerOptions({level:t.logger||Sb})),this.messages=new kb(this.logger,t.core),this.subscriber=new Zb(this,this.logger),this.publisher=new Kb(this,this.logger),this.relayUrl=(t==null?void 0:t.relayUrl)||Df,this.projectId=t.projectId,this.provider={}}async init(){this.logger.trace("Initialized"),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${dl}...`),await this.restartTransport(dl)}this.registerEventListeners(),this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},Rb)}get context(){return Re.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(t,i,s){this.isInitialized(),await this.publisher.publish(t,i,s),await this.recordMessageEvent({topic:t,message:i,publishedAt:Date.now()})}async subscribe(t,i){var s;this.isInitialized();let o=((s=this.subscriber.topicMap.get(t))==null?void 0:s[0])||"";return o||(await Promise.all([new Promise(h=>{this.subscriber.once(Gr.created,p=>{p.topic===t&&h()})}),new Promise(async h=>{o=await this.subscriber.subscribe(t,i),h()})]),o)}async unsubscribe(t,i){this.isInitialized(),await this.subscriber.unsubscribe(t,i)}on(t,i){this.events.on(t,i)}once(t,i){this.events.once(t,i)}off(t,i){this.events.off(t,i)}removeListener(t,i){this.events.removeListener(t,i)}async transportClose(){this.transportExplicitlyClosed=!0,this.connected&&(await this.provider.disconnect(),this.events.emit(mt.transport_closed))}async transportOpen(t){if(this.transportExplicitlyClosed=!1,!this.reconnecting){this.relayUrl=t||this.relayUrl,this.reconnecting=!0;try{await Promise.all([new Promise(i=>{this.initialized||i(),this.subscriber.once(Gr.resubscribed,()=>{i()})}),await Promise.race([new Promise(async(i,s)=>{await lo(this.provider.connect(),5e3,`Socket stalled when trying to connect to ${this.relayUrl}`).catch(o=>s(o)).then(()=>i()).finally(()=>this.removeListener(mt.transport_closed,this.rejectTransportOpen))}),new Promise(i=>this.once(mt.transport_closed,this.rejectTransportOpen))])])}catch(i){this.logger.error(i);const s=i;if(!this.isConnectionStalled(s.message))throw i;this.events.emit(mt.transport_closed)}finally{this.reconnecting=!1}}}async restartTransport(t){this.transportExplicitlyClosed||this.reconnecting||(this.relayUrl=t||this.relayUrl,this.connected&&await Promise.all([new Promise(i=>{this.provider.once(Un.disconnect,()=>{i()})}),this.transportClose()]),await this.createProvider(),await this.transportOpen())}isConnectionStalled(t){return this.staleConnectionErrors.some(i=>t.includes(i))}rejectTransportOpen(){throw new Error("Attempt to connect to relay via `transportOpen` has stalled. Retrying...")}async createProvider(){const t=await this.core.crypto.signJWT(this.relayUrl);this.provider=new Ii(new qw(Nm({sdkVersion:Ob,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:t,useOnCloseEvent:!0}))),this.registerProviderListeners()}async recordMessageEvent(t){const{topic:i,message:s}=t;await this.messages.set(i,s)}async shouldIgnoreMessageEvent(t){const{topic:i,message:s}=t;return await this.subscriber.isSubscribed(i)?this.messages.has(i,s):!0}async onProviderPayload(t){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:t}),Cc(t)){if(!t.method.endsWith(Ab))return;const i=t.params,{topic:s,message:o,publishedAt:h}=i.data,p={topic:s,message:o,publishedAt:h};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(rE({type:"event",event:i.id},p)),this.events.emit(i.id,p),await this.acknowledgePayload(t),await this.onMessageEvent(p)}else _o(t)&&this.events.emit(mt.message_ack,t)}async onMessageEvent(t){await this.shouldIgnoreMessageEvent(t)||(this.events.emit(mt.message,t),await this.recordMessageEvent(t))}async acknowledgePayload(t){const i=Ac(t.id,!0);await this.provider.connection.send(i)}registerProviderListeners(){this.provider.on(Un.payload,t=>this.onProviderPayload(t)),this.provider.on(Un.connect,()=>{this.events.emit(mt.connect)}),this.provider.on(Un.disconnect,()=>{this.onProviderDisconnect()}),this.provider.on(Un.error,t=>{this.logger.error(t),this.events.emit(mt.error,t)})}registerEventListeners(){this.events.on(mt.connection_stalled,async()=>{await this.restartTransport()})}onProviderDisconnect(){this.events.emit(mt.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||setTimeout(async()=>{await this.restartTransport()},se.toMiliseconds(Cb))}isInitialized(){if(!this.initialized){const{message:t}=Q("NOT_INITIALIZED",this.name);throw new Error(t)}}async toEstablishConnection(){if(!this.connected){if(this.connecting)return await new Promise(t=>{const i=setInterval(()=>{this.connected&&(clearInterval(i),t())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var nE=Object.defineProperty,_l=Object.getOwnPropertySymbols,sE=Object.prototype.hasOwnProperty,oE=Object.prototype.propertyIsEnumerable,bl=(a,t,i)=>t in a?nE(a,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[t]=i,El=(a,t)=>{for(var i in t||(t={}))sE.call(t,i)&&bl(a,i,t[i]);if(_l)for(var i of _l(t))oE.call(t,i)&&bl(a,i,t[i]);return a};class Eo extends tw{constructor(t,i,s,o=Ei,h=void 0){super(t,i,s,o),this.core=t,this.logger=i,this.name=s,this.map=new Map,this.version=Tb,this.cached=[],this.initialized=!1,this.storagePrefix=Ei,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(p=>{this.getKey&&p!==null&&!bi(p)?this.map.set(this.getKey(p),p):bm(p)?this.map.set(p.id,p):Em(p)&&this.map.set(p.topic,p)}),this.cached=[],this.initialized=!0)},this.set=async(p,g)=>{this.isInitialized(),this.map.has(p)?await this.update(p,g):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:p,value:g}),this.map.set(p,g),await this.persist())},this.get=p=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:p}),this.getData(p)),this.getAll=p=>(this.isInitialized(),p?this.values.filter(g=>Object.keys(p).every(_=>Hw(g[_],p[_]))):this.values),this.update=async(p,g)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:p,update:g});const _=El(El({},this.getData(p)),g);this.map.set(p,_),await this.persist()},this.delete=async(p,g)=>{this.isInitialized(),this.map.has(p)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:p,reason:g}),this.map.delete(p),await this.persist())},this.logger=Re.generateChildLogger(i,this.name),this.storagePrefix=o,this.getKey=h}get context(){return Re.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(t){await this.core.storage.setItem(this.storageKey,t)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(t){const i=this.map.get(t);if(!i){const{message:s}=Q("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(s),new Error(s)}return i}async persist(){await this.setDataStore(this.values)}async restore(){try{const t=await this.getDataStore();if(typeof t>"u"||!t.length)return;if(this.map.size){const{message:i}=Q("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(i),new Error(i)}this.cached=t,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(t){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(t)}}isInitialized(){if(!this.initialized){const{message:t}=Q("NOT_INITIALIZED",this.name);throw new Error(t)}}}class aE{constructor(t,i){this.core=t,this.logger=i,this.name=$b,this.version=Mb,this.events=new Ic,this.initialized=!1,this.storagePrefix=Ei,this.ignoredPayloadTypes=[Hl],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:s})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...s])]},this.create=async()=>{this.isInitialized();const s=hc(),o=await this.core.crypto.setSymKey(s),h=$r(se.FIVE_MINUTES),p={protocol:Nf},g={topic:o,expiry:h,relay:p,active:!1},_=Dm({protocol:this.core.protocol,version:this.core.version,topic:o,symKey:s,relay:p});return await this.pairings.set(o,g),await this.core.relayer.subscribe(o),this.core.expirer.set(o,h),{topic:o,uri:_}},this.pair=async s=>{this.isInitialized(),this.isValidPair(s);const{topic:o,symKey:h,relay:p}=Lm(s.uri);if(this.pairings.keys.includes(o))throw new Error(`Pairing already exists: ${o}`);if(this.core.crypto.hasKeys(o))throw new Error(`Keychain already exists: ${o}`);const g=$r(se.FIVE_MINUTES),_={topic:o,relay:p,expiry:g,active:!1};return await this.pairings.set(o,_),await this.core.crypto.setSymKey(h,o),await this.core.relayer.subscribe(o,{relay:p}),this.core.expirer.set(o,g),s.activatePairing&&await this.activate({topic:o}),_},this.activate=async({topic:s})=>{this.isInitialized();const o=$r(se.THIRTY_DAYS);await this.pairings.update(s,{active:!0,expiry:o}),this.core.expirer.set(s,o)},this.ping=async s=>{this.isInitialized(),await this.isValidPing(s);const{topic:o}=s;if(this.pairings.keys.includes(o)){const h=await this.sendRequest(o,"wc_pairingPing",{}),{done:p,resolve:g,reject:_}=fn();this.events.once(Ft("pairing_ping",h),({error:m})=>{m?_(m):g()}),await p()}},this.updateExpiry=async({topic:s,expiry:o})=>{this.isInitialized(),await this.pairings.update(s,{expiry:o})},this.updateMetadata=async({topic:s,metadata:o})=>{this.isInitialized(),await this.pairings.update(s,{peerMetadata:o})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async s=>{this.isInitialized(),await this.isValidDisconnect(s);const{topic:o}=s;this.pairings.keys.includes(o)&&(await this.sendRequest(o,"wc_pairingDelete",rr("USER_DISCONNECTED")),await this.deletePairing(o))},this.sendRequest=async(s,o,h)=>{const p=mo(o,h),g=await this.core.crypto.encode(s,p),_=qn[o].req;return this.core.history.set(s,p),this.core.relayer.publish(s,g,_),p.id},this.sendResult=async(s,o,h)=>{const p=Ac(s,h),g=await this.core.crypto.encode(o,p),_=await this.core.history.get(o,s),m=qn[_.request.method].res;await this.core.relayer.publish(o,g,m),await this.core.history.resolve(p)},this.sendError=async(s,o,h)=>{const p=wo(s,h),g=await this.core.crypto.encode(o,p),_=await this.core.history.get(o,s),m=qn[_.request.method]?qn[_.request.method].res:qn.unregistered_method.res;await this.core.relayer.publish(o,g,m),await this.core.history.resolve(p)},this.deletePairing=async(s,o)=>{await this.core.relayer.unsubscribe(s),await Promise.all([this.pairings.delete(s,rr("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(s),o?Promise.resolve():this.core.expirer.del(s)])},this.cleanup=async()=>{const s=this.pairings.getAll().filter(o=>_i(o.expiry));await Promise.all(s.map(o=>this.deletePairing(o.topic)))},this.onRelayEventRequest=s=>{const{topic:o,payload:h}=s,p=h.method;if(this.pairings.keys.includes(o))switch(p){case"wc_pairingPing":return this.onPairingPingRequest(o,h);case"wc_pairingDelete":return this.onPairingDeleteRequest(o,h);default:return this.onUnknownRpcMethodRequest(o,h)}},this.onRelayEventResponse=async s=>{const{topic:o,payload:h}=s,p=(await this.core.history.get(o,h.id)).request.method;if(this.pairings.keys.includes(o))switch(p){case"wc_pairingPing":return this.onPairingPingResponse(o,h);default:return this.onUnknownRpcMethodResponse(p)}},this.onPairingPingRequest=async(s,o)=>{const{id:h}=o;try{this.isValidPing({topic:s}),await this.sendResult(h,s,!0),this.events.emit("pairing_ping",{id:h,topic:s})}catch(p){await this.sendError(h,s,p),this.logger.error(p)}},this.onPairingPingResponse=(s,o)=>{const{id:h}=o;setTimeout(()=>{ci(o)?this.events.emit(Ft("pairing_ping",h),{}):Mr(o)&&this.events.emit(Ft("pairing_ping",h),{error:o.error})},500)},this.onPairingDeleteRequest=async(s,o)=>{const{id:h}=o;try{this.isValidDisconnect({topic:s}),await this.deletePairing(s),this.events.emit("pairing_delete",{id:h,topic:s})}catch(p){await this.sendError(h,s,p),this.logger.error(p)}},this.onUnknownRpcMethodRequest=async(s,o)=>{const{id:h,method:p}=o;try{if(this.registeredMethods.includes(p))return;const g=rr("WC_METHOD_UNSUPPORTED",p);await this.sendError(h,s,g),this.logger.error(g)}catch(g){await this.sendError(h,s,g),this.logger.error(g)}},this.onUnknownRpcMethodResponse=s=>{this.registeredMethods.includes(s)||this.logger.error(rr("WC_METHOD_UNSUPPORTED",s))},this.isValidPair=s=>{if(!hr(s)){const{message:o}=Q("MISSING_OR_INVALID",`pair() params: ${s}`);throw new Error(o)}if(!Fm(s.uri)){const{message:o}=Q("MISSING_OR_INVALID",`pair() uri: ${s.uri}`);throw new Error(o)}},this.isValidPing=async s=>{if(!hr(s)){const{message:h}=Q("MISSING_OR_INVALID",`ping() params: ${s}`);throw new Error(h)}const{topic:o}=s;await this.isValidPairingTopic(o)},this.isValidDisconnect=async s=>{if(!hr(s)){const{message:h}=Q("MISSING_OR_INVALID",`disconnect() params: ${s}`);throw new Error(h)}const{topic:o}=s;await this.isValidPairingTopic(o)},this.isValidPairingTopic=async s=>{if(!pn(s,!1)){const{message:o}=Q("MISSING_OR_INVALID",`pairing topic should be a string: ${s}`);throw new Error(o)}if(!this.pairings.keys.includes(s)){const{message:o}=Q("NO_MATCHING_KEY",`pairing topic doesn't exist: ${s}`);throw new Error(o)}if(_i(this.pairings.get(s).expiry)){await this.deletePairing(s);const{message:o}=Q("EXPIRED",`pairing topic: ${s}`);throw new Error(o)}},this.core=t,this.logger=Re.generateChildLogger(i,this.name),this.pairings=new Eo(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Re.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:t}=Q("NOT_INITIALIZED",this.name);throw new Error(t)}}registerRelayerEvents(){this.core.relayer.on(mt.message,async t=>{const{topic:i,message:s}=t;if(this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(s)))return;const o=await this.core.crypto.decode(i,s);Cc(o)?(this.core.history.set(i,o),this.onRelayEventRequest({topic:i,payload:o})):_o(o)&&(await this.core.history.resolve(o),await this.onRelayEventResponse({topic:i,payload:o}),this.core.history.delete(i,o.id))})}registerExpirerEvents(){this.core.expirer.on(Cr.expired,async t=>{const{topic:i}=kl(t.target);i&&this.pairings.keys.includes(i)&&(await this.deletePairing(i,!0),this.events.emit("pairing_expire",{topic:i}))})}}class cE extends X1{constructor(t,i){super(t,i),this.core=t,this.logger=i,this.records=new Map,this.events=new vr.EventEmitter,this.name=jb,this.version=zb,this.cached=[],this.initialized=!1,this.storagePrefix=Ei,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.records.set(s.id,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(s,o,h)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:s,request:o,chainId:h}),this.records.has(o.id))return;const p={id:o.id,topic:s,request:{method:o.method,params:o.params||null},chainId:h,expiry:$r(se.THIRTY_DAYS)};this.records.set(p.id,p),this.events.emit(Vr.created,p)},this.resolve=async s=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:s}),!this.records.has(s.id))return;const o=await this.getRecord(s.id);typeof o.response>"u"&&(o.response=Mr(s)?{error:s.error}:{result:s.result},this.records.set(o.id,o),this.events.emit(Vr.updated,o))},this.get=async(s,o)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:s,id:o}),await this.getRecord(o)),this.delete=(s,o)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:o}),this.values.forEach(h=>{if(h.topic===s){if(typeof o<"u"&&h.id!==o)return;this.records.delete(h.id),this.events.emit(Vr.deleted,h)}})},this.exists=async(s,o)=>(this.isInitialized(),this.records.has(o)?(await this.getRecord(o)).topic===s:!1),this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.logger=Re.generateChildLogger(i,this.name)}get context(){return Re.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const t=[];return this.values.forEach(i=>{if(typeof i.response<"u")return;const s={topic:i.topic,request:mo(i.request.method,i.request.params,i.id),chainId:i.chainId};return t.push(s)}),t}async setJsonRpcRecords(t){await this.core.storage.setItem(this.storageKey,t)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(t){this.isInitialized();const i=this.records.get(t);if(!i){const{message:s}=Q("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(s)}return i}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Vr.sync)}async restore(){try{const t=await this.getJsonRpcRecords();if(typeof t>"u"||!t.length)return;if(this.records.size){const{message:i}=Q("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(i),new Error(i)}this.cached=t,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(t){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(t)}}registerEventListeners(){this.events.on(Vr.created,t=>{const i=Vr.created;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,record:t}),this.persist()}),this.events.on(Vr.updated,t=>{const i=Vr.updated;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,record:t}),this.persist()}),this.events.on(Vr.deleted,t=>{const i=Vr.deleted;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,record:t}),this.persist()}),this.core.heartbeat.on(mn.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach(t=>{se.toMiliseconds(t.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${t.id}`),this.delete(t.topic,t.id))})}catch(t){this.logger.warn(t)}}isInitialized(){if(!this.initialized){const{message:t}=Q("NOT_INITIALIZED",this.name);throw new Error(t)}}}class uE extends iw{constructor(t,i){super(t,i),this.core=t,this.logger=i,this.expirations=new Map,this.events=new vr.EventEmitter,this.name=Ub,this.version=qb,this.cached=[],this.initialized=!1,this.storagePrefix=Ei,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.expirations.set(s.target,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=s=>{try{const o=this.formatTarget(s);return typeof this.getExpiration(o)<"u"}catch{return!1}},this.set=(s,o)=>{this.isInitialized();const h=this.formatTarget(s),p={target:h,expiry:o};this.expirations.set(h,p),this.checkExpiry(h,p),this.events.emit(Cr.created,{target:h,expiration:p})},this.get=s=>{this.isInitialized();const o=this.formatTarget(s);return this.getExpiration(o)},this.del=s=>{if(this.isInitialized(),this.has(s)){const o=this.formatTarget(s),h=this.getExpiration(o);this.expirations.delete(o),this.events.emit(Cr.deleted,{target:o,expiration:h})}},this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.logger=Re.generateChildLogger(i,this.name)}get context(){return Re.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(t){if(typeof t=="string")return $m(t);if(typeof t=="number")return Mm(t);const{message:i}=Q("UNKNOWN_TYPE",`Target type: ${typeof t}`);throw new Error(i)}async setExpirations(t){await this.core.storage.setItem(this.storageKey,t)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Cr.sync)}async restore(){try{const t=await this.getExpirations();if(typeof t>"u"||!t.length)return;if(this.expirations.size){const{message:i}=Q("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(i),new Error(i)}this.cached=t,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(t){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(t)}}getExpiration(t){const i=this.expirations.get(t);if(!i){const{message:s}=Q("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(s),new Error(s)}return i}checkExpiry(t,i){const{expiry:s}=i;se.toMiliseconds(s)-Date.now()<=0&&this.expire(t,i)}expire(t,i){this.expirations.delete(t),this.events.emit(Cr.expired,{target:t,expiration:i})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((t,i)=>this.checkExpiry(i,t))}registerEventListeners(){this.core.heartbeat.on(mn.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(Cr.created,t=>{const i=Cr.created;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,data:t}),this.persist()}),this.events.on(Cr.expired,t=>{const i=Cr.expired;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,data:t}),this.persist()}),this.events.on(Cr.deleted,t=>{const i=Cr.deleted;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,data:t}),this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=Q("NOT_INITIALIZED",this.name);throw new Error(t)}}}class hE extends nw{constructor(t,i){super(t,i),this.projectId=t,this.logger=i,this.name=rc,this.initialized=!1,this.init=async s=>{jm()||!Kl()||(this.verifyUrl=(s==null?void 0:s.verifyUrl)||gl,await this.createIframe())},this.register=async s=>{var o;if(this.initialized||await this.init(),!!this.iframe)try{(o=this.iframe.contentWindow)==null||o.postMessage(s.attestationId,this.verifyUrl),this.logger.info(`postMessage sent: ${s.attestationId} ${this.verifyUrl}`)}catch{}},this.resolve=async s=>{var o;if(this.isDevEnv)return"";this.logger.info(`resolving attestation: ${s.attestationId}`);const h=this.startAbortTimer(se.FIVE_SECONDS),p=await fetch(`${this.verifyUrl}/attestation/${s.attestationId}`,{signal:this.abortController.signal});return clearTimeout(h),p.status===200?(o=await p.json())==null?void 0:o.origin:""},this.createIframe=async()=>{try{await Promise.race([new Promise((s,o)=>{if(document.getElementById(rc))return s();const h=document.createElement("iframe");h.setAttribute("id",rc),h.setAttribute("src",`${this.verifyUrl}/${this.projectId}`),h.style.display="none",h.addEventListener("load",()=>{this.initialized=!0,s()}),h.addEventListener("error",p=>{o(p)}),document.body.append(h),this.iframe=h}),new Promise(s=>{setTimeout(()=>s("iframe load timeout"),se.toMiliseconds(se.ONE_SECOND/2))})])}catch(s){this.logger.error(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.error(s)}},this.logger=Re.generateChildLogger(i,this.name),this.verifyUrl=gl,this.abortController=new AbortController,this.isDevEnv=zm()&&{}.IS_VITEST}get context(){return Re.getLoggerContext(this.logger)}startAbortTimer(t){return setTimeout(()=>this.abortController.abort(),se.toMiliseconds(t))}}var lE=Object.defineProperty,Il=Object.getOwnPropertySymbols,fE=Object.prototype.hasOwnProperty,pE=Object.prototype.propertyIsEnumerable,xl=(a,t,i)=>t in a?lE(a,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[t]=i,Sl=(a,t)=>{for(var i in t||(t={}))fE.call(t,i)&&xl(a,i,t[i]);if(Il)for(var i of Il(t))pE.call(t,i)&&xl(a,i,t[i]);return a};class Rc extends Y1{constructor(t){super(t),this.protocol=Tf,this.version=db,this.name=Oc,this.events=new vr.EventEmitter,this.initialized=!1,this.on=(s,o)=>this.events.on(s,o),this.once=(s,o)=>this.events.once(s,o),this.off=(s,o)=>this.events.off(s,o),this.removeListener=(s,o)=>this.events.removeListener(s,o),this.projectId=t==null?void 0:t.projectId,this.relayUrl=(t==null?void 0:t.relayUrl)||Df;const i=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Re.pino(Re.getDefaultLoggerOptions({level:(t==null?void 0:t.logger)||gb.logger}));this.logger=Re.generateChildLogger(i,this.name),this.heartbeat=new mn.HeartBeat,this.crypto=new Hb(this,this.logger,t==null?void 0:t.keychain),this.history=new cE(this,this.logger),this.expirer=new uE(this,this.logger),this.storage=t!=null&&t.storage?t.storage:new q1(Sl(Sl({},yb),t==null?void 0:t.storageOptions)),this.relayer=new iE({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new aE(this,this.logger),this.verify=new hE(this.projectId||"",this.logger)}static async init(t){const i=new Rc(t);await i.initialize();const s=await i.crypto.getClientId();return await i.storage.setItem(Nb,s),i}get context(){return Re.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(t){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,t),this.logger.error(t.message),t}}}const dE=Rc,Lf="wc",Ff=2,$f="client",Tc=`${Lf}@${Ff}:${$f}:`,nc={name:$f,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},gE="WALLETCONNECT_DEEPLINK_CHOICE",yE="proposal",Mf="Proposal expired",vE="session",ro=se.SEVEN_DAYS,mE="engine",Hn={wc_sessionPropose:{req:{ttl:se.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:se.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:se.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:se.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:se.ONE_DAY,prompt:!1,tag:1104},res:{ttl:se.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:se.ONE_DAY,prompt:!1,tag:1106},res:{ttl:se.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:se.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:se.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:se.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:se.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:se.ONE_DAY,prompt:!1,tag:1112},res:{ttl:se.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:se.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:se.THIRTY_SECONDS,prompt:!1,tag:1115}}},sc={min:se.FIVE_MINUTES,max:se.SEVEN_DAYS},wE="request",_E=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var bE=Object.defineProperty,EE=Object.defineProperties,IE=Object.getOwnPropertyDescriptors,Pl=Object.getOwnPropertySymbols,xE=Object.prototype.hasOwnProperty,SE=Object.prototype.propertyIsEnumerable,Al=(a,t,i)=>t in a?bE(a,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[t]=i,Ar=(a,t)=>{for(var i in t||(t={}))xE.call(t,i)&&Al(a,i,t[i]);if(Pl)for(var i of Pl(t))SE.call(t,i)&&Al(a,i,t[i]);return a},oc=(a,t)=>EE(a,IE(t));class PE extends ow{constructor(t){super(t),this.name=mE,this.events=new Ic,this.initialized=!1,this.ignoredPayloadTypes=[Hl],this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.client.core.pairing.register({methods:Object.keys(Hn)}),this.initialized=!0)},this.connect=async i=>{this.isInitialized();const s=oc(Ar({},i),{requiredNamespaces:i.requiredNamespaces||{},optionalNamespaces:i.optionalNamespaces||{}});await this.isValidConnect(s);const{pairingTopic:o,requiredNamespaces:h,optionalNamespaces:p,sessionProperties:g,relays:_}=s;let m=o,x,O=!1;if(m&&(O=this.client.core.pairing.pairings.get(m).active),!m||!O){const{topic:fe,uri:pe}=await this.client.core.pairing.create();m=fe,x=pe}const L=await this.client.core.crypto.generateKeyPair(),z=Ar({requiredNamespaces:h,optionalNamespaces:p,relays:_??[{protocol:Nf}],proposer:{publicKey:L,metadata:this.client.metadata}},g&&{sessionProperties:g}),{reject:R,resolve:K,done:re}=fn(se.FIVE_MINUTES,Mf);if(this.events.once(Ft("session_connect"),async({error:fe,session:pe})=>{if(fe)R(fe);else if(pe){pe.self.publicKey=L;const de=oc(Ar({},pe),{requiredNamespaces:pe.requiredNamespaces,optionalNamespaces:pe.optionalNamespaces});await this.client.session.set(pe.topic,de),await this.setExpiry(pe.topic,pe.expiry),m&&await this.client.core.pairing.updateMetadata({topic:m,metadata:pe.peer.metadata}),K(de)}}),!m){const{message:fe}=Q("NO_MATCHING_KEY",`connect() pairing topic: ${m}`);throw new Error(fe)}const he=await this.sendRequest(m,"wc_sessionPropose",z),le=$r(se.FIVE_MINUTES);return await this.setProposal(he,Ar({id:he,expiry:le},z)),{uri:x,approval:re}},this.pair=async i=>(this.isInitialized(),await this.client.core.pairing.pair(i)),this.approve=async i=>{this.isInitialized(),await this.isValidApprove(i);const{id:s,relayProtocol:o,namespaces:h,sessionProperties:p}=i,g=this.client.proposal.get(s);let{pairingTopic:_,proposer:m,requiredNamespaces:x,optionalNamespaces:O}=g;_=_||"",oo(x)||(x=qm(h,"approve()"));const L=await this.client.core.crypto.generateKeyPair(),z=m.publicKey,R=await this.client.core.crypto.generateSharedKey(L,z);_&&s&&(await this.client.core.pairing.updateMetadata({topic:_,metadata:m.metadata}),await this.sendResult(s,_,{relay:{protocol:o??"irn"},responderPublicKey:L}),await this.client.proposal.delete(s,rr("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:_}));const K=Ar({relay:{protocol:o??"irn"},namespaces:h,requiredNamespaces:x,optionalNamespaces:O,pairingTopic:_,controller:{publicKey:L,metadata:this.client.metadata},expiry:$r(ro)},p&&{sessionProperties:p});await this.client.core.relayer.subscribe(R),await this.sendRequest(R,"wc_sessionSettle",K);const re=oc(Ar({},K),{topic:R,pairingTopic:_,acknowledged:!1,self:K.controller,peer:{publicKey:m.publicKey,metadata:m.metadata},controller:L});return await this.client.session.set(R,re),await this.setExpiry(R,$r(ro)),{topic:R,acknowledged:()=>new Promise(he=>setTimeout(()=>he(this.client.session.get(R)),500))}},this.reject=async i=>{this.isInitialized(),await this.isValidReject(i);const{id:s,reason:o}=i,{pairingTopic:h}=this.client.proposal.get(s);h&&(await this.sendError(s,h,o),await this.client.proposal.delete(s,rr("USER_DISCONNECTED")))},this.update=async i=>{this.isInitialized(),await this.isValidUpdate(i);const{topic:s,namespaces:o}=i,h=await this.sendRequest(s,"wc_sessionUpdate",{namespaces:o}),{done:p,resolve:g,reject:_}=fn();return this.events.once(Ft("session_update",h),({error:m})=>{m?_(m):g()}),await this.client.session.update(s,{namespaces:o}),{acknowledged:p}},this.extend=async i=>{this.isInitialized(),await this.isValidExtend(i);const{topic:s}=i,o=await this.sendRequest(s,"wc_sessionExtend",{}),{done:h,resolve:p,reject:g}=fn();return this.events.once(Ft("session_extend",o),({error:_})=>{_?g(_):p()}),await this.setExpiry(s,$r(ro)),{acknowledged:h}},this.request=async i=>{this.isInitialized(),await this.isValidRequest(i);const{chainId:s,request:o,topic:h,expiry:p}=i,g=await this.sendRequest(h,"wc_sessionRequest",{request:o,chainId:s},p),{done:_,resolve:m,reject:x}=fn(p);this.events.once(Ft("session_request",g),({error:L,result:z})=>{L?x(L):m(z)}),this.client.events.emit("session_request_sent",{topic:h,request:o,chainId:s,id:g});const O=await this.client.core.storage.getItem(gE);return Bm({id:g,topic:h,wcDeepLink:O}),await _()},this.respond=async i=>{this.isInitialized(),await this.isValidRespond(i);const{topic:s,response:o}=i,{id:h}=o;ci(o)?await this.sendResult(h,s,o.result):Mr(o)&&await this.sendError(h,s,o.error),this.deletePendingSessionRequest(i.response.id,{message:"fulfilled",code:0})},this.ping=async i=>{this.isInitialized(),await this.isValidPing(i);const{topic:s}=i;if(this.client.session.keys.includes(s)){const o=await this.sendRequest(s,"wc_sessionPing",{}),{done:h,resolve:p,reject:g}=fn();this.events.once(Ft("session_ping",o),({error:_})=>{_?g(_):p()}),await h()}else this.client.core.pairing.pairings.keys.includes(s)&&await this.client.core.pairing.ping({topic:s})},this.emit=async i=>{this.isInitialized(),await this.isValidEmit(i);const{topic:s,event:o,chainId:h}=i;await this.sendRequest(s,"wc_sessionEvent",{event:o,chainId:h})},this.disconnect=async i=>{this.isInitialized(),await this.isValidDisconnect(i);const{topic:s}=i;if(this.client.session.keys.includes(s)){const o=Pc().toString();let h;const p=g=>{(g==null?void 0:g.id.toString())===o&&(this.client.core.relayer.events.removeListener(mt.message_ack,p),h())};await Promise.all([new Promise(g=>{h=g,this.client.core.relayer.on(mt.message_ack,p)}),this.sendRequest(s,"wc_sessionDelete",rr("USER_DISCONNECTED"),void 0,o)]),await this.deleteSession(s)}else await this.client.core.pairing.disconnect({topic:s})},this.find=i=>(this.isInitialized(),this.client.session.getAll().filter(s=>Hm(s,i))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=async i=>{if(i.pairingTopic)try{const s=this.client.core.pairing.pairings.get(i.pairingTopic),o=this.client.core.pairing.pairings.getAll().filter(h=>{var p,g;return((p=h.peerMetadata)==null?void 0:p.url)&&((g=h.peerMetadata)==null?void 0:g.url)===i.peer.metadata.url&&h.topic&&h.topic!==s.topic});if(o.length===0)return;this.client.logger.info(`Cleaning up ${o.length} duplicate pairing(s)`),await Promise.all(o.map(h=>this.client.core.pairing.disconnect({topic:h.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(s){this.client.logger.error(s)}},this.deleteSession=async(i,s)=>{const{self:o}=this.client.session.get(i);await this.client.core.relayer.unsubscribe(i),this.client.session.delete(i,rr("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(o.publicKey)&&await this.client.core.crypto.deleteKeyPair(o.publicKey),this.client.core.crypto.keychain.has(i)&&await this.client.core.crypto.deleteSymKey(i),s||this.client.core.expirer.del(i)},this.deleteProposal=async(i,s)=>{await Promise.all([this.client.proposal.delete(i,rr("USER_DISCONNECTED")),s?Promise.resolve():this.client.core.expirer.del(i)])},this.deletePendingSessionRequest=async(i,s,o=!1)=>{await Promise.all([this.client.pendingRequest.delete(i,s),o?Promise.resolve():this.client.core.expirer.del(i)])},this.setExpiry=async(i,s)=>{this.client.session.keys.includes(i)&&await this.client.session.update(i,{expiry:s}),this.client.core.expirer.set(i,s)},this.setProposal=async(i,s)=>{await this.client.proposal.set(i,s),this.client.core.expirer.set(i,s.expiry)},this.setPendingSessionRequest=async i=>{const s=Hn.wc_sessionRequest.req.ttl,{id:o,topic:h,params:p}=i;await this.client.pendingRequest.set(o,{id:o,topic:h,params:p}),s&&this.client.core.expirer.set(o,$r(s))},this.sendRequest=async(i,s,o,h,p)=>{const g=mo(s,o);if(Kl()&&_E.includes(s)){const x=dn(JSON.stringify(g));await this.client.core.verify.register({attestationId:x})}const _=await this.client.core.crypto.encode(i,g),m=Hn[s].req;return h&&(m.ttl=h),p&&(m.id=p),this.client.core.history.set(i,g),this.client.core.relayer.publish(i,_,m),g.id},this.sendResult=async(i,s,o)=>{const h=Ac(i,o),p=await this.client.core.crypto.encode(s,h),g=await this.client.core.history.get(s,i),_=Hn[g.request.method].res;this.client.core.relayer.publish(s,p,_),await this.client.core.history.resolve(h)},this.sendError=async(i,s,o)=>{const h=wo(i,o),p=await this.client.core.crypto.encode(s,h),g=await this.client.core.history.get(s,i),_=Hn[g.request.method].res;this.client.core.relayer.publish(s,p,_),await this.client.core.history.resolve(h)},this.cleanup=async()=>{const i=[],s=[];this.client.session.getAll().forEach(o=>{_i(o.expiry)&&i.push(o.topic)}),this.client.proposal.getAll().forEach(o=>{_i(o.expiry)&&s.push(o.id)}),await Promise.all([...i.map(o=>this.deleteSession(o)),...s.map(o=>this.deleteProposal(o))])},this.onRelayEventRequest=i=>{const{topic:s,payload:o}=i,h=o.method;switch(h){case"wc_sessionPropose":return this.onSessionProposeRequest(s,o);case"wc_sessionSettle":return this.onSessionSettleRequest(s,o);case"wc_sessionUpdate":return this.onSessionUpdateRequest(s,o);case"wc_sessionExtend":return this.onSessionExtendRequest(s,o);case"wc_sessionPing":return this.onSessionPingRequest(s,o);case"wc_sessionDelete":return this.onSessionDeleteRequest(s,o);case"wc_sessionRequest":return this.onSessionRequest(s,o);case"wc_sessionEvent":return this.onSessionEventRequest(s,o);default:return this.client.logger.info(`Unsupported request method ${h}`)}},this.onRelayEventResponse=async i=>{const{topic:s,payload:o}=i,h=(await this.client.core.history.get(s,o.id)).request.method;switch(h){case"wc_sessionPropose":return this.onSessionProposeResponse(s,o);case"wc_sessionSettle":return this.onSessionSettleResponse(s,o);case"wc_sessionUpdate":return this.onSessionUpdateResponse(s,o);case"wc_sessionExtend":return this.onSessionExtendResponse(s,o);case"wc_sessionPing":return this.onSessionPingResponse(s,o);case"wc_sessionRequest":return this.onSessionRequestResponse(s,o);default:return this.client.logger.info(`Unsupported response method ${h}`)}},this.onRelayEventUnknownPayload=i=>{const{topic:s}=i,{message:o}=Q("MISSING_OR_INVALID",`Decoded payload on topic ${s} is not identifiable as a JSON-RPC request or a response.`);throw new Error(o)},this.onSessionProposeRequest=async(i,s)=>{const{params:o,id:h}=s;try{this.isValidConnect(Ar({},s.params));const p=$r(se.FIVE_MINUTES),g=Ar({id:h,pairingTopic:i,expiry:p},o);await this.setProposal(h,g);const _=dn(JSON.stringify(s)),m=await this.getVerifyContext(_,g.proposer.metadata);this.client.events.emit("session_proposal",{id:h,params:g,verifyContext:m})}catch(p){await this.sendError(h,i,p),this.client.logger.error(p)}},this.onSessionProposeResponse=async(i,s)=>{const{id:o}=s;if(ci(s)){const{result:h}=s;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:h});const p=this.client.proposal.get(o);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:p});const g=p.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:g});const _=h.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:_});const m=await this.client.core.crypto.generateSharedKey(g,_);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:m});const x=await this.client.core.relayer.subscribe(m);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:x}),await this.client.core.pairing.activate({topic:i})}else Mr(s)&&(await this.client.proposal.delete(o,rr("USER_DISCONNECTED")),this.events.emit(Ft("session_connect"),{error:s.error}))},this.onSessionSettleRequest=async(i,s)=>{const{id:o,params:h}=s;try{this.isValidSessionSettleRequest(h);const{relay:p,controller:g,expiry:_,namespaces:m,requiredNamespaces:x,optionalNamespaces:O,sessionProperties:L,pairingTopic:z}=s.params,R=Ar({topic:i,relay:p,expiry:_,namespaces:m,acknowledged:!0,pairingTopic:z,requiredNamespaces:x,optionalNamespaces:O,controller:g.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:g.publicKey,metadata:g.metadata}},L&&{sessionProperties:L});await this.sendResult(s.id,i,!0),this.events.emit(Ft("session_connect"),{session:R}),this.cleanupDuplicatePairings(R)}catch(p){await this.sendError(o,i,p),this.client.logger.error(p)}},this.onSessionSettleResponse=async(i,s)=>{const{id:o}=s;ci(s)?(await this.client.session.update(i,{acknowledged:!0}),this.events.emit(Ft("session_approve",o),{})):Mr(s)&&(await this.client.session.delete(i,rr("USER_DISCONNECTED")),this.events.emit(Ft("session_approve",o),{error:s.error}))},this.onSessionUpdateRequest=async(i,s)=>{const{params:o,id:h}=s;try{this.isValidUpdate(Ar({topic:i},o)),await this.client.session.update(i,{namespaces:o.namespaces}),await this.sendResult(h,i,!0),this.client.events.emit("session_update",{id:h,topic:i,params:o})}catch(p){await this.sendError(h,i,p),this.client.logger.error(p)}},this.onSessionUpdateResponse=(i,s)=>{const{id:o}=s;ci(s)?this.events.emit(Ft("session_update",o),{}):Mr(s)&&this.events.emit(Ft("session_update",o),{error:s.error})},this.onSessionExtendRequest=async(i,s)=>{const{id:o}=s;try{this.isValidExtend({topic:i}),await this.setExpiry(i,$r(ro)),await this.sendResult(o,i,!0),this.client.events.emit("session_extend",{id:o,topic:i})}catch(h){await this.sendError(o,i,h),this.client.logger.error(h)}},this.onSessionExtendResponse=(i,s)=>{const{id:o}=s;ci(s)?this.events.emit(Ft("session_extend",o),{}):Mr(s)&&this.events.emit(Ft("session_extend",o),{error:s.error})},this.onSessionPingRequest=async(i,s)=>{const{id:o}=s;try{this.isValidPing({topic:i}),await this.sendResult(o,i,!0),this.client.events.emit("session_ping",{id:o,topic:i})}catch(h){await this.sendError(o,i,h),this.client.logger.error(h)}},this.onSessionPingResponse=(i,s)=>{const{id:o}=s;setTimeout(()=>{ci(s)?this.events.emit(Ft("session_ping",o),{}):Mr(s)&&this.events.emit(Ft("session_ping",o),{error:s.error})},500)},this.onSessionDeleteRequest=async(i,s)=>{const{id:o}=s;try{this.isValidDisconnect({topic:i,reason:s.params}),await Promise.all([new Promise(h=>{this.client.core.relayer.once(mt.publish,async()=>{h(await this.deleteSession(i))})}),this.sendResult(o,i,!0)]),this.client.events.emit("session_delete",{id:o,topic:i})}catch(h){this.client.logger.error(h)}},this.onSessionRequest=async(i,s)=>{const{id:o,params:h}=s;try{this.isValidRequest(Ar({topic:i},h)),await this.setPendingSessionRequest({id:o,topic:i,params:h});const p=dn(JSON.stringify(s)),g=this.client.session.get(i),_=await this.getVerifyContext(p,g.peer.metadata);this.client.events.emit("session_request",{id:o,topic:i,params:h,verifyContext:_})}catch(p){await this.sendError(o,i,p),this.client.logger.error(p)}},this.onSessionRequestResponse=(i,s)=>{const{id:o}=s;ci(s)?this.events.emit(Ft("session_request",o),{result:s.result}):Mr(s)&&this.events.emit(Ft("session_request",o),{error:s.error})},this.onSessionEventRequest=async(i,s)=>{const{id:o,params:h}=s;try{this.isValidEmit(Ar({topic:i},h)),this.client.events.emit("session_event",{id:o,topic:i,params:h})}catch(p){await this.sendError(o,i,p),this.client.logger.error(p)}},this.isValidConnect=async i=>{if(!hr(i)){const{message:_}=Q("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(i)}`);throw new Error(_)}const{pairingTopic:s,requiredNamespaces:o,optionalNamespaces:h,sessionProperties:p,relays:g}=i;if(bi(s)||await this.isValidPairingTopic(s),!km(g,!0)){const{message:_}=Q("MISSING_OR_INVALID",`connect() relays: ${g}`);throw new Error(_)}!bi(o)&&oo(o)!==0&&this.validateNamespaces(o,"requiredNamespaces"),!bi(h)&&oo(h)!==0&&this.validateNamespaces(h,"optionalNamespaces"),bi(p)||this.validateSessionProps(p,"sessionProperties")},this.validateNamespaces=(i,s)=>{const o=Km(i,"connect()",s);if(o)throw new Error(o.message)},this.isValidApprove=async i=>{if(!hr(i))throw new Error(Q("MISSING_OR_INVALID",`approve() params: ${i}`).message);const{id:s,namespaces:o,relayProtocol:h,sessionProperties:p}=i;await this.isValidProposalId(s);const g=this.client.proposal.get(s),_=Ga(o,"approve()");if(_)throw new Error(_.message);const m=Fh(g.requiredNamespaces,o,"approve()");if(m)throw new Error(m.message);if(!pn(h,!0)){const{message:x}=Q("MISSING_OR_INVALID",`approve() relayProtocol: ${h}`);throw new Error(x)}bi(p)||this.validateSessionProps(p,"sessionProperties")},this.isValidReject=async i=>{if(!hr(i)){const{message:h}=Q("MISSING_OR_INVALID",`reject() params: ${i}`);throw new Error(h)}const{id:s,reason:o}=i;if(await this.isValidProposalId(s),!Vm(o)){const{message:h}=Q("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(o)}`);throw new Error(h)}},this.isValidSessionSettleRequest=i=>{if(!hr(i)){const{message:m}=Q("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${i}`);throw new Error(m)}const{relay:s,controller:o,namespaces:h,expiry:p}=i;if(!Gm(s)){const{message:m}=Q("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(m)}const g=Wm(o,"onSessionSettleRequest()");if(g)throw new Error(g.message);const _=Ga(h,"onSessionSettleRequest()");if(_)throw new Error(_.message);if(_i(p)){const{message:m}=Q("EXPIRED","onSessionSettleRequest()");throw new Error(m)}},this.isValidUpdate=async i=>{if(!hr(i)){const{message:_}=Q("MISSING_OR_INVALID",`update() params: ${i}`);throw new Error(_)}const{topic:s,namespaces:o}=i;await this.isValidSessionTopic(s);const h=this.client.session.get(s),p=Ga(o,"update()");if(p)throw new Error(p.message);const g=Fh(h.requiredNamespaces,o,"update()");if(g)throw new Error(g.message)},this.isValidExtend=async i=>{if(!hr(i)){const{message:o}=Q("MISSING_OR_INVALID",`extend() params: ${i}`);throw new Error(o)}const{topic:s}=i;await this.isValidSessionTopic(s)},this.isValidRequest=async i=>{if(!hr(i)){const{message:_}=Q("MISSING_OR_INVALID",`request() params: ${i}`);throw new Error(_)}const{topic:s,request:o,chainId:h,expiry:p}=i;await this.isValidSessionTopic(s);const{namespaces:g}=this.client.session.get(s);if(!$h(g,h)){const{message:_}=Q("MISSING_OR_INVALID",`request() chainId: ${h}`);throw new Error(_)}if(!Jm(o)){const{message:_}=Q("MISSING_OR_INVALID",`request() ${JSON.stringify(o)}`);throw new Error(_)}if(!Ym(g,h,o.method)){const{message:_}=Q("MISSING_OR_INVALID",`request() method: ${o.method}`);throw new Error(_)}if(p&&!Xm(p,sc)){const{message:_}=Q("MISSING_OR_INVALID",`request() expiry: ${p}. Expiry must be a number (in seconds) between ${sc.min} and ${sc.max}`);throw new Error(_)}},this.isValidRespond=async i=>{if(!hr(i)){const{message:h}=Q("MISSING_OR_INVALID",`respond() params: ${i}`);throw new Error(h)}const{topic:s,response:o}=i;if(await this.isValidSessionTopic(s),!Zm(o)){const{message:h}=Q("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(o)}`);throw new Error(h)}},this.isValidPing=async i=>{if(!hr(i)){const{message:o}=Q("MISSING_OR_INVALID",`ping() params: ${i}`);throw new Error(o)}const{topic:s}=i;await this.isValidSessionOrPairingTopic(s)},this.isValidEmit=async i=>{if(!hr(i)){const{message:g}=Q("MISSING_OR_INVALID",`emit() params: ${i}`);throw new Error(g)}const{topic:s,event:o,chainId:h}=i;await this.isValidSessionTopic(s);const{namespaces:p}=this.client.session.get(s);if(!$h(p,h)){const{message:g}=Q("MISSING_OR_INVALID",`emit() chainId: ${h}`);throw new Error(g)}if(!Qm(o)){const{message:g}=Q("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(g)}if(!e1(p,h,o.name)){const{message:g}=Q("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(g)}},this.isValidDisconnect=async i=>{if(!hr(i)){const{message:o}=Q("MISSING_OR_INVALID",`disconnect() params: ${i}`);throw new Error(o)}const{topic:s}=i;await this.isValidSessionOrPairingTopic(s)},this.getVerifyContext=async(i,s)=>{const o={verified:{verifyUrl:s.verifyUrl||"",validation:"UNKNOWN",origin:s.url||""}};try{const h=await this.client.core.verify.resolve({attestationId:i,verifyUrl:s.verifyUrl});h&&(o.verified.origin=h,o.verified.validation=h===s.url?"VALID":"INVALID")}catch(h){this.client.logger.error(h)}return this.client.logger.info(`Verify context: ${JSON.stringify(o)}`),o},this.validateSessionProps=(i,s)=>{Object.values(i).forEach(o=>{if(!pn(o,!1)){const{message:h}=Q("MISSING_OR_INVALID",`${s} must be in Record<string, string> format. Received: ${JSON.stringify(o)}`);throw new Error(h)}})}}isInitialized(){if(!this.initialized){const{message:t}=Q("NOT_INITIALIZED",this.name);throw new Error(t)}}registerRelayerEvents(){this.client.core.relayer.on(mt.message,async t=>{const{topic:i,message:s}=t;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(s)))return;const o=await this.client.core.crypto.decode(i,s);Cc(o)?(this.client.core.history.set(i,o),this.onRelayEventRequest({topic:i,payload:o})):_o(o)?(await this.client.core.history.resolve(o),await this.onRelayEventResponse({topic:i,payload:o}),this.client.core.history.delete(i,o.id)):this.onRelayEventUnknownPayload({topic:i,payload:o})})}registerExpirerEvents(){this.client.core.expirer.on(Cr.expired,async t=>{const{topic:i,id:s}=kl(t.target);if(s&&this.client.pendingRequest.keys.includes(s))return await this.deletePendingSessionRequest(s,Q("EXPIRED"),!0);i?this.client.session.keys.includes(i)&&(await this.deleteSession(i,!0),this.client.events.emit("session_expire",{topic:i})):s&&(await this.deleteProposal(s,!0),this.client.events.emit("proposal_expire",{id:s}))})}isValidPairingTopic(t){if(!pn(t,!1)){const{message:i}=Q("MISSING_OR_INVALID",`pairing topic should be a string: ${t}`);throw new Error(i)}if(!this.client.core.pairing.pairings.keys.includes(t)){const{message:i}=Q("NO_MATCHING_KEY",`pairing topic doesn't exist: ${t}`);throw new Error(i)}if(_i(this.client.core.pairing.pairings.get(t).expiry)){const{message:i}=Q("EXPIRED",`pairing topic: ${t}`);throw new Error(i)}}async isValidSessionTopic(t){if(!pn(t,!1)){const{message:i}=Q("MISSING_OR_INVALID",`session topic should be a string: ${t}`);throw new Error(i)}if(!this.client.session.keys.includes(t)){const{message:i}=Q("NO_MATCHING_KEY",`session topic doesn't exist: ${t}`);throw new Error(i)}if(_i(this.client.session.get(t).expiry)){await this.deleteSession(t);const{message:i}=Q("EXPIRED",`session topic: ${t}`);throw new Error(i)}}async isValidSessionOrPairingTopic(t){if(this.client.session.keys.includes(t))await this.isValidSessionTopic(t);else if(this.client.core.pairing.pairings.keys.includes(t))this.isValidPairingTopic(t);else if(pn(t,!1)){const{message:i}=Q("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${t}`);throw new Error(i)}else{const{message:i}=Q("MISSING_OR_INVALID",`session or pairing topic should be a string: ${t}`);throw new Error(i)}}async isValidProposalId(t){if(!t1(t)){const{message:i}=Q("MISSING_OR_INVALID",`proposal id should be a number: ${t}`);throw new Error(i)}if(!this.client.proposal.keys.includes(t)){const{message:i}=Q("NO_MATCHING_KEY",`proposal id doesn't exist: ${t}`);throw new Error(i)}if(_i(this.client.proposal.get(t).expiry)){await this.deleteProposal(t);const{message:i}=Q("EXPIRED",`proposal id: ${t}`);throw new Error(i)}}}class AE extends Eo{constructor(t,i){super(t,i,yE,Tc),this.core=t,this.logger=i}}class CE extends Eo{constructor(t,i){super(t,i,vE,Tc),this.core=t,this.logger=i}}class OE extends Eo{constructor(t,i){super(t,i,wE,Tc,s=>s.id),this.core=t,this.logger=i}}let RE=class jf extends sw{constructor(t){super(t),this.protocol=Lf,this.version=Ff,this.name=nc.name,this.events=new vr.EventEmitter,this.on=(s,o)=>this.events.on(s,o),this.once=(s,o)=>this.events.once(s,o),this.off=(s,o)=>this.events.off(s,o),this.removeListener=(s,o)=>this.events.removeListener(s,o),this.removeAllListeners=s=>this.events.removeAllListeners(s),this.connect=async s=>{try{return await this.engine.connect(s)}catch(o){throw this.logger.error(o.message),o}},this.pair=async s=>{try{return await this.engine.pair(s)}catch(o){throw this.logger.error(o.message),o}},this.approve=async s=>{try{return await this.engine.approve(s)}catch(o){throw this.logger.error(o.message),o}},this.reject=async s=>{try{return await this.engine.reject(s)}catch(o){throw this.logger.error(o.message),o}},this.update=async s=>{try{return await this.engine.update(s)}catch(o){throw this.logger.error(o.message),o}},this.extend=async s=>{try{return await this.engine.extend(s)}catch(o){throw this.logger.error(o.message),o}},this.request=async s=>{try{return await this.engine.request(s)}catch(o){throw this.logger.error(o.message),o}},this.respond=async s=>{try{return await this.engine.respond(s)}catch(o){throw this.logger.error(o.message),o}},this.ping=async s=>{try{return await this.engine.ping(s)}catch(o){throw this.logger.error(o.message),o}},this.emit=async s=>{try{return await this.engine.emit(s)}catch(o){throw this.logger.error(o.message),o}},this.disconnect=async s=>{try{return await this.engine.disconnect(s)}catch(o){throw this.logger.error(o.message),o}},this.find=s=>{try{return this.engine.find(s)}catch(o){throw this.logger.error(o.message),o}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(s){throw this.logger.error(s.message),s}},this.name=(t==null?void 0:t.name)||nc.name,this.metadata=(t==null?void 0:t.metadata)||Um();const i=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Re.pino(Re.getDefaultLoggerOptions({level:(t==null?void 0:t.logger)||nc.logger}));this.core=(t==null?void 0:t.core)||new dE(t),this.logger=Re.generateChildLogger(i,this.name),this.session=new CE(this.core,this.logger),this.proposal=new AE(this.core,this.logger),this.pendingRequest=new OE(this.core,this.logger),this.engine=new PE(this)}static async init(t){const i=new jf(t);return await i.initialize(),i}get context(){return Re.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(t){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(t.message),t}}};var gc={exports:{}};(function(a,t){var i=typeof self<"u"?self:jr,s=function(){function h(){this.fetch=!1,this.DOMException=i.DOMException}return h.prototype=i,new h}();(function(h){(function(p){var g={searchParams:"URLSearchParams"in h,iterable:"Symbol"in h&&"iterator"in Symbol,blob:"FileReader"in h&&"Blob"in h&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in h,arrayBuffer:"ArrayBuffer"in h};function _(v){return v&&DataView.prototype.isPrototypeOf(v)}if(g.arrayBuffer)var m=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],x=ArrayBuffer.isView||function(v){return v&&m.indexOf(Object.prototype.toString.call(v))>-1};function O(v){if(typeof v!="string"&&(v=String(v)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(v))throw new TypeError("Invalid character in header field name");return v.toLowerCase()}function L(v){return typeof v!="string"&&(v=String(v)),v}function z(v){var I={next:function(){var X=v.shift();return{done:X===void 0,value:X}}};return g.iterable&&(I[Symbol.iterator]=function(){return I}),I}function R(v){this.map={},v instanceof R?v.forEach(function(I,X){this.append(X,I)},this):Array.isArray(v)?v.forEach(function(I){this.append(I[0],I[1])},this):v&&Object.getOwnPropertyNames(v).forEach(function(I){this.append(I,v[I])},this)}R.prototype.append=function(v,I){v=O(v),I=L(I);var X=this.map[v];this.map[v]=X?X+", "+I:I},R.prototype.delete=function(v){delete this.map[O(v)]},R.prototype.get=function(v){return v=O(v),this.has(v)?this.map[v]:null},R.prototype.has=function(v){return this.map.hasOwnProperty(O(v))},R.prototype.set=function(v,I){this.map[O(v)]=L(I)},R.prototype.forEach=function(v,I){for(var X in this.map)this.map.hasOwnProperty(X)&&v.call(I,this.map[X],X,this)},R.prototype.keys=function(){var v=[];return this.forEach(function(I,X){v.push(X)}),z(v)},R.prototype.values=function(){var v=[];return this.forEach(function(I){v.push(I)}),z(v)},R.prototype.entries=function(){var v=[];return this.forEach(function(I,X){v.push([X,I])}),z(v)},g.iterable&&(R.prototype[Symbol.iterator]=R.prototype.entries);function K(v){if(v.bodyUsed)return Promise.reject(new TypeError("Already read"));v.bodyUsed=!0}function re(v){return new Promise(function(I,X){v.onload=function(){I(v.result)},v.onerror=function(){X(v.error)}})}function he(v){var I=new FileReader,X=re(I);return I.readAsArrayBuffer(v),X}function le(v){var I=new FileReader,X=re(I);return I.readAsText(v),X}function fe(v){for(var I=new Uint8Array(v),X=new Array(I.length),ce=0;ce<I.length;ce++)X[ce]=String.fromCharCode(I[ce]);return X.join("")}function pe(v){if(v.slice)return v.slice(0);var I=new Uint8Array(v.byteLength);return I.set(new Uint8Array(v)),I.buffer}function de(){return this.bodyUsed=!1,this._initBody=function(v){this._bodyInit=v,v?typeof v=="string"?this._bodyText=v:g.blob&&Blob.prototype.isPrototypeOf(v)?this._bodyBlob=v:g.formData&&FormData.prototype.isPrototypeOf(v)?this._bodyFormData=v:g.searchParams&&URLSearchParams.prototype.isPrototypeOf(v)?this._bodyText=v.toString():g.arrayBuffer&&g.blob&&_(v)?(this._bodyArrayBuffer=pe(v.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):g.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(v)||x(v))?this._bodyArrayBuffer=pe(v):this._bodyText=v=Object.prototype.toString.call(v):this._bodyText="",this.headers.get("content-type")||(typeof v=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):g.searchParams&&URLSearchParams.prototype.isPrototypeOf(v)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},g.blob&&(this.blob=function(){var v=K(this);if(v)return v;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?K(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(he)}),this.text=function(){var v=K(this);if(v)return v;if(this._bodyBlob)return le(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(fe(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},g.formData&&(this.formData=function(){return this.text().then(ve)}),this.json=function(){return this.text().then(JSON.parse)},this}var F=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function q(v){var I=v.toUpperCase();return F.indexOf(I)>-1?I:v}function W(v,I){I=I||{};var X=I.body;if(v instanceof W){if(v.bodyUsed)throw new TypeError("Already read");this.url=v.url,this.credentials=v.credentials,I.headers||(this.headers=new R(v.headers)),this.method=v.method,this.mode=v.mode,this.signal=v.signal,!X&&v._bodyInit!=null&&(X=v._bodyInit,v.bodyUsed=!0)}else this.url=String(v);if(this.credentials=I.credentials||this.credentials||"same-origin",(I.headers||!this.headers)&&(this.headers=new R(I.headers)),this.method=q(I.method||this.method||"GET"),this.mode=I.mode||this.mode||null,this.signal=I.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&X)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(X)}W.prototype.clone=function(){return new W(this,{body:this._bodyInit})};function ve(v){var I=new FormData;return v.trim().split("&").forEach(function(X){if(X){var ce=X.split("="),V=ce.shift().replace(/\+/g," "),B=ce.join("=").replace(/\+/g," ");I.append(decodeURIComponent(V),decodeURIComponent(B))}}),I}function ie(v){var I=new R,X=v.replace(/\r?\n[\t ]+/g," ");return X.split(/\r?\n/).forEach(function(ce){var V=ce.split(":"),B=V.shift().trim();if(B){var k=V.join(":").trim();I.append(B,k)}}),I}de.call(W.prototype);function ue(v,I){I||(I={}),this.type="default",this.status=I.status===void 0?200:I.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in I?I.statusText:"OK",this.headers=new R(I.headers),this.url=I.url||"",this._initBody(v)}de.call(ue.prototype),ue.prototype.clone=function(){return new ue(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new R(this.headers),url:this.url})},ue.error=function(){var v=new ue(null,{status:0,statusText:""});return v.type="error",v};var Te=[301,302,303,307,308];ue.redirect=function(v,I){if(Te.indexOf(I)===-1)throw new RangeError("Invalid status code");return new ue(null,{status:I,headers:{location:v}})},p.DOMException=h.DOMException;try{new p.DOMException}catch{p.DOMException=function(I,X){this.message=I,this.name=X;var ce=Error(I);this.stack=ce.stack},p.DOMException.prototype=Object.create(Error.prototype),p.DOMException.prototype.constructor=p.DOMException}function Ue(v,I){return new Promise(function(X,ce){var V=new W(v,I);if(V.signal&&V.signal.aborted)return ce(new p.DOMException("Aborted","AbortError"));var B=new XMLHttpRequest;function k(){B.abort()}B.onload=function(){var G={status:B.status,statusText:B.statusText,headers:ie(B.getAllResponseHeaders()||"")};G.url="responseURL"in B?B.responseURL:G.headers.get("X-Request-URL");var Ye="response"in B?B.response:B.responseText;X(new ue(Ye,G))},B.onerror=function(){ce(new TypeError("Network request failed"))},B.ontimeout=function(){ce(new TypeError("Network request failed"))},B.onabort=function(){ce(new p.DOMException("Aborted","AbortError"))},B.open(V.method,V.url,!0),V.credentials==="include"?B.withCredentials=!0:V.credentials==="omit"&&(B.withCredentials=!1),"responseType"in B&&g.blob&&(B.responseType="blob"),V.headers.forEach(function(G,Ye){B.setRequestHeader(Ye,G)}),V.signal&&(V.signal.addEventListener("abort",k),B.onreadystatechange=function(){B.readyState===4&&V.signal.removeEventListener("abort",k)}),B.send(typeof V._bodyInit>"u"?null:V._bodyInit)})}return Ue.polyfill=!0,h.fetch||(h.fetch=Ue,h.Headers=R,h.Request=W,h.Response=ue),p.Headers=R,p.Request=W,p.Response=ue,p.fetch=Ue,Object.defineProperty(p,"__esModule",{value:!0}),p})({})})(s),s.fetch.ponyfill=!0,delete s.fetch.polyfill;var o=s;t=o.fetch,t.default=o.fetch,t.fetch=o.fetch,t.Headers=o.Headers,t.Request=o.Request,t.Response=o.Response,a.exports=t})(gc,gc.exports);var TE=gc.exports;const Cl=_c(TE),NE={Accept:"application/json","Content-Type":"application/json"},DE="POST",Ol={headers:NE,method:DE},Rl=10;class ki{constructor(t,i=!1){if(this.url=t,this.disableProviderPing=i,this.events=new vr.EventEmitter,this.isAvailable=!1,this.registering=!1,!il(t))throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);this.url=t,this.disableProviderPing=i}get connected(){return this.isAvailable}get connecting(){return this.registering}on(t,i){this.events.on(t,i)}once(t,i){this.events.once(t,i)}off(t,i){this.events.off(t,i)}removeListener(t,i){this.events.removeListener(t,i)}async open(t=this.url){await this.register(t)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(t,i){this.isAvailable||await this.register();try{const s=qi(t),h=await(await Cl(this.url,Object.assign(Object.assign({},Ol),{body:s}))).json();this.onPayload({data:h})}catch(s){this.onError(t.id,s)}}async register(t=this.url){if(!il(t))throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);if(this.registering){const i=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=i||this.events.listenerCount("open")>=i)&&this.events.setMaxListeners(i+1),new Promise((s,o)=>{this.events.once("register_error",h=>{this.resetMaxListeners(),o(h)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return o(new Error("HTTP connection is missing or invalid"));s()})})}this.url=t,this.registering=!0;try{if(!this.disableProviderPing){const i=qi({id:1,jsonrpc:"2.0",method:"test",params:[]});await Cl(t,Object.assign(Object.assign({},Ol),{body:i}))}this.onOpen()}catch(i){const s=this.parseError(i);throw this.events.emit("register_error",s),this.onClose(),s}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(t){if(typeof t.data>"u")return;const i=typeof t.data=="string"?Wn(t.data):t.data;this.events.emit("payload",i)}onError(t,i){const s=this.parseError(i),o=s.message||s.toString(),h=wo(t,o);this.events.emit("payload",h)}parseError(t,i=this.url){return gf(t,i,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>Rl&&this.events.setMaxListeners(Rl)}}const Tl="error",LE="wss://relay.walletconnect.com",FE="wc",$E="universal_provider",Nl=`${FE}@2:${$E}:`,ME="https://rpc.walletconnect.com/v1",xi={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var kn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},yc={exports:{}};/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(a,t){(function(){var i,s="4.17.21",o=200,h="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",p="Expected a function",g="Invalid `variable` option passed into `_.template`",_="__lodash_hash_undefined__",m=500,x="__lodash_placeholder__",O=1,L=2,z=4,R=1,K=2,re=1,he=2,le=4,fe=8,pe=16,de=32,F=64,q=128,W=256,ve=512,ie=30,ue="...",Te=800,Ue=16,v=1,I=2,X=3,ce=1/0,V=9007199254740991,B=17976931348623157e292,k=0/0,G=4294967295,Ye=G-1,ke=G>>>1,zr=[["ary",q],["bind",re],["bindKey",he],["curry",fe],["curryRight",pe],["flip",ve],["partial",de],["partialRight",F],["rearg",W]],Ie="[object Arguments]",St="[object Array]",D="[object AsyncFunction]",N="[object Boolean]",C="[object Date]",u="[object DOMException]",E="[object Error]",ee="[object Function]",ge="[object GeneratorFunction]",be="[object Map]",Ne="[object Number]",Le="[object Null]",Pe="[object Object]",Pt="[object Promise]",wt="[object Proxy]",ot="[object RegExp]",$e="[object Set]",Ze="[object String]",Qe="[object Symbol]",at="[object Undefined]",qe="[object WeakMap]",et="[object WeakSet]",De="[object ArrayBuffer]",Ke="[object DataView]",ht="[object Float32Array]",je="[object Float64Array]",At="[object Int8Array]",$t="[object Int16Array]",Ht="[object Int32Array]",kt="[object Uint8Array]",zt="[object Uint8ClampedArray]",Jt="[object Uint16Array]",ir="[object Uint32Array]",Ur=/\b__p \+= '';/g,Yt=/\b(__p \+=) '' \+/g,Wr=/(__e\(.*?\)|\b__t\)) \+\n'';/g,ui=/&(?:amp|lt|gt|quot|#39);/g,Si=/[&<>"']/g,lt=RegExp(ui.source),it=RegExp(Si.source),ft=/<%-([\s\S]+?)%>/g,pt=/<%([\s\S]+?)%>/g,ct=/<%=([\s\S]+?)%>/g,nt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ct=/^\w*$/,Ot=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,dt=/[\\^$.*+?()[\]{}|]/g,Rt=RegExp(dt.source),gt=/^\s+/,_t=/\s/,yt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Xe=/\{\n\/\* \[wrapped with (.+)\] \*/,Tt=/,? & /,Nt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Io=/[()=,{}\[\]\/\s]/,xo=/\\(\\)?/g,So=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,mr=/\w*$/,Po=/^[-+]0x[0-9a-f]+$/i,Ao=/^0b[01]+$/i,Co=/^\[object .+?Constructor\]$/,Oo=/^0o[0-7]+$/i,Ro=/^(?:0|[1-9]\d*)$/,Jr=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Ki=/($^)/,To=/['\n\r\u2028\u2029\\]/g,Vi="\\ud800-\\udfff",No="\\u0300-\\u036f",Do="\\ufe20-\\ufe2f",Gi="\\u20d0-\\u20ff",Yn=No+Do+Gi,Xn="\\u2700-\\u27bf",Rr="a-z\\xdf-\\xf6\\xf8-\\xff",Lo="\\xac\\xb1\\xd7\\xf7",Fo="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",$o="\\u2000-\\u206f",Mo=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Zn="A-Z\\xc0-\\xd6\\xd8-\\xde",Qn="\\ufe0e\\ufe0f",Pi=Lo+Fo+$o+Mo,wn="[']",Ai="["+Vi+"]",_n="["+Pi+"]",Ci="["+Yn+"]",es="\\d+",jo="["+Xn+"]",ts="["+Rr+"]",rs="[^"+Vi+Pi+es+Xn+Rr+Zn+"]",Wi="\\ud83c[\\udffb-\\udfff]",zo="(?:"+Ci+"|"+Wi+")",is="[^"+Vi+"]",Ji="(?:\\ud83c[\\udde6-\\uddff]){2}",hi="[\\ud800-\\udbff][\\udc00-\\udfff]",lr="["+Zn+"]",ns="\\u200d",ss="(?:"+ts+"|"+rs+")",qr="(?:"+lr+"|"+rs+")",os="(?:"+wn+"(?:d|ll|m|re|s|t|ve))?",as="(?:"+wn+"(?:D|LL|M|RE|S|T|VE))?",cs=zo+"?",us="["+Qn+"]?",Uo="(?:"+ns+"(?:"+[is,Ji,hi].join("|")+")"+us+cs+")*",Yr="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",hs="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",ls=us+cs+Uo,Yi="(?:"+[jo,Ji,hi].join("|")+")"+ls,qo="(?:"+[is+Ci+"?",Ci,Ji,hi,Ai].join("|")+")",bn=RegExp(wn,"g"),Bo=RegExp(Ci,"g"),Xi=RegExp(Wi+"(?="+Wi+")|"+qo+ls,"g"),fs=RegExp([lr+"?"+ts+"+"+os+"(?="+[_n,lr,"$"].join("|")+")",qr+"+"+as+"(?="+[_n,lr+ss,"$"].join("|")+")",lr+"?"+ss+"+"+os,lr+"+"+as,hs,Yr,es,Yi].join("|"),"g"),ps=RegExp("["+ns+Vi+Yn+Qn+"]"),Oi=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,ds=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Ho=-1,Ve={};Ve[ht]=Ve[je]=Ve[At]=Ve[$t]=Ve[Ht]=Ve[kt]=Ve[zt]=Ve[Jt]=Ve[ir]=!0,Ve[Ie]=Ve[St]=Ve[De]=Ve[N]=Ve[Ke]=Ve[C]=Ve[E]=Ve[ee]=Ve[be]=Ve[Ne]=Ve[Pe]=Ve[ot]=Ve[$e]=Ve[Ze]=Ve[qe]=!1;var Be={};Be[Ie]=Be[St]=Be[De]=Be[Ke]=Be[N]=Be[C]=Be[ht]=Be[je]=Be[At]=Be[$t]=Be[Ht]=Be[be]=Be[Ne]=Be[Pe]=Be[ot]=Be[$e]=Be[Ze]=Be[Qe]=Be[kt]=Be[zt]=Be[Jt]=Be[ir]=!0,Be[E]=Be[ee]=Be[qe]=!1;var y={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},S={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},U={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Y={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Ge=parseFloat,me=parseInt,tt=typeof kn=="object"&&kn&&kn.Object===Object&&kn,Dt=typeof self=="object"&&self&&self.Object===Object&&self,Ce=tt||Dt||Function("return this")(),We=t&&!t.nodeType&&t,bt=We&&!0&&a&&!a.nodeType&&a,nr=bt&&bt.exports===We,Lt=nr&&tt.process,rt=function(){try{var P=bt&&bt.require&&bt.require("util").types;return P||Lt&&Lt.binding&&Lt.binding("util")}catch{}}(),Xt=rt&&rt.isArrayBuffer,Tr=rt&&rt.isDate,wr=rt&&rt.isMap,Br=rt&&rt.isRegExp,En=rt&&rt.isSet,Ri=rt&&rt.isTypedArray;function Ut(P,$,T){switch(T.length){case 0:return P.call($);case 1:return P.call($,T[0]);case 2:return P.call($,T[0],T[1]);case 3:return P.call($,T[0],T[1],T[2])}return P.apply($,T)}function qf(P,$,T,Z){for(var ye=-1,Fe=P==null?0:P.length;++ye<Fe;){var Mt=P[ye];$(Z,Mt,T(Mt),P)}return Z}function _r(P,$){for(var T=-1,Z=P==null?0:P.length;++T<Z&&$(P[T],T,P)!==!1;);return P}function Bf(P,$){for(var T=P==null?0:P.length;T--&&$(P[T],T,P)!==!1;);return P}function Lc(P,$){for(var T=-1,Z=P==null?0:P.length;++T<Z;)if(!$(P[T],T,P))return!1;return!0}function li(P,$){for(var T=-1,Z=P==null?0:P.length,ye=0,Fe=[];++T<Z;){var Mt=P[T];$(Mt,T,P)&&(Fe[ye++]=Mt)}return Fe}function gs(P,$){var T=P==null?0:P.length;return!!T&&Zi(P,$,0)>-1}function ko(P,$,T){for(var Z=-1,ye=P==null?0:P.length;++Z<ye;)if(T($,P[Z]))return!0;return!1}function st(P,$){for(var T=-1,Z=P==null?0:P.length,ye=Array(Z);++T<Z;)ye[T]=$(P[T],T,P);return ye}function fi(P,$){for(var T=-1,Z=$.length,ye=P.length;++T<Z;)P[ye+T]=$[T];return P}function Ko(P,$,T,Z){var ye=-1,Fe=P==null?0:P.length;for(Z&&Fe&&(T=P[++ye]);++ye<Fe;)T=$(T,P[ye],ye,P);return T}function Hf(P,$,T,Z){var ye=P==null?0:P.length;for(Z&&ye&&(T=P[--ye]);ye--;)T=$(T,P[ye],ye,P);return T}function Vo(P,$){for(var T=-1,Z=P==null?0:P.length;++T<Z;)if($(P[T],T,P))return!0;return!1}var kf=Go("length");function Kf(P){return P.split("")}function Vf(P){return P.match(Nt)||[]}function Fc(P,$,T){var Z;return T(P,function(ye,Fe,Mt){if($(ye,Fe,Mt))return Z=Fe,!1}),Z}function ys(P,$,T,Z){for(var ye=P.length,Fe=T+(Z?1:-1);Z?Fe--:++Fe<ye;)if($(P[Fe],Fe,P))return Fe;return-1}function Zi(P,$,T){return $===$?np(P,$,T):ys(P,$c,T)}function Gf(P,$,T,Z){for(var ye=T-1,Fe=P.length;++ye<Fe;)if(Z(P[ye],$))return ye;return-1}function $c(P){return P!==P}function Mc(P,$){var T=P==null?0:P.length;return T?Jo(P,$)/T:k}function Go(P){return function($){return $==null?i:$[P]}}function Wo(P){return function($){return P==null?i:P[$]}}function jc(P,$,T,Z,ye){return ye(P,function(Fe,Mt,Je){T=Z?(Z=!1,Fe):$(T,Fe,Mt,Je)}),T}function Wf(P,$){var T=P.length;for(P.sort($);T--;)P[T]=P[T].value;return P}function Jo(P,$){for(var T,Z=-1,ye=P.length;++Z<ye;){var Fe=$(P[Z]);Fe!==i&&(T=T===i?Fe:T+Fe)}return T}function Yo(P,$){for(var T=-1,Z=Array(P);++T<P;)Z[T]=$(T);return Z}function Jf(P,$){return st($,function(T){return[T,P[T]]})}function zc(P){return P&&P.slice(0,Hc(P)+1).replace(gt,"")}function fr(P){return function($){return P($)}}function Xo(P,$){return st($,function(T){return P[T]})}function In(P,$){return P.has($)}function Uc(P,$){for(var T=-1,Z=P.length;++T<Z&&Zi($,P[T],0)>-1;);return T}function qc(P,$){for(var T=P.length;T--&&Zi($,P[T],0)>-1;);return T}function Yf(P,$){for(var T=P.length,Z=0;T--;)P[T]===$&&++Z;return Z}var Xf=Wo(y),Zf=Wo(S);function Qf(P){return"\\"+Y[P]}function ep(P,$){return P==null?i:P[$]}function Qi(P){return ps.test(P)}function tp(P){return Oi.test(P)}function rp(P){for(var $,T=[];!($=P.next()).done;)T.push($.value);return T}function Zo(P){var $=-1,T=Array(P.size);return P.forEach(function(Z,ye){T[++$]=[ye,Z]}),T}function Bc(P,$){return function(T){return P($(T))}}function pi(P,$){for(var T=-1,Z=P.length,ye=0,Fe=[];++T<Z;){var Mt=P[T];(Mt===$||Mt===x)&&(P[T]=x,Fe[ye++]=T)}return Fe}function vs(P){var $=-1,T=Array(P.size);return P.forEach(function(Z){T[++$]=Z}),T}function ip(P){var $=-1,T=Array(P.size);return P.forEach(function(Z){T[++$]=[Z,Z]}),T}function np(P,$,T){for(var Z=T-1,ye=P.length;++Z<ye;)if(P[Z]===$)return Z;return-1}function sp(P,$,T){for(var Z=T+1;Z--;)if(P[Z]===$)return Z;return Z}function en(P){return Qi(P)?ap(P):kf(P)}function Nr(P){return Qi(P)?cp(P):Kf(P)}function Hc(P){for(var $=P.length;$--&&_t.test(P.charAt($)););return $}var op=Wo(U);function ap(P){for(var $=Xi.lastIndex=0;Xi.test(P);)++$;return $}function cp(P){return P.match(Xi)||[]}function up(P){return P.match(fs)||[]}var hp=function P($){$=$==null?Ce:tn.defaults(Ce.Object(),$,tn.pick(Ce,ds));var T=$.Array,Z=$.Date,ye=$.Error,Fe=$.Function,Mt=$.Math,Je=$.Object,Qo=$.RegExp,lp=$.String,br=$.TypeError,ms=T.prototype,fp=Fe.prototype,rn=Je.prototype,ws=$["__core-js_shared__"],_s=fp.toString,ze=rn.hasOwnProperty,pp=0,kc=function(){var e=/[^.]+$/.exec(ws&&ws.keys&&ws.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),bs=rn.toString,dp=_s.call(Je),gp=Ce._,yp=Qo("^"+_s.call(ze).replace(dt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Es=nr?$.Buffer:i,di=$.Symbol,Is=$.Uint8Array,Kc=Es?Es.allocUnsafe:i,xs=Bc(Je.getPrototypeOf,Je),Vc=Je.create,Gc=rn.propertyIsEnumerable,Ss=ms.splice,Wc=di?di.isConcatSpreadable:i,xn=di?di.iterator:i,Ti=di?di.toStringTag:i,Ps=function(){try{var e=$i(Je,"defineProperty");return e({},"",{}),e}catch{}}(),vp=$.clearTimeout!==Ce.clearTimeout&&$.clearTimeout,mp=Z&&Z.now!==Ce.Date.now&&Z.now,wp=$.setTimeout!==Ce.setTimeout&&$.setTimeout,As=Mt.ceil,Cs=Mt.floor,ea=Je.getOwnPropertySymbols,_p=Es?Es.isBuffer:i,Jc=$.isFinite,bp=ms.join,Ep=Bc(Je.keys,Je),jt=Mt.max,Gt=Mt.min,Ip=Z.now,xp=$.parseInt,Yc=Mt.random,Sp=ms.reverse,ta=$i($,"DataView"),Sn=$i($,"Map"),ra=$i($,"Promise"),nn=$i($,"Set"),Pn=$i($,"WeakMap"),An=$i(Je,"create"),Os=Pn&&new Pn,sn={},Pp=Mi(ta),Ap=Mi(Sn),Cp=Mi(ra),Op=Mi(nn),Rp=Mi(Pn),Rs=di?di.prototype:i,Cn=Rs?Rs.valueOf:i,Xc=Rs?Rs.toString:i;function f(e){if(vt(e)&&!we(e)&&!(e instanceof Ae)){if(e instanceof Er)return e;if(ze.call(e,"__wrapped__"))return Zu(e)}return new Er(e)}var on=function(){function e(){}return function(r){if(!ut(r))return{};if(Vc)return Vc(r);e.prototype=r;var n=new e;return e.prototype=i,n}}();function Ts(){}function Er(e,r){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!r,this.__index__=0,this.__values__=i}f.templateSettings={escape:ft,evaluate:pt,interpolate:ct,variable:"",imports:{_:f}},f.prototype=Ts.prototype,f.prototype.constructor=f,Er.prototype=on(Ts.prototype),Er.prototype.constructor=Er;function Ae(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=G,this.__views__=[]}function Tp(){var e=new Ae(this.__wrapped__);return e.__actions__=sr(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=sr(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=sr(this.__views__),e}function Np(){if(this.__filtered__){var e=new Ae(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function Dp(){var e=this.__wrapped__.value(),r=this.__dir__,n=we(e),c=r<0,l=n?e.length:0,d=Kd(0,l,this.__views__),w=d.start,b=d.end,A=b-w,M=c?b:w-1,j=this.__iteratees__,H=j.length,J=0,te=Gt(A,this.__takeCount__);if(!n||!c&&l==A&&te==A)return bu(e,this.__actions__);var oe=[];e:for(;A--&&J<te;){M+=r;for(var Ee=-1,ae=e[M];++Ee<H;){var Se=j[Ee],Oe=Se.iteratee,gr=Se.type,er=Oe(ae);if(gr==I)ae=er;else if(!er){if(gr==v)continue e;break e}}oe[J++]=ae}return oe}Ae.prototype=on(Ts.prototype),Ae.prototype.constructor=Ae;function Ni(e){var r=-1,n=e==null?0:e.length;for(this.clear();++r<n;){var c=e[r];this.set(c[0],c[1])}}function Lp(){this.__data__=An?An(null):{},this.size=0}function Fp(e){var r=this.has(e)&&delete this.__data__[e];return this.size-=r?1:0,r}function $p(e){var r=this.__data__;if(An){var n=r[e];return n===_?i:n}return ze.call(r,e)?r[e]:i}function Mp(e){var r=this.__data__;return An?r[e]!==i:ze.call(r,e)}function jp(e,r){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=An&&r===i?_:r,this}Ni.prototype.clear=Lp,Ni.prototype.delete=Fp,Ni.prototype.get=$p,Ni.prototype.has=Mp,Ni.prototype.set=jp;function Xr(e){var r=-1,n=e==null?0:e.length;for(this.clear();++r<n;){var c=e[r];this.set(c[0],c[1])}}function zp(){this.__data__=[],this.size=0}function Up(e){var r=this.__data__,n=Ns(r,e);if(n<0)return!1;var c=r.length-1;return n==c?r.pop():Ss.call(r,n,1),--this.size,!0}function qp(e){var r=this.__data__,n=Ns(r,e);return n<0?i:r[n][1]}function Bp(e){return Ns(this.__data__,e)>-1}function Hp(e,r){var n=this.__data__,c=Ns(n,e);return c<0?(++this.size,n.push([e,r])):n[c][1]=r,this}Xr.prototype.clear=zp,Xr.prototype.delete=Up,Xr.prototype.get=qp,Xr.prototype.has=Bp,Xr.prototype.set=Hp;function Zr(e){var r=-1,n=e==null?0:e.length;for(this.clear();++r<n;){var c=e[r];this.set(c[0],c[1])}}function kp(){this.size=0,this.__data__={hash:new Ni,map:new(Sn||Xr),string:new Ni}}function Kp(e){var r=ks(this,e).delete(e);return this.size-=r?1:0,r}function Vp(e){return ks(this,e).get(e)}function Gp(e){return ks(this,e).has(e)}function Wp(e,r){var n=ks(this,e),c=n.size;return n.set(e,r),this.size+=n.size==c?0:1,this}Zr.prototype.clear=kp,Zr.prototype.delete=Kp,Zr.prototype.get=Vp,Zr.prototype.has=Gp,Zr.prototype.set=Wp;function Di(e){var r=-1,n=e==null?0:e.length;for(this.__data__=new Zr;++r<n;)this.add(e[r])}function Jp(e){return this.__data__.set(e,_),this}function Yp(e){return this.__data__.has(e)}Di.prototype.add=Di.prototype.push=Jp,Di.prototype.has=Yp;function Dr(e){var r=this.__data__=new Xr(e);this.size=r.size}function Xp(){this.__data__=new Xr,this.size=0}function Zp(e){var r=this.__data__,n=r.delete(e);return this.size=r.size,n}function Qp(e){return this.__data__.get(e)}function ed(e){return this.__data__.has(e)}function td(e,r){var n=this.__data__;if(n instanceof Xr){var c=n.__data__;if(!Sn||c.length<o-1)return c.push([e,r]),this.size=++n.size,this;n=this.__data__=new Zr(c)}return n.set(e,r),this.size=n.size,this}Dr.prototype.clear=Xp,Dr.prototype.delete=Zp,Dr.prototype.get=Qp,Dr.prototype.has=ed,Dr.prototype.set=td;function Zc(e,r){var n=we(e),c=!n&&ji(e),l=!n&&!c&&wi(e),d=!n&&!c&&!l&&hn(e),w=n||c||l||d,b=w?Yo(e.length,lp):[],A=b.length;for(var M in e)(r||ze.call(e,M))&&!(w&&(M=="length"||l&&(M=="offset"||M=="parent")||d&&(M=="buffer"||M=="byteLength"||M=="byteOffset")||ri(M,A)))&&b.push(M);return b}function Qc(e){var r=e.length;return r?e[pa(0,r-1)]:i}function rd(e,r){return Ks(sr(e),Li(r,0,e.length))}function id(e){return Ks(sr(e))}function ia(e,r,n){(n!==i&&!Lr(e[r],n)||n===i&&!(r in e))&&Qr(e,r,n)}function On(e,r,n){var c=e[r];(!(ze.call(e,r)&&Lr(c,n))||n===i&&!(r in e))&&Qr(e,r,n)}function Ns(e,r){for(var n=e.length;n--;)if(Lr(e[n][0],r))return n;return-1}function nd(e,r,n,c){return gi(e,function(l,d,w){r(c,l,n(l),w)}),c}function eu(e,r){return e&&kr(r,qt(r),e)}function sd(e,r){return e&&kr(r,ar(r),e)}function Qr(e,r,n){r=="__proto__"&&Ps?Ps(e,r,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[r]=n}function na(e,r){for(var n=-1,c=r.length,l=T(c),d=e==null;++n<c;)l[n]=d?i:ja(e,r[n]);return l}function Li(e,r,n){return e===e&&(n!==i&&(e=e<=n?e:n),r!==i&&(e=e>=r?e:r)),e}function Ir(e,r,n,c,l,d){var w,b=r&O,A=r&L,M=r&z;if(n&&(w=l?n(e,c,l,d):n(e)),w!==i)return w;if(!ut(e))return e;var j=we(e);if(j){if(w=Gd(e),!b)return sr(e,w)}else{var H=Wt(e),J=H==ee||H==ge;if(wi(e))return xu(e,b);if(H==Pe||H==Ie||J&&!l){if(w=A||J?{}:Hu(e),!b)return A?$d(e,sd(w,e)):Fd(e,eu(w,e))}else{if(!Be[H])return l?e:{};w=Wd(e,H,b)}}d||(d=new Dr);var te=d.get(e);if(te)return te;d.set(e,w),mh(e)?e.forEach(function(ae){w.add(Ir(ae,r,n,ae,e,d))}):yh(e)&&e.forEach(function(ae,Se){w.set(Se,Ir(ae,r,n,Se,e,d))});var oe=M?A?xa:Ia:A?ar:qt,Ee=j?i:oe(e);return _r(Ee||e,function(ae,Se){Ee&&(Se=ae,ae=e[Se]),On(w,Se,Ir(ae,r,n,Se,e,d))}),w}function od(e){var r=qt(e);return function(n){return tu(n,e,r)}}function tu(e,r,n){var c=n.length;if(e==null)return!c;for(e=Je(e);c--;){var l=n[c],d=r[l],w=e[l];if(w===i&&!(l in e)||!d(w))return!1}return!0}function ru(e,r,n){if(typeof e!="function")throw new br(p);return $n(function(){e.apply(i,n)},r)}function Rn(e,r,n,c){var l=-1,d=gs,w=!0,b=e.length,A=[],M=r.length;if(!b)return A;n&&(r=st(r,fr(n))),c?(d=ko,w=!1):r.length>=o&&(d=In,w=!1,r=new Di(r));e:for(;++l<b;){var j=e[l],H=n==null?j:n(j);if(j=c||j!==0?j:0,w&&H===H){for(var J=M;J--;)if(r[J]===H)continue e;A.push(j)}else d(r,H,c)||A.push(j)}return A}var gi=Ou(Hr),iu=Ou(oa,!0);function ad(e,r){var n=!0;return gi(e,function(c,l,d){return n=!!r(c,l,d),n}),n}function Ds(e,r,n){for(var c=-1,l=e.length;++c<l;){var d=e[c],w=r(d);if(w!=null&&(b===i?w===w&&!dr(w):n(w,b)))var b=w,A=d}return A}function cd(e,r,n,c){var l=e.length;for(n=_e(n),n<0&&(n=-n>l?0:l+n),c=c===i||c>l?l:_e(c),c<0&&(c+=l),c=n>c?0:_h(c);n<c;)e[n++]=r;return e}function nu(e,r){var n=[];return gi(e,function(c,l,d){r(c,l,d)&&n.push(c)}),n}function Kt(e,r,n,c,l){var d=-1,w=e.length;for(n||(n=Yd),l||(l=[]);++d<w;){var b=e[d];r>0&&n(b)?r>1?Kt(b,r-1,n,c,l):fi(l,b):c||(l[l.length]=b)}return l}var sa=Ru(),su=Ru(!0);function Hr(e,r){return e&&sa(e,r,qt)}function oa(e,r){return e&&su(e,r,qt)}function Ls(e,r){return li(r,function(n){return ii(e[n])})}function Fi(e,r){r=vi(r,e);for(var n=0,c=r.length;e!=null&&n<c;)e=e[Kr(r[n++])];return n&&n==c?e:i}function ou(e,r,n){var c=r(e);return we(e)?c:fi(c,n(e))}function Zt(e){return e==null?e===i?at:Le:Ti&&Ti in Je(e)?kd(e):ig(e)}function aa(e,r){return e>r}function ud(e,r){return e!=null&&ze.call(e,r)}function hd(e,r){return e!=null&&r in Je(e)}function ld(e,r,n){return e>=Gt(r,n)&&e<jt(r,n)}function ca(e,r,n){for(var c=n?ko:gs,l=e[0].length,d=e.length,w=d,b=T(d),A=1/0,M=[];w--;){var j=e[w];w&&r&&(j=st(j,fr(r))),A=Gt(j.length,A),b[w]=!n&&(r||l>=120&&j.length>=120)?new Di(w&&j):i}j=e[0];var H=-1,J=b[0];e:for(;++H<l&&M.length<A;){var te=j[H],oe=r?r(te):te;if(te=n||te!==0?te:0,!(J?In(J,oe):c(M,oe,n))){for(w=d;--w;){var Ee=b[w];if(!(Ee?In(Ee,oe):c(e[w],oe,n)))continue e}J&&J.push(oe),M.push(te)}}return M}function fd(e,r,n,c){return Hr(e,function(l,d,w){r(c,n(l),d,w)}),c}function Tn(e,r,n){r=vi(r,e),e=Gu(e,r);var c=e==null?e:e[Kr(Sr(r))];return c==null?i:Ut(c,e,n)}function au(e){return vt(e)&&Zt(e)==Ie}function pd(e){return vt(e)&&Zt(e)==De}function dd(e){return vt(e)&&Zt(e)==C}function Nn(e,r,n,c,l){return e===r?!0:e==null||r==null||!vt(e)&&!vt(r)?e!==e&&r!==r:gd(e,r,n,c,Nn,l)}function gd(e,r,n,c,l,d){var w=we(e),b=we(r),A=w?St:Wt(e),M=b?St:Wt(r);A=A==Ie?Pe:A,M=M==Ie?Pe:M;var j=A==Pe,H=M==Pe,J=A==M;if(J&&wi(e)){if(!wi(r))return!1;w=!0,j=!1}if(J&&!j)return d||(d=new Dr),w||hn(e)?Uu(e,r,n,c,l,d):Bd(e,r,A,n,c,l,d);if(!(n&R)){var te=j&&ze.call(e,"__wrapped__"),oe=H&&ze.call(r,"__wrapped__");if(te||oe){var Ee=te?e.value():e,ae=oe?r.value():r;return d||(d=new Dr),l(Ee,ae,n,c,d)}}return J?(d||(d=new Dr),Hd(e,r,n,c,l,d)):!1}function yd(e){return vt(e)&&Wt(e)==be}function ua(e,r,n,c){var l=n.length,d=l,w=!c;if(e==null)return!d;for(e=Je(e);l--;){var b=n[l];if(w&&b[2]?b[1]!==e[b[0]]:!(b[0]in e))return!1}for(;++l<d;){b=n[l];var A=b[0],M=e[A],j=b[1];if(w&&b[2]){if(M===i&&!(A in e))return!1}else{var H=new Dr;if(c)var J=c(M,j,A,e,r,H);if(!(J===i?Nn(j,M,R|K,c,H):J))return!1}}return!0}function cu(e){if(!ut(e)||Zd(e))return!1;var r=ii(e)?yp:Co;return r.test(Mi(e))}function vd(e){return vt(e)&&Zt(e)==ot}function md(e){return vt(e)&&Wt(e)==$e}function wd(e){return vt(e)&&Xs(e.length)&&!!Ve[Zt(e)]}function uu(e){return typeof e=="function"?e:e==null?cr:typeof e=="object"?we(e)?fu(e[0],e[1]):lu(e):Th(e)}function ha(e){if(!Fn(e))return Ep(e);var r=[];for(var n in Je(e))ze.call(e,n)&&n!="constructor"&&r.push(n);return r}function _d(e){if(!ut(e))return rg(e);var r=Fn(e),n=[];for(var c in e)c=="constructor"&&(r||!ze.call(e,c))||n.push(c);return n}function la(e,r){return e<r}function hu(e,r){var n=-1,c=or(e)?T(e.length):[];return gi(e,function(l,d,w){c[++n]=r(l,d,w)}),c}function lu(e){var r=Pa(e);return r.length==1&&r[0][2]?Ku(r[0][0],r[0][1]):function(n){return n===e||ua(n,e,r)}}function fu(e,r){return Ca(e)&&ku(r)?Ku(Kr(e),r):function(n){var c=ja(n,e);return c===i&&c===r?za(n,e):Nn(r,c,R|K)}}function Fs(e,r,n,c,l){e!==r&&sa(r,function(d,w){if(l||(l=new Dr),ut(d))bd(e,r,w,n,Fs,c,l);else{var b=c?c(Ra(e,w),d,w+"",e,r,l):i;b===i&&(b=d),ia(e,w,b)}},ar)}function bd(e,r,n,c,l,d,w){var b=Ra(e,n),A=Ra(r,n),M=w.get(A);if(M){ia(e,n,M);return}var j=d?d(b,A,n+"",e,r,w):i,H=j===i;if(H){var J=we(A),te=!J&&wi(A),oe=!J&&!te&&hn(A);j=A,J||te||oe?we(b)?j=b:Et(b)?j=sr(b):te?(H=!1,j=xu(A,!0)):oe?(H=!1,j=Su(A,!0)):j=[]:Mn(A)||ji(A)?(j=b,ji(b)?j=bh(b):(!ut(b)||ii(b))&&(j=Hu(A))):H=!1}H&&(w.set(A,j),l(j,A,c,d,w),w.delete(A)),ia(e,n,j)}function pu(e,r){var n=e.length;if(n)return r+=r<0?n:0,ri(r,n)?e[r]:i}function du(e,r,n){r.length?r=st(r,function(d){return we(d)?function(w){return Fi(w,d.length===1?d[0]:d)}:d}):r=[cr];var c=-1;r=st(r,fr(ne()));var l=hu(e,function(d,w,b){var A=st(r,function(M){return M(d)});return{criteria:A,index:++c,value:d}});return Wf(l,function(d,w){return Ld(d,w,n)})}function Ed(e,r){return gu(e,r,function(n,c){return za(e,c)})}function gu(e,r,n){for(var c=-1,l=r.length,d={};++c<l;){var w=r[c],b=Fi(e,w);n(b,w)&&Dn(d,vi(w,e),b)}return d}function Id(e){return function(r){return Fi(r,e)}}function fa(e,r,n,c){var l=c?Gf:Zi,d=-1,w=r.length,b=e;for(e===r&&(r=sr(r)),n&&(b=st(e,fr(n)));++d<w;)for(var A=0,M=r[d],j=n?n(M):M;(A=l(b,j,A,c))>-1;)b!==e&&Ss.call(b,A,1),Ss.call(e,A,1);return e}function yu(e,r){for(var n=e?r.length:0,c=n-1;n--;){var l=r[n];if(n==c||l!==d){var d=l;ri(l)?Ss.call(e,l,1):ya(e,l)}}return e}function pa(e,r){return e+Cs(Yc()*(r-e+1))}function xd(e,r,n,c){for(var l=-1,d=jt(As((r-e)/(n||1)),0),w=T(d);d--;)w[c?d:++l]=e,e+=n;return w}function da(e,r){var n="";if(!e||r<1||r>V)return n;do r%2&&(n+=e),r=Cs(r/2),r&&(e+=e);while(r);return n}function xe(e,r){return Ta(Vu(e,r,cr),e+"")}function Sd(e){return Qc(ln(e))}function Pd(e,r){var n=ln(e);return Ks(n,Li(r,0,n.length))}function Dn(e,r,n,c){if(!ut(e))return e;r=vi(r,e);for(var l=-1,d=r.length,w=d-1,b=e;b!=null&&++l<d;){var A=Kr(r[l]),M=n;if(A==="__proto__"||A==="constructor"||A==="prototype")return e;if(l!=w){var j=b[A];M=c?c(j,A,b):i,M===i&&(M=ut(j)?j:ri(r[l+1])?[]:{})}On(b,A,M),b=b[A]}return e}var vu=Os?function(e,r){return Os.set(e,r),e}:cr,Ad=Ps?function(e,r){return Ps(e,"toString",{configurable:!0,enumerable:!1,value:qa(r),writable:!0})}:cr;function Cd(e){return Ks(ln(e))}function xr(e,r,n){var c=-1,l=e.length;r<0&&(r=-r>l?0:l+r),n=n>l?l:n,n<0&&(n+=l),l=r>n?0:n-r>>>0,r>>>=0;for(var d=T(l);++c<l;)d[c]=e[c+r];return d}function Od(e,r){var n;return gi(e,function(c,l,d){return n=r(c,l,d),!n}),!!n}function $s(e,r,n){var c=0,l=e==null?c:e.length;if(typeof r=="number"&&r===r&&l<=ke){for(;c<l;){var d=c+l>>>1,w=e[d];w!==null&&!dr(w)&&(n?w<=r:w<r)?c=d+1:l=d}return l}return ga(e,r,cr,n)}function ga(e,r,n,c){var l=0,d=e==null?0:e.length;if(d===0)return 0;r=n(r);for(var w=r!==r,b=r===null,A=dr(r),M=r===i;l<d;){var j=Cs((l+d)/2),H=n(e[j]),J=H!==i,te=H===null,oe=H===H,Ee=dr(H);if(w)var ae=c||oe;else M?ae=oe&&(c||J):b?ae=oe&&J&&(c||!te):A?ae=oe&&J&&!te&&(c||!Ee):te||Ee?ae=!1:ae=c?H<=r:H<r;ae?l=j+1:d=j}return Gt(d,Ye)}function mu(e,r){for(var n=-1,c=e.length,l=0,d=[];++n<c;){var w=e[n],b=r?r(w):w;if(!n||!Lr(b,A)){var A=b;d[l++]=w===0?0:w}}return d}function wu(e){return typeof e=="number"?e:dr(e)?k:+e}function pr(e){if(typeof e=="string")return e;if(we(e))return st(e,pr)+"";if(dr(e))return Xc?Xc.call(e):"";var r=e+"";return r=="0"&&1/e==-ce?"-0":r}function yi(e,r,n){var c=-1,l=gs,d=e.length,w=!0,b=[],A=b;if(n)w=!1,l=ko;else if(d>=o){var M=r?null:Ud(e);if(M)return vs(M);w=!1,l=In,A=new Di}else A=r?[]:b;e:for(;++c<d;){var j=e[c],H=r?r(j):j;if(j=n||j!==0?j:0,w&&H===H){for(var J=A.length;J--;)if(A[J]===H)continue e;r&&A.push(H),b.push(j)}else l(A,H,n)||(A!==b&&A.push(H),b.push(j))}return b}function ya(e,r){return r=vi(r,e),e=Gu(e,r),e==null||delete e[Kr(Sr(r))]}function _u(e,r,n,c){return Dn(e,r,n(Fi(e,r)),c)}function Ms(e,r,n,c){for(var l=e.length,d=c?l:-1;(c?d--:++d<l)&&r(e[d],d,e););return n?xr(e,c?0:d,c?d+1:l):xr(e,c?d+1:0,c?l:d)}function bu(e,r){var n=e;return n instanceof Ae&&(n=n.value()),Ko(r,function(c,l){return l.func.apply(l.thisArg,fi([c],l.args))},n)}function va(e,r,n){var c=e.length;if(c<2)return c?yi(e[0]):[];for(var l=-1,d=T(c);++l<c;)for(var w=e[l],b=-1;++b<c;)b!=l&&(d[l]=Rn(d[l]||w,e[b],r,n));return yi(Kt(d,1),r,n)}function Eu(e,r,n){for(var c=-1,l=e.length,d=r.length,w={};++c<l;){var b=c<d?r[c]:i;n(w,e[c],b)}return w}function ma(e){return Et(e)?e:[]}function wa(e){return typeof e=="function"?e:cr}function vi(e,r){return we(e)?e:Ca(e,r)?[e]:Xu(Me(e))}var Rd=xe;function mi(e,r,n){var c=e.length;return n=n===i?c:n,!r&&n>=c?e:xr(e,r,n)}var Iu=vp||function(e){return Ce.clearTimeout(e)};function xu(e,r){if(r)return e.slice();var n=e.length,c=Kc?Kc(n):new e.constructor(n);return e.copy(c),c}function _a(e){var r=new e.constructor(e.byteLength);return new Is(r).set(new Is(e)),r}function Td(e,r){var n=r?_a(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}function Nd(e){var r=new e.constructor(e.source,mr.exec(e));return r.lastIndex=e.lastIndex,r}function Dd(e){return Cn?Je(Cn.call(e)):{}}function Su(e,r){var n=r?_a(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function Pu(e,r){if(e!==r){var n=e!==i,c=e===null,l=e===e,d=dr(e),w=r!==i,b=r===null,A=r===r,M=dr(r);if(!b&&!M&&!d&&e>r||d&&w&&A&&!b&&!M||c&&w&&A||!n&&A||!l)return 1;if(!c&&!d&&!M&&e<r||M&&n&&l&&!c&&!d||b&&n&&l||!w&&l||!A)return-1}return 0}function Ld(e,r,n){for(var c=-1,l=e.criteria,d=r.criteria,w=l.length,b=n.length;++c<w;){var A=Pu(l[c],d[c]);if(A){if(c>=b)return A;var M=n[c];return A*(M=="desc"?-1:1)}}return e.index-r.index}function Au(e,r,n,c){for(var l=-1,d=e.length,w=n.length,b=-1,A=r.length,M=jt(d-w,0),j=T(A+M),H=!c;++b<A;)j[b]=r[b];for(;++l<w;)(H||l<d)&&(j[n[l]]=e[l]);for(;M--;)j[b++]=e[l++];return j}function Cu(e,r,n,c){for(var l=-1,d=e.length,w=-1,b=n.length,A=-1,M=r.length,j=jt(d-b,0),H=T(j+M),J=!c;++l<j;)H[l]=e[l];for(var te=l;++A<M;)H[te+A]=r[A];for(;++w<b;)(J||l<d)&&(H[te+n[w]]=e[l++]);return H}function sr(e,r){var n=-1,c=e.length;for(r||(r=T(c));++n<c;)r[n]=e[n];return r}function kr(e,r,n,c){var l=!n;n||(n={});for(var d=-1,w=r.length;++d<w;){var b=r[d],A=c?c(n[b],e[b],b,n,e):i;A===i&&(A=e[b]),l?Qr(n,b,A):On(n,b,A)}return n}function Fd(e,r){return kr(e,Aa(e),r)}function $d(e,r){return kr(e,qu(e),r)}function js(e,r){return function(n,c){var l=we(n)?qf:nd,d=r?r():{};return l(n,e,ne(c,2),d)}}function an(e){return xe(function(r,n){var c=-1,l=n.length,d=l>1?n[l-1]:i,w=l>2?n[2]:i;for(d=e.length>3&&typeof d=="function"?(l--,d):i,w&&Qt(n[0],n[1],w)&&(d=l<3?i:d,l=1),r=Je(r);++c<l;){var b=n[c];b&&e(r,b,c,d)}return r})}function Ou(e,r){return function(n,c){if(n==null)return n;if(!or(n))return e(n,c);for(var l=n.length,d=r?l:-1,w=Je(n);(r?d--:++d<l)&&c(w[d],d,w)!==!1;);return n}}function Ru(e){return function(r,n,c){for(var l=-1,d=Je(r),w=c(r),b=w.length;b--;){var A=w[e?b:++l];if(n(d[A],A,d)===!1)break}return r}}function Md(e,r,n){var c=r&re,l=Ln(e);function d(){var w=this&&this!==Ce&&this instanceof d?l:e;return w.apply(c?n:this,arguments)}return d}function Tu(e){return function(r){r=Me(r);var n=Qi(r)?Nr(r):i,c=n?n[0]:r.charAt(0),l=n?mi(n,1).join(""):r.slice(1);return c[e]()+l}}function cn(e){return function(r){return Ko(Oh(Ch(r).replace(bn,"")),e,"")}}function Ln(e){return function(){var r=arguments;switch(r.length){case 0:return new e;case 1:return new e(r[0]);case 2:return new e(r[0],r[1]);case 3:return new e(r[0],r[1],r[2]);case 4:return new e(r[0],r[1],r[2],r[3]);case 5:return new e(r[0],r[1],r[2],r[3],r[4]);case 6:return new e(r[0],r[1],r[2],r[3],r[4],r[5]);case 7:return new e(r[0],r[1],r[2],r[3],r[4],r[5],r[6])}var n=on(e.prototype),c=e.apply(n,r);return ut(c)?c:n}}function jd(e,r,n){var c=Ln(e);function l(){for(var d=arguments.length,w=T(d),b=d,A=un(l);b--;)w[b]=arguments[b];var M=d<3&&w[0]!==A&&w[d-1]!==A?[]:pi(w,A);if(d-=M.length,d<n)return $u(e,r,zs,l.placeholder,i,w,M,i,i,n-d);var j=this&&this!==Ce&&this instanceof l?c:e;return Ut(j,this,w)}return l}function Nu(e){return function(r,n,c){var l=Je(r);if(!or(r)){var d=ne(n,3);r=qt(r),n=function(b){return d(l[b],b,l)}}var w=e(r,n,c);return w>-1?l[d?r[w]:w]:i}}function Du(e){return ti(function(r){var n=r.length,c=n,l=Er.prototype.thru;for(e&&r.reverse();c--;){var d=r[c];if(typeof d!="function")throw new br(p);if(l&&!w&&Hs(d)=="wrapper")var w=new Er([],!0)}for(c=w?c:n;++c<n;){d=r[c];var b=Hs(d),A=b=="wrapper"?Sa(d):i;A&&Oa(A[0])&&A[1]==(q|fe|de|W)&&!A[4].length&&A[9]==1?w=w[Hs(A[0])].apply(w,A[3]):w=d.length==1&&Oa(d)?w[b]():w.thru(d)}return function(){var M=arguments,j=M[0];if(w&&M.length==1&&we(j))return w.plant(j).value();for(var H=0,J=n?r[H].apply(this,M):j;++H<n;)J=r[H].call(this,J);return J}})}function zs(e,r,n,c,l,d,w,b,A,M){var j=r&q,H=r&re,J=r&he,te=r&(fe|pe),oe=r&ve,Ee=J?i:Ln(e);function ae(){for(var Se=arguments.length,Oe=T(Se),gr=Se;gr--;)Oe[gr]=arguments[gr];if(te)var er=un(ae),yr=Yf(Oe,er);if(c&&(Oe=Au(Oe,c,l,te)),d&&(Oe=Cu(Oe,d,w,te)),Se-=yr,te&&Se<M){var It=pi(Oe,er);return $u(e,r,zs,ae.placeholder,n,Oe,It,b,A,M-Se)}var Fr=H?n:this,si=J?Fr[e]:e;return Se=Oe.length,b?Oe=ng(Oe,b):oe&&Se>1&&Oe.reverse(),j&&A<Se&&(Oe.length=A),this&&this!==Ce&&this instanceof ae&&(si=Ee||Ln(si)),si.apply(Fr,Oe)}return ae}function Lu(e,r){return function(n,c){return fd(n,e,r(c),{})}}function Us(e,r){return function(n,c){var l;if(n===i&&c===i)return r;if(n!==i&&(l=n),c!==i){if(l===i)return c;typeof n=="string"||typeof c=="string"?(n=pr(n),c=pr(c)):(n=wu(n),c=wu(c)),l=e(n,c)}return l}}function ba(e){return ti(function(r){return r=st(r,fr(ne())),xe(function(n){var c=this;return e(r,function(l){return Ut(l,c,n)})})})}function qs(e,r){r=r===i?" ":pr(r);var n=r.length;if(n<2)return n?da(r,e):r;var c=da(r,As(e/en(r)));return Qi(r)?mi(Nr(c),0,e).join(""):c.slice(0,e)}function zd(e,r,n,c){var l=r&re,d=Ln(e);function w(){for(var b=-1,A=arguments.length,M=-1,j=c.length,H=T(j+A),J=this&&this!==Ce&&this instanceof w?d:e;++M<j;)H[M]=c[M];for(;A--;)H[M++]=arguments[++b];return Ut(J,l?n:this,H)}return w}function Fu(e){return function(r,n,c){return c&&typeof c!="number"&&Qt(r,n,c)&&(n=c=i),r=ni(r),n===i?(n=r,r=0):n=ni(n),c=c===i?r<n?1:-1:ni(c),xd(r,n,c,e)}}function Bs(e){return function(r,n){return typeof r=="string"&&typeof n=="string"||(r=Pr(r),n=Pr(n)),e(r,n)}}function $u(e,r,n,c,l,d,w,b,A,M){var j=r&fe,H=j?w:i,J=j?i:w,te=j?d:i,oe=j?i:d;r|=j?de:F,r&=~(j?F:de),r&le||(r&=~(re|he));var Ee=[e,r,l,te,H,oe,J,b,A,M],ae=n.apply(i,Ee);return Oa(e)&&Wu(ae,Ee),ae.placeholder=c,Ju(ae,e,r)}function Ea(e){var r=Mt[e];return function(n,c){if(n=Pr(n),c=c==null?0:Gt(_e(c),292),c&&Jc(n)){var l=(Me(n)+"e").split("e"),d=r(l[0]+"e"+(+l[1]+c));return l=(Me(d)+"e").split("e"),+(l[0]+"e"+(+l[1]-c))}return r(n)}}var Ud=nn&&1/vs(new nn([,-0]))[1]==ce?function(e){return new nn(e)}:ka;function Mu(e){return function(r){var n=Wt(r);return n==be?Zo(r):n==$e?ip(r):Jf(r,e(r))}}function ei(e,r,n,c,l,d,w,b){var A=r&he;if(!A&&typeof e!="function")throw new br(p);var M=c?c.length:0;if(M||(r&=~(de|F),c=l=i),w=w===i?w:jt(_e(w),0),b=b===i?b:_e(b),M-=l?l.length:0,r&F){var j=c,H=l;c=l=i}var J=A?i:Sa(e),te=[e,r,n,c,l,j,H,d,w,b];if(J&&tg(te,J),e=te[0],r=te[1],n=te[2],c=te[3],l=te[4],b=te[9]=te[9]===i?A?0:e.length:jt(te[9]-M,0),!b&&r&(fe|pe)&&(r&=~(fe|pe)),!r||r==re)var oe=Md(e,r,n);else r==fe||r==pe?oe=jd(e,r,b):(r==de||r==(re|de))&&!l.length?oe=zd(e,r,n,c):oe=zs.apply(i,te);var Ee=J?vu:Wu;return Ju(Ee(oe,te),e,r)}function ju(e,r,n,c){return e===i||Lr(e,rn[n])&&!ze.call(c,n)?r:e}function zu(e,r,n,c,l,d){return ut(e)&&ut(r)&&(d.set(r,e),Fs(e,r,i,zu,d),d.delete(r)),e}function qd(e){return Mn(e)?i:e}function Uu(e,r,n,c,l,d){var w=n&R,b=e.length,A=r.length;if(b!=A&&!(w&&A>b))return!1;var M=d.get(e),j=d.get(r);if(M&&j)return M==r&&j==e;var H=-1,J=!0,te=n&K?new Di:i;for(d.set(e,r),d.set(r,e);++H<b;){var oe=e[H],Ee=r[H];if(c)var ae=w?c(Ee,oe,H,r,e,d):c(oe,Ee,H,e,r,d);if(ae!==i){if(ae)continue;J=!1;break}if(te){if(!Vo(r,function(Se,Oe){if(!In(te,Oe)&&(oe===Se||l(oe,Se,n,c,d)))return te.push(Oe)})){J=!1;break}}else if(!(oe===Ee||l(oe,Ee,n,c,d))){J=!1;break}}return d.delete(e),d.delete(r),J}function Bd(e,r,n,c,l,d,w){switch(n){case Ke:if(e.byteLength!=r.byteLength||e.byteOffset!=r.byteOffset)return!1;e=e.buffer,r=r.buffer;case De:return!(e.byteLength!=r.byteLength||!d(new Is(e),new Is(r)));case N:case C:case Ne:return Lr(+e,+r);case E:return e.name==r.name&&e.message==r.message;case ot:case Ze:return e==r+"";case be:var b=Zo;case $e:var A=c&R;if(b||(b=vs),e.size!=r.size&&!A)return!1;var M=w.get(e);if(M)return M==r;c|=K,w.set(e,r);var j=Uu(b(e),b(r),c,l,d,w);return w.delete(e),j;case Qe:if(Cn)return Cn.call(e)==Cn.call(r)}return!1}function Hd(e,r,n,c,l,d){var w=n&R,b=Ia(e),A=b.length,M=Ia(r),j=M.length;if(A!=j&&!w)return!1;for(var H=A;H--;){var J=b[H];if(!(w?J in r:ze.call(r,J)))return!1}var te=d.get(e),oe=d.get(r);if(te&&oe)return te==r&&oe==e;var Ee=!0;d.set(e,r),d.set(r,e);for(var ae=w;++H<A;){J=b[H];var Se=e[J],Oe=r[J];if(c)var gr=w?c(Oe,Se,J,r,e,d):c(Se,Oe,J,e,r,d);if(!(gr===i?Se===Oe||l(Se,Oe,n,c,d):gr)){Ee=!1;break}ae||(ae=J=="constructor")}if(Ee&&!ae){var er=e.constructor,yr=r.constructor;er!=yr&&"constructor"in e&&"constructor"in r&&!(typeof er=="function"&&er instanceof er&&typeof yr=="function"&&yr instanceof yr)&&(Ee=!1)}return d.delete(e),d.delete(r),Ee}function ti(e){return Ta(Vu(e,i,th),e+"")}function Ia(e){return ou(e,qt,Aa)}function xa(e){return ou(e,ar,qu)}var Sa=Os?function(e){return Os.get(e)}:ka;function Hs(e){for(var r=e.name+"",n=sn[r],c=ze.call(sn,r)?n.length:0;c--;){var l=n[c],d=l.func;if(d==null||d==e)return l.name}return r}function un(e){var r=ze.call(f,"placeholder")?f:e;return r.placeholder}function ne(){var e=f.iteratee||Ba;return e=e===Ba?uu:e,arguments.length?e(arguments[0],arguments[1]):e}function ks(e,r){var n=e.__data__;return Xd(r)?n[typeof r=="string"?"string":"hash"]:n.map}function Pa(e){for(var r=qt(e),n=r.length;n--;){var c=r[n],l=e[c];r[n]=[c,l,ku(l)]}return r}function $i(e,r){var n=ep(e,r);return cu(n)?n:i}function kd(e){var r=ze.call(e,Ti),n=e[Ti];try{e[Ti]=i;var c=!0}catch{}var l=bs.call(e);return c&&(r?e[Ti]=n:delete e[Ti]),l}var Aa=ea?function(e){return e==null?[]:(e=Je(e),li(ea(e),function(r){return Gc.call(e,r)}))}:Ka,qu=ea?function(e){for(var r=[];e;)fi(r,Aa(e)),e=xs(e);return r}:Ka,Wt=Zt;(ta&&Wt(new ta(new ArrayBuffer(1)))!=Ke||Sn&&Wt(new Sn)!=be||ra&&Wt(ra.resolve())!=Pt||nn&&Wt(new nn)!=$e||Pn&&Wt(new Pn)!=qe)&&(Wt=function(e){var r=Zt(e),n=r==Pe?e.constructor:i,c=n?Mi(n):"";if(c)switch(c){case Pp:return Ke;case Ap:return be;case Cp:return Pt;case Op:return $e;case Rp:return qe}return r});function Kd(e,r,n){for(var c=-1,l=n.length;++c<l;){var d=n[c],w=d.size;switch(d.type){case"drop":e+=w;break;case"dropRight":r-=w;break;case"take":r=Gt(r,e+w);break;case"takeRight":e=jt(e,r-w);break}}return{start:e,end:r}}function Vd(e){var r=e.match(Xe);return r?r[1].split(Tt):[]}function Bu(e,r,n){r=vi(r,e);for(var c=-1,l=r.length,d=!1;++c<l;){var w=Kr(r[c]);if(!(d=e!=null&&n(e,w)))break;e=e[w]}return d||++c!=l?d:(l=e==null?0:e.length,!!l&&Xs(l)&&ri(w,l)&&(we(e)||ji(e)))}function Gd(e){var r=e.length,n=new e.constructor(r);return r&&typeof e[0]=="string"&&ze.call(e,"index")&&(n.index=e.index,n.input=e.input),n}function Hu(e){return typeof e.constructor=="function"&&!Fn(e)?on(xs(e)):{}}function Wd(e,r,n){var c=e.constructor;switch(r){case De:return _a(e);case N:case C:return new c(+e);case Ke:return Td(e,n);case ht:case je:case At:case $t:case Ht:case kt:case zt:case Jt:case ir:return Su(e,n);case be:return new c;case Ne:case Ze:return new c(e);case ot:return Nd(e);case $e:return new c;case Qe:return Dd(e)}}function Jd(e,r){var n=r.length;if(!n)return e;var c=n-1;return r[c]=(n>1?"& ":"")+r[c],r=r.join(n>2?", ":" "),e.replace(yt,`{
/* [wrapped with `+r+`] */
`)}function Yd(e){return we(e)||ji(e)||!!(Wc&&e&&e[Wc])}function ri(e,r){var n=typeof e;return r=r??V,!!r&&(n=="number"||n!="symbol"&&Ro.test(e))&&e>-1&&e%1==0&&e<r}function Qt(e,r,n){if(!ut(n))return!1;var c=typeof r;return(c=="number"?or(n)&&ri(r,n.length):c=="string"&&r in n)?Lr(n[r],e):!1}function Ca(e,r){if(we(e))return!1;var n=typeof e;return n=="number"||n=="symbol"||n=="boolean"||e==null||dr(e)?!0:Ct.test(e)||!nt.test(e)||r!=null&&e in Je(r)}function Xd(e){var r=typeof e;return r=="string"||r=="number"||r=="symbol"||r=="boolean"?e!=="__proto__":e===null}function Oa(e){var r=Hs(e),n=f[r];if(typeof n!="function"||!(r in Ae.prototype))return!1;if(e===n)return!0;var c=Sa(n);return!!c&&e===c[0]}function Zd(e){return!!kc&&kc in e}var Qd=ws?ii:Va;function Fn(e){var r=e&&e.constructor,n=typeof r=="function"&&r.prototype||rn;return e===n}function ku(e){return e===e&&!ut(e)}function Ku(e,r){return function(n){return n==null?!1:n[e]===r&&(r!==i||e in Je(n))}}function eg(e){var r=Js(e,function(c){return n.size===m&&n.clear(),c}),n=r.cache;return r}function tg(e,r){var n=e[1],c=r[1],l=n|c,d=l<(re|he|q),w=c==q&&n==fe||c==q&&n==W&&e[7].length<=r[8]||c==(q|W)&&r[7].length<=r[8]&&n==fe;if(!(d||w))return e;c&re&&(e[2]=r[2],l|=n&re?0:le);var b=r[3];if(b){var A=e[3];e[3]=A?Au(A,b,r[4]):b,e[4]=A?pi(e[3],x):r[4]}return b=r[5],b&&(A=e[5],e[5]=A?Cu(A,b,r[6]):b,e[6]=A?pi(e[5],x):r[6]),b=r[7],b&&(e[7]=b),c&q&&(e[8]=e[8]==null?r[8]:Gt(e[8],r[8])),e[9]==null&&(e[9]=r[9]),e[0]=r[0],e[1]=l,e}function rg(e){var r=[];if(e!=null)for(var n in Je(e))r.push(n);return r}function ig(e){return bs.call(e)}function Vu(e,r,n){return r=jt(r===i?e.length-1:r,0),function(){for(var c=arguments,l=-1,d=jt(c.length-r,0),w=T(d);++l<d;)w[l]=c[r+l];l=-1;for(var b=T(r+1);++l<r;)b[l]=c[l];return b[r]=n(w),Ut(e,this,b)}}function Gu(e,r){return r.length<2?e:Fi(e,xr(r,0,-1))}function ng(e,r){for(var n=e.length,c=Gt(r.length,n),l=sr(e);c--;){var d=r[c];e[c]=ri(d,n)?l[d]:i}return e}function Ra(e,r){if(!(r==="constructor"&&typeof e[r]=="function")&&r!="__proto__")return e[r]}var Wu=Yu(vu),$n=wp||function(e,r){return Ce.setTimeout(e,r)},Ta=Yu(Ad);function Ju(e,r,n){var c=r+"";return Ta(e,Jd(c,sg(Vd(c),n)))}function Yu(e){var r=0,n=0;return function(){var c=Ip(),l=Ue-(c-n);if(n=c,l>0){if(++r>=Te)return arguments[0]}else r=0;return e.apply(i,arguments)}}function Ks(e,r){var n=-1,c=e.length,l=c-1;for(r=r===i?c:r;++n<r;){var d=pa(n,l),w=e[d];e[d]=e[n],e[n]=w}return e.length=r,e}var Xu=eg(function(e){var r=[];return e.charCodeAt(0)===46&&r.push(""),e.replace(Ot,function(n,c,l,d){r.push(l?d.replace(xo,"$1"):c||n)}),r});function Kr(e){if(typeof e=="string"||dr(e))return e;var r=e+"";return r=="0"&&1/e==-ce?"-0":r}function Mi(e){if(e!=null){try{return _s.call(e)}catch{}try{return e+""}catch{}}return""}function sg(e,r){return _r(zr,function(n){var c="_."+n[0];r&n[1]&&!gs(e,c)&&e.push(c)}),e.sort()}function Zu(e){if(e instanceof Ae)return e.clone();var r=new Er(e.__wrapped__,e.__chain__);return r.__actions__=sr(e.__actions__),r.__index__=e.__index__,r.__values__=e.__values__,r}function og(e,r,n){(n?Qt(e,r,n):r===i)?r=1:r=jt(_e(r),0);var c=e==null?0:e.length;if(!c||r<1)return[];for(var l=0,d=0,w=T(As(c/r));l<c;)w[d++]=xr(e,l,l+=r);return w}function ag(e){for(var r=-1,n=e==null?0:e.length,c=0,l=[];++r<n;){var d=e[r];d&&(l[c++]=d)}return l}function cg(){var e=arguments.length;if(!e)return[];for(var r=T(e-1),n=arguments[0],c=e;c--;)r[c-1]=arguments[c];return fi(we(n)?sr(n):[n],Kt(r,1))}var ug=xe(function(e,r){return Et(e)?Rn(e,Kt(r,1,Et,!0)):[]}),hg=xe(function(e,r){var n=Sr(r);return Et(n)&&(n=i),Et(e)?Rn(e,Kt(r,1,Et,!0),ne(n,2)):[]}),lg=xe(function(e,r){var n=Sr(r);return Et(n)&&(n=i),Et(e)?Rn(e,Kt(r,1,Et,!0),i,n):[]});function fg(e,r,n){var c=e==null?0:e.length;return c?(r=n||r===i?1:_e(r),xr(e,r<0?0:r,c)):[]}function pg(e,r,n){var c=e==null?0:e.length;return c?(r=n||r===i?1:_e(r),r=c-r,xr(e,0,r<0?0:r)):[]}function dg(e,r){return e&&e.length?Ms(e,ne(r,3),!0,!0):[]}function gg(e,r){return e&&e.length?Ms(e,ne(r,3),!0):[]}function yg(e,r,n,c){var l=e==null?0:e.length;return l?(n&&typeof n!="number"&&Qt(e,r,n)&&(n=0,c=l),cd(e,r,n,c)):[]}function Qu(e,r,n){var c=e==null?0:e.length;if(!c)return-1;var l=n==null?0:_e(n);return l<0&&(l=jt(c+l,0)),ys(e,ne(r,3),l)}function eh(e,r,n){var c=e==null?0:e.length;if(!c)return-1;var l=c-1;return n!==i&&(l=_e(n),l=n<0?jt(c+l,0):Gt(l,c-1)),ys(e,ne(r,3),l,!0)}function th(e){var r=e==null?0:e.length;return r?Kt(e,1):[]}function vg(e){var r=e==null?0:e.length;return r?Kt(e,ce):[]}function mg(e,r){var n=e==null?0:e.length;return n?(r=r===i?1:_e(r),Kt(e,r)):[]}function wg(e){for(var r=-1,n=e==null?0:e.length,c={};++r<n;){var l=e[r];c[l[0]]=l[1]}return c}function rh(e){return e&&e.length?e[0]:i}function _g(e,r,n){var c=e==null?0:e.length;if(!c)return-1;var l=n==null?0:_e(n);return l<0&&(l=jt(c+l,0)),Zi(e,r,l)}function bg(e){var r=e==null?0:e.length;return r?xr(e,0,-1):[]}var Eg=xe(function(e){var r=st(e,ma);return r.length&&r[0]===e[0]?ca(r):[]}),Ig=xe(function(e){var r=Sr(e),n=st(e,ma);return r===Sr(n)?r=i:n.pop(),n.length&&n[0]===e[0]?ca(n,ne(r,2)):[]}),xg=xe(function(e){var r=Sr(e),n=st(e,ma);return r=typeof r=="function"?r:i,r&&n.pop(),n.length&&n[0]===e[0]?ca(n,i,r):[]});function Sg(e,r){return e==null?"":bp.call(e,r)}function Sr(e){var r=e==null?0:e.length;return r?e[r-1]:i}function Pg(e,r,n){var c=e==null?0:e.length;if(!c)return-1;var l=c;return n!==i&&(l=_e(n),l=l<0?jt(c+l,0):Gt(l,c-1)),r===r?sp(e,r,l):ys(e,$c,l,!0)}function Ag(e,r){return e&&e.length?pu(e,_e(r)):i}var Cg=xe(ih);function ih(e,r){return e&&e.length&&r&&r.length?fa(e,r):e}function Og(e,r,n){return e&&e.length&&r&&r.length?fa(e,r,ne(n,2)):e}function Rg(e,r,n){return e&&e.length&&r&&r.length?fa(e,r,i,n):e}var Tg=ti(function(e,r){var n=e==null?0:e.length,c=na(e,r);return yu(e,st(r,function(l){return ri(l,n)?+l:l}).sort(Pu)),c});function Ng(e,r){var n=[];if(!(e&&e.length))return n;var c=-1,l=[],d=e.length;for(r=ne(r,3);++c<d;){var w=e[c];r(w,c,e)&&(n.push(w),l.push(c))}return yu(e,l),n}function Na(e){return e==null?e:Sp.call(e)}function Dg(e,r,n){var c=e==null?0:e.length;return c?(n&&typeof n!="number"&&Qt(e,r,n)?(r=0,n=c):(r=r==null?0:_e(r),n=n===i?c:_e(n)),xr(e,r,n)):[]}function Lg(e,r){return $s(e,r)}function Fg(e,r,n){return ga(e,r,ne(n,2))}function $g(e,r){var n=e==null?0:e.length;if(n){var c=$s(e,r);if(c<n&&Lr(e[c],r))return c}return-1}function Mg(e,r){return $s(e,r,!0)}function jg(e,r,n){return ga(e,r,ne(n,2),!0)}function zg(e,r){var n=e==null?0:e.length;if(n){var c=$s(e,r,!0)-1;if(Lr(e[c],r))return c}return-1}function Ug(e){return e&&e.length?mu(e):[]}function qg(e,r){return e&&e.length?mu(e,ne(r,2)):[]}function Bg(e){var r=e==null?0:e.length;return r?xr(e,1,r):[]}function Hg(e,r,n){return e&&e.length?(r=n||r===i?1:_e(r),xr(e,0,r<0?0:r)):[]}function kg(e,r,n){var c=e==null?0:e.length;return c?(r=n||r===i?1:_e(r),r=c-r,xr(e,r<0?0:r,c)):[]}function Kg(e,r){return e&&e.length?Ms(e,ne(r,3),!1,!0):[]}function Vg(e,r){return e&&e.length?Ms(e,ne(r,3)):[]}var Gg=xe(function(e){return yi(Kt(e,1,Et,!0))}),Wg=xe(function(e){var r=Sr(e);return Et(r)&&(r=i),yi(Kt(e,1,Et,!0),ne(r,2))}),Jg=xe(function(e){var r=Sr(e);return r=typeof r=="function"?r:i,yi(Kt(e,1,Et,!0),i,r)});function Yg(e){return e&&e.length?yi(e):[]}function Xg(e,r){return e&&e.length?yi(e,ne(r,2)):[]}function Zg(e,r){return r=typeof r=="function"?r:i,e&&e.length?yi(e,i,r):[]}function Da(e){if(!(e&&e.length))return[];var r=0;return e=li(e,function(n){if(Et(n))return r=jt(n.length,r),!0}),Yo(r,function(n){return st(e,Go(n))})}function nh(e,r){if(!(e&&e.length))return[];var n=Da(e);return r==null?n:st(n,function(c){return Ut(r,i,c)})}var Qg=xe(function(e,r){return Et(e)?Rn(e,r):[]}),ey=xe(function(e){return va(li(e,Et))}),ty=xe(function(e){var r=Sr(e);return Et(r)&&(r=i),va(li(e,Et),ne(r,2))}),ry=xe(function(e){var r=Sr(e);return r=typeof r=="function"?r:i,va(li(e,Et),i,r)}),iy=xe(Da);function ny(e,r){return Eu(e||[],r||[],On)}function sy(e,r){return Eu(e||[],r||[],Dn)}var oy=xe(function(e){var r=e.length,n=r>1?e[r-1]:i;return n=typeof n=="function"?(e.pop(),n):i,nh(e,n)});function sh(e){var r=f(e);return r.__chain__=!0,r}function ay(e,r){return r(e),e}function Vs(e,r){return r(e)}var cy=ti(function(e){var r=e.length,n=r?e[0]:0,c=this.__wrapped__,l=function(d){return na(d,e)};return r>1||this.__actions__.length||!(c instanceof Ae)||!ri(n)?this.thru(l):(c=c.slice(n,+n+(r?1:0)),c.__actions__.push({func:Vs,args:[l],thisArg:i}),new Er(c,this.__chain__).thru(function(d){return r&&!d.length&&d.push(i),d}))});function uy(){return sh(this)}function hy(){return new Er(this.value(),this.__chain__)}function ly(){this.__values__===i&&(this.__values__=wh(this.value()));var e=this.__index__>=this.__values__.length,r=e?i:this.__values__[this.__index__++];return{done:e,value:r}}function fy(){return this}function py(e){for(var r,n=this;n instanceof Ts;){var c=Zu(n);c.__index__=0,c.__values__=i,r?l.__wrapped__=c:r=c;var l=c;n=n.__wrapped__}return l.__wrapped__=e,r}function dy(){var e=this.__wrapped__;if(e instanceof Ae){var r=e;return this.__actions__.length&&(r=new Ae(this)),r=r.reverse(),r.__actions__.push({func:Vs,args:[Na],thisArg:i}),new Er(r,this.__chain__)}return this.thru(Na)}function gy(){return bu(this.__wrapped__,this.__actions__)}var yy=js(function(e,r,n){ze.call(e,n)?++e[n]:Qr(e,n,1)});function vy(e,r,n){var c=we(e)?Lc:ad;return n&&Qt(e,r,n)&&(r=i),c(e,ne(r,3))}function my(e,r){var n=we(e)?li:nu;return n(e,ne(r,3))}var wy=Nu(Qu),_y=Nu(eh);function by(e,r){return Kt(Gs(e,r),1)}function Ey(e,r){return Kt(Gs(e,r),ce)}function Iy(e,r,n){return n=n===i?1:_e(n),Kt(Gs(e,r),n)}function oh(e,r){var n=we(e)?_r:gi;return n(e,ne(r,3))}function ah(e,r){var n=we(e)?Bf:iu;return n(e,ne(r,3))}var xy=js(function(e,r,n){ze.call(e,n)?e[n].push(r):Qr(e,n,[r])});function Sy(e,r,n,c){e=or(e)?e:ln(e),n=n&&!c?_e(n):0;var l=e.length;return n<0&&(n=jt(l+n,0)),Zs(e)?n<=l&&e.indexOf(r,n)>-1:!!l&&Zi(e,r,n)>-1}var Py=xe(function(e,r,n){var c=-1,l=typeof r=="function",d=or(e)?T(e.length):[];return gi(e,function(w){d[++c]=l?Ut(r,w,n):Tn(w,r,n)}),d}),Ay=js(function(e,r,n){Qr(e,n,r)});function Gs(e,r){var n=we(e)?st:hu;return n(e,ne(r,3))}function Cy(e,r,n,c){return e==null?[]:(we(r)||(r=r==null?[]:[r]),n=c?i:n,we(n)||(n=n==null?[]:[n]),du(e,r,n))}var Oy=js(function(e,r,n){e[n?0:1].push(r)},function(){return[[],[]]});function Ry(e,r,n){var c=we(e)?Ko:jc,l=arguments.length<3;return c(e,ne(r,4),n,l,gi)}function Ty(e,r,n){var c=we(e)?Hf:jc,l=arguments.length<3;return c(e,ne(r,4),n,l,iu)}function Ny(e,r){var n=we(e)?li:nu;return n(e,Ys(ne(r,3)))}function Dy(e){var r=we(e)?Qc:Sd;return r(e)}function Ly(e,r,n){(n?Qt(e,r,n):r===i)?r=1:r=_e(r);var c=we(e)?rd:Pd;return c(e,r)}function Fy(e){var r=we(e)?id:Cd;return r(e)}function $y(e){if(e==null)return 0;if(or(e))return Zs(e)?en(e):e.length;var r=Wt(e);return r==be||r==$e?e.size:ha(e).length}function My(e,r,n){var c=we(e)?Vo:Od;return n&&Qt(e,r,n)&&(r=i),c(e,ne(r,3))}var jy=xe(function(e,r){if(e==null)return[];var n=r.length;return n>1&&Qt(e,r[0],r[1])?r=[]:n>2&&Qt(r[0],r[1],r[2])&&(r=[r[0]]),du(e,Kt(r,1),[])}),Ws=mp||function(){return Ce.Date.now()};function zy(e,r){if(typeof r!="function")throw new br(p);return e=_e(e),function(){if(--e<1)return r.apply(this,arguments)}}function ch(e,r,n){return r=n?i:r,r=e&&r==null?e.length:r,ei(e,q,i,i,i,i,r)}function uh(e,r){var n;if(typeof r!="function")throw new br(p);return e=_e(e),function(){return--e>0&&(n=r.apply(this,arguments)),e<=1&&(r=i),n}}var La=xe(function(e,r,n){var c=re;if(n.length){var l=pi(n,un(La));c|=de}return ei(e,c,r,n,l)}),hh=xe(function(e,r,n){var c=re|he;if(n.length){var l=pi(n,un(hh));c|=de}return ei(r,c,e,n,l)});function lh(e,r,n){r=n?i:r;var c=ei(e,fe,i,i,i,i,i,r);return c.placeholder=lh.placeholder,c}function fh(e,r,n){r=n?i:r;var c=ei(e,pe,i,i,i,i,i,r);return c.placeholder=fh.placeholder,c}function ph(e,r,n){var c,l,d,w,b,A,M=0,j=!1,H=!1,J=!0;if(typeof e!="function")throw new br(p);r=Pr(r)||0,ut(n)&&(j=!!n.leading,H="maxWait"in n,d=H?jt(Pr(n.maxWait)||0,r):d,J="trailing"in n?!!n.trailing:J);function te(It){var Fr=c,si=l;return c=l=i,M=It,w=e.apply(si,Fr),w}function oe(It){return M=It,b=$n(Se,r),j?te(It):w}function Ee(It){var Fr=It-A,si=It-M,Nh=r-Fr;return H?Gt(Nh,d-si):Nh}function ae(It){var Fr=It-A,si=It-M;return A===i||Fr>=r||Fr<0||H&&si>=d}function Se(){var It=Ws();if(ae(It))return Oe(It);b=$n(Se,Ee(It))}function Oe(It){return b=i,J&&c?te(It):(c=l=i,w)}function gr(){b!==i&&Iu(b),M=0,c=A=l=b=i}function er(){return b===i?w:Oe(Ws())}function yr(){var It=Ws(),Fr=ae(It);if(c=arguments,l=this,A=It,Fr){if(b===i)return oe(A);if(H)return Iu(b),b=$n(Se,r),te(A)}return b===i&&(b=$n(Se,r)),w}return yr.cancel=gr,yr.flush=er,yr}var Uy=xe(function(e,r){return ru(e,1,r)}),qy=xe(function(e,r,n){return ru(e,Pr(r)||0,n)});function By(e){return ei(e,ve)}function Js(e,r){if(typeof e!="function"||r!=null&&typeof r!="function")throw new br(p);var n=function(){var c=arguments,l=r?r.apply(this,c):c[0],d=n.cache;if(d.has(l))return d.get(l);var w=e.apply(this,c);return n.cache=d.set(l,w)||d,w};return n.cache=new(Js.Cache||Zr),n}Js.Cache=Zr;function Ys(e){if(typeof e!="function")throw new br(p);return function(){var r=arguments;switch(r.length){case 0:return!e.call(this);case 1:return!e.call(this,r[0]);case 2:return!e.call(this,r[0],r[1]);case 3:return!e.call(this,r[0],r[1],r[2])}return!e.apply(this,r)}}function Hy(e){return uh(2,e)}var ky=Rd(function(e,r){r=r.length==1&&we(r[0])?st(r[0],fr(ne())):st(Kt(r,1),fr(ne()));var n=r.length;return xe(function(c){for(var l=-1,d=Gt(c.length,n);++l<d;)c[l]=r[l].call(this,c[l]);return Ut(e,this,c)})}),Fa=xe(function(e,r){var n=pi(r,un(Fa));return ei(e,de,i,r,n)}),dh=xe(function(e,r){var n=pi(r,un(dh));return ei(e,F,i,r,n)}),Ky=ti(function(e,r){return ei(e,W,i,i,i,r)});function Vy(e,r){if(typeof e!="function")throw new br(p);return r=r===i?r:_e(r),xe(e,r)}function Gy(e,r){if(typeof e!="function")throw new br(p);return r=r==null?0:jt(_e(r),0),xe(function(n){var c=n[r],l=mi(n,0,r);return c&&fi(l,c),Ut(e,this,l)})}function Wy(e,r,n){var c=!0,l=!0;if(typeof e!="function")throw new br(p);return ut(n)&&(c="leading"in n?!!n.leading:c,l="trailing"in n?!!n.trailing:l),ph(e,r,{leading:c,maxWait:r,trailing:l})}function Jy(e){return ch(e,1)}function Yy(e,r){return Fa(wa(r),e)}function Xy(){if(!arguments.length)return[];var e=arguments[0];return we(e)?e:[e]}function Zy(e){return Ir(e,z)}function Qy(e,r){return r=typeof r=="function"?r:i,Ir(e,z,r)}function ev(e){return Ir(e,O|z)}function tv(e,r){return r=typeof r=="function"?r:i,Ir(e,O|z,r)}function rv(e,r){return r==null||tu(e,r,qt(r))}function Lr(e,r){return e===r||e!==e&&r!==r}var iv=Bs(aa),nv=Bs(function(e,r){return e>=r}),ji=au(function(){return arguments}())?au:function(e){return vt(e)&&ze.call(e,"callee")&&!Gc.call(e,"callee")},we=T.isArray,sv=Xt?fr(Xt):pd;function or(e){return e!=null&&Xs(e.length)&&!ii(e)}function Et(e){return vt(e)&&or(e)}function ov(e){return e===!0||e===!1||vt(e)&&Zt(e)==N}var wi=_p||Va,av=Tr?fr(Tr):dd;function cv(e){return vt(e)&&e.nodeType===1&&!Mn(e)}function uv(e){if(e==null)return!0;if(or(e)&&(we(e)||typeof e=="string"||typeof e.splice=="function"||wi(e)||hn(e)||ji(e)))return!e.length;var r=Wt(e);if(r==be||r==$e)return!e.size;if(Fn(e))return!ha(e).length;for(var n in e)if(ze.call(e,n))return!1;return!0}function hv(e,r){return Nn(e,r)}function lv(e,r,n){n=typeof n=="function"?n:i;var c=n?n(e,r):i;return c===i?Nn(e,r,i,n):!!c}function $a(e){if(!vt(e))return!1;var r=Zt(e);return r==E||r==u||typeof e.message=="string"&&typeof e.name=="string"&&!Mn(e)}function fv(e){return typeof e=="number"&&Jc(e)}function ii(e){if(!ut(e))return!1;var r=Zt(e);return r==ee||r==ge||r==D||r==wt}function gh(e){return typeof e=="number"&&e==_e(e)}function Xs(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=V}function ut(e){var r=typeof e;return e!=null&&(r=="object"||r=="function")}function vt(e){return e!=null&&typeof e=="object"}var yh=wr?fr(wr):yd;function pv(e,r){return e===r||ua(e,r,Pa(r))}function dv(e,r,n){return n=typeof n=="function"?n:i,ua(e,r,Pa(r),n)}function gv(e){return vh(e)&&e!=+e}function yv(e){if(Qd(e))throw new ye(h);return cu(e)}function vv(e){return e===null}function mv(e){return e==null}function vh(e){return typeof e=="number"||vt(e)&&Zt(e)==Ne}function Mn(e){if(!vt(e)||Zt(e)!=Pe)return!1;var r=xs(e);if(r===null)return!0;var n=ze.call(r,"constructor")&&r.constructor;return typeof n=="function"&&n instanceof n&&_s.call(n)==dp}var Ma=Br?fr(Br):vd;function wv(e){return gh(e)&&e>=-V&&e<=V}var mh=En?fr(En):md;function Zs(e){return typeof e=="string"||!we(e)&&vt(e)&&Zt(e)==Ze}function dr(e){return typeof e=="symbol"||vt(e)&&Zt(e)==Qe}var hn=Ri?fr(Ri):wd;function _v(e){return e===i}function bv(e){return vt(e)&&Wt(e)==qe}function Ev(e){return vt(e)&&Zt(e)==et}var Iv=Bs(la),xv=Bs(function(e,r){return e<=r});function wh(e){if(!e)return[];if(or(e))return Zs(e)?Nr(e):sr(e);if(xn&&e[xn])return rp(e[xn]());var r=Wt(e),n=r==be?Zo:r==$e?vs:ln;return n(e)}function ni(e){if(!e)return e===0?e:0;if(e=Pr(e),e===ce||e===-ce){var r=e<0?-1:1;return r*B}return e===e?e:0}function _e(e){var r=ni(e),n=r%1;return r===r?n?r-n:r:0}function _h(e){return e?Li(_e(e),0,G):0}function Pr(e){if(typeof e=="number")return e;if(dr(e))return k;if(ut(e)){var r=typeof e.valueOf=="function"?e.valueOf():e;e=ut(r)?r+"":r}if(typeof e!="string")return e===0?e:+e;e=zc(e);var n=Ao.test(e);return n||Oo.test(e)?me(e.slice(2),n?2:8):Po.test(e)?k:+e}function bh(e){return kr(e,ar(e))}function Sv(e){return e?Li(_e(e),-V,V):e===0?e:0}function Me(e){return e==null?"":pr(e)}var Pv=an(function(e,r){if(Fn(r)||or(r)){kr(r,qt(r),e);return}for(var n in r)ze.call(r,n)&&On(e,n,r[n])}),Eh=an(function(e,r){kr(r,ar(r),e)}),Qs=an(function(e,r,n,c){kr(r,ar(r),e,c)}),Av=an(function(e,r,n,c){kr(r,qt(r),e,c)}),Cv=ti(na);function Ov(e,r){var n=on(e);return r==null?n:eu(n,r)}var Rv=xe(function(e,r){e=Je(e);var n=-1,c=r.length,l=c>2?r[2]:i;for(l&&Qt(r[0],r[1],l)&&(c=1);++n<c;)for(var d=r[n],w=ar(d),b=-1,A=w.length;++b<A;){var M=w[b],j=e[M];(j===i||Lr(j,rn[M])&&!ze.call(e,M))&&(e[M]=d[M])}return e}),Tv=xe(function(e){return e.push(i,zu),Ut(Ih,i,e)});function Nv(e,r){return Fc(e,ne(r,3),Hr)}function Dv(e,r){return Fc(e,ne(r,3),oa)}function Lv(e,r){return e==null?e:sa(e,ne(r,3),ar)}function Fv(e,r){return e==null?e:su(e,ne(r,3),ar)}function $v(e,r){return e&&Hr(e,ne(r,3))}function Mv(e,r){return e&&oa(e,ne(r,3))}function jv(e){return e==null?[]:Ls(e,qt(e))}function zv(e){return e==null?[]:Ls(e,ar(e))}function ja(e,r,n){var c=e==null?i:Fi(e,r);return c===i?n:c}function Uv(e,r){return e!=null&&Bu(e,r,ud)}function za(e,r){return e!=null&&Bu(e,r,hd)}var qv=Lu(function(e,r,n){r!=null&&typeof r.toString!="function"&&(r=bs.call(r)),e[r]=n},qa(cr)),Bv=Lu(function(e,r,n){r!=null&&typeof r.toString!="function"&&(r=bs.call(r)),ze.call(e,r)?e[r].push(n):e[r]=[n]},ne),Hv=xe(Tn);function qt(e){return or(e)?Zc(e):ha(e)}function ar(e){return or(e)?Zc(e,!0):_d(e)}function kv(e,r){var n={};return r=ne(r,3),Hr(e,function(c,l,d){Qr(n,r(c,l,d),c)}),n}function Kv(e,r){var n={};return r=ne(r,3),Hr(e,function(c,l,d){Qr(n,l,r(c,l,d))}),n}var Vv=an(function(e,r,n){Fs(e,r,n)}),Ih=an(function(e,r,n,c){Fs(e,r,n,c)}),Gv=ti(function(e,r){var n={};if(e==null)return n;var c=!1;r=st(r,function(d){return d=vi(d,e),c||(c=d.length>1),d}),kr(e,xa(e),n),c&&(n=Ir(n,O|L|z,qd));for(var l=r.length;l--;)ya(n,r[l]);return n});function Wv(e,r){return xh(e,Ys(ne(r)))}var Jv=ti(function(e,r){return e==null?{}:Ed(e,r)});function xh(e,r){if(e==null)return{};var n=st(xa(e),function(c){return[c]});return r=ne(r),gu(e,n,function(c,l){return r(c,l[0])})}function Yv(e,r,n){r=vi(r,e);var c=-1,l=r.length;for(l||(l=1,e=i);++c<l;){var d=e==null?i:e[Kr(r[c])];d===i&&(c=l,d=n),e=ii(d)?d.call(e):d}return e}function Xv(e,r,n){return e==null?e:Dn(e,r,n)}function Zv(e,r,n,c){return c=typeof c=="function"?c:i,e==null?e:Dn(e,r,n,c)}var Sh=Mu(qt),Ph=Mu(ar);function Qv(e,r,n){var c=we(e),l=c||wi(e)||hn(e);if(r=ne(r,4),n==null){var d=e&&e.constructor;l?n=c?new d:[]:ut(e)?n=ii(d)?on(xs(e)):{}:n={}}return(l?_r:Hr)(e,function(w,b,A){return r(n,w,b,A)}),n}function e0(e,r){return e==null?!0:ya(e,r)}function t0(e,r,n){return e==null?e:_u(e,r,wa(n))}function r0(e,r,n,c){return c=typeof c=="function"?c:i,e==null?e:_u(e,r,wa(n),c)}function ln(e){return e==null?[]:Xo(e,qt(e))}function i0(e){return e==null?[]:Xo(e,ar(e))}function n0(e,r,n){return n===i&&(n=r,r=i),n!==i&&(n=Pr(n),n=n===n?n:0),r!==i&&(r=Pr(r),r=r===r?r:0),Li(Pr(e),r,n)}function s0(e,r,n){return r=ni(r),n===i?(n=r,r=0):n=ni(n),e=Pr(e),ld(e,r,n)}function o0(e,r,n){if(n&&typeof n!="boolean"&&Qt(e,r,n)&&(r=n=i),n===i&&(typeof r=="boolean"?(n=r,r=i):typeof e=="boolean"&&(n=e,e=i)),e===i&&r===i?(e=0,r=1):(e=ni(e),r===i?(r=e,e=0):r=ni(r)),e>r){var c=e;e=r,r=c}if(n||e%1||r%1){var l=Yc();return Gt(e+l*(r-e+Ge("1e-"+((l+"").length-1))),r)}return pa(e,r)}var a0=cn(function(e,r,n){return r=r.toLowerCase(),e+(n?Ah(r):r)});function Ah(e){return Ua(Me(e).toLowerCase())}function Ch(e){return e=Me(e),e&&e.replace(Jr,Xf).replace(Bo,"")}function c0(e,r,n){e=Me(e),r=pr(r);var c=e.length;n=n===i?c:Li(_e(n),0,c);var l=n;return n-=r.length,n>=0&&e.slice(n,l)==r}function u0(e){return e=Me(e),e&&it.test(e)?e.replace(Si,Zf):e}function h0(e){return e=Me(e),e&&Rt.test(e)?e.replace(dt,"\\$&"):e}var l0=cn(function(e,r,n){return e+(n?"-":"")+r.toLowerCase()}),f0=cn(function(e,r,n){return e+(n?" ":"")+r.toLowerCase()}),p0=Tu("toLowerCase");function d0(e,r,n){e=Me(e),r=_e(r);var c=r?en(e):0;if(!r||c>=r)return e;var l=(r-c)/2;return qs(Cs(l),n)+e+qs(As(l),n)}function g0(e,r,n){e=Me(e),r=_e(r);var c=r?en(e):0;return r&&c<r?e+qs(r-c,n):e}function y0(e,r,n){e=Me(e),r=_e(r);var c=r?en(e):0;return r&&c<r?qs(r-c,n)+e:e}function v0(e,r,n){return n||r==null?r=0:r&&(r=+r),xp(Me(e).replace(gt,""),r||0)}function m0(e,r,n){return(n?Qt(e,r,n):r===i)?r=1:r=_e(r),da(Me(e),r)}function w0(){var e=arguments,r=Me(e[0]);return e.length<3?r:r.replace(e[1],e[2])}var _0=cn(function(e,r,n){return e+(n?"_":"")+r.toLowerCase()});function b0(e,r,n){return n&&typeof n!="number"&&Qt(e,r,n)&&(r=n=i),n=n===i?G:n>>>0,n?(e=Me(e),e&&(typeof r=="string"||r!=null&&!Ma(r))&&(r=pr(r),!r&&Qi(e))?mi(Nr(e),0,n):e.split(r,n)):[]}var E0=cn(function(e,r,n){return e+(n?" ":"")+Ua(r)});function I0(e,r,n){return e=Me(e),n=n==null?0:Li(_e(n),0,e.length),r=pr(r),e.slice(n,n+r.length)==r}function x0(e,r,n){var c=f.templateSettings;n&&Qt(e,r,n)&&(r=i),e=Me(e),r=Qs({},r,c,ju);var l=Qs({},r.imports,c.imports,ju),d=qt(l),w=Xo(l,d),b,A,M=0,j=r.interpolate||Ki,H="__p += '",J=Qo((r.escape||Ki).source+"|"+j.source+"|"+(j===ct?So:Ki).source+"|"+(r.evaluate||Ki).source+"|$","g"),te="//# sourceURL="+(ze.call(r,"sourceURL")?(r.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Ho+"]")+`
`;e.replace(J,function(ae,Se,Oe,gr,er,yr){return Oe||(Oe=gr),H+=e.slice(M,yr).replace(To,Qf),Se&&(b=!0,H+=`' +
__e(`+Se+`) +
'`),er&&(A=!0,H+=`';
`+er+`;
__p += '`),Oe&&(H+=`' +
((__t = (`+Oe+`)) == null ? '' : __t) +
'`),M=yr+ae.length,ae}),H+=`';
`;var oe=ze.call(r,"variable")&&r.variable;if(!oe)H=`with (obj) {
`+H+`
}
`;else if(Io.test(oe))throw new ye(g);H=(A?H.replace(Ur,""):H).replace(Yt,"$1").replace(Wr,"$1;"),H="function("+(oe||"obj")+`) {
`+(oe?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(b?", __e = _.escape":"")+(A?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+H+`return __p
}`;var Ee=Rh(function(){return Fe(d,te+"return "+H).apply(i,w)});if(Ee.source=H,$a(Ee))throw Ee;return Ee}function S0(e){return Me(e).toLowerCase()}function P0(e){return Me(e).toUpperCase()}function A0(e,r,n){if(e=Me(e),e&&(n||r===i))return zc(e);if(!e||!(r=pr(r)))return e;var c=Nr(e),l=Nr(r),d=Uc(c,l),w=qc(c,l)+1;return mi(c,d,w).join("")}function C0(e,r,n){if(e=Me(e),e&&(n||r===i))return e.slice(0,Hc(e)+1);if(!e||!(r=pr(r)))return e;var c=Nr(e),l=qc(c,Nr(r))+1;return mi(c,0,l).join("")}function O0(e,r,n){if(e=Me(e),e&&(n||r===i))return e.replace(gt,"");if(!e||!(r=pr(r)))return e;var c=Nr(e),l=Uc(c,Nr(r));return mi(c,l).join("")}function R0(e,r){var n=ie,c=ue;if(ut(r)){var l="separator"in r?r.separator:l;n="length"in r?_e(r.length):n,c="omission"in r?pr(r.omission):c}e=Me(e);var d=e.length;if(Qi(e)){var w=Nr(e);d=w.length}if(n>=d)return e;var b=n-en(c);if(b<1)return c;var A=w?mi(w,0,b).join(""):e.slice(0,b);if(l===i)return A+c;if(w&&(b+=A.length-b),Ma(l)){if(e.slice(b).search(l)){var M,j=A;for(l.global||(l=Qo(l.source,Me(mr.exec(l))+"g")),l.lastIndex=0;M=l.exec(j);)var H=M.index;A=A.slice(0,H===i?b:H)}}else if(e.indexOf(pr(l),b)!=b){var J=A.lastIndexOf(l);J>-1&&(A=A.slice(0,J))}return A+c}function T0(e){return e=Me(e),e&&lt.test(e)?e.replace(ui,op):e}var N0=cn(function(e,r,n){return e+(n?" ":"")+r.toUpperCase()}),Ua=Tu("toUpperCase");function Oh(e,r,n){return e=Me(e),r=n?i:r,r===i?tp(e)?up(e):Vf(e):e.match(r)||[]}var Rh=xe(function(e,r){try{return Ut(e,i,r)}catch(n){return $a(n)?n:new ye(n)}}),D0=ti(function(e,r){return _r(r,function(n){n=Kr(n),Qr(e,n,La(e[n],e))}),e});function L0(e){var r=e==null?0:e.length,n=ne();return e=r?st(e,function(c){if(typeof c[1]!="function")throw new br(p);return[n(c[0]),c[1]]}):[],xe(function(c){for(var l=-1;++l<r;){var d=e[l];if(Ut(d[0],this,c))return Ut(d[1],this,c)}})}function F0(e){return od(Ir(e,O))}function qa(e){return function(){return e}}function $0(e,r){return e==null||e!==e?r:e}var M0=Du(),j0=Du(!0);function cr(e){return e}function Ba(e){return uu(typeof e=="function"?e:Ir(e,O))}function z0(e){return lu(Ir(e,O))}function U0(e,r){return fu(e,Ir(r,O))}var q0=xe(function(e,r){return function(n){return Tn(n,e,r)}}),B0=xe(function(e,r){return function(n){return Tn(e,n,r)}});function Ha(e,r,n){var c=qt(r),l=Ls(r,c);n==null&&!(ut(r)&&(l.length||!c.length))&&(n=r,r=e,e=this,l=Ls(r,qt(r)));var d=!(ut(n)&&"chain"in n)||!!n.chain,w=ii(e);return _r(l,function(b){var A=r[b];e[b]=A,w&&(e.prototype[b]=function(){var M=this.__chain__;if(d||M){var j=e(this.__wrapped__),H=j.__actions__=sr(this.__actions__);return H.push({func:A,args:arguments,thisArg:e}),j.__chain__=M,j}return A.apply(e,fi([this.value()],arguments))})}),e}function H0(){return Ce._===this&&(Ce._=gp),this}function ka(){}function k0(e){return e=_e(e),xe(function(r){return pu(r,e)})}var K0=ba(st),V0=ba(Lc),G0=ba(Vo);function Th(e){return Ca(e)?Go(Kr(e)):Id(e)}function W0(e){return function(r){return e==null?i:Fi(e,r)}}var J0=Fu(),Y0=Fu(!0);function Ka(){return[]}function Va(){return!1}function X0(){return{}}function Z0(){return""}function Q0(){return!0}function em(e,r){if(e=_e(e),e<1||e>V)return[];var n=G,c=Gt(e,G);r=ne(r),e-=G;for(var l=Yo(c,r);++n<e;)r(n);return l}function tm(e){return we(e)?st(e,Kr):dr(e)?[e]:sr(Xu(Me(e)))}function rm(e){var r=++pp;return Me(e)+r}var im=Us(function(e,r){return e+r},0),nm=Ea("ceil"),sm=Us(function(e,r){return e/r},1),om=Ea("floor");function am(e){return e&&e.length?Ds(e,cr,aa):i}function cm(e,r){return e&&e.length?Ds(e,ne(r,2),aa):i}function um(e){return Mc(e,cr)}function hm(e,r){return Mc(e,ne(r,2))}function lm(e){return e&&e.length?Ds(e,cr,la):i}function fm(e,r){return e&&e.length?Ds(e,ne(r,2),la):i}var pm=Us(function(e,r){return e*r},1),dm=Ea("round"),gm=Us(function(e,r){return e-r},0);function ym(e){return e&&e.length?Jo(e,cr):0}function vm(e,r){return e&&e.length?Jo(e,ne(r,2)):0}return f.after=zy,f.ary=ch,f.assign=Pv,f.assignIn=Eh,f.assignInWith=Qs,f.assignWith=Av,f.at=Cv,f.before=uh,f.bind=La,f.bindAll=D0,f.bindKey=hh,f.castArray=Xy,f.chain=sh,f.chunk=og,f.compact=ag,f.concat=cg,f.cond=L0,f.conforms=F0,f.constant=qa,f.countBy=yy,f.create=Ov,f.curry=lh,f.curryRight=fh,f.debounce=ph,f.defaults=Rv,f.defaultsDeep=Tv,f.defer=Uy,f.delay=qy,f.difference=ug,f.differenceBy=hg,f.differenceWith=lg,f.drop=fg,f.dropRight=pg,f.dropRightWhile=dg,f.dropWhile=gg,f.fill=yg,f.filter=my,f.flatMap=by,f.flatMapDeep=Ey,f.flatMapDepth=Iy,f.flatten=th,f.flattenDeep=vg,f.flattenDepth=mg,f.flip=By,f.flow=M0,f.flowRight=j0,f.fromPairs=wg,f.functions=jv,f.functionsIn=zv,f.groupBy=xy,f.initial=bg,f.intersection=Eg,f.intersectionBy=Ig,f.intersectionWith=xg,f.invert=qv,f.invertBy=Bv,f.invokeMap=Py,f.iteratee=Ba,f.keyBy=Ay,f.keys=qt,f.keysIn=ar,f.map=Gs,f.mapKeys=kv,f.mapValues=Kv,f.matches=z0,f.matchesProperty=U0,f.memoize=Js,f.merge=Vv,f.mergeWith=Ih,f.method=q0,f.methodOf=B0,f.mixin=Ha,f.negate=Ys,f.nthArg=k0,f.omit=Gv,f.omitBy=Wv,f.once=Hy,f.orderBy=Cy,f.over=K0,f.overArgs=ky,f.overEvery=V0,f.overSome=G0,f.partial=Fa,f.partialRight=dh,f.partition=Oy,f.pick=Jv,f.pickBy=xh,f.property=Th,f.propertyOf=W0,f.pull=Cg,f.pullAll=ih,f.pullAllBy=Og,f.pullAllWith=Rg,f.pullAt=Tg,f.range=J0,f.rangeRight=Y0,f.rearg=Ky,f.reject=Ny,f.remove=Ng,f.rest=Vy,f.reverse=Na,f.sampleSize=Ly,f.set=Xv,f.setWith=Zv,f.shuffle=Fy,f.slice=Dg,f.sortBy=jy,f.sortedUniq=Ug,f.sortedUniqBy=qg,f.split=b0,f.spread=Gy,f.tail=Bg,f.take=Hg,f.takeRight=kg,f.takeRightWhile=Kg,f.takeWhile=Vg,f.tap=ay,f.throttle=Wy,f.thru=Vs,f.toArray=wh,f.toPairs=Sh,f.toPairsIn=Ph,f.toPath=tm,f.toPlainObject=bh,f.transform=Qv,f.unary=Jy,f.union=Gg,f.unionBy=Wg,f.unionWith=Jg,f.uniq=Yg,f.uniqBy=Xg,f.uniqWith=Zg,f.unset=e0,f.unzip=Da,f.unzipWith=nh,f.update=t0,f.updateWith=r0,f.values=ln,f.valuesIn=i0,f.without=Qg,f.words=Oh,f.wrap=Yy,f.xor=ey,f.xorBy=ty,f.xorWith=ry,f.zip=iy,f.zipObject=ny,f.zipObjectDeep=sy,f.zipWith=oy,f.entries=Sh,f.entriesIn=Ph,f.extend=Eh,f.extendWith=Qs,Ha(f,f),f.add=im,f.attempt=Rh,f.camelCase=a0,f.capitalize=Ah,f.ceil=nm,f.clamp=n0,f.clone=Zy,f.cloneDeep=ev,f.cloneDeepWith=tv,f.cloneWith=Qy,f.conformsTo=rv,f.deburr=Ch,f.defaultTo=$0,f.divide=sm,f.endsWith=c0,f.eq=Lr,f.escape=u0,f.escapeRegExp=h0,f.every=vy,f.find=wy,f.findIndex=Qu,f.findKey=Nv,f.findLast=_y,f.findLastIndex=eh,f.findLastKey=Dv,f.floor=om,f.forEach=oh,f.forEachRight=ah,f.forIn=Lv,f.forInRight=Fv,f.forOwn=$v,f.forOwnRight=Mv,f.get=ja,f.gt=iv,f.gte=nv,f.has=Uv,f.hasIn=za,f.head=rh,f.identity=cr,f.includes=Sy,f.indexOf=_g,f.inRange=s0,f.invoke=Hv,f.isArguments=ji,f.isArray=we,f.isArrayBuffer=sv,f.isArrayLike=or,f.isArrayLikeObject=Et,f.isBoolean=ov,f.isBuffer=wi,f.isDate=av,f.isElement=cv,f.isEmpty=uv,f.isEqual=hv,f.isEqualWith=lv,f.isError=$a,f.isFinite=fv,f.isFunction=ii,f.isInteger=gh,f.isLength=Xs,f.isMap=yh,f.isMatch=pv,f.isMatchWith=dv,f.isNaN=gv,f.isNative=yv,f.isNil=mv,f.isNull=vv,f.isNumber=vh,f.isObject=ut,f.isObjectLike=vt,f.isPlainObject=Mn,f.isRegExp=Ma,f.isSafeInteger=wv,f.isSet=mh,f.isString=Zs,f.isSymbol=dr,f.isTypedArray=hn,f.isUndefined=_v,f.isWeakMap=bv,f.isWeakSet=Ev,f.join=Sg,f.kebabCase=l0,f.last=Sr,f.lastIndexOf=Pg,f.lowerCase=f0,f.lowerFirst=p0,f.lt=Iv,f.lte=xv,f.max=am,f.maxBy=cm,f.mean=um,f.meanBy=hm,f.min=lm,f.minBy=fm,f.stubArray=Ka,f.stubFalse=Va,f.stubObject=X0,f.stubString=Z0,f.stubTrue=Q0,f.multiply=pm,f.nth=Ag,f.noConflict=H0,f.noop=ka,f.now=Ws,f.pad=d0,f.padEnd=g0,f.padStart=y0,f.parseInt=v0,f.random=o0,f.reduce=Ry,f.reduceRight=Ty,f.repeat=m0,f.replace=w0,f.result=Yv,f.round=dm,f.runInContext=P,f.sample=Dy,f.size=$y,f.snakeCase=_0,f.some=My,f.sortedIndex=Lg,f.sortedIndexBy=Fg,f.sortedIndexOf=$g,f.sortedLastIndex=Mg,f.sortedLastIndexBy=jg,f.sortedLastIndexOf=zg,f.startCase=E0,f.startsWith=I0,f.subtract=gm,f.sum=ym,f.sumBy=vm,f.template=x0,f.times=em,f.toFinite=ni,f.toInteger=_e,f.toLength=_h,f.toLower=S0,f.toNumber=Pr,f.toSafeInteger=Sv,f.toString=Me,f.toUpper=P0,f.trim=A0,f.trimEnd=C0,f.trimStart=O0,f.truncate=R0,f.unescape=T0,f.uniqueId=rm,f.upperCase=N0,f.upperFirst=Ua,f.each=oh,f.eachRight=ah,f.first=rh,Ha(f,function(){var e={};return Hr(f,function(r,n){ze.call(f.prototype,n)||(e[n]=r)}),e}(),{chain:!1}),f.VERSION=s,_r(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){f[e].placeholder=f}),_r(["drop","take"],function(e,r){Ae.prototype[e]=function(n){n=n===i?1:jt(_e(n),0);var c=this.__filtered__&&!r?new Ae(this):this.clone();return c.__filtered__?c.__takeCount__=Gt(n,c.__takeCount__):c.__views__.push({size:Gt(n,G),type:e+(c.__dir__<0?"Right":"")}),c},Ae.prototype[e+"Right"]=function(n){return this.reverse()[e](n).reverse()}}),_r(["filter","map","takeWhile"],function(e,r){var n=r+1,c=n==v||n==X;Ae.prototype[e]=function(l){var d=this.clone();return d.__iteratees__.push({iteratee:ne(l,3),type:n}),d.__filtered__=d.__filtered__||c,d}}),_r(["head","last"],function(e,r){var n="take"+(r?"Right":"");Ae.prototype[e]=function(){return this[n](1).value()[0]}}),_r(["initial","tail"],function(e,r){var n="drop"+(r?"":"Right");Ae.prototype[e]=function(){return this.__filtered__?new Ae(this):this[n](1)}}),Ae.prototype.compact=function(){return this.filter(cr)},Ae.prototype.find=function(e){return this.filter(e).head()},Ae.prototype.findLast=function(e){return this.reverse().find(e)},Ae.prototype.invokeMap=xe(function(e,r){return typeof e=="function"?new Ae(this):this.map(function(n){return Tn(n,e,r)})}),Ae.prototype.reject=function(e){return this.filter(Ys(ne(e)))},Ae.prototype.slice=function(e,r){e=_e(e);var n=this;return n.__filtered__&&(e>0||r<0)?new Ae(n):(e<0?n=n.takeRight(-e):e&&(n=n.drop(e)),r!==i&&(r=_e(r),n=r<0?n.dropRight(-r):n.take(r-e)),n)},Ae.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Ae.prototype.toArray=function(){return this.take(G)},Hr(Ae.prototype,function(e,r){var n=/^(?:filter|find|map|reject)|While$/.test(r),c=/^(?:head|last)$/.test(r),l=f[c?"take"+(r=="last"?"Right":""):r],d=c||/^find/.test(r);l&&(f.prototype[r]=function(){var w=this.__wrapped__,b=c?[1]:arguments,A=w instanceof Ae,M=b[0],j=A||we(w),H=function(Se){var Oe=l.apply(f,fi([Se],b));return c&&J?Oe[0]:Oe};j&&n&&typeof M=="function"&&M.length!=1&&(A=j=!1);var J=this.__chain__,te=!!this.__actions__.length,oe=d&&!J,Ee=A&&!te;if(!d&&j){w=Ee?w:new Ae(this);var ae=e.apply(w,b);return ae.__actions__.push({func:Vs,args:[H],thisArg:i}),new Er(ae,J)}return oe&&Ee?e.apply(this,b):(ae=this.thru(H),oe?c?ae.value()[0]:ae.value():ae)})}),_r(["pop","push","shift","sort","splice","unshift"],function(e){var r=ms[e],n=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",c=/^(?:pop|shift)$/.test(e);f.prototype[e]=function(){var l=arguments;if(c&&!this.__chain__){var d=this.value();return r.apply(we(d)?d:[],l)}return this[n](function(w){return r.apply(we(w)?w:[],l)})}}),Hr(Ae.prototype,function(e,r){var n=f[r];if(n){var c=n.name+"";ze.call(sn,c)||(sn[c]=[]),sn[c].push({name:r,func:n})}}),sn[zs(i,he).name]=[{name:"wrapper",func:i}],Ae.prototype.clone=Tp,Ae.prototype.reverse=Np,Ae.prototype.value=Dp,f.prototype.at=cy,f.prototype.chain=uy,f.prototype.commit=hy,f.prototype.next=ly,f.prototype.plant=py,f.prototype.reverse=dy,f.prototype.toJSON=f.prototype.valueOf=f.prototype.value=gy,f.prototype.first=f.prototype.head,xn&&(f.prototype[xn]=fy),f},tn=hp();bt?((bt.exports=tn)._=tn,We._=tn):Ce._=tn}).call(kn)})(yc,yc.exports);var jE=Object.defineProperty,zE=Object.defineProperties,UE=Object.getOwnPropertyDescriptors,Dl=Object.getOwnPropertySymbols,qE=Object.prototype.hasOwnProperty,BE=Object.prototype.propertyIsEnumerable,Ll=(a,t,i)=>t in a?jE(a,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[t]=i,io=(a,t)=>{for(var i in t||(t={}))qE.call(t,i)&&Ll(a,i,t[i]);if(Dl)for(var i of Dl(t))BE.call(t,i)&&Ll(a,i,t[i]);return a},HE=(a,t)=>zE(a,UE(t));function Or(a,t,i){let s;const o=vc(a);return t.rpcMap&&(s=t.rpcMap[o]),s||(s=`${ME}?chainId=eip155:${o}&projectId=${i}`),s}function vc(a){return a.includes("eip155")?Number(a.split(":")[1]):Number(a)}function zf(a){return a.map(t=>`${t.split(":")[0]}:${t.split(":")[1]}`)}function kE(a,t){const i=Object.keys(t.namespaces).filter(o=>o.includes(a));if(!i.length)return[];const s=[];return i.forEach(o=>{const h=t.namespaces[o].accounts;s.push(...h)}),s}function KE(a={},t={}){const i=Fl(a),s=Fl(t);return yc.exports.merge(i,s)}function Fl(a){var t,i,s,o;const h={};if(!oo(a))return h;for(const[p,g]of Object.entries(a)){const _=Wl(p)?[p]:g.chains,m=g.methods||[],x=g.events||[],O=g.rpcMap||{},L=ao(p);h[L]=HE(io(io({},h[L]),g),{chains:Wa(_,(t=h[L])==null?void 0:t.chains),methods:Wa(m,(i=h[L])==null?void 0:i.methods),events:Wa(x,(s=h[L])==null?void 0:s.events),rpcMap:io(io({},O),(o=h[L])==null?void 0:o.rpcMap)})}return h}function VE(a){return a.includes(":")?a.split(":")[2]:a}function GE(a){const t={};for(const[i,s]of Object.entries(a)){const o=s.methods||[],h=s.events||[],p=s.accounts||[],g=Wl(i)?[i]:s.chains?s.chains:zf(s.accounts);t[i]={chains:g,methods:o,events:h,accounts:p}}return t}const Uf={},xt=a=>Uf[a],ac=(a,t)=>{Uf[a]=t};class WE{constructor(t){this.name="polkadot",this.namespace=t.namespace,this.events=xt("events"),this.client=xt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,i){if(this.chainId=t,!this.httpProviders[t]){const s=i||Or(`${this.name}:${t}`,this.namespace);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,s)}this.events.emit(xi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?t.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2])||[]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(i=>{var s;t[i]=this.createHttpProvider(i,(s=this.namespace.rpcMap)==null?void 0:s[i])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,i=this.httpProviders[t];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return i}setHttpProvider(t,i){const s=this.createHttpProvider(t,i);s&&(this.httpProviders[t]=s)}createHttpProvider(t,i){const s=i||Or(t,this.namespace);return typeof s>"u"?void 0:new Ii(new ki(s,xt("disableProviderPing")))}}class JE{constructor(t){this.name="eip155",this.namespace=t.namespace,this.events=xt("events"),this.client=xt("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(t){switch(t.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(t);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(t.request.method)?await this.client.request(t):this.getHttpProvider().request(t.request)}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}setDefaultChain(t,i){const s=vc(t);if(!this.httpProviders[s]){const o=i||Or(`${this.name}:${s}`,this.namespace,this.client.core.projectId);if(!o)throw new Error(`No RPC url provided for chainId: ${s}`);this.setHttpProvider(s,o)}this.chainId=s,this.events.emit(xi.DEFAULT_CHAIN_CHANGED,`${this.name}:${s}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}createHttpProvider(t,i){const s=i||Or(`${this.name}:${t}`,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Ii(new ki(s,xt("disableProviderPing")))}setHttpProvider(t,i){const s=this.createHttpProvider(t,i);s&&(this.httpProviders[t]=s)}createHttpProviders(){const t={};return this.namespace.chains.forEach(i=>{var s;const o=vc(i);t[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[i])}),t}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}getHttpProvider(){const t=this.chainId,i=this.httpProviders[t];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return i}async handleSwitchChain(t){var i,s;let o=t.request.params?(i=t.request.params[0])==null?void 0:i.chainId:"0x0";o=o.startsWith("0x")?o:`0x${o}`;const h=parseInt(o,16);if(this.isChainApproved(h))this.setDefaultChain(`${h}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:t.topic,request:{method:t.request.method,params:[{chainId:o}]},chainId:(s=this.namespace.chains)==null?void 0:s[0]}),this.setDefaultChain(`${h}`);else throw new Error(`Failed to switch to chain 'eip155:${h}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(t){return this.namespace.chains.includes(`${this.name}:${t}`)}}class YE{constructor(t){this.name="solana",this.namespace=t.namespace,this.events=xt("events"),this.client=xt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,i){if(!this.httpProviders[t]){const s=i||Or(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,s)}this.chainId=t,this.events.emit(xi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(i=>{var s;t[i]=this.createHttpProvider(i,(s=this.namespace.rpcMap)==null?void 0:s[i])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,i=this.httpProviders[t];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return i}setHttpProvider(t,i){const s=this.createHttpProvider(t,i);s&&(this.httpProviders[t]=s)}createHttpProvider(t,i){const s=i||Or(t,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Ii(new ki(s,xt("disableProviderPing")))}}class XE{constructor(t){this.name="cosmos",this.namespace=t.namespace,this.events=xt("events"),this.client=xt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,i){if(this.chainId=t,!this.httpProviders[t]){const s=i||Or(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,s)}this.events.emit(xi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(i=>{var s;t[i]=this.createHttpProvider(i,(s=this.namespace.rpcMap)==null?void 0:s[i])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,i=this.httpProviders[t];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return i}setHttpProvider(t,i){const s=this.createHttpProvider(t,i);s&&(this.httpProviders[t]=s)}createHttpProvider(t,i){const s=i||Or(t,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Ii(new ki(s,xt("disableProviderPing")))}}class ZE{constructor(t){this.name="cip34",this.namespace=t.namespace,this.events=xt("events"),this.client=xt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,i){if(this.chainId=t,!this.httpProviders[t]){const s=i||this.getCardanoRPCUrl(t);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,s)}this.events.emit(xi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(i=>{const s=this.getCardanoRPCUrl(i);t[i]=this.createHttpProvider(i,s)}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,i=this.httpProviders[t];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return i}getCardanoRPCUrl(t){const i=this.namespace.rpcMap;if(i)return i[t]}setHttpProvider(t,i){const s=this.createHttpProvider(t,i);s&&(this.httpProviders[t]=s)}createHttpProvider(t,i){const s=i||this.getCardanoRPCUrl(t);return typeof s>"u"?void 0:new Ii(new ki(s,xt("disableProviderPing")))}}class QE{constructor(t){this.name="elrond",this.namespace=t.namespace,this.events=xt("events"),this.client=xt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,i){if(!this.httpProviders[t]){const s=i||Or(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,s)}this.chainId=t,this.events.emit(xi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(i=>{var s;t[i]=this.createHttpProvider(i,(s=this.namespace.rpcMap)==null?void 0:s[i])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,i=this.httpProviders[t];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return i}setHttpProvider(t,i){const s=this.createHttpProvider(t,i);s&&(this.httpProviders[t]=s)}createHttpProvider(t,i){const s=i||Or(t,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Ii(new ki(s,xt("disableProviderPing")))}}class eI{constructor(t){this.name="multiversx",this.namespace=t.namespace,this.events=xt("events"),this.client=xt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,i){if(!this.httpProviders[t]){const s=i||Or(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,s)}this.chainId=t,this.events.emit(xi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(i=>{var s;t[i]=this.createHttpProvider(i,(s=this.namespace.rpcMap)==null?void 0:s[i])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,i=this.httpProviders[t];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return i}setHttpProvider(t,i){const s=this.createHttpProvider(t,i);s&&(this.httpProviders[t]=s)}createHttpProvider(t,i){const s=i||Or(t,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Ii(new ki(s,xt("disableProviderPing")))}}var tI=Object.defineProperty,rI=Object.defineProperties,iI=Object.getOwnPropertyDescriptors,$l=Object.getOwnPropertySymbols,nI=Object.prototype.hasOwnProperty,sI=Object.prototype.propertyIsEnumerable,Ml=(a,t,i)=>t in a?tI(a,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[t]=i,no=(a,t)=>{for(var i in t||(t={}))nI.call(t,i)&&Ml(a,i,t[i]);if($l)for(var i of $l(t))sI.call(t,i)&&Ml(a,i,t[i]);return a},cc=(a,t)=>rI(a,iI(t));class Nc{constructor(t){this.events=new Ic,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=t,this.logger=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Re.pino(Re.getDefaultLoggerOptions({level:(t==null?void 0:t.logger)||Tl})),this.disableProviderPing=(t==null?void 0:t.disableProviderPing)||!1}static async init(t){const i=new Nc(t);return await i.initialize(),i}async request(t,i){const[s,o]=this.validateChain(i);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(s).request({request:no({},t),chainId:`${s}:${o}`,topic:this.session.topic})}sendAsync(t,i,s){this.request(t,s).then(o=>i(null,o)).catch(o=>i(o,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var t;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(t=this.session)==null?void 0:t.topic,reason:rr("USER_DISCONNECTED")}),await this.cleanup()}async connect(t){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(t),await this.cleanupPendingPairings(),!t.skipPairing)return await this.pair(t.pairingTopic)}on(t,i){this.events.on(t,i)}once(t,i){this.events.once(t,i)}removeListener(t,i){this.events.removeListener(t,i)}off(t,i){this.events.off(t,i)}get isWalletConnect(){return!0}async pair(t){this.shouldAbortPairingAttempt=!1;let i=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(i>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:s,approval:o}=await this.client.connect({pairingTopic:t,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});s&&(this.uri=s,this.events.emit("display_uri",s)),await o().then(h=>{this.session=h,this.namespaces||(this.namespaces=GE(h.namespaces),this.persist("namespaces",this.namespaces))}).catch(h=>{if(h.message!==Mf)throw h;i++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(t,i){try{if(!this.session)return;const[s,o]=this.validateChain(t);this.getProvider(s).setDefaultChain(o,i)}catch(s){if(!/Please call connect/.test(s.message))throw s}}async cleanupPendingPairings(t={}){this.logger.info("Cleaning up inactive pairings...");const i=this.client.pairing.getAll();if(yn(i)){for(const s of i)t.deletePairings?this.client.core.expirer.set(s.topic,0):await this.client.core.relayer.subscriber.unsubscribe(s.topic);this.logger.info(`Inactive pairings cleared: ${i.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const t=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[t]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await RE.init({logger:this.providerOpts.logger||Tl,relayUrl:this.providerOpts.relayUrl||LE,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const t=[...new Set(Object.keys(this.session.namespaces).map(i=>ao(i)))];ac("client",this.client),ac("events",this.events),ac("disableProviderPing",this.disableProviderPing),t.forEach(i=>{if(!this.session)return;const s=kE(i,this.session),o=zf(s),h=KE(this.namespaces,this.optionalNamespaces),p=cc(no({},h[i]),{accounts:s,chains:o});switch(i){case"eip155":this.rpcProviders[i]=new JE({namespace:p});break;case"solana":this.rpcProviders[i]=new YE({namespace:p});break;case"cosmos":this.rpcProviders[i]=new XE({namespace:p});break;case"polkadot":this.rpcProviders[i]=new WE({namespace:p});break;case"cip34":this.rpcProviders[i]=new ZE({namespace:p});break;case"elrond":this.rpcProviders[i]=new QE({namespace:p});break;case"multiversx":this.rpcProviders[i]=new eI({namespace:p});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",t=>{this.events.emit("session_ping",t)}),this.client.on("session_event",t=>{const{params:i}=t,{event:s}=i;if(s.name==="accountsChanged"){const o=s.data;o&&yn(o)&&this.events.emit("accountsChanged",o.map(VE))}else s.name==="chainChanged"?this.onChainChanged(i.chainId):this.events.emit(s.name,s.data);this.events.emit("session_event",t)}),this.client.on("session_update",({topic:t,params:i})=>{var s;const{namespaces:o}=i,h=(s=this.client)==null?void 0:s.session.get(t);this.session=cc(no({},h),{namespaces:o}),this.onSessionUpdate(),this.events.emit("session_update",{topic:t,params:i})}),this.client.on("session_delete",async t=>{await this.cleanup(),this.events.emit("session_delete",t),this.events.emit("disconnect",cc(no({},rr("USER_DISCONNECTED")),{data:t.topic}))}),this.on(xi.DEFAULT_CHAIN_CHANGED,t=>{this.onChainChanged(t,!0)})}getProvider(t){if(!this.rpcProviders[t])throw new Error(`Provider not found: ${t}`);return this.rpcProviders[t]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(t=>{var i;this.getProvider(t).updateNamespace((i=this.session)==null?void 0:i.namespaces[t])})}setNamespaces(t){const{namespaces:i,optionalNamespaces:s,sessionProperties:o}=t;i&&Object.keys(i).length&&(this.namespaces=i),s&&Object.keys(s).length&&(this.optionalNamespaces=s),this.sessionProperties=o,this.persist("namespaces",i),this.persist("optionalNamespaces",s)}validateChain(t){const[i,s]=(t==null?void 0:t.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[i,s];if(i&&!Object.keys(this.namespaces||{}).map(p=>ao(p)).includes(i))throw new Error(`Namespace '${i}' is not configured. Please call connect() first with namespace config.`);if(i&&s)return[i,s];const o=ao(Object.keys(this.namespaces)[0]),h=this.rpcProviders[o].getDefaultChain();return[o,h]}async requestAccounts(){const[t]=this.validateChain();return await this.getProvider(t).requestAccounts()}onChainChanged(t,i=!1){var s;if(!this.namespaces)return;const[o,h]=this.validateChain(t);i||this.getProvider(o).setDefaultChain(h),((s=this.namespaces[o])!=null?s:this.namespaces[`${o}:${h}`]).defaultChain=h,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",h)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(t,i){this.client.core.storage.setItem(`${Nl}/${t}`,i)}async getFromStore(t){return await this.client.core.storage.getItem(`${Nl}/${t}`)}}const oI=Nc,aI="wc",cI="ethereum_provider",uI=`${aI}@2:${cI}:`,hI="https://rpc.walletconnect.com/v1/",mc=["eth_sendTransaction","personal_sign"],lI=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],wc=["chainChanged","accountsChanged"],fI=["message","disconnect","connect"];var pI=Object.defineProperty,dI=Object.defineProperties,gI=Object.getOwnPropertyDescriptors,jl=Object.getOwnPropertySymbols,yI=Object.prototype.hasOwnProperty,vI=Object.prototype.propertyIsEnumerable,zl=(a,t,i)=>t in a?pI(a,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[t]=i,Kn=(a,t)=>{for(var i in t||(t={}))yI.call(t,i)&&zl(a,i,t[i]);if(jl)for(var i of jl(t))vI.call(t,i)&&zl(a,i,t[i]);return a},Ul=(a,t)=>dI(a,gI(t));function go(a){return Number(a[0].split(":")[1])}function uc(a){return`0x${a.toString(16)}`}function mI(a){const{chains:t,optionalChains:i,methods:s,optionalMethods:o,events:h,optionalEvents:p,rpcMap:g}=a;if(!yn(t))throw new Error("Invalid chains");const _={chains:t,methods:s||mc,events:h||wc,rpcMap:Kn({},t.length?{[go(t)]:g[go(t)]}:{})},m=h==null?void 0:h.filter(z=>!wc.includes(z)),x=s==null?void 0:s.filter(z=>!mc.includes(z));if(!i&&!p&&!o&&!(m!=null&&m.length)&&!(x!=null&&x.length))return{required:t.length?_:void 0};const O=(m==null?void 0:m.length)&&(x==null?void 0:x.length)||!i,L={chains:[...new Set(O?_.chains.concat(i||[]):i)],methods:[...new Set(_.methods.concat(o!=null&&o.length?o:lI))],events:[...new Set(_.events.concat(p||fI))],rpcMap:g};return{required:t.length?_:void 0,optional:i.length?L:void 0}}class Dc{constructor(){this.events=new vr.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=uI,this.on=(t,i)=>(this.events.on(t,i),this),this.once=(t,i)=>(this.events.once(t,i),this),this.removeListener=(t,i)=>(this.events.removeListener(t,i),this),this.off=(t,i)=>(this.events.off(t,i),this),this.parseAccount=t=>this.isCompatibleChainId(t)?this.parseAccountId(t).address:t,this.signer={},this.rpc={}}static async init(t){const i=new Dc;return await i.initialize(t),i}async request(t){return await this.signer.request(t,this.formatChainId(this.chainId))}sendAsync(t,i){this.signer.sendAsync(t,i,this.formatChainId(this.chainId))}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(t){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(t);const{required:i,optional:s}=mI(this.rpc);try{const o=await new Promise(async(p,g)=>{var _;this.rpc.showQrModal&&((_=this.modal)==null||_.subscribeModal(m=>{!m.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),g(new Error("Connection request reset. Please try again.")))})),await this.signer.connect(Ul(Kn({namespaces:Kn({},i&&{[this.namespace]:i})},s&&{optionalNamespaces:{[this.namespace]:s}}),{pairingTopic:t==null?void 0:t.pairingTopic})).then(m=>{p(m)}).catch(m=>{g(new Error(m.message))})});if(!o)return;this.setChainIds(this.rpc.chains);const h=r1(o.namespaces,[this.namespace]);this.setAccounts(h),this.events.emit("connect",{chainId:uc(this.chainId)})}catch(o){throw this.signer.logger.error(o),o}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",t=>{const{params:i}=t,{event:s}=i;s.name==="accountsChanged"?(this.accounts=this.parseAccounts(s.data),this.events.emit("accountsChanged",this.accounts)):s.name==="chainChanged"?this.setChainId(this.formatChainId(s.data)):this.events.emit(s.name,s.data),this.events.emit("session_event",t)}),this.signer.on("chainChanged",t=>{const i=parseInt(t);this.chainId=i,this.events.emit("chainChanged",uc(this.chainId)),this.persist()}),this.signer.on("session_update",t=>{this.events.emit("session_update",t)}),this.signer.on("session_delete",t=>{this.reset(),this.events.emit("session_delete",t),this.events.emit("disconnect",Ul(Kn({},rr("USER_DISCONNECTED")),{data:t.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",t=>{var i,s;this.rpc.showQrModal&&((i=this.modal)==null||i.closeModal(),(s=this.modal)==null||s.openModal({uri:t})),this.events.emit("display_uri",t)})}switchEthereumChain(t){this.request({method:"wallet_switchEthereumChain",params:[{chainId:t.toString(16)}]})}isCompatibleChainId(t){return typeof t=="string"?t.startsWith(`${this.namespace}:`):!1}formatChainId(t){return`${this.namespace}:${t}`}parseChainId(t){return Number(t.split(":")[1])}setChainIds(t){const i=t.filter(s=>this.isCompatibleChainId(s)).map(s=>this.parseChainId(s));i.length&&(this.chainId=i[0],this.events.emit("chainChanged",uc(this.chainId)),this.persist())}setChainId(t){if(this.isCompatibleChainId(t)){const i=this.parseChainId(t);this.chainId=i,this.switchEthereumChain(i)}}parseAccountId(t){const[i,s,o]=t.split(":");return{chainId:`${i}:${s}`,address:o}}setAccounts(t){this.accounts=t.filter(i=>this.parseChainId(this.parseAccountId(i).chainId)===this.chainId).map(i=>this.parseAccountId(i).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(t){var i,s;const o=(i=t==null?void 0:t.chains)!=null?i:[],h=(s=t==null?void 0:t.optionalChains)!=null?s:[],p=o.concat(h);if(!p.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const g=o.length?(t==null?void 0:t.methods)||mc:[],_=o.length?(t==null?void 0:t.events)||wc:[],m=(t==null?void 0:t.optionalMethods)||[],x=(t==null?void 0:t.optionalEvents)||[],O=(t==null?void 0:t.rpcMap)||this.buildRpcMap(p,t.projectId),L=(t==null?void 0:t.qrModalOptions)||void 0;return{chains:o==null?void 0:o.map(z=>this.formatChainId(z)),optionalChains:h.map(z=>this.formatChainId(z)),methods:g,events:_,optionalMethods:m,optionalEvents:x,rpcMap:O,showQrModal:!!(t!=null&&t.showQrModal),qrModalOptions:L,projectId:t.projectId,metadata:t.metadata}}buildRpcMap(t,i){const s={};return t.forEach(o=>{s[o]=this.getRpcUrl(o,i)}),s}async initialize(t){if(this.rpc=this.getRpcConfig(t),this.chainId=this.rpc.chains.length?go(this.rpc.chains):go(this.rpc.optionalChains),this.signer=await oI.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:t.disableProviderPing,relayUrl:t.relayUrl,storageOptions:t.storageOptions}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let i;try{const{WalletConnectModal:s}=await i1(()=>import("./index-2744a57d.js").then(o=>o.a),["./index-2744a57d.js","./index-74b68cc3.js","./index-f4824932.css"],import.meta.url);i=s}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(i)try{this.modal=new i(Kn({walletConnectVersion:2,projectId:this.rpc.projectId,standaloneChains:this.rpc.chains},this.rpc.qrModalOptions))}catch(s){throw this.signer.logger.error(s),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(t){if(!t)return;const{chains:i,optionalChains:s,rpcMap:o}=t;i&&yn(i)&&(this.rpc.chains=i.map(h=>this.formatChainId(h)),i.forEach(h=>{this.rpc.rpcMap[h]=(o==null?void 0:o[h])||this.getRpcUrl(h)})),s&&yn(s)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=s==null?void 0:s.map(h=>this.formatChainId(h)),s.forEach(h=>{this.rpc.rpcMap[h]=(o==null?void 0:o[h])||this.getRpcUrl(h)}))}getRpcUrl(t,i){var s;return((s=this.rpc.rpcMap)==null?void 0:s[t])||`${hI}?chainId=eip155:${t}&projectId=${i||this.rpc.projectId}`}async loadPersistedSession(){if(!this.session)return;const t=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),i=this.session.namespaces[`${this.namespace}:${t}`]?this.session.namespaces[`${this.namespace}:${t}`]:this.session.namespaces[this.namespace];this.setChainIds(t?[this.formatChainId(t)]:i==null?void 0:i.accounts),this.setAccounts(i==null?void 0:i.accounts)}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(t){return typeof t=="string"||t instanceof String?[this.parseAccount(t)]:t.map(i=>this.parseAccount(i))}}const TI=Dc;export{TI as EthereumProvider,fI as OPTIONAL_EVENTS,lI as OPTIONAL_METHODS,wc as REQUIRED_EVENTS,mc as REQUIRED_METHODS,Dc as default};
