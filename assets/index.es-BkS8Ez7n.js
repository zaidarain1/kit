import{p as si,g as Pu,d as st,B as Cu,c as Jr,a as Au,_ as P_}from"./index-DvzIrRmi.js";import{r as C_,e as zr,U as Tu}from"./___vite-browser-external_commonjs-proxy-Cs5HWIgl.js";var Ru={},ra={},Le={},Md={};(function(i){Object.defineProperty(i,"__esModule",{value:!0});function e(f,y){var g=f>>>16&65535,m=f&65535,D=y>>>16&65535,I=y&65535;return m*I+(g*I+m*D<<16>>>0)|0}i.mul=Math.imul||e;function t(f,y){return f+y|0}i.add=t;function s(f,y){return f-y|0}i.sub=s;function o(f,y){return f<<y|f>>>32-y}i.rotl=o;function c(f,y){return f<<32-y|f>>>y}i.rotr=c;function d(f){return typeof f=="number"&&isFinite(f)&&Math.floor(f)===f}i.isInteger=Number.isInteger||d,i.MAX_SAFE_INTEGER=9007199254740991,i.isSafeInteger=function(f){return i.isInteger(f)&&f>=-i.MAX_SAFE_INTEGER&&f<=i.MAX_SAFE_INTEGER}})(Md);Object.defineProperty(Le,"__esModule",{value:!0});var jd=Md;function A_(i,e){return e===void 0&&(e=0),(i[e+0]<<8|i[e+1])<<16>>16}Le.readInt16BE=A_;function T_(i,e){return e===void 0&&(e=0),(i[e+0]<<8|i[e+1])>>>0}Le.readUint16BE=T_;function R_(i,e){return e===void 0&&(e=0),(i[e+1]<<8|i[e])<<16>>16}Le.readInt16LE=R_;function N_(i,e){return e===void 0&&(e=0),(i[e+1]<<8|i[e])>>>0}Le.readUint16LE=N_;function qd(i,e,t){return e===void 0&&(e=new Uint8Array(2)),t===void 0&&(t=0),e[t+0]=i>>>8,e[t+1]=i>>>0,e}Le.writeUint16BE=qd;Le.writeInt16BE=qd;function Fd(i,e,t){return e===void 0&&(e=new Uint8Array(2)),t===void 0&&(t=0),e[t+0]=i>>>0,e[t+1]=i>>>8,e}Le.writeUint16LE=Fd;Le.writeInt16LE=Fd;function ou(i,e){return e===void 0&&(e=0),i[e]<<24|i[e+1]<<16|i[e+2]<<8|i[e+3]}Le.readInt32BE=ou;function au(i,e){return e===void 0&&(e=0),(i[e]<<24|i[e+1]<<16|i[e+2]<<8|i[e+3])>>>0}Le.readUint32BE=au;function cu(i,e){return e===void 0&&(e=0),i[e+3]<<24|i[e+2]<<16|i[e+1]<<8|i[e]}Le.readInt32LE=cu;function uu(i,e){return e===void 0&&(e=0),(i[e+3]<<24|i[e+2]<<16|i[e+1]<<8|i[e])>>>0}Le.readUint32LE=uu;function Yo(i,e,t){return e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0),e[t+0]=i>>>24,e[t+1]=i>>>16,e[t+2]=i>>>8,e[t+3]=i>>>0,e}Le.writeUint32BE=Yo;Le.writeInt32BE=Yo;function Jo(i,e,t){return e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0),e[t+0]=i>>>0,e[t+1]=i>>>8,e[t+2]=i>>>16,e[t+3]=i>>>24,e}Le.writeUint32LE=Jo;Le.writeInt32LE=Jo;function U_(i,e){e===void 0&&(e=0);var t=ou(i,e),s=ou(i,e+4);return t*4294967296+s-(s>>31)*4294967296}Le.readInt64BE=U_;function $_(i,e){e===void 0&&(e=0);var t=au(i,e),s=au(i,e+4);return t*4294967296+s}Le.readUint64BE=$_;function L_(i,e){e===void 0&&(e=0);var t=cu(i,e),s=cu(i,e+4);return s*4294967296+t-(t>>31)*4294967296}Le.readInt64LE=L_;function M_(i,e){e===void 0&&(e=0);var t=uu(i,e),s=uu(i,e+4);return s*4294967296+t}Le.readUint64LE=M_;function zd(i,e,t){return e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0),Yo(i/4294967296>>>0,e,t),Yo(i>>>0,e,t+4),e}Le.writeUint64BE=zd;Le.writeInt64BE=zd;function Bd(i,e,t){return e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0),Jo(i>>>0,e,t),Jo(i/4294967296>>>0,e,t+4),e}Le.writeUint64LE=Bd;Le.writeInt64LE=Bd;function j_(i,e,t){if(t===void 0&&(t=0),i%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(i/8>e.length-t)throw new Error("readUintBE: array is too short for the given bitLength");for(var s=0,o=1,c=i/8+t-1;c>=t;c--)s+=e[c]*o,o*=256;return s}Le.readUintBE=j_;function q_(i,e,t){if(t===void 0&&(t=0),i%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(i/8>e.length-t)throw new Error("readUintLE: array is too short for the given bitLength");for(var s=0,o=1,c=t;c<t+i/8;c++)s+=e[c]*o,o*=256;return s}Le.readUintLE=q_;function F_(i,e,t,s){if(t===void 0&&(t=new Uint8Array(i/8)),s===void 0&&(s=0),i%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!jd.isSafeInteger(e))throw new Error("writeUintBE value must be an integer");for(var o=1,c=i/8+s-1;c>=s;c--)t[c]=e/o&255,o*=256;return t}Le.writeUintBE=F_;function z_(i,e,t,s){if(t===void 0&&(t=new Uint8Array(i/8)),s===void 0&&(s=0),i%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!jd.isSafeInteger(e))throw new Error("writeUintLE value must be an integer");for(var o=1,c=s;c<s+i/8;c++)t[c]=e/o&255,o*=256;return t}Le.writeUintLE=z_;function B_(i,e){e===void 0&&(e=0);var t=new DataView(i.buffer,i.byteOffset,i.byteLength);return t.getFloat32(e)}Le.readFloat32BE=B_;function H_(i,e){e===void 0&&(e=0);var t=new DataView(i.buffer,i.byteOffset,i.byteLength);return t.getFloat32(e,!0)}Le.readFloat32LE=H_;function K_(i,e){e===void 0&&(e=0);var t=new DataView(i.buffer,i.byteOffset,i.byteLength);return t.getFloat64(e)}Le.readFloat64BE=K_;function k_(i,e){e===void 0&&(e=0);var t=new DataView(i.buffer,i.byteOffset,i.byteLength);return t.getFloat64(e,!0)}Le.readFloat64LE=k_;function V_(i,e,t){e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat32(t,i),e}Le.writeFloat32BE=V_;function G_(i,e,t){e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat32(t,i,!0),e}Le.writeFloat32LE=G_;function W_(i,e,t){e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat64(t,i),e}Le.writeFloat64BE=W_;function Y_(i,e,t){e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat64(t,i,!0),e}Le.writeFloat64LE=Y_;var Ar={};Object.defineProperty(Ar,"__esModule",{value:!0});function J_(i){for(var e=0;e<i.length;e++)i[e]=0;return i}Ar.wipe=J_;Object.defineProperty(ra,"__esModule",{value:!0});var er=Le,hu=Ar,Q_=20;function X_(i,e,t){for(var s=1634760805,o=857760878,c=2036477234,d=1797285236,f=t[3]<<24|t[2]<<16|t[1]<<8|t[0],y=t[7]<<24|t[6]<<16|t[5]<<8|t[4],g=t[11]<<24|t[10]<<16|t[9]<<8|t[8],m=t[15]<<24|t[14]<<16|t[13]<<8|t[12],D=t[19]<<24|t[18]<<16|t[17]<<8|t[16],I=t[23]<<24|t[22]<<16|t[21]<<8|t[20],T=t[27]<<24|t[26]<<16|t[25]<<8|t[24],P=t[31]<<24|t[30]<<16|t[29]<<8|t[28],z=e[3]<<24|e[2]<<16|e[1]<<8|e[0],H=e[7]<<24|e[6]<<16|e[5]<<8|e[4],ie=e[11]<<24|e[10]<<16|e[9]<<8|e[8],U=e[15]<<24|e[14]<<16|e[13]<<8|e[12],j=s,O=o,A=c,E=d,u=f,_=y,G=g,W=m,se=D,ue=I,de=T,b=P,C=z,ee=H,Q=ie,k=U,V=0;V<Q_;V+=2)j=j+u|0,C^=j,C=C>>>16|C<<16,se=se+C|0,u^=se,u=u>>>20|u<<12,O=O+_|0,ee^=O,ee=ee>>>16|ee<<16,ue=ue+ee|0,_^=ue,_=_>>>20|_<<12,A=A+G|0,Q^=A,Q=Q>>>16|Q<<16,de=de+Q|0,G^=de,G=G>>>20|G<<12,E=E+W|0,k^=E,k=k>>>16|k<<16,b=b+k|0,W^=b,W=W>>>20|W<<12,A=A+G|0,Q^=A,Q=Q>>>24|Q<<8,de=de+Q|0,G^=de,G=G>>>25|G<<7,E=E+W|0,k^=E,k=k>>>24|k<<8,b=b+k|0,W^=b,W=W>>>25|W<<7,O=O+_|0,ee^=O,ee=ee>>>24|ee<<8,ue=ue+ee|0,_^=ue,_=_>>>25|_<<7,j=j+u|0,C^=j,C=C>>>24|C<<8,se=se+C|0,u^=se,u=u>>>25|u<<7,j=j+_|0,k^=j,k=k>>>16|k<<16,de=de+k|0,_^=de,_=_>>>20|_<<12,O=O+G|0,C^=O,C=C>>>16|C<<16,b=b+C|0,G^=b,G=G>>>20|G<<12,A=A+W|0,ee^=A,ee=ee>>>16|ee<<16,se=se+ee|0,W^=se,W=W>>>20|W<<12,E=E+u|0,Q^=E,Q=Q>>>16|Q<<16,ue=ue+Q|0,u^=ue,u=u>>>20|u<<12,A=A+W|0,ee^=A,ee=ee>>>24|ee<<8,se=se+ee|0,W^=se,W=W>>>25|W<<7,E=E+u|0,Q^=E,Q=Q>>>24|Q<<8,ue=ue+Q|0,u^=ue,u=u>>>25|u<<7,O=O+G|0,C^=O,C=C>>>24|C<<8,b=b+C|0,G^=b,G=G>>>25|G<<7,j=j+_|0,k^=j,k=k>>>24|k<<8,de=de+k|0,_^=de,_=_>>>25|_<<7;er.writeUint32LE(j+s|0,i,0),er.writeUint32LE(O+o|0,i,4),er.writeUint32LE(A+c|0,i,8),er.writeUint32LE(E+d|0,i,12),er.writeUint32LE(u+f|0,i,16),er.writeUint32LE(_+y|0,i,20),er.writeUint32LE(G+g|0,i,24),er.writeUint32LE(W+m|0,i,28),er.writeUint32LE(se+D|0,i,32),er.writeUint32LE(ue+I|0,i,36),er.writeUint32LE(de+T|0,i,40),er.writeUint32LE(b+P|0,i,44),er.writeUint32LE(C+z|0,i,48),er.writeUint32LE(ee+H|0,i,52),er.writeUint32LE(Q+ie|0,i,56),er.writeUint32LE(k+U|0,i,60)}function Hd(i,e,t,s,o){if(o===void 0&&(o=0),i.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(s.length<t.length)throw new Error("ChaCha: destination is shorter than source");var c,d;if(o===0){if(e.length!==8&&e.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");c=new Uint8Array(16),d=c.length-e.length,c.set(e,d)}else{if(e.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");c=e,d=o}for(var f=new Uint8Array(64),y=0;y<t.length;y+=64){X_(f,c,i);for(var g=y;g<y+64&&g<t.length;g++)s[g]=t[g]^f[g-y];e1(c,0,d)}return hu.wipe(f),o===0&&hu.wipe(c),s}ra.streamXOR=Hd;function Z_(i,e,t,s){return s===void 0&&(s=0),hu.wipe(t),Hd(i,e,t,t,s)}ra.stream=Z_;function e1(i,e,t){for(var s=1;t--;)s=s+(i[e]&255)|0,i[e]=s&255,s>>>=8,e++;if(s>0)throw new Error("ChaCha: counter overflow")}var Kd={},Bi={};Object.defineProperty(Bi,"__esModule",{value:!0});function t1(i,e,t){return~(i-1)&e|i-1&t}Bi.select=t1;function r1(i,e){return(i|0)-(e|0)-1>>>31&1}Bi.lessOrEqual=r1;function kd(i,e){if(i.length!==e.length)return 0;for(var t=0,s=0;s<i.length;s++)t|=i[s]^e[s];return 1&t-1>>>8}Bi.compare=kd;function i1(i,e){return i.length===0||e.length===0?!1:kd(i,e)!==0}Bi.equal=i1;(function(i){Object.defineProperty(i,"__esModule",{value:!0});var e=Bi,t=Ar;i.DIGEST_LENGTH=16;var s=function(){function d(f){this.digestLength=i.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var y=f[0]|f[1]<<8;this._r[0]=y&8191;var g=f[2]|f[3]<<8;this._r[1]=(y>>>13|g<<3)&8191;var m=f[4]|f[5]<<8;this._r[2]=(g>>>10|m<<6)&7939;var D=f[6]|f[7]<<8;this._r[3]=(m>>>7|D<<9)&8191;var I=f[8]|f[9]<<8;this._r[4]=(D>>>4|I<<12)&255,this._r[5]=I>>>1&8190;var T=f[10]|f[11]<<8;this._r[6]=(I>>>14|T<<2)&8191;var P=f[12]|f[13]<<8;this._r[7]=(T>>>11|P<<5)&8065;var z=f[14]|f[15]<<8;this._r[8]=(P>>>8|z<<8)&8191,this._r[9]=z>>>5&127,this._pad[0]=f[16]|f[17]<<8,this._pad[1]=f[18]|f[19]<<8,this._pad[2]=f[20]|f[21]<<8,this._pad[3]=f[22]|f[23]<<8,this._pad[4]=f[24]|f[25]<<8,this._pad[5]=f[26]|f[27]<<8,this._pad[6]=f[28]|f[29]<<8,this._pad[7]=f[30]|f[31]<<8}return d.prototype._blocks=function(f,y,g){for(var m=this._fin?0:2048,D=this._h[0],I=this._h[1],T=this._h[2],P=this._h[3],z=this._h[4],H=this._h[5],ie=this._h[6],U=this._h[7],j=this._h[8],O=this._h[9],A=this._r[0],E=this._r[1],u=this._r[2],_=this._r[3],G=this._r[4],W=this._r[5],se=this._r[6],ue=this._r[7],de=this._r[8],b=this._r[9];g>=16;){var C=f[y+0]|f[y+1]<<8;D+=C&8191;var ee=f[y+2]|f[y+3]<<8;I+=(C>>>13|ee<<3)&8191;var Q=f[y+4]|f[y+5]<<8;T+=(ee>>>10|Q<<6)&8191;var k=f[y+6]|f[y+7]<<8;P+=(Q>>>7|k<<9)&8191;var V=f[y+8]|f[y+9]<<8;z+=(k>>>4|V<<12)&8191,H+=V>>>1&8191;var J=f[y+10]|f[y+11]<<8;ie+=(V>>>14|J<<2)&8191;var re=f[y+12]|f[y+13]<<8;U+=(J>>>11|re<<5)&8191;var _e=f[y+14]|f[y+15]<<8;j+=(re>>>8|_e<<8)&8191,O+=_e>>>5|m;var oe=0,be=oe;be+=D*A,be+=I*(5*b),be+=T*(5*de),be+=P*(5*ue),be+=z*(5*se),oe=be>>>13,be&=8191,be+=H*(5*W),be+=ie*(5*G),be+=U*(5*_),be+=j*(5*u),be+=O*(5*E),oe+=be>>>13,be&=8191;var le=oe;le+=D*E,le+=I*A,le+=T*(5*b),le+=P*(5*de),le+=z*(5*ue),oe=le>>>13,le&=8191,le+=H*(5*se),le+=ie*(5*W),le+=U*(5*G),le+=j*(5*_),le+=O*(5*u),oe+=le>>>13,le&=8191;var me=oe;me+=D*u,me+=I*E,me+=T*A,me+=P*(5*b),me+=z*(5*de),oe=me>>>13,me&=8191,me+=H*(5*ue),me+=ie*(5*se),me+=U*(5*W),me+=j*(5*G),me+=O*(5*_),oe+=me>>>13,me&=8191;var B=oe;B+=D*_,B+=I*u,B+=T*E,B+=P*A,B+=z*(5*b),oe=B>>>13,B&=8191,B+=H*(5*de),B+=ie*(5*ue),B+=U*(5*se),B+=j*(5*W),B+=O*(5*G),oe+=B>>>13,B&=8191;var F=oe;F+=D*G,F+=I*_,F+=T*u,F+=P*E,F+=z*A,oe=F>>>13,F&=8191,F+=H*(5*b),F+=ie*(5*de),F+=U*(5*ue),F+=j*(5*se),F+=O*(5*W),oe+=F>>>13,F&=8191;var $=oe;$+=D*W,$+=I*G,$+=T*_,$+=P*u,$+=z*E,oe=$>>>13,$&=8191,$+=H*A,$+=ie*(5*b),$+=U*(5*de),$+=j*(5*ue),$+=O*(5*se),oe+=$>>>13,$&=8191;var l=oe;l+=D*se,l+=I*W,l+=T*G,l+=P*_,l+=z*u,oe=l>>>13,l&=8191,l+=H*E,l+=ie*A,l+=U*(5*b),l+=j*(5*de),l+=O*(5*ue),oe+=l>>>13,l&=8191;var R=oe;R+=D*ue,R+=I*se,R+=T*W,R+=P*G,R+=z*_,oe=R>>>13,R&=8191,R+=H*u,R+=ie*E,R+=U*A,R+=j*(5*b),R+=O*(5*de),oe+=R>>>13,R&=8191;var ae=oe;ae+=D*de,ae+=I*ue,ae+=T*se,ae+=P*W,ae+=z*G,oe=ae>>>13,ae&=8191,ae+=H*_,ae+=ie*u,ae+=U*E,ae+=j*A,ae+=O*(5*b),oe+=ae>>>13,ae&=8191;var fe=oe;fe+=D*b,fe+=I*de,fe+=T*ue,fe+=P*se,fe+=z*W,oe=fe>>>13,fe&=8191,fe+=H*G,fe+=ie*_,fe+=U*u,fe+=j*E,fe+=O*A,oe+=fe>>>13,fe&=8191,oe=(oe<<2)+oe|0,oe=oe+be|0,be=oe&8191,oe=oe>>>13,le+=oe,D=be,I=le,T=me,P=B,z=F,H=$,ie=l,U=R,j=ae,O=fe,y+=16,g-=16}this._h[0]=D,this._h[1]=I,this._h[2]=T,this._h[3]=P,this._h[4]=z,this._h[5]=H,this._h[6]=ie,this._h[7]=U,this._h[8]=j,this._h[9]=O},d.prototype.finish=function(f,y){y===void 0&&(y=0);var g=new Uint16Array(10),m,D,I,T;if(this._leftover){for(T=this._leftover,this._buffer[T++]=1;T<16;T++)this._buffer[T]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(m=this._h[1]>>>13,this._h[1]&=8191,T=2;T<10;T++)this._h[T]+=m,m=this._h[T]>>>13,this._h[T]&=8191;for(this._h[0]+=m*5,m=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=m,m=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=m,g[0]=this._h[0]+5,m=g[0]>>>13,g[0]&=8191,T=1;T<10;T++)g[T]=this._h[T]+m,m=g[T]>>>13,g[T]&=8191;for(g[9]-=8192,D=(m^1)-1,T=0;T<10;T++)g[T]&=D;for(D=~D,T=0;T<10;T++)this._h[T]=this._h[T]&D|g[T];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,I=this._h[0]+this._pad[0],this._h[0]=I&65535,T=1;T<8;T++)I=(this._h[T]+this._pad[T]|0)+(I>>>16)|0,this._h[T]=I&65535;return f[y+0]=this._h[0]>>>0,f[y+1]=this._h[0]>>>8,f[y+2]=this._h[1]>>>0,f[y+3]=this._h[1]>>>8,f[y+4]=this._h[2]>>>0,f[y+5]=this._h[2]>>>8,f[y+6]=this._h[3]>>>0,f[y+7]=this._h[3]>>>8,f[y+8]=this._h[4]>>>0,f[y+9]=this._h[4]>>>8,f[y+10]=this._h[5]>>>0,f[y+11]=this._h[5]>>>8,f[y+12]=this._h[6]>>>0,f[y+13]=this._h[6]>>>8,f[y+14]=this._h[7]>>>0,f[y+15]=this._h[7]>>>8,this._finished=!0,this},d.prototype.update=function(f){var y=0,g=f.length,m;if(this._leftover){m=16-this._leftover,m>g&&(m=g);for(var D=0;D<m;D++)this._buffer[this._leftover+D]=f[y+D];if(g-=m,y+=m,this._leftover+=m,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(g>=16&&(m=g-g%16,this._blocks(f,y,m),y+=m,g-=m),g){for(var D=0;D<g;D++)this._buffer[this._leftover+D]=f[y+D];this._leftover+=g}return this},d.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var f=new Uint8Array(16);return this.finish(f),f},d.prototype.clean=function(){return t.wipe(this._buffer),t.wipe(this._r),t.wipe(this._h),t.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},d}();i.Poly1305=s;function o(d,f){var y=new s(d);y.update(f);var g=y.digest();return y.clean(),g}i.oneTimeAuth=o;function c(d,f){return d.length!==i.DIGEST_LENGTH||f.length!==i.DIGEST_LENGTH?!1:e.equal(d,f)}i.equal=c})(Kd);(function(i){Object.defineProperty(i,"__esModule",{value:!0});var e=ra,t=Kd,s=Ar,o=Le,c=Bi;i.KEY_LENGTH=32,i.NONCE_LENGTH=12,i.TAG_LENGTH=16;var d=new Uint8Array(16),f=function(){function y(g){if(this.nonceLength=i.NONCE_LENGTH,this.tagLength=i.TAG_LENGTH,g.length!==i.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(g)}return y.prototype.seal=function(g,m,D,I){if(g.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var T=new Uint8Array(16);T.set(g,T.length-g.length);var P=new Uint8Array(32);e.stream(this._key,T,P,4);var z=m.length+this.tagLength,H;if(I){if(I.length!==z)throw new Error("ChaCha20Poly1305: incorrect destination length");H=I}else H=new Uint8Array(z);return e.streamXOR(this._key,T,m,H,4),this._authenticate(H.subarray(H.length-this.tagLength,H.length),P,H.subarray(0,H.length-this.tagLength),D),s.wipe(T),H},y.prototype.open=function(g,m,D,I){if(g.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(m.length<this.tagLength)return null;var T=new Uint8Array(16);T.set(g,T.length-g.length);var P=new Uint8Array(32);e.stream(this._key,T,P,4);var z=new Uint8Array(this.tagLength);if(this._authenticate(z,P,m.subarray(0,m.length-this.tagLength),D),!c.equal(z,m.subarray(m.length-this.tagLength,m.length)))return null;var H=m.length-this.tagLength,ie;if(I){if(I.length!==H)throw new Error("ChaCha20Poly1305: incorrect destination length");ie=I}else ie=new Uint8Array(H);return e.streamXOR(this._key,T,m.subarray(0,m.length-this.tagLength),ie,4),s.wipe(T),ie},y.prototype.clean=function(){return s.wipe(this._key),this},y.prototype._authenticate=function(g,m,D,I){var T=new t.Poly1305(m);I&&(T.update(I),I.length%16>0&&T.update(d.subarray(I.length%16))),T.update(D),D.length%16>0&&T.update(d.subarray(D.length%16));var P=new Uint8Array(8);I&&o.writeUint64LE(I.length,P),T.update(P),o.writeUint64LE(D.length,P),T.update(P);for(var z=T.digest(),H=0;H<z.length;H++)g[H]=z[H];T.clean(),s.wipe(z),s.wipe(P)},y}();i.ChaCha20Poly1305=f})(Ru);var Vd={},Ps={},Nu={};Object.defineProperty(Nu,"__esModule",{value:!0});function n1(i){return typeof i.saveState<"u"&&typeof i.restoreState<"u"&&typeof i.cleanSavedState<"u"}Nu.isSerializableHash=n1;Object.defineProperty(Ps,"__esModule",{value:!0});var ii=Nu,s1=Bi,o1=Ar,Gd=function(){function i(e,t){this._finished=!1,this._inner=new e,this._outer=new e,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var s=new Uint8Array(this.blockSize);t.length>this.blockSize?this._inner.update(t).finish(s).clean():s.set(t);for(var o=0;o<s.length;o++)s[o]^=54;this._inner.update(s);for(var o=0;o<s.length;o++)s[o]^=106;this._outer.update(s),ii.isSerializableHash(this._inner)&&ii.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),o1.wipe(s)}return i.prototype.reset=function(){if(!ii.isSerializableHash(this._inner)||!ii.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},i.prototype.clean=function(){ii.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),ii.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},i.prototype.update=function(e){return this._inner.update(e),this},i.prototype.finish=function(e){return this._finished?(this._outer.finish(e),this):(this._inner.finish(e),this._outer.update(e.subarray(0,this.digestLength)).finish(e),this._finished=!0,this)},i.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},i.prototype.saveState=function(){if(!ii.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},i.prototype.restoreState=function(e){if(!ii.isSerializableHash(this._inner)||!ii.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(e),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},i.prototype.cleanSavedState=function(e){if(!ii.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(e)},i}();Ps.HMAC=Gd;function a1(i,e,t){var s=new Gd(i,e);s.update(t);var o=s.digest();return s.clean(),o}Ps.hmac=a1;Ps.equal=s1.equal;Object.defineProperty(Vd,"__esModule",{value:!0});var Xl=Ps,Zl=Ar,c1=function(){function i(e,t,s,o){s===void 0&&(s=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=e,this._info=o;var c=Xl.hmac(this._hash,s,t);this._hmac=new Xl.HMAC(e,c),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return i.prototype._fillBuffer=function(){this._counter[0]++;var e=this._counter[0];if(e===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),e>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},i.prototype.expand=function(e){for(var t=new Uint8Array(e),s=0;s<t.length;s++)this._bufpos===this._buffer.length&&this._fillBuffer(),t[s]=this._buffer[this._bufpos++];return t},i.prototype.clean=function(){this._hmac.clean(),Zl.wipe(this._buffer),Zl.wipe(this._counter),this._bufpos=0},i}(),u1=Vd.HKDF=c1,Bn={},ia={},na={};Object.defineProperty(na,"__esModule",{value:!0});na.BrowserRandomSource=void 0;const ef=65536;class h1{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const e=typeof self<"u"?self.crypto||self.msCrypto:null;e&&e.getRandomValues!==void 0&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const t=new Uint8Array(e);for(let s=0;s<t.length;s+=ef)this._crypto.getRandomValues(t.subarray(s,s+Math.min(t.length-s,ef)));return t}}na.BrowserRandomSource=h1;function l1(i){throw new Error('Could not dynamically require "'+i+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var sa={};Object.defineProperty(sa,"__esModule",{value:!0});sa.NodeRandomSource=void 0;const f1=Ar;class d1{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof l1<"u"){const e=C_;e&&e.randomBytes&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let t=this._crypto.randomBytes(e);if(t.length!==e)throw new Error("NodeRandomSource: got fewer bytes than requested");const s=new Uint8Array(e);for(let o=0;o<s.length;o++)s[o]=t[o];return(0,f1.wipe)(t),s}}sa.NodeRandomSource=d1;Object.defineProperty(ia,"__esModule",{value:!0});ia.SystemRandomSource=void 0;const p1=na,g1=sa;class y1{constructor(){if(this.isAvailable=!1,this.name="",this._source=new p1.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new g1.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(e){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(e)}}ia.SystemRandomSource=y1;(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.randomStringForEntropy=i.randomString=i.randomUint32=i.randomBytes=i.defaultRandomSource=void 0;const e=ia,t=Le,s=Ar;i.defaultRandomSource=new e.SystemRandomSource;function o(g,m=i.defaultRandomSource){return m.randomBytes(g)}i.randomBytes=o;function c(g=i.defaultRandomSource){const m=o(4,g),D=(0,t.readUint32LE)(m);return(0,s.wipe)(m),D}i.randomUint32=c;const d="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function f(g,m=d,D=i.defaultRandomSource){if(m.length<2)throw new Error("randomString charset is too short");if(m.length>256)throw new Error("randomString charset is too long");let I="";const T=m.length,P=256-256%T;for(;g>0;){const z=o(Math.ceil(g*256/P),D);for(let H=0;H<z.length&&g>0;H++){const ie=z[H];ie<P&&(I+=m.charAt(ie%T),g--)}(0,s.wipe)(z)}return I}i.randomString=f;function y(g,m=d,D=i.defaultRandomSource){const I=Math.ceil(g/(Math.log(m.length)/Math.LN2));return f(I,m,D)}i.randomStringForEntropy=y})(Bn);var oa={};(function(i){Object.defineProperty(i,"__esModule",{value:!0});var e=Le,t=Ar;i.DIGEST_LENGTH=32,i.BLOCK_SIZE=64;var s=function(){function f(){this.digestLength=i.DIGEST_LENGTH,this.blockSize=i.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return f.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},f.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},f.prototype.clean=function(){t.wipe(this._buffer),t.wipe(this._temp),this.reset()},f.prototype.update=function(y,g){if(g===void 0&&(g=y.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var m=0;if(this._bytesHashed+=g,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&g>0;)this._buffer[this._bufferLength++]=y[m++],g--;this._bufferLength===this.blockSize&&(c(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(g>=this.blockSize&&(m=c(this._temp,this._state,y,m,g),g%=this.blockSize);g>0;)this._buffer[this._bufferLength++]=y[m++],g--;return this},f.prototype.finish=function(y){if(!this._finished){var g=this._bytesHashed,m=this._bufferLength,D=g/536870912|0,I=g<<3,T=g%64<56?64:128;this._buffer[m]=128;for(var P=m+1;P<T-8;P++)this._buffer[P]=0;e.writeUint32BE(D,this._buffer,T-8),e.writeUint32BE(I,this._buffer,T-4),c(this._temp,this._state,this._buffer,0,T),this._finished=!0}for(var P=0;P<this.digestLength/4;P++)e.writeUint32BE(this._state[P],y,P*4);return this},f.prototype.digest=function(){var y=new Uint8Array(this.digestLength);return this.finish(y),y},f.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},f.prototype.restoreState=function(y){return this._state.set(y.state),this._bufferLength=y.bufferLength,y.buffer&&this._buffer.set(y.buffer),this._bytesHashed=y.bytesHashed,this._finished=!1,this},f.prototype.cleanSavedState=function(y){t.wipe(y.state),y.buffer&&t.wipe(y.buffer),y.bufferLength=0,y.bytesHashed=0},f}();i.SHA256=s;var o=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function c(f,y,g,m,D){for(;D>=64;){for(var I=y[0],T=y[1],P=y[2],z=y[3],H=y[4],ie=y[5],U=y[6],j=y[7],O=0;O<16;O++){var A=m+O*4;f[O]=e.readUint32BE(g,A)}for(var O=16;O<64;O++){var E=f[O-2],u=(E>>>17|E<<15)^(E>>>19|E<<13)^E>>>10;E=f[O-15];var _=(E>>>7|E<<25)^(E>>>18|E<<14)^E>>>3;f[O]=(u+f[O-7]|0)+(_+f[O-16]|0)}for(var O=0;O<64;O++){var u=(((H>>>6|H<<26)^(H>>>11|H<<21)^(H>>>25|H<<7))+(H&ie^~H&U)|0)+(j+(o[O]+f[O]|0)|0)|0,_=((I>>>2|I<<30)^(I>>>13|I<<19)^(I>>>22|I<<10))+(I&T^I&P^T&P)|0;j=U,U=ie,ie=H,H=z+u|0,z=P,P=T,T=I,I=u+_|0}y[0]+=I,y[1]+=T,y[2]+=P,y[3]+=z,y[4]+=H,y[5]+=ie,y[6]+=U,y[7]+=j,m+=64,D-=64}return m}function d(f){var y=new s;y.update(f);var g=y.digest();return y.clean(),g}i.hash=d})(oa);var Uu={};(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.sharedKey=i.generateKeyPair=i.generateKeyPairFromSeed=i.scalarMultBase=i.scalarMult=i.SHARED_KEY_LENGTH=i.SECRET_KEY_LENGTH=i.PUBLIC_KEY_LENGTH=void 0;const e=Bn,t=Ar;i.PUBLIC_KEY_LENGTH=32,i.SECRET_KEY_LENGTH=32,i.SHARED_KEY_LENGTH=32;function s(O){const A=new Float64Array(16);if(O)for(let E=0;E<O.length;E++)A[E]=O[E];return A}const o=new Uint8Array(32);o[0]=9;const c=s([56129,1]);function d(O){let A=1;for(let E=0;E<16;E++){let u=O[E]+A+65535;A=Math.floor(u/65536),O[E]=u-A*65536}O[0]+=A-1+37*(A-1)}function f(O,A,E){const u=~(E-1);for(let _=0;_<16;_++){const G=u&(O[_]^A[_]);O[_]^=G,A[_]^=G}}function y(O,A){const E=s(),u=s();for(let _=0;_<16;_++)u[_]=A[_];d(u),d(u),d(u);for(let _=0;_<2;_++){E[0]=u[0]-65517;for(let W=1;W<15;W++)E[W]=u[W]-65535-(E[W-1]>>16&1),E[W-1]&=65535;E[15]=u[15]-32767-(E[14]>>16&1);const G=E[15]>>16&1;E[14]&=65535,f(u,E,1-G)}for(let _=0;_<16;_++)O[2*_]=u[_]&255,O[2*_+1]=u[_]>>8}function g(O,A){for(let E=0;E<16;E++)O[E]=A[2*E]+(A[2*E+1]<<8);O[15]&=32767}function m(O,A,E){for(let u=0;u<16;u++)O[u]=A[u]+E[u]}function D(O,A,E){for(let u=0;u<16;u++)O[u]=A[u]-E[u]}function I(O,A,E){let u,_,G=0,W=0,se=0,ue=0,de=0,b=0,C=0,ee=0,Q=0,k=0,V=0,J=0,re=0,_e=0,oe=0,be=0,le=0,me=0,B=0,F=0,$=0,l=0,R=0,ae=0,fe=0,Ie=0,Be=0,ke=0,Me=0,gt=0,yt=0,qe=E[0],xe=E[1],Ne=E[2],Ue=E[3],Fe=E[4],Pe=E[5],$e=E[6],Se=E[7],Ce=E[8],He=E[9],Oe=E[10],Ve=E[11],We=E[12],et=E[13],tt=E[14],Qe=E[15];u=A[0],G+=u*qe,W+=u*xe,se+=u*Ne,ue+=u*Ue,de+=u*Fe,b+=u*Pe,C+=u*$e,ee+=u*Se,Q+=u*Ce,k+=u*He,V+=u*Oe,J+=u*Ve,re+=u*We,_e+=u*et,oe+=u*tt,be+=u*Qe,u=A[1],W+=u*qe,se+=u*xe,ue+=u*Ne,de+=u*Ue,b+=u*Fe,C+=u*Pe,ee+=u*$e,Q+=u*Se,k+=u*Ce,V+=u*He,J+=u*Oe,re+=u*Ve,_e+=u*We,oe+=u*et,be+=u*tt,le+=u*Qe,u=A[2],se+=u*qe,ue+=u*xe,de+=u*Ne,b+=u*Ue,C+=u*Fe,ee+=u*Pe,Q+=u*$e,k+=u*Se,V+=u*Ce,J+=u*He,re+=u*Oe,_e+=u*Ve,oe+=u*We,be+=u*et,le+=u*tt,me+=u*Qe,u=A[3],ue+=u*qe,de+=u*xe,b+=u*Ne,C+=u*Ue,ee+=u*Fe,Q+=u*Pe,k+=u*$e,V+=u*Se,J+=u*Ce,re+=u*He,_e+=u*Oe,oe+=u*Ve,be+=u*We,le+=u*et,me+=u*tt,B+=u*Qe,u=A[4],de+=u*qe,b+=u*xe,C+=u*Ne,ee+=u*Ue,Q+=u*Fe,k+=u*Pe,V+=u*$e,J+=u*Se,re+=u*Ce,_e+=u*He,oe+=u*Oe,be+=u*Ve,le+=u*We,me+=u*et,B+=u*tt,F+=u*Qe,u=A[5],b+=u*qe,C+=u*xe,ee+=u*Ne,Q+=u*Ue,k+=u*Fe,V+=u*Pe,J+=u*$e,re+=u*Se,_e+=u*Ce,oe+=u*He,be+=u*Oe,le+=u*Ve,me+=u*We,B+=u*et,F+=u*tt,$+=u*Qe,u=A[6],C+=u*qe,ee+=u*xe,Q+=u*Ne,k+=u*Ue,V+=u*Fe,J+=u*Pe,re+=u*$e,_e+=u*Se,oe+=u*Ce,be+=u*He,le+=u*Oe,me+=u*Ve,B+=u*We,F+=u*et,$+=u*tt,l+=u*Qe,u=A[7],ee+=u*qe,Q+=u*xe,k+=u*Ne,V+=u*Ue,J+=u*Fe,re+=u*Pe,_e+=u*$e,oe+=u*Se,be+=u*Ce,le+=u*He,me+=u*Oe,B+=u*Ve,F+=u*We,$+=u*et,l+=u*tt,R+=u*Qe,u=A[8],Q+=u*qe,k+=u*xe,V+=u*Ne,J+=u*Ue,re+=u*Fe,_e+=u*Pe,oe+=u*$e,be+=u*Se,le+=u*Ce,me+=u*He,B+=u*Oe,F+=u*Ve,$+=u*We,l+=u*et,R+=u*tt,ae+=u*Qe,u=A[9],k+=u*qe,V+=u*xe,J+=u*Ne,re+=u*Ue,_e+=u*Fe,oe+=u*Pe,be+=u*$e,le+=u*Se,me+=u*Ce,B+=u*He,F+=u*Oe,$+=u*Ve,l+=u*We,R+=u*et,ae+=u*tt,fe+=u*Qe,u=A[10],V+=u*qe,J+=u*xe,re+=u*Ne,_e+=u*Ue,oe+=u*Fe,be+=u*Pe,le+=u*$e,me+=u*Se,B+=u*Ce,F+=u*He,$+=u*Oe,l+=u*Ve,R+=u*We,ae+=u*et,fe+=u*tt,Ie+=u*Qe,u=A[11],J+=u*qe,re+=u*xe,_e+=u*Ne,oe+=u*Ue,be+=u*Fe,le+=u*Pe,me+=u*$e,B+=u*Se,F+=u*Ce,$+=u*He,l+=u*Oe,R+=u*Ve,ae+=u*We,fe+=u*et,Ie+=u*tt,Be+=u*Qe,u=A[12],re+=u*qe,_e+=u*xe,oe+=u*Ne,be+=u*Ue,le+=u*Fe,me+=u*Pe,B+=u*$e,F+=u*Se,$+=u*Ce,l+=u*He,R+=u*Oe,ae+=u*Ve,fe+=u*We,Ie+=u*et,Be+=u*tt,ke+=u*Qe,u=A[13],_e+=u*qe,oe+=u*xe,be+=u*Ne,le+=u*Ue,me+=u*Fe,B+=u*Pe,F+=u*$e,$+=u*Se,l+=u*Ce,R+=u*He,ae+=u*Oe,fe+=u*Ve,Ie+=u*We,Be+=u*et,ke+=u*tt,Me+=u*Qe,u=A[14],oe+=u*qe,be+=u*xe,le+=u*Ne,me+=u*Ue,B+=u*Fe,F+=u*Pe,$+=u*$e,l+=u*Se,R+=u*Ce,ae+=u*He,fe+=u*Oe,Ie+=u*Ve,Be+=u*We,ke+=u*et,Me+=u*tt,gt+=u*Qe,u=A[15],be+=u*qe,le+=u*xe,me+=u*Ne,B+=u*Ue,F+=u*Fe,$+=u*Pe,l+=u*$e,R+=u*Se,ae+=u*Ce,fe+=u*He,Ie+=u*Oe,Be+=u*Ve,ke+=u*We,Me+=u*et,gt+=u*tt,yt+=u*Qe,G+=38*le,W+=38*me,se+=38*B,ue+=38*F,de+=38*$,b+=38*l,C+=38*R,ee+=38*ae,Q+=38*fe,k+=38*Ie,V+=38*Be,J+=38*ke,re+=38*Me,_e+=38*gt,oe+=38*yt,_=1,u=G+_+65535,_=Math.floor(u/65536),G=u-_*65536,u=W+_+65535,_=Math.floor(u/65536),W=u-_*65536,u=se+_+65535,_=Math.floor(u/65536),se=u-_*65536,u=ue+_+65535,_=Math.floor(u/65536),ue=u-_*65536,u=de+_+65535,_=Math.floor(u/65536),de=u-_*65536,u=b+_+65535,_=Math.floor(u/65536),b=u-_*65536,u=C+_+65535,_=Math.floor(u/65536),C=u-_*65536,u=ee+_+65535,_=Math.floor(u/65536),ee=u-_*65536,u=Q+_+65535,_=Math.floor(u/65536),Q=u-_*65536,u=k+_+65535,_=Math.floor(u/65536),k=u-_*65536,u=V+_+65535,_=Math.floor(u/65536),V=u-_*65536,u=J+_+65535,_=Math.floor(u/65536),J=u-_*65536,u=re+_+65535,_=Math.floor(u/65536),re=u-_*65536,u=_e+_+65535,_=Math.floor(u/65536),_e=u-_*65536,u=oe+_+65535,_=Math.floor(u/65536),oe=u-_*65536,u=be+_+65535,_=Math.floor(u/65536),be=u-_*65536,G+=_-1+37*(_-1),_=1,u=G+_+65535,_=Math.floor(u/65536),G=u-_*65536,u=W+_+65535,_=Math.floor(u/65536),W=u-_*65536,u=se+_+65535,_=Math.floor(u/65536),se=u-_*65536,u=ue+_+65535,_=Math.floor(u/65536),ue=u-_*65536,u=de+_+65535,_=Math.floor(u/65536),de=u-_*65536,u=b+_+65535,_=Math.floor(u/65536),b=u-_*65536,u=C+_+65535,_=Math.floor(u/65536),C=u-_*65536,u=ee+_+65535,_=Math.floor(u/65536),ee=u-_*65536,u=Q+_+65535,_=Math.floor(u/65536),Q=u-_*65536,u=k+_+65535,_=Math.floor(u/65536),k=u-_*65536,u=V+_+65535,_=Math.floor(u/65536),V=u-_*65536,u=J+_+65535,_=Math.floor(u/65536),J=u-_*65536,u=re+_+65535,_=Math.floor(u/65536),re=u-_*65536,u=_e+_+65535,_=Math.floor(u/65536),_e=u-_*65536,u=oe+_+65535,_=Math.floor(u/65536),oe=u-_*65536,u=be+_+65535,_=Math.floor(u/65536),be=u-_*65536,G+=_-1+37*(_-1),O[0]=G,O[1]=W,O[2]=se,O[3]=ue,O[4]=de,O[5]=b,O[6]=C,O[7]=ee,O[8]=Q,O[9]=k,O[10]=V,O[11]=J,O[12]=re,O[13]=_e,O[14]=oe,O[15]=be}function T(O,A){I(O,A,A)}function P(O,A){const E=s();for(let u=0;u<16;u++)E[u]=A[u];for(let u=253;u>=0;u--)T(E,E),u!==2&&u!==4&&I(E,E,A);for(let u=0;u<16;u++)O[u]=E[u]}function z(O,A){const E=new Uint8Array(32),u=new Float64Array(80),_=s(),G=s(),W=s(),se=s(),ue=s(),de=s();for(let Q=0;Q<31;Q++)E[Q]=O[Q];E[31]=O[31]&127|64,E[0]&=248,g(u,A);for(let Q=0;Q<16;Q++)G[Q]=u[Q];_[0]=se[0]=1;for(let Q=254;Q>=0;--Q){const k=E[Q>>>3]>>>(Q&7)&1;f(_,G,k),f(W,se,k),m(ue,_,W),D(_,_,W),m(W,G,se),D(G,G,se),T(se,ue),T(de,_),I(_,W,_),I(W,G,ue),m(ue,_,W),D(_,_,W),T(G,_),D(W,se,de),I(_,W,c),m(_,_,se),I(W,W,_),I(_,se,de),I(se,G,u),T(G,ue),f(_,G,k),f(W,se,k)}for(let Q=0;Q<16;Q++)u[Q+16]=_[Q],u[Q+32]=W[Q],u[Q+48]=G[Q],u[Q+64]=se[Q];const b=u.subarray(32),C=u.subarray(16);P(b,b),I(C,C,b);const ee=new Uint8Array(32);return y(ee,C),ee}i.scalarMult=z;function H(O){return z(O,o)}i.scalarMultBase=H;function ie(O){if(O.length!==i.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${i.SECRET_KEY_LENGTH} bytes`);const A=new Uint8Array(O);return{publicKey:H(A),secretKey:A}}i.generateKeyPairFromSeed=ie;function U(O){const A=(0,e.randomBytes)(32,O),E=ie(A);return(0,t.wipe)(A),E}i.generateKeyPair=U;function j(O,A,E=!1){if(O.length!==i.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(A.length!==i.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");const u=z(O,A);if(E){let _=0;for(let G=0;G<u.length;G++)_|=u[G];if(_===0)throw new Error("X25519: invalid shared key")}return u}i.sharedKey=j})(Uu);function $u(i){return globalThis.Buffer!=null?new Uint8Array(i.buffer,i.byteOffset,i.byteLength):i}function Wd(i=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?$u(globalThis.Buffer.allocUnsafe(i)):new Uint8Array(i)}function lu(i,e){e||(e=i.reduce((o,c)=>o+c.length,0));const t=Wd(e);let s=0;for(const o of i)t.set(o,s),s+=o.length;return $u(t)}function v1(i,e){if(i.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),s=0;s<t.length;s++)t[s]=255;for(var o=0;o<i.length;o++){var c=i.charAt(o),d=c.charCodeAt(0);if(t[d]!==255)throw new TypeError(c+" is ambiguous");t[d]=o}var f=i.length,y=i.charAt(0),g=Math.log(f)/Math.log(256),m=Math.log(256)/Math.log(f);function D(P){if(P instanceof Uint8Array||(ArrayBuffer.isView(P)?P=new Uint8Array(P.buffer,P.byteOffset,P.byteLength):Array.isArray(P)&&(P=Uint8Array.from(P))),!(P instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(P.length===0)return"";for(var z=0,H=0,ie=0,U=P.length;ie!==U&&P[ie]===0;)ie++,z++;for(var j=(U-ie)*m+1>>>0,O=new Uint8Array(j);ie!==U;){for(var A=P[ie],E=0,u=j-1;(A!==0||E<H)&&u!==-1;u--,E++)A+=256*O[u]>>>0,O[u]=A%f>>>0,A=A/f>>>0;if(A!==0)throw new Error("Non-zero carry");H=E,ie++}for(var _=j-H;_!==j&&O[_]===0;)_++;for(var G=y.repeat(z);_<j;++_)G+=i.charAt(O[_]);return G}function I(P){if(typeof P!="string")throw new TypeError("Expected String");if(P.length===0)return new Uint8Array;var z=0;if(P[z]!==" "){for(var H=0,ie=0;P[z]===y;)H++,z++;for(var U=(P.length-z)*g+1>>>0,j=new Uint8Array(U);P[z];){var O=t[P.charCodeAt(z)];if(O===255)return;for(var A=0,E=U-1;(O!==0||A<ie)&&E!==-1;E--,A++)O+=f*j[E]>>>0,j[E]=O%256>>>0,O=O/256>>>0;if(O!==0)throw new Error("Non-zero carry");ie=A,z++}if(P[z]!==" "){for(var u=U-ie;u!==U&&j[u]===0;)u++;for(var _=new Uint8Array(H+(U-u)),G=H;u!==U;)_[G++]=j[u++];return _}}}function T(P){var z=I(P);if(z)return z;throw new Error(`Non-${e} character`)}return{encode:D,decodeUnsafe:I,decode:T}}var m1=v1,w1=m1;const _1=i=>{if(i instanceof Uint8Array&&i.constructor.name==="Uint8Array")return i;if(i instanceof ArrayBuffer)return new Uint8Array(i);if(ArrayBuffer.isView(i))return new Uint8Array(i.buffer,i.byteOffset,i.byteLength);throw new Error("Unknown type, must be binary type")},b1=i=>new TextEncoder().encode(i),E1=i=>new TextDecoder().decode(i);class D1{constructor(e,t,s){this.name=e,this.prefix=t,this.baseEncode=s}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class S1{constructor(e,t,s){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=s}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Yd(this,e)}}class I1{constructor(e){this.decoders=e}or(e){return Yd(this,e)}decode(e){const t=e[0],s=this.decoders[t];if(s)return s.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Yd=(i,e)=>new I1({...i.decoders||{[i.prefix]:i},...e.decoders||{[e.prefix]:e}});class x1{constructor(e,t,s,o){this.name=e,this.prefix=t,this.baseEncode=s,this.baseDecode=o,this.encoder=new D1(e,t,s),this.decoder=new S1(e,t,o)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const aa=({name:i,prefix:e,encode:t,decode:s})=>new x1(i,e,t,s),Cs=({prefix:i,name:e,alphabet:t})=>{const{encode:s,decode:o}=w1(t,e);return aa({prefix:i,name:e,encode:s,decode:c=>_1(o(c))})},O1=(i,e,t,s)=>{const o={};for(let m=0;m<e.length;++m)o[e[m]]=m;let c=i.length;for(;i[c-1]==="=";)--c;const d=new Uint8Array(c*t/8|0);let f=0,y=0,g=0;for(let m=0;m<c;++m){const D=o[i[m]];if(D===void 0)throw new SyntaxError(`Non-${s} character`);y=y<<t|D,f+=t,f>=8&&(f-=8,d[g++]=255&y>>f)}if(f>=t||255&y<<8-f)throw new SyntaxError("Unexpected end of data");return d},P1=(i,e,t)=>{const s=e[e.length-1]==="=",o=(1<<t)-1;let c="",d=0,f=0;for(let y=0;y<i.length;++y)for(f=f<<8|i[y],d+=8;d>t;)d-=t,c+=e[o&f>>d];if(d&&(c+=e[o&f<<t-d]),s)for(;c.length*t&7;)c+="=";return c},Jt=({name:i,prefix:e,bitsPerChar:t,alphabet:s})=>aa({prefix:e,name:i,encode(o){return P1(o,s,t)},decode(o){return O1(o,s,t,i)}}),C1=aa({prefix:"\0",name:"identity",encode:i=>E1(i),decode:i=>b1(i)}),A1=Object.freeze(Object.defineProperty({__proto__:null,identity:C1},Symbol.toStringTag,{value:"Module"})),T1=Jt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),R1=Object.freeze(Object.defineProperty({__proto__:null,base2:T1},Symbol.toStringTag,{value:"Module"})),N1=Jt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),U1=Object.freeze(Object.defineProperty({__proto__:null,base8:N1},Symbol.toStringTag,{value:"Module"})),$1=Cs({prefix:"9",name:"base10",alphabet:"0123456789"}),L1=Object.freeze(Object.defineProperty({__proto__:null,base10:$1},Symbol.toStringTag,{value:"Module"})),M1=Jt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),j1=Jt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),q1=Object.freeze(Object.defineProperty({__proto__:null,base16:M1,base16upper:j1},Symbol.toStringTag,{value:"Module"})),F1=Jt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),z1=Jt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),B1=Jt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),H1=Jt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),K1=Jt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),k1=Jt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),V1=Jt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),G1=Jt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),W1=Jt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),Y1=Object.freeze(Object.defineProperty({__proto__:null,base32:F1,base32hex:K1,base32hexpad:V1,base32hexpadupper:G1,base32hexupper:k1,base32pad:B1,base32padupper:H1,base32upper:z1,base32z:W1},Symbol.toStringTag,{value:"Module"})),J1=Cs({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Q1=Cs({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),X1=Object.freeze(Object.defineProperty({__proto__:null,base36:J1,base36upper:Q1},Symbol.toStringTag,{value:"Module"})),Z1=Cs({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),eb=Cs({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),tb=Object.freeze(Object.defineProperty({__proto__:null,base58btc:Z1,base58flickr:eb},Symbol.toStringTag,{value:"Module"})),rb=Jt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),ib=Jt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),nb=Jt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),sb=Jt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),ob=Object.freeze(Object.defineProperty({__proto__:null,base64:rb,base64pad:ib,base64url:nb,base64urlpad:sb},Symbol.toStringTag,{value:"Module"})),Jd=Array.from("ðŸš€ðŸªâ˜„ðŸ›°ðŸŒŒðŸŒ‘ðŸŒ’ðŸŒ“ðŸŒ”ðŸŒ•ðŸŒ–ðŸŒ—ðŸŒ˜ðŸŒðŸŒðŸŒŽðŸ‰â˜€ðŸ’»ðŸ–¥ðŸ’¾ðŸ’¿ðŸ˜‚â¤ðŸ˜ðŸ¤£ðŸ˜ŠðŸ™ðŸ’•ðŸ˜­ðŸ˜˜ðŸ‘ðŸ˜…ðŸ‘ðŸ˜ðŸ”¥ðŸ¥°ðŸ’”ðŸ’–ðŸ’™ðŸ˜¢ðŸ¤”ðŸ˜†ðŸ™„ðŸ’ªðŸ˜‰â˜ºðŸ‘ŒðŸ¤—ðŸ’œðŸ˜”ðŸ˜ŽðŸ˜‡ðŸŒ¹ðŸ¤¦ðŸŽ‰ðŸ’žâœŒâœ¨ðŸ¤·ðŸ˜±ðŸ˜ŒðŸŒ¸ðŸ™ŒðŸ˜‹ðŸ’—ðŸ’šðŸ˜ðŸ’›ðŸ™‚ðŸ’“ðŸ¤©ðŸ˜„ðŸ˜€ðŸ–¤ðŸ˜ƒðŸ’¯ðŸ™ˆðŸ‘‡ðŸŽ¶ðŸ˜’ðŸ¤­â£ðŸ˜œðŸ’‹ðŸ‘€ðŸ˜ªðŸ˜‘ðŸ’¥ðŸ™‹ðŸ˜žðŸ˜©ðŸ˜¡ðŸ¤ªðŸ‘ŠðŸ¥³ðŸ˜¥ðŸ¤¤ðŸ‘‰ðŸ’ƒðŸ˜³âœ‹ðŸ˜šðŸ˜ðŸ˜´ðŸŒŸðŸ˜¬ðŸ™ƒðŸ€ðŸŒ·ðŸ˜»ðŸ˜“â­âœ…ðŸ¥ºðŸŒˆðŸ˜ˆðŸ¤˜ðŸ’¦âœ”ðŸ˜£ðŸƒðŸ’â˜¹ðŸŽŠðŸ’˜ðŸ˜ â˜ðŸ˜•ðŸŒºðŸŽ‚ðŸŒ»ðŸ˜ðŸ–•ðŸ’ðŸ™ŠðŸ˜¹ðŸ—£ðŸ’«ðŸ’€ðŸ‘‘ðŸŽµðŸ¤žðŸ˜›ðŸ”´ðŸ˜¤ðŸŒ¼ðŸ˜«âš½ðŸ¤™â˜•ðŸ†ðŸ¤«ðŸ‘ˆðŸ˜®ðŸ™†ðŸ»ðŸƒðŸ¶ðŸ’ðŸ˜²ðŸŒ¿ðŸ§¡ðŸŽâš¡ðŸŒžðŸŽˆâŒâœŠðŸ‘‹ðŸ˜°ðŸ¤¨ðŸ˜¶ðŸ¤ðŸš¶ðŸ’°ðŸ“ðŸ’¢ðŸ¤ŸðŸ™ðŸš¨ðŸ’¨ðŸ¤¬âœˆðŸŽ€ðŸºðŸ¤“ðŸ˜™ðŸ’ŸðŸŒ±ðŸ˜–ðŸ‘¶ðŸ¥´â–¶âž¡â“ðŸ’ŽðŸ’¸â¬‡ðŸ˜¨ðŸŒšðŸ¦‹ðŸ˜·ðŸ•ºâš ðŸ™…ðŸ˜ŸðŸ˜µðŸ‘ŽðŸ¤²ðŸ¤ ðŸ¤§ðŸ“ŒðŸ”µðŸ’…ðŸ§ðŸ¾ðŸ’ðŸ˜—ðŸ¤‘ðŸŒŠðŸ¤¯ðŸ·â˜ŽðŸ’§ðŸ˜¯ðŸ’†ðŸ‘†ðŸŽ¤ðŸ™‡ðŸ‘â„ðŸŒ´ðŸ’£ðŸ¸ðŸ’ŒðŸ“ðŸ¥€ðŸ¤¢ðŸ‘…ðŸ’¡ðŸ’©ðŸ‘ðŸ“¸ðŸ‘»ðŸ¤ðŸ¤®ðŸŽ¼ðŸ¥µðŸš©ðŸŽðŸŠðŸ‘¼ðŸ’ðŸ“£ðŸ¥‚"),ab=Jd.reduce((i,e,t)=>(i[t]=e,i),[]),cb=Jd.reduce((i,e,t)=>(i[e.codePointAt(0)]=t,i),[]);function ub(i){return i.reduce((e,t)=>(e+=ab[t],e),"")}function hb(i){const e=[];for(const t of i){const s=cb[t.codePointAt(0)];if(s===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(s)}return new Uint8Array(e)}const lb=aa({prefix:"ðŸš€",name:"base256emoji",encode:ub,decode:hb}),fb=Object.freeze(Object.defineProperty({__proto__:null,base256emoji:lb},Symbol.toStringTag,{value:"Module"}));new TextEncoder;new TextDecoder;const tf={...A1,...R1,...U1,...L1,...q1,...Y1,...X1,...tb,...ob,...fb};function Qd(i,e,t,s){return{name:i,prefix:e,encoder:{name:i,prefix:e,encode:t},decoder:{decode:s}}}const rf=Qd("utf8","u",i=>"u"+new TextDecoder("utf8").decode(i),i=>new TextEncoder().encode(i.substring(1))),Mc=Qd("ascii","a",i=>{let e="a";for(let t=0;t<i.length;t++)e+=String.fromCharCode(i[t]);return e},i=>{i=i.substring(1);const e=Wd(i.length);for(let t=0;t<i.length;t++)e[t]=i.charCodeAt(t);return e}),Xd={utf8:rf,"utf-8":rf,hex:tf.base16,latin1:Mc,ascii:Mc,binary:Mc,...tf};function br(i,e="utf8"){const t=Xd[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?$u(globalThis.Buffer.from(i,"utf-8")):t.decoder.decode(`${t.prefix}${i}`)}function fr(i,e="utf8"){const t=Xd[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(i.buffer,i.byteOffset,i.byteLength).toString("utf8"):t.encoder.encode(i).substring(1)}var nf=function(i,e,t){if(t||arguments.length===2)for(var s=0,o=e.length,c;s<o;s++)(c||!(s in e))&&(c||(c=Array.prototype.slice.call(e,0,s)),c[s]=e[s]);return i.concat(c||Array.prototype.slice.call(e))},db=function(){function i(e,t,s){this.name=e,this.version=t,this.os=s,this.type="browser"}return i}(),pb=function(){function i(e){this.version=e,this.type="node",this.name="node",this.os=si.platform}return i}(),gb=function(){function i(e,t,s,o){this.name=e,this.version=t,this.os=s,this.bot=o,this.type="bot-device"}return i}(),yb=function(){function i(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return i}(),vb=function(){function i(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return i}(),mb=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,wb=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,sf=3,_b=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",mb]],of=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function bb(i){return i?af(i):typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new vb:typeof navigator<"u"?af(navigator.userAgent):Sb()}function Eb(i){return i!==""&&_b.reduce(function(e,t){var s=t[0],o=t[1];if(e)return e;var c=o.exec(i);return!!c&&[s,c]},!1)}function af(i){var e=Eb(i);if(!e)return null;var t=e[0],s=e[1];if(t==="searchbot")return new yb;var o=s[1]&&s[1].split(".").join("_").split("_").slice(0,3);o?o.length<sf&&(o=nf(nf([],o,!0),Ib(sf-o.length),!0)):o=[];var c=o.join("."),d=Db(i),f=wb.exec(i);return f&&f[1]?new gb(t,c,d,f[1]):new db(t,c,d)}function Db(i){for(var e=0,t=of.length;e<t;e++){var s=of[e],o=s[0],c=s[1],d=c.exec(i);if(d)return o}return null}function Sb(){var i=typeof si<"u"&&si.version;return i?new pb(si.version.slice(1)):null}function Ib(i){for(var e=[],t=0;t<i;t++)e.push("0");return e}var ve={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var fu=function(i,e){return fu=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,s){t.__proto__=s}||function(t,s){for(var o in s)s.hasOwnProperty(o)&&(t[o]=s[o])},fu(i,e)};function xb(i,e){fu(i,e);function t(){this.constructor=i}i.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var du=function(){return du=Object.assign||function(e){for(var t,s=1,o=arguments.length;s<o;s++){t=arguments[s];for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(e[c]=t[c])}return e},du.apply(this,arguments)};function Ob(i,e){var t={};for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&e.indexOf(s)<0&&(t[s]=i[s]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(i);o<s.length;o++)e.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(i,s[o])&&(t[s[o]]=i[s[o]]);return t}function Pb(i,e,t,s){var o=arguments.length,c=o<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,t):s,d;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(i,e,t,s);else for(var f=i.length-1;f>=0;f--)(d=i[f])&&(c=(o<3?d(c):o>3?d(e,t,c):d(e,t))||c);return o>3&&c&&Object.defineProperty(e,t,c),c}function Cb(i,e){return function(t,s){e(t,s,i)}}function Ab(i,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,e)}function Tb(i,e,t,s){function o(c){return c instanceof t?c:new t(function(d){d(c)})}return new(t||(t=Promise))(function(c,d){function f(m){try{g(s.next(m))}catch(D){d(D)}}function y(m){try{g(s.throw(m))}catch(D){d(D)}}function g(m){m.done?c(m.value):o(m.value).then(f,y)}g((s=s.apply(i,e||[])).next())})}function Rb(i,e){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},s,o,c,d;return d={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(d[Symbol.iterator]=function(){return this}),d;function f(g){return function(m){return y([g,m])}}function y(g){if(s)throw new TypeError("Generator is already executing.");for(;t;)try{if(s=1,o&&(c=g[0]&2?o.return:g[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,g[1])).done)return c;switch(o=0,c&&(g=[g[0]&2,c.value]),g[0]){case 0:case 1:c=g;break;case 4:return t.label++,{value:g[1],done:!1};case 5:t.label++,o=g[1],g=[0];continue;case 7:g=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(g[0]===6||g[0]===2)){t=0;continue}if(g[0]===3&&(!c||g[1]>c[0]&&g[1]<c[3])){t.label=g[1];break}if(g[0]===6&&t.label<c[1]){t.label=c[1],c=g;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(g);break}c[2]&&t.ops.pop(),t.trys.pop();continue}g=e.call(i,t)}catch(m){g=[6,m],o=0}finally{s=c=0}if(g[0]&5)throw g[1];return{value:g[0]?g[1]:void 0,done:!0}}}function Nb(i,e,t,s){s===void 0&&(s=t),i[s]=e[t]}function Ub(i,e){for(var t in i)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=i[t])}function pu(i){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&i[e],s=0;if(t)return t.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&s>=i.length&&(i=void 0),{value:i&&i[s++],done:!i}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Zd(i,e){var t=typeof Symbol=="function"&&i[Symbol.iterator];if(!t)return i;var s=t.call(i),o,c=[],d;try{for(;(e===void 0||e-- >0)&&!(o=s.next()).done;)c.push(o.value)}catch(f){d={error:f}}finally{try{o&&!o.done&&(t=s.return)&&t.call(s)}finally{if(d)throw d.error}}return c}function $b(){for(var i=[],e=0;e<arguments.length;e++)i=i.concat(Zd(arguments[e]));return i}function Lb(){for(var i=0,e=0,t=arguments.length;e<t;e++)i+=arguments[e].length;for(var s=Array(i),o=0,e=0;e<t;e++)for(var c=arguments[e],d=0,f=c.length;d<f;d++,o++)s[o]=c[d];return s}function Ss(i){return this instanceof Ss?(this.v=i,this):new Ss(i)}function Mb(i,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=t.apply(i,e||[]),o,c=[];return o={},d("next"),d("throw"),d("return"),o[Symbol.asyncIterator]=function(){return this},o;function d(I){s[I]&&(o[I]=function(T){return new Promise(function(P,z){c.push([I,T,P,z])>1||f(I,T)})})}function f(I,T){try{y(s[I](T))}catch(P){D(c[0][3],P)}}function y(I){I.value instanceof Ss?Promise.resolve(I.value.v).then(g,m):D(c[0][2],I)}function g(I){f("next",I)}function m(I){f("throw",I)}function D(I,T){I(T),c.shift(),c.length&&f(c[0][0],c[0][1])}}function jb(i){var e,t;return e={},s("next"),s("throw",function(o){throw o}),s("return"),e[Symbol.iterator]=function(){return this},e;function s(o,c){e[o]=i[o]?function(d){return(t=!t)?{value:Ss(i[o](d)),done:o==="return"}:c?c(d):d}:c}}function qb(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=i[Symbol.asyncIterator],t;return e?e.call(i):(i=typeof pu=="function"?pu(i):i[Symbol.iterator](),t={},s("next"),s("throw"),s("return"),t[Symbol.asyncIterator]=function(){return this},t);function s(c){t[c]=i[c]&&function(d){return new Promise(function(f,y){d=i[c](d),o(f,y,d.done,d.value)})}}function o(c,d,f,y){Promise.resolve(y).then(function(g){c({value:g,done:f})},d)}}function Fb(i,e){return Object.defineProperty?Object.defineProperty(i,"raw",{value:e}):i.raw=e,i}function zb(i){if(i&&i.__esModule)return i;var e={};if(i!=null)for(var t in i)Object.hasOwnProperty.call(i,t)&&(e[t]=i[t]);return e.default=i,e}function Bb(i){return i&&i.__esModule?i:{default:i}}function Hb(i,e){if(!e.has(i))throw new TypeError("attempted to get private field on non-instance");return e.get(i)}function Kb(i,e,t){if(!e.has(i))throw new TypeError("attempted to set private field on non-instance");return e.set(i,t),t}const kb=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return du},__asyncDelegator:jb,__asyncGenerator:Mb,__asyncValues:qb,__await:Ss,__awaiter:Tb,__classPrivateFieldGet:Hb,__classPrivateFieldSet:Kb,__createBinding:Nb,__decorate:Pb,__exportStar:Ub,__extends:xb,__generator:Rb,__importDefault:Bb,__importStar:zb,__makeTemplateObject:Fb,__metadata:Ab,__param:Cb,__read:Zd,__rest:Ob,__spread:$b,__spreadArrays:Lb,__values:pu},Symbol.toStringTag,{value:"Module"})),ai=Pu(kb);var jc={},ds={},cf;function Vb(){if(cf)return ds;cf=1,Object.defineProperty(ds,"__esModule",{value:!0}),ds.delay=void 0;function i(e){return new Promise(t=>{setTimeout(()=>{t(!0)},e)})}return ds.delay=i,ds}var sn={},qc={},on={},uf;function Gb(){return uf||(uf=1,Object.defineProperty(on,"__esModule",{value:!0}),on.ONE_THOUSAND=on.ONE_HUNDRED=void 0,on.ONE_HUNDRED=100,on.ONE_THOUSAND=1e3),on}var Fc={},hf;function Wb(){return hf||(hf=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.ONE_YEAR=i.FOUR_WEEKS=i.THREE_WEEKS=i.TWO_WEEKS=i.ONE_WEEK=i.THIRTY_DAYS=i.SEVEN_DAYS=i.FIVE_DAYS=i.THREE_DAYS=i.ONE_DAY=i.TWENTY_FOUR_HOURS=i.TWELVE_HOURS=i.SIX_HOURS=i.THREE_HOURS=i.ONE_HOUR=i.SIXTY_MINUTES=i.THIRTY_MINUTES=i.TEN_MINUTES=i.FIVE_MINUTES=i.ONE_MINUTE=i.SIXTY_SECONDS=i.THIRTY_SECONDS=i.TEN_SECONDS=i.FIVE_SECONDS=i.ONE_SECOND=void 0,i.ONE_SECOND=1,i.FIVE_SECONDS=5,i.TEN_SECONDS=10,i.THIRTY_SECONDS=30,i.SIXTY_SECONDS=60,i.ONE_MINUTE=i.SIXTY_SECONDS,i.FIVE_MINUTES=i.ONE_MINUTE*5,i.TEN_MINUTES=i.ONE_MINUTE*10,i.THIRTY_MINUTES=i.ONE_MINUTE*30,i.SIXTY_MINUTES=i.ONE_MINUTE*60,i.ONE_HOUR=i.SIXTY_MINUTES,i.THREE_HOURS=i.ONE_HOUR*3,i.SIX_HOURS=i.ONE_HOUR*6,i.TWELVE_HOURS=i.ONE_HOUR*12,i.TWENTY_FOUR_HOURS=i.ONE_HOUR*24,i.ONE_DAY=i.TWENTY_FOUR_HOURS,i.THREE_DAYS=i.ONE_DAY*3,i.FIVE_DAYS=i.ONE_DAY*5,i.SEVEN_DAYS=i.ONE_DAY*7,i.THIRTY_DAYS=i.ONE_DAY*30,i.ONE_WEEK=i.SEVEN_DAYS,i.TWO_WEEKS=i.ONE_WEEK*2,i.THREE_WEEKS=i.ONE_WEEK*3,i.FOUR_WEEKS=i.ONE_WEEK*4,i.ONE_YEAR=i.ONE_DAY*365}(Fc)),Fc}var lf;function ep(){return lf||(lf=1,function(i){Object.defineProperty(i,"__esModule",{value:!0});const e=ai;e.__exportStar(Gb(),i),e.__exportStar(Wb(),i)}(qc)),qc}var ff;function Yb(){if(ff)return sn;ff=1,Object.defineProperty(sn,"__esModule",{value:!0}),sn.fromMiliseconds=sn.toMiliseconds=void 0;const i=ep();function e(s){return s*i.ONE_THOUSAND}sn.toMiliseconds=e;function t(s){return Math.floor(s/i.ONE_THOUSAND)}return sn.fromMiliseconds=t,sn}var df;function Jb(){return df||(df=1,function(i){Object.defineProperty(i,"__esModule",{value:!0});const e=ai;e.__exportStar(Vb(),i),e.__exportStar(Yb(),i)}(jc)),jc}var Ln={},pf;function Qb(){if(pf)return Ln;pf=1,Object.defineProperty(Ln,"__esModule",{value:!0}),Ln.Watch=void 0;class i{constructor(){this.timestamps=new Map}start(t){if(this.timestamps.has(t))throw new Error(`Watch already started for label: ${t}`);this.timestamps.set(t,{started:Date.now()})}stop(t){const s=this.get(t);if(typeof s.elapsed<"u")throw new Error(`Watch already stopped for label: ${t}`);const o=Date.now()-s.started;this.timestamps.set(t,{started:s.started,elapsed:o})}get(t){const s=this.timestamps.get(t);if(typeof s>"u")throw new Error(`No timestamp found for label: ${t}`);return s}elapsed(t){const s=this.get(t);return s.elapsed||Date.now()-s.started}}return Ln.Watch=i,Ln.default=i,Ln}var zc={},ps={},gf;function Xb(){if(gf)return ps;gf=1,Object.defineProperty(ps,"__esModule",{value:!0}),ps.IWatch=void 0;class i{}return ps.IWatch=i,ps}var yf;function Zb(){return yf||(yf=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),ai.__exportStar(Xb(),i)}(zc)),zc}(function(i){Object.defineProperty(i,"__esModule",{value:!0});const e=ai;e.__exportStar(Jb(),i),e.__exportStar(Qb(),i),e.__exportStar(Zb(),i),e.__exportStar(ep(),i)})(ve);var ft={};Object.defineProperty(ft,"__esModule",{value:!0});ft.getLocalStorage=ft.getLocalStorageOrThrow=ft.getCrypto=ft.getCryptoOrThrow=tp=ft.getLocation=ft.getLocationOrThrow=Mu=ft.getNavigator=ft.getNavigatorOrThrow=Lu=ft.getDocument=ft.getDocumentOrThrow=ft.getFromWindowOrThrow=ft.getFromWindow=void 0;function ln(i){let e;return typeof window<"u"&&typeof window[i]<"u"&&(e=window[i]),e}ft.getFromWindow=ln;function Hn(i){const e=ln(i);if(!e)throw new Error(`${i} is not defined in Window`);return e}ft.getFromWindowOrThrow=Hn;function eE(){return Hn("document")}ft.getDocumentOrThrow=eE;function tE(){return ln("document")}var Lu=ft.getDocument=tE;function rE(){return Hn("navigator")}ft.getNavigatorOrThrow=rE;function iE(){return ln("navigator")}var Mu=ft.getNavigator=iE;function nE(){return Hn("location")}ft.getLocationOrThrow=nE;function sE(){return ln("location")}var tp=ft.getLocation=sE;function oE(){return Hn("crypto")}ft.getCryptoOrThrow=oE;function aE(){return ln("crypto")}ft.getCrypto=aE;function cE(){return Hn("localStorage")}ft.getLocalStorageOrThrow=cE;function uE(){return ln("localStorage")}ft.getLocalStorage=uE;var ju={};Object.defineProperty(ju,"__esModule",{value:!0});var rp=ju.getWindowMetadata=void 0;const vf=ft;function hE(){let i,e;try{i=vf.getDocumentOrThrow(),e=vf.getLocationOrThrow()}catch{return null}function t(){const D=i.getElementsByTagName("link"),I=[];for(let T=0;T<D.length;T++){const P=D[T],z=P.getAttribute("rel");if(z&&z.toLowerCase().indexOf("icon")>-1){const H=P.getAttribute("href");if(H)if(H.toLowerCase().indexOf("https:")===-1&&H.toLowerCase().indexOf("http:")===-1&&H.indexOf("//")!==0){let ie=e.protocol+"//"+e.host;if(H.indexOf("/")===0)ie+=H;else{const U=e.pathname.split("/");U.pop();const j=U.join("/");ie+=j+"/"+H}I.push(ie)}else if(H.indexOf("//")===0){const ie=e.protocol+H;I.push(ie)}else I.push(H)}}return I}function s(...D){const I=i.getElementsByTagName("meta");for(let T=0;T<I.length;T++){const P=I[T],z=["itemprop","property","name"].map(H=>P.getAttribute(H)).filter(H=>H?D.includes(H):!1);if(z.length&&z){const H=P.getAttribute("content");if(H)return H}}return""}function o(){let D=s("name","og:site_name","og:title","twitter:title");return D||(D=i.title),D}function c(){return s("description","og:description","twitter:description","keywords")}const d=o(),f=c(),y=e.origin,g=t();return{description:f,url:y,icons:g,name:d}}rp=ju.getWindowMetadata=hE;var Is={},lE=i=>encodeURIComponent(i).replace(/[!'()*]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`),ip="%[a-f0-9]{2}",mf=new RegExp("("+ip+")|([^%]+?)","gi"),wf=new RegExp("("+ip+")+","gi");function gu(i,e){try{return[decodeURIComponent(i.join(""))]}catch{}if(i.length===1)return i;e=e||1;var t=i.slice(0,e),s=i.slice(e);return Array.prototype.concat.call([],gu(t),gu(s))}function fE(i){try{return decodeURIComponent(i)}catch{for(var e=i.match(mf)||[],t=1;t<e.length;t++)i=gu(e,t).join(""),e=i.match(mf)||[];return i}}function dE(i){for(var e={"%FE%FF":"ï¿½ï¿½","%FF%FE":"ï¿½ï¿½"},t=wf.exec(i);t;){try{e[t[0]]=decodeURIComponent(t[0])}catch{var s=fE(t[0]);s!==t[0]&&(e[t[0]]=s)}t=wf.exec(i)}e["%C2"]="ï¿½";for(var o=Object.keys(e),c=0;c<o.length;c++){var d=o[c];i=i.replace(new RegExp(d,"g"),e[d])}return i}var pE=function(i){if(typeof i!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof i+"`");try{return i=i.replace(/\+/g," "),decodeURIComponent(i)}catch{return dE(i)}},gE=(i,e)=>{if(!(typeof i=="string"&&typeof e=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(e==="")return[i];const t=i.indexOf(e);return t===-1?[i]:[i.slice(0,t),i.slice(t+e.length)]},yE=function(i,e){for(var t={},s=Object.keys(i),o=Array.isArray(e),c=0;c<s.length;c++){var d=s[c],f=i[d];(o?e.indexOf(d)!==-1:e(d,f,i))&&(t[d]=f)}return t};(function(i){const e=lE,t=pE,s=gE,o=yE,c=U=>U==null,d=Symbol("encodeFragmentIdentifier");function f(U){switch(U.arrayFormat){case"index":return j=>(O,A)=>{const E=O.length;return A===void 0||U.skipNull&&A===null||U.skipEmptyString&&A===""?O:A===null?[...O,[m(j,U),"[",E,"]"].join("")]:[...O,[m(j,U),"[",m(E,U),"]=",m(A,U)].join("")]};case"bracket":return j=>(O,A)=>A===void 0||U.skipNull&&A===null||U.skipEmptyString&&A===""?O:A===null?[...O,[m(j,U),"[]"].join("")]:[...O,[m(j,U),"[]=",m(A,U)].join("")];case"colon-list-separator":return j=>(O,A)=>A===void 0||U.skipNull&&A===null||U.skipEmptyString&&A===""?O:A===null?[...O,[m(j,U),":list="].join("")]:[...O,[m(j,U),":list=",m(A,U)].join("")];case"comma":case"separator":case"bracket-separator":{const j=U.arrayFormat==="bracket-separator"?"[]=":"=";return O=>(A,E)=>E===void 0||U.skipNull&&E===null||U.skipEmptyString&&E===""?A:(E=E===null?"":E,A.length===0?[[m(O,U),j,m(E,U)].join("")]:[[A,m(E,U)].join(U.arrayFormatSeparator)])}default:return j=>(O,A)=>A===void 0||U.skipNull&&A===null||U.skipEmptyString&&A===""?O:A===null?[...O,m(j,U)]:[...O,[m(j,U),"=",m(A,U)].join("")]}}function y(U){let j;switch(U.arrayFormat){case"index":return(O,A,E)=>{if(j=/\[(\d*)\]$/.exec(O),O=O.replace(/\[\d*\]$/,""),!j){E[O]=A;return}E[O]===void 0&&(E[O]={}),E[O][j[1]]=A};case"bracket":return(O,A,E)=>{if(j=/(\[\])$/.exec(O),O=O.replace(/\[\]$/,""),!j){E[O]=A;return}if(E[O]===void 0){E[O]=[A];return}E[O]=[].concat(E[O],A)};case"colon-list-separator":return(O,A,E)=>{if(j=/(:list)$/.exec(O),O=O.replace(/:list$/,""),!j){E[O]=A;return}if(E[O]===void 0){E[O]=[A];return}E[O]=[].concat(E[O],A)};case"comma":case"separator":return(O,A,E)=>{const u=typeof A=="string"&&A.includes(U.arrayFormatSeparator),_=typeof A=="string"&&!u&&D(A,U).includes(U.arrayFormatSeparator);A=_?D(A,U):A;const G=u||_?A.split(U.arrayFormatSeparator).map(W=>D(W,U)):A===null?A:D(A,U);E[O]=G};case"bracket-separator":return(O,A,E)=>{const u=/(\[\])$/.test(O);if(O=O.replace(/\[\]$/,""),!u){E[O]=A&&D(A,U);return}const _=A===null?[]:A.split(U.arrayFormatSeparator).map(G=>D(G,U));if(E[O]===void 0){E[O]=_;return}E[O]=[].concat(E[O],_)};default:return(O,A,E)=>{if(E[O]===void 0){E[O]=A;return}E[O]=[].concat(E[O],A)}}}function g(U){if(typeof U!="string"||U.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function m(U,j){return j.encode?j.strict?e(U):encodeURIComponent(U):U}function D(U,j){return j.decode?t(U):U}function I(U){return Array.isArray(U)?U.sort():typeof U=="object"?I(Object.keys(U)).sort((j,O)=>Number(j)-Number(O)).map(j=>U[j]):U}function T(U){const j=U.indexOf("#");return j!==-1&&(U=U.slice(0,j)),U}function P(U){let j="";const O=U.indexOf("#");return O!==-1&&(j=U.slice(O)),j}function z(U){U=T(U);const j=U.indexOf("?");return j===-1?"":U.slice(j+1)}function H(U,j){return j.parseNumbers&&!Number.isNaN(Number(U))&&typeof U=="string"&&U.trim()!==""?U=Number(U):j.parseBooleans&&U!==null&&(U.toLowerCase()==="true"||U.toLowerCase()==="false")&&(U=U.toLowerCase()==="true"),U}function ie(U,j){j=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},j),g(j.arrayFormatSeparator);const O=y(j),A=Object.create(null);if(typeof U!="string"||(U=U.trim().replace(/^[?#&]/,""),!U))return A;for(const E of U.split("&")){if(E==="")continue;let[u,_]=s(j.decode?E.replace(/\+/g," "):E,"=");_=_===void 0?null:["comma","separator","bracket-separator"].includes(j.arrayFormat)?_:D(_,j),O(D(u,j),_,A)}for(const E of Object.keys(A)){const u=A[E];if(typeof u=="object"&&u!==null)for(const _ of Object.keys(u))u[_]=H(u[_],j);else A[E]=H(u,j)}return j.sort===!1?A:(j.sort===!0?Object.keys(A).sort():Object.keys(A).sort(j.sort)).reduce((E,u)=>{const _=A[u];return _&&typeof _=="object"&&!Array.isArray(_)?E[u]=I(_):E[u]=_,E},Object.create(null))}i.extract=z,i.parse=ie,i.stringify=(U,j)=>{if(!U)return"";j=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},j),g(j.arrayFormatSeparator);const O=_=>j.skipNull&&c(U[_])||j.skipEmptyString&&U[_]==="",A=f(j),E={};for(const _ of Object.keys(U))O(_)||(E[_]=U[_]);const u=Object.keys(E);return j.sort!==!1&&u.sort(j.sort),u.map(_=>{const G=U[_];return G===void 0?"":G===null?m(_,j):Array.isArray(G)?G.length===0&&j.arrayFormat==="bracket-separator"?m(_,j)+"[]":G.reduce(A(_),[]).join("&"):m(_,j)+"="+m(G,j)}).filter(_=>_.length>0).join("&")},i.parseUrl=(U,j)=>{j=Object.assign({decode:!0},j);const[O,A]=s(U,"#");return Object.assign({url:O.split("?")[0]||"",query:ie(z(U),j)},j&&j.parseFragmentIdentifier&&A?{fragmentIdentifier:D(A,j)}:{})},i.stringifyUrl=(U,j)=>{j=Object.assign({encode:!0,strict:!0,[d]:!0},j);const O=T(U.url).split("?")[0]||"",A=i.extract(U.url),E=i.parse(A,{sort:!1}),u=Object.assign(E,U.query);let _=i.stringify(u,j);_&&(_=`?${_}`);let G=P(U.url);return U.fragmentIdentifier&&(G=`#${j[d]?m(U.fragmentIdentifier,j):U.fragmentIdentifier}`),`${O}${_}${G}`},i.pick=(U,j,O)=>{O=Object.assign({parseFragmentIdentifier:!0,[d]:!1},O);const{url:A,query:E,fragmentIdentifier:u}=i.parseUrl(U,O);return i.stringifyUrl({url:A,query:o(E,j),fragmentIdentifier:u},O)},i.exclude=(U,j,O)=>{const A=Array.isArray(j)?E=>!j.includes(E):(E,u)=>!j(E,u);return i.pick(U,A,O)}})(Is);const vE={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe"}},mE=":";function wE(i){const[e,t]=i.split(mE);return{namespace:e,reference:t}}function _E(i,e=[]){const t=[];return Object.keys(i).forEach(s=>{if(e.length&&!e.includes(s))return;const o=i[s];t.push(...o.accounts)}),t}function np(i,e){return i.includes(":")?[i]:e.chains||[]}const sp="base10",lr="base16",yu="base64pad",qu="utf8",op=0,fn=1,bE=0,_f=1,vu=12,Fu=32;function EE(){const i=Uu.generateKeyPair();return{privateKey:fr(i.secretKey,lr),publicKey:fr(i.publicKey,lr)}}function mu(){const i=Bn.randomBytes(Fu);return fr(i,lr)}function DE(i,e){const t=Uu.sharedKey(br(i,lr),br(e,lr),!0),s=new u1(oa.SHA256,t).expand(Fu);return fr(s,lr)}function SE(i){const e=oa.hash(br(i,lr));return fr(e,lr)}function Fn(i){const e=oa.hash(br(i,qu));return fr(e,lr)}function IE(i){return br(`${i}`,sp)}function As(i){return Number(fr(i,sp))}function xE(i){const e=IE(typeof i.type<"u"?i.type:op);if(As(e)===fn&&typeof i.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const t=typeof i.senderPublicKey<"u"?br(i.senderPublicKey,lr):void 0,s=typeof i.iv<"u"?br(i.iv,lr):Bn.randomBytes(vu),o=new Ru.ChaCha20Poly1305(br(i.symKey,lr)).seal(s,br(i.message,qu));return PE({type:e,sealed:o,iv:s,senderPublicKey:t})}function OE(i){const e=new Ru.ChaCha20Poly1305(br(i.symKey,lr)),{sealed:t,iv:s}=Qo(i.encoded),o=e.open(s,t);if(o===null)throw new Error("Failed to decrypt");return fr(o,qu)}function PE(i){if(As(i.type)===fn){if(typeof i.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return fr(lu([i.type,i.senderPublicKey,i.iv,i.sealed]),yu)}return fr(lu([i.type,i.iv,i.sealed]),yu)}function Qo(i){const e=br(i,yu),t=e.slice(bE,_f),s=_f;if(As(t)===fn){const f=s+Fu,y=f+vu,g=e.slice(s,f),m=e.slice(f,y),D=e.slice(y);return{type:t,sealed:D,iv:m,senderPublicKey:g}}const o=s+vu,c=e.slice(s,o),d=e.slice(o);return{type:t,sealed:d,iv:c}}function CE(i,e){const t=Qo(i);return ap({type:As(t.type),senderPublicKey:typeof t.senderPublicKey<"u"?fr(t.senderPublicKey,lr):void 0,receiverPublicKey:e==null?void 0:e.receiverPublicKey})}function ap(i){const e=(i==null?void 0:i.type)||op;if(e===fn){if(typeof(i==null?void 0:i.senderPublicKey)>"u")throw new Error("missing sender public key");if(typeof(i==null?void 0:i.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:i==null?void 0:i.senderPublicKey,receiverPublicKey:i==null?void 0:i.receiverPublicKey}}function bf(i){return i.type===fn&&typeof i.senderPublicKey=="string"&&typeof i.receiverPublicKey=="string"}var AE=Object.defineProperty,Ef=Object.getOwnPropertySymbols,TE=Object.prototype.hasOwnProperty,RE=Object.prototype.propertyIsEnumerable,Df=(i,e,t)=>e in i?AE(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,Sf=(i,e)=>{for(var t in e||(e={}))TE.call(e,t)&&Df(i,t,e[t]);if(Ef)for(var t of Ef(e))RE.call(e,t)&&Df(i,t,e[t]);return i};const NE="ReactNative",Cr={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},UE="js";function zu(){return typeof si<"u"&&typeof si.versions<"u"&&typeof si.versions.node<"u"}function Kn(){return!Lu()&&!!Mu()&&navigator.product===NE}function kn(){return!zu()&&!!Mu()&&!!Lu()}function Ts(){return Kn()?Cr.reactNative:zu()?Cr.node:kn()?Cr.browser:Cr.unknown}function $E(){var i;try{return Kn()&&typeof st<"u"&&typeof(st==null?void 0:st.Application)<"u"?(i=st.Application)==null?void 0:i.applicationId:void 0}catch{return}}function LE(i,e){let t=Is.parse(i);return t=Sf(Sf({},t),e),i=Is.stringify(t),i}function ME(){return rp()||{name:"",description:"",url:"",icons:[""]}}function jE(){if(Ts()===Cr.reactNative&&typeof st<"u"&&typeof(st==null?void 0:st.Platform)<"u"){const{OS:t,Version:s}=st.Platform;return[t,s].join("-")}const i=bb();if(i===null)return"unknown";const e=i.os?i.os.replace(" ","").toLowerCase():"unknown";return i.type==="browser"?[e,i.name,i.version].join("-"):[e,i.version].join("-")}function qE(){var i;const e=Ts();return e===Cr.browser?[e,((i=tp())==null?void 0:i.host)||"unknown"].join(":"):e}function FE(i,e,t){const s=jE(),o=qE();return[[i,e].join("-"),[UE,t].join("-"),s,o].join("/")}function zE({protocol:i,version:e,relayUrl:t,sdkVersion:s,auth:o,projectId:c,useOnCloseEvent:d,bundleId:f}){const y=t.split("?"),g=FE(i,e,s),m={auth:o,ua:g,projectId:c,useOnCloseEvent:d||void 0,origin:f||void 0},D=LE(y[1]||"",m);return y[0]+"?"+D}function un(i,e){return i.filter(t=>e.includes(t)).length===i.length}function cp(i){return Object.fromEntries(i.entries())}function up(i){return new Map(Object.entries(i))}function jn(i=ve.FIVE_MINUTES,e){const t=ve.toMiliseconds(i||ve.FIVE_MINUTES);let s,o,c;return{resolve:d=>{c&&s&&(clearTimeout(c),s(d))},reject:d=>{c&&o&&(clearTimeout(c),o(d))},done:()=>new Promise((d,f)=>{c=setTimeout(()=>{f(new Error(e))},t),s=d,o=f})}}function xs(i,e,t){return new Promise(async(s,o)=>{const c=setTimeout(()=>o(new Error(t)),e);try{const d=await i;s(d)}catch(d){o(d)}clearTimeout(c)})}function hp(i,e){if(typeof e=="string"&&e.startsWith(`${i}:`))return e;if(i.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(i.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${i}`)}function BE(i){return hp("topic",i)}function HE(i){return hp("id",i)}function lp(i){const[e,t]=i.split(":"),s={id:void 0,topic:void 0};if(e==="topic"&&typeof t=="string")s.topic=t;else if(e==="id"&&Number.isInteger(Number(t)))s.id=Number(t);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${t}`);return s}function Pr(i,e){return ve.fromMiliseconds((e||Date.now())+ve.toMiliseconds(i))}function qi(i){return Date.now()>=ve.toMiliseconds(i)}function $t(i,e){return`${i}${e?`:${e}`:""}`}function Bc(i=[],e=[]){return[...new Set([...i,...e])]}async function KE({id:i,topic:e,wcDeepLink:t}){try{if(!t)return;const s=typeof t=="string"?JSON.parse(t):t;let o=s==null?void 0:s.href;if(typeof o!="string")return;o.endsWith("/")&&(o=o.slice(0,-1));const c=`${o}/wc?requestId=${i}&sessionTopic=${e}`,d=Ts();d===Cr.browser?c.startsWith("https://")?window.open(c,"_blank","noreferrer noopener"):window.open(c,"_self","noreferrer noopener"):d===Cr.reactNative&&typeof(st==null?void 0:st.Linking)<"u"&&await st.Linking.openURL(c)}catch(s){console.error(s)}}async function kE(i,e){try{return await i.getItem(e)||(kn()?localStorage.getItem(e):void 0)}catch(t){console.error(t)}}const VE="irn";function wu(i){return(i==null?void 0:i.relay)||{protocol:VE}}function Vo(i){const e=vE[i];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${i}`);return e}var GE=Object.defineProperty,WE=Object.defineProperties,YE=Object.getOwnPropertyDescriptors,If=Object.getOwnPropertySymbols,JE=Object.prototype.hasOwnProperty,QE=Object.prototype.propertyIsEnumerable,xf=(i,e,t)=>e in i?GE(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,XE=(i,e)=>{for(var t in e||(e={}))JE.call(e,t)&&xf(i,t,e[t]);if(If)for(var t of If(e))QE.call(e,t)&&xf(i,t,e[t]);return i},ZE=(i,e)=>WE(i,YE(e));function eD(i,e="-"){const t={},s="relay"+e;return Object.keys(i).forEach(o=>{if(o.startsWith(s)){const c=o.replace(s,""),d=i[o];t[c]=d}}),t}function Of(i){i=i.includes("wc://")?i.replace("wc://",""):i,i=i.includes("wc:")?i.replace("wc:",""):i;const e=i.indexOf(":"),t=i.indexOf("?")!==-1?i.indexOf("?"):void 0,s=i.substring(0,e),o=i.substring(e+1,t).split("@"),c=typeof t<"u"?i.substring(t):"",d=Is.parse(c);return{protocol:s,topic:tD(o[0]),version:parseInt(o[1],10),symKey:d.symKey,relay:eD(d),expiryTimestamp:d.expiryTimestamp?parseInt(d.expiryTimestamp,10):void 0}}function tD(i){return i.startsWith("//")?i.substring(2):i}function rD(i,e="-"){const t="relay",s={};return Object.keys(i).forEach(o=>{const c=t+e+o;i[o]&&(s[c]=i[o])}),s}function iD(i){return`${i.protocol}:${i.topic}@${i.version}?`+Is.stringify(ZE(XE({symKey:i.symKey},rD(i.relay)),{expiryTimestamp:i.expiryTimestamp}))}function Vn(i){const e=[];return i.forEach(t=>{const[s,o]=t.split(":");e.push(`${s}:${o}`)}),e}function nD(i){const e=[];return Object.values(i).forEach(t=>{e.push(...Vn(t.accounts))}),e}function sD(i,e){const t=[];return Object.values(i).forEach(s=>{Vn(s.accounts).includes(e)&&t.push(...s.methods)}),t}function oD(i,e){const t=[];return Object.values(i).forEach(s=>{Vn(s.accounts).includes(e)&&t.push(...s.events)}),t}function Bu(i){return i.includes(":")}function _s(i){return Bu(i)?i.split(":")[0]:i}const aD={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},cD={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function ce(i,e){const{message:t,code:s}=cD[i];return{message:e?`${t} ${e}`:t,code:s}}function _t(i,e){const{message:t,code:s}=aD[i];return{message:e?`${t} ${e}`:t,code:s}}function oi(i,e){return Array.isArray(i)?typeof e<"u"&&i.length?i.every(e):!0:!1}function Os(i){return Object.getPrototypeOf(i)===Object.prototype&&Object.keys(i).length}function hr(i){return typeof i>"u"}function Wt(i,e){return e&&hr(i)?!0:typeof i=="string"&&!!i.trim().length}function Hu(i,e){return e&&hr(i)?!0:typeof i=="number"&&!isNaN(i)}function uD(i,e){const{requiredNamespaces:t}=e,s=Object.keys(i.namespaces),o=Object.keys(t);let c=!0;return un(o,s)?(s.forEach(d=>{const{accounts:f,methods:y,events:g}=i.namespaces[d],m=Vn(f),D=t[d];(!un(np(d,D),m)||!un(D.methods,y)||!un(D.events,g))&&(c=!1)}),c):!1}function Xo(i){return Wt(i,!1)&&i.includes(":")?i.split(":").length===2:!1}function hD(i){if(Wt(i,!1)&&i.includes(":")){const e=i.split(":");if(e.length===3){const t=e[0]+":"+e[1];return!!e[2]&&Xo(t)}}return!1}function lD(i){if(Wt(i,!1))try{return typeof new URL(i)<"u"}catch{return!1}return!1}function fD(i){var e;return(e=i==null?void 0:i.proposer)==null?void 0:e.publicKey}function dD(i){return i==null?void 0:i.topic}function pD(i,e){let t=null;return Wt(i==null?void 0:i.publicKey,!1)||(t=ce("MISSING_OR_INVALID",`${e} controller public key should be a string`)),t}function Pf(i){let e=!0;return oi(i)?i.length&&(e=i.every(t=>Wt(t,!1))):e=!1,e}function gD(i,e,t){let s=null;return oi(e)&&e.length?e.forEach(o=>{s||Xo(o)||(s=_t("UNSUPPORTED_CHAINS",`${t}, chain ${o} should be a string and conform to "namespace:chainId" format`))}):Xo(i)||(s=_t("UNSUPPORTED_CHAINS",`${t}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),s}function yD(i,e,t){let s=null;return Object.entries(i).forEach(([o,c])=>{if(s)return;const d=gD(o,np(o,c),`${e} ${t}`);d&&(s=d)}),s}function vD(i,e){let t=null;return oi(i)?i.forEach(s=>{t||hD(s)||(t=_t("UNSUPPORTED_ACCOUNTS",`${e}, account ${s} should be a string and conform to "namespace:chainId:address" format`))}):t=_t("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),t}function mD(i,e){let t=null;return Object.values(i).forEach(s=>{if(t)return;const o=vD(s==null?void 0:s.accounts,`${e} namespace`);o&&(t=o)}),t}function wD(i,e){let t=null;return Pf(i==null?void 0:i.methods)?Pf(i==null?void 0:i.events)||(t=_t("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):t=_t("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),t}function fp(i,e){let t=null;return Object.values(i).forEach(s=>{if(t)return;const o=wD(s,`${e}, namespace`);o&&(t=o)}),t}function _D(i,e,t){let s=null;if(i&&Os(i)){const o=fp(i,e);o&&(s=o);const c=yD(i,e,t);c&&(s=c)}else s=ce("MISSING_OR_INVALID",`${e}, ${t} should be an object with data`);return s}function Hc(i,e){let t=null;if(i&&Os(i)){const s=fp(i,e);s&&(t=s);const o=mD(i,e);o&&(t=o)}else t=ce("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return t}function dp(i){return Wt(i.protocol,!0)}function bD(i,e){let t=!1;return e&&!i?t=!0:i&&oi(i)&&i.length&&i.forEach(s=>{t=dp(s)}),t}function ED(i){return typeof i=="number"}function _r(i){return typeof i<"u"&&typeof i!==null}function DD(i){return!(!i||typeof i!="object"||!i.code||!Hu(i.code,!1)||!i.message||!Wt(i.message,!1))}function SD(i){return!(hr(i)||!Wt(i.method,!1))}function ID(i){return!(hr(i)||hr(i.result)&&hr(i.error)||!Hu(i.id,!1)||!Wt(i.jsonrpc,!1))}function xD(i){return!(hr(i)||!Wt(i.name,!1))}function Cf(i,e){return!(!Xo(e)||!nD(i).includes(e))}function OD(i,e,t){return Wt(t,!1)?sD(i,e).includes(t):!1}function PD(i,e,t){return Wt(t,!1)?oD(i,e).includes(t):!1}function Af(i,e,t){let s=null;const o=CD(i),c=AD(e),d=Object.keys(o),f=Object.keys(c),y=Tf(Object.keys(i)),g=Tf(Object.keys(e)),m=y.filter(D=>!g.includes(D));return m.length&&(s=ce("NON_CONFORMING_NAMESPACES",`${t} namespaces keys don't satisfy requiredNamespaces.
      Required: ${m.toString()}
      Received: ${Object.keys(e).toString()}`)),un(d,f)||(s=ce("NON_CONFORMING_NAMESPACES",`${t} namespaces chains don't satisfy required namespaces.
      Required: ${d.toString()}
      Approved: ${f.toString()}`)),Object.keys(e).forEach(D=>{if(!D.includes(":")||s)return;const I=Vn(e[D].accounts);I.includes(D)||(s=ce("NON_CONFORMING_NAMESPACES",`${t} namespaces accounts don't satisfy namespace accounts for ${D}
        Required: ${D}
        Approved: ${I.toString()}`))}),d.forEach(D=>{s||(un(o[D].methods,c[D].methods)?un(o[D].events,c[D].events)||(s=ce("NON_CONFORMING_NAMESPACES",`${t} namespaces events don't satisfy namespace events for ${D}`)):s=ce("NON_CONFORMING_NAMESPACES",`${t} namespaces methods don't satisfy namespace methods for ${D}`))}),s}function CD(i){const e={};return Object.keys(i).forEach(t=>{var s;t.includes(":")?e[t]=i[t]:(s=i[t].chains)==null||s.forEach(o=>{e[o]={methods:i[t].methods,events:i[t].events}})}),e}function Tf(i){return[...new Set(i.map(e=>e.includes(":")?e.split(":")[0]:e))]}function AD(i){const e={};return Object.keys(i).forEach(t=>{if(t.includes(":"))e[t]=i[t];else{const s=Vn(i[t].accounts);s==null||s.forEach(o=>{e[o]={accounts:i[t].accounts.filter(c=>c.includes(`${o}:`)),methods:i[t].methods,events:i[t].events}})}}),e}function TD(i,e){return Hu(i,!1)&&i<=e.max&&i>=e.min}function Rf(){const i=Ts();return new Promise(e=>{switch(i){case Cr.browser:e(RD());break;case Cr.reactNative:e(ND());break;case Cr.node:e(UD());break;default:e(!0)}})}function RD(){return kn()&&(navigator==null?void 0:navigator.onLine)}async function ND(){if(Kn()&&typeof st<"u"&&st!=null&&st.NetInfo){const i=await(st==null?void 0:st.NetInfo.fetch());return i==null?void 0:i.isConnected}return!0}function UD(){return!0}function $D(i){switch(Ts()){case Cr.browser:LD(i);break;case Cr.reactNative:MD(i);break}}function LD(i){!Kn()&&kn()&&(window.addEventListener("online",()=>i(!0)),window.addEventListener("offline",()=>i(!1)))}function MD(i){var e;Kn()&&typeof st<"u"&&st!=null&&st.NetInfo&&((e=st)==null||e.NetInfo.addEventListener(t=>i(t==null?void 0:t.isConnected)))}const Kc={};let Fo=class{static get(e){return Kc[e]}static set(e,t){Kc[e]=t}static delete(e){delete Kc[e]}};const jD=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,qD=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,FD=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function zD(i,e){if(i==="__proto__"||i==="constructor"&&e&&typeof e=="object"&&"prototype"in e){BD(i);return}return e}function BD(i){console.warn(`[destr] Dropping "${i}" key to prevent prototype pollution.`)}function zo(i,e={}){if(typeof i!="string")return i;const t=i.trim();if(i[0]==='"'&&i.at(-1)==='"'&&!i.includes("\\"))return t.slice(1,-1);if(t.length<=9){const s=t.toLowerCase();if(s==="true")return!0;if(s==="false")return!1;if(s==="undefined")return;if(s==="null")return null;if(s==="nan")return Number.NaN;if(s==="infinity")return Number.POSITIVE_INFINITY;if(s==="-infinity")return Number.NEGATIVE_INFINITY}if(!FD.test(i)){if(e.strict)throw new SyntaxError("[destr] Invalid JSON");return i}try{if(jD.test(i)||qD.test(i)){if(e.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(i,zD)}return JSON.parse(i)}catch(s){if(e.strict)throw s;return i}}function HD(i){return!i||typeof i.then!="function"?Promise.resolve(i):i}function Gt(i,...e){try{return HD(i(...e))}catch(t){return Promise.reject(t)}}function KD(i){const e=typeof i;return i===null||e!=="object"&&e!=="function"}function kD(i){const e=Object.getPrototypeOf(i);return!e||e.isPrototypeOf(Object)}function Go(i){if(KD(i))return String(i);if(kD(i)||Array.isArray(i))return JSON.stringify(i);if(typeof i.toJSON=="function")return Go(i.toJSON());throw new Error("[unstorage] Cannot stringify value!")}function pp(){if(typeof Cu===void 0)throw new TypeError("[unstorage] Buffer is not supported!")}const _u="base64:";function VD(i){if(typeof i=="string")return i;pp();const e=Cu.from(i).toString("base64");return _u+e}function GD(i){return typeof i!="string"||!i.startsWith(_u)?i:(pp(),Cu.from(i.slice(_u.length),"base64"))}function wr(i){return i?i.split("?")[0].replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""):""}function WD(...i){return wr(i.join(":"))}function Bo(i){return i=wr(i),i?i+":":""}const YD="memory",JD=()=>{const i=new Map;return{name:YD,options:{},hasItem(e){return i.has(e)},getItem(e){return i.get(e)??null},getItemRaw(e){return i.get(e)??null},setItem(e,t){i.set(e,t)},setItemRaw(e,t){i.set(e,t)},removeItem(e){i.delete(e)},getKeys(){return Array.from(i.keys())},clear(){i.clear()},dispose(){i.clear()}}};function QD(i={}){const e={mounts:{"":i.driver||JD()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},t=g=>{for(const m of e.mountpoints)if(g.startsWith(m))return{base:m,relativeKey:g.slice(m.length),driver:e.mounts[m]};return{base:"",relativeKey:g,driver:e.mounts[""]}},s=(g,m)=>e.mountpoints.filter(D=>D.startsWith(g)||m&&g.startsWith(D)).map(D=>({relativeBase:g.length>D.length?g.slice(D.length):void 0,mountpoint:D,driver:e.mounts[D]})),o=(g,m)=>{if(e.watching){m=wr(m);for(const D of e.watchListeners)D(g,m)}},c=async()=>{if(!e.watching){e.watching=!0;for(const g in e.mounts)e.unwatch[g]=await Nf(e.mounts[g],o,g)}},d=async()=>{if(e.watching){for(const g in e.unwatch)await e.unwatch[g]();e.unwatch={},e.watching=!1}},f=(g,m,D)=>{const I=new Map,T=P=>{let z=I.get(P.base);return z||(z={driver:P.driver,base:P.base,items:[]},I.set(P.base,z)),z};for(const P of g){const z=typeof P=="string",H=wr(z?P:P.key),ie=z?void 0:P.value,U=z||!P.options?m:{...m,...P.options},j=t(H);T(j).items.push({key:H,value:ie,relativeKey:j.relativeKey,options:U})}return Promise.all([...I.values()].map(P=>D(P))).then(P=>P.flat())},y={hasItem(g,m={}){g=wr(g);const{relativeKey:D,driver:I}=t(g);return Gt(I.hasItem,D,m)},getItem(g,m={}){g=wr(g);const{relativeKey:D,driver:I}=t(g);return Gt(I.getItem,D,m).then(T=>zo(T))},getItems(g,m){return f(g,m,D=>D.driver.getItems?Gt(D.driver.getItems,D.items.map(I=>({key:I.relativeKey,options:I.options})),m).then(I=>I.map(T=>({key:WD(D.base,T.key),value:zo(T.value)}))):Promise.all(D.items.map(I=>Gt(D.driver.getItem,I.relativeKey,I.options).then(T=>({key:I.key,value:zo(T)})))))},getItemRaw(g,m={}){g=wr(g);const{relativeKey:D,driver:I}=t(g);return I.getItemRaw?Gt(I.getItemRaw,D,m):Gt(I.getItem,D,m).then(T=>GD(T))},async setItem(g,m,D={}){if(m===void 0)return y.removeItem(g);g=wr(g);const{relativeKey:I,driver:T}=t(g);T.setItem&&(await Gt(T.setItem,I,Go(m),D),T.watch||o("update",g))},async setItems(g,m){await f(g,m,async D=>{D.driver.setItems&&await Gt(D.driver.setItems,D.items.map(I=>({key:I.relativeKey,value:Go(I.value),options:I.options})),m),D.driver.setItem&&await Promise.all(D.items.map(I=>Gt(D.driver.setItem,I.relativeKey,Go(I.value),I.options)))})},async setItemRaw(g,m,D={}){if(m===void 0)return y.removeItem(g,D);g=wr(g);const{relativeKey:I,driver:T}=t(g);if(T.setItemRaw)await Gt(T.setItemRaw,I,m,D);else if(T.setItem)await Gt(T.setItem,I,VD(m),D);else return;T.watch||o("update",g)},async removeItem(g,m={}){typeof m=="boolean"&&(m={removeMeta:m}),g=wr(g);const{relativeKey:D,driver:I}=t(g);I.removeItem&&(await Gt(I.removeItem,D,m),(m.removeMeta||m.removeMata)&&await Gt(I.removeItem,D+"$",m),I.watch||o("remove",g))},async getMeta(g,m={}){typeof m=="boolean"&&(m={nativeOnly:m}),g=wr(g);const{relativeKey:D,driver:I}=t(g),T=Object.create(null);if(I.getMeta&&Object.assign(T,await Gt(I.getMeta,D,m)),!m.nativeOnly){const P=await Gt(I.getItem,D+"$",m).then(z=>zo(z));P&&typeof P=="object"&&(typeof P.atime=="string"&&(P.atime=new Date(P.atime)),typeof P.mtime=="string"&&(P.mtime=new Date(P.mtime)),Object.assign(T,P))}return T},setMeta(g,m,D={}){return this.setItem(g+"$",m,D)},removeMeta(g,m={}){return this.removeItem(g+"$",m)},async getKeys(g,m={}){g=Bo(g);const D=s(g,!0);let I=[];const T=[];for(const P of D){const H=(await Gt(P.driver.getKeys,P.relativeBase,m)).map(ie=>P.mountpoint+wr(ie)).filter(ie=>!I.some(U=>ie.startsWith(U)));T.push(...H),I=[P.mountpoint,...I.filter(ie=>!ie.startsWith(P.mountpoint))]}return g?T.filter(P=>P.startsWith(g)&&!P.endsWith("$")):T.filter(P=>!P.endsWith("$"))},async clear(g,m={}){g=Bo(g),await Promise.all(s(g,!1).map(async D=>{if(D.driver.clear)return Gt(D.driver.clear,D.relativeBase,m);if(D.driver.removeItem){const I=await D.driver.getKeys(D.relativeBase||"",m);return Promise.all(I.map(T=>D.driver.removeItem(T,m)))}}))},async dispose(){await Promise.all(Object.values(e.mounts).map(g=>Uf(g)))},async watch(g){return await c(),e.watchListeners.push(g),async()=>{e.watchListeners=e.watchListeners.filter(m=>m!==g),e.watchListeners.length===0&&await d()}},async unwatch(){e.watchListeners=[],await d()},mount(g,m){if(g=Bo(g),g&&e.mounts[g])throw new Error(`already mounted at ${g}`);return g&&(e.mountpoints.push(g),e.mountpoints.sort((D,I)=>I.length-D.length)),e.mounts[g]=m,e.watching&&Promise.resolve(Nf(m,o,g)).then(D=>{e.unwatch[g]=D}).catch(console.error),y},async unmount(g,m=!0){g=Bo(g),!(!g||!e.mounts[g])&&(e.watching&&g in e.unwatch&&(e.unwatch[g](),delete e.unwatch[g]),m&&await Uf(e.mounts[g]),e.mountpoints=e.mountpoints.filter(D=>D!==g),delete e.mounts[g])},getMount(g=""){g=wr(g)+":";const m=t(g);return{driver:m.driver,base:m.base}},getMounts(g="",m={}){return g=wr(g),s(g,m.parents).map(I=>({driver:I.driver,base:I.mountpoint}))}};return y}function Nf(i,e,t){return i.watch?i.watch((s,o)=>e(s,t+o)):()=>{}}async function Uf(i){typeof i.dispose=="function"&&await Gt(i.dispose)}function dn(i){return new Promise((e,t)=>{i.oncomplete=i.onsuccess=()=>e(i.result),i.onabort=i.onerror=()=>t(i.error)})}function gp(i,e){const t=indexedDB.open(i);t.onupgradeneeded=()=>t.result.createObjectStore(e);const s=dn(t);return(o,c)=>s.then(d=>c(d.transaction(e,o).objectStore(e)))}let kc;function Rs(){return kc||(kc=gp("keyval-store","keyval")),kc}function $f(i,e=Rs()){return e("readonly",t=>dn(t.get(i)))}function XD(i,e,t=Rs()){return t("readwrite",s=>(s.put(e,i),dn(s.transaction)))}function ZD(i,e=Rs()){return e("readwrite",t=>(t.delete(i),dn(t.transaction)))}function e3(i=Rs()){return i("readwrite",e=>(e.clear(),dn(e.transaction)))}function t3(i,e){return i.openCursor().onsuccess=function(){this.result&&(e(this.result),this.result.continue())},dn(i.transaction)}function r3(i=Rs()){return i("readonly",e=>{if(e.getAllKeys)return dn(e.getAllKeys());const t=[];return t3(e,s=>t.push(s.key)).then(()=>t)})}const i3=i=>JSON.stringify(i,(e,t)=>typeof t=="bigint"?t.toString()+"n":t),n3=i=>{const e=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,t=i.replace(e,'$1"$2n"$3');return JSON.parse(t,(s,o)=>typeof o=="string"&&o.match(/^\d+n$/)?BigInt(o.substring(0,o.length-1)):o)};function Ns(i){if(typeof i!="string")throw new Error(`Cannot safe json parse value of type ${typeof i}`);try{return n3(i)}catch{return i}}function hn(i){return typeof i=="string"?i:i3(i)||""}const s3="idb-keyval";var o3=(i={})=>{const e=i.base&&i.base.length>0?`${i.base}:`:"",t=o=>e+o;let s;return i.dbName&&i.storeName&&(s=gp(i.dbName,i.storeName)),{name:s3,options:i,async hasItem(o){return!(typeof await $f(t(o),s)>"u")},async getItem(o){return await $f(t(o),s)??null},setItem(o,c){return XD(t(o),c,s)},removeItem(o){return ZD(t(o),s)},getKeys(){return r3(s)},clear(){return e3(s)}}};const a3="WALLET_CONNECT_V2_INDEXED_DB",c3="keyvaluestorage";let u3=class{constructor(){this.indexedDb=QD({driver:o3({dbName:a3,storeName:c3})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(e=>[e.key,e.value])}async getItem(e){const t=await this.indexedDb.getItem(e);if(t!==null)return t}async setItem(e,t){await this.indexedDb.setItem(e,hn(t))}async removeItem(e){await this.indexedDb.removeItem(e)}};var Vc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof st<"u"?st:typeof self<"u"?self:{},Wo={exports:{}};(function(){let i;function e(){}i=e,i.prototype.getItem=function(t){return this.hasOwnProperty(t)?String(this[t]):null},i.prototype.setItem=function(t,s){this[t]=String(s)},i.prototype.removeItem=function(t){delete this[t]},i.prototype.clear=function(){const t=this;Object.keys(t).forEach(function(s){t[s]=void 0,delete t[s]})},i.prototype.key=function(t){return t=t||0,Object.keys(this)[t]},i.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof Vc<"u"&&Vc.localStorage?Wo.exports=Vc.localStorage:typeof window<"u"&&window.localStorage?Wo.exports=window.localStorage:Wo.exports=new e})();function h3(i){var e;return[i[0],Ns((e=i[1])!=null?e:"")]}class l3{constructor(){this.localStorage=Wo.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(h3)}async getItem(e){const t=this.localStorage.getItem(e);if(t!==null)return Ns(t)}async setItem(e,t){this.localStorage.setItem(e,hn(t))}async removeItem(e){this.localStorage.removeItem(e)}}const f3="wc_storage_version",Lf=1,d3=async(i,e,t)=>{const s=f3,o=await e.getItem(s);if(o&&o>=Lf){t(e);return}const c=await i.getKeys();if(!c.length){t(e);return}const d=[];for(;c.length;){const f=c.shift();if(!f)continue;const y=f.toLowerCase();if(y.includes("wc@")||y.includes("walletconnect")||y.includes("wc_")||y.includes("wallet_connect")){const g=await i.getItem(f);await e.setItem(f,g),d.push(f)}}await e.setItem(s,Lf),t(e),p3(i,d)},p3=async(i,e)=>{e.length&&e.forEach(async t=>{await i.removeItem(t)})};let g3=class{constructor(){this.initialized=!1,this.setInitialized=t=>{this.storage=t,this.initialized=!0};const e=new l3;this.storage=e;try{const t=new u3;d3(e,t,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(e){return await this.initialize(),this.storage.getItem(e)}async setItem(e,t){return await this.initialize(),this.storage.setItem(e,t)}async removeItem(e){return await this.initialize(),this.storage.removeItem(e)}async initialize(){this.initialized||await new Promise(e=>{const t=setInterval(()=>{this.initialized&&(clearInterval(t),e())},20)})}};var Gn={},gs={},Gc={},ys={};let pn=class{};const y3=Object.freeze(Object.defineProperty({__proto__:null,IEvents:pn},Symbol.toStringTag,{value:"Module"})),v3=Pu(y3);var Mf;function m3(){if(Mf)return ys;Mf=1,Object.defineProperty(ys,"__esModule",{value:!0}),ys.IHeartBeat=void 0;const i=v3;class e extends i.IEvents{constructor(s){super()}}return ys.IHeartBeat=e,ys}var jf;function yp(){return jf||(jf=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),ai.__exportStar(m3(),i)}(Gc)),Gc}var Wc={},an={},qf;function w3(){if(qf)return an;qf=1,Object.defineProperty(an,"__esModule",{value:!0}),an.HEARTBEAT_EVENTS=an.HEARTBEAT_INTERVAL=void 0;const i=ve;return an.HEARTBEAT_INTERVAL=i.FIVE_SECONDS,an.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},an}var Ff;function vp(){return Ff||(Ff=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),ai.__exportStar(w3(),i)}(Wc)),Wc}var zf;function _3(){if(zf)return gs;zf=1,Object.defineProperty(gs,"__esModule",{value:!0}),gs.HeartBeat=void 0;const i=ai,e=zr,t=ve,s=yp(),o=vp();class c extends s.IHeartBeat{constructor(f){super(f),this.events=new e.EventEmitter,this.interval=o.HEARTBEAT_INTERVAL,this.interval=(f==null?void 0:f.interval)||o.HEARTBEAT_INTERVAL}static init(f){return i.__awaiter(this,void 0,void 0,function*(){const y=new c(f);return yield y.init(),y})}init(){return i.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(f,y){this.events.on(f,y)}once(f,y){this.events.once(f,y)}off(f,y){this.events.off(f,y)}removeListener(f,y){this.events.removeListener(f,y)}initialize(){return i.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),t.toMiliseconds(this.interval))})}pulse(){this.events.emit(o.HEARTBEAT_EVENTS.pulse)}}return gs.HeartBeat=c,gs}(function(i){Object.defineProperty(i,"__esModule",{value:!0});const e=ai;e.__exportStar(_3(),i),e.__exportStar(yp(),i),e.__exportStar(vp(),i)})(Gn);var Je={},Yc,Bf;function b3(){if(Bf)return Yc;Bf=1;function i(t){try{return JSON.stringify(t)}catch{return'"[Circular]"'}}Yc=e;function e(t,s,o){var c=o&&o.stringify||i,d=1;if(typeof t=="object"&&t!==null){var f=s.length+d;if(f===1)return t;var y=new Array(f);y[0]=c(t);for(var g=1;g<f;g++)y[g]=c(s[g]);return y.join(" ")}if(typeof t!="string")return t;var m=s.length;if(m===0)return t;for(var D="",I=1-d,T=-1,P=t&&t.length||0,z=0;z<P;){if(t.charCodeAt(z)===37&&z+1<P){switch(T=T>-1?T:0,t.charCodeAt(z+1)){case 100:case 102:if(I>=m||s[I]==null)break;T<z&&(D+=t.slice(T,z)),D+=Number(s[I]),T=z+2,z++;break;case 105:if(I>=m||s[I]==null)break;T<z&&(D+=t.slice(T,z)),D+=Math.floor(Number(s[I])),T=z+2,z++;break;case 79:case 111:case 106:if(I>=m||s[I]===void 0)break;T<z&&(D+=t.slice(T,z));var H=typeof s[I];if(H==="string"){D+="'"+s[I]+"'",T=z+2,z++;break}if(H==="function"){D+=s[I].name||"<anonymous>",T=z+2,z++;break}D+=c(s[I]),T=z+2,z++;break;case 115:if(I>=m)break;T<z&&(D+=t.slice(T,z)),D+=String(s[I]),T=z+2,z++;break;case 37:T<z&&(D+=t.slice(T,z)),D+="%",T=z+2,z++,I--;break}++I}++z}return T===-1?t:(T<P&&(D+=t.slice(T)),D)}return Yc}var Jc,Hf;function E3(){if(Hf)return Jc;Hf=1;const i=b3();Jc=o;const e=A().console||{},t={mapHttpRequest:P,mapHttpResponse:P,wrapRequestSerializer:z,wrapResponseSerializer:z,wrapErrorSerializer:z,req:P,res:P,err:I};function s(E,u){return Array.isArray(E)?E.filter(function(G){return G!=="!stdSerializers.err"}):E===!0?Object.keys(u):!1}function o(E){E=E||{},E.browser=E.browser||{};const u=E.browser.transmit;if(u&&typeof u.send!="function")throw Error("pino: transmit option must have a send function");const _=E.browser.write||e;E.browser.write&&(E.browser.asObject=!0);const G=E.serializers||{},W=s(E.browser.serialize,G);let se=E.browser.serialize;Array.isArray(E.browser.serialize)&&E.browser.serialize.indexOf("!stdSerializers.err")>-1&&(se=!1);const ue=["error","fatal","warn","info","debug","trace"];typeof _=="function"&&(_.error=_.fatal=_.warn=_.info=_.debug=_.trace=_),E.enabled===!1&&(E.level="silent");const de=E.level||"info",b=Object.create(_);b.log||(b.log=H),Object.defineProperty(b,"levelVal",{get:ee}),Object.defineProperty(b,"level",{get:Q,set:k});const C={transmit:u,serialize:W,asObject:E.browser.asObject,levels:ue,timestamp:T(E)};b.levels=o.levels,b.level=de,b.setMaxListeners=b.getMaxListeners=b.emit=b.addListener=b.on=b.prependListener=b.once=b.prependOnceListener=b.removeListener=b.removeAllListeners=b.listeners=b.listenerCount=b.eventNames=b.write=b.flush=H,b.serializers=G,b._serialize=W,b._stdErrSerialize=se,b.child=V,u&&(b._logEvent=D());function ee(){return this.level==="silent"?1/0:this.levels.values[this.level]}function Q(){return this._level}function k(J){if(J!=="silent"&&!this.levels.values[J])throw Error("unknown level "+J);this._level=J,c(C,b,"error","log"),c(C,b,"fatal","error"),c(C,b,"warn","error"),c(C,b,"info","log"),c(C,b,"debug","log"),c(C,b,"trace","log")}function V(J,re){if(!J)throw new Error("missing bindings for child Pino");re=re||{},W&&J.serializers&&(re.serializers=J.serializers);const _e=re.serializers;if(W&&_e){var oe=Object.assign({},G,_e),be=E.browser.serialize===!0?Object.keys(oe):W;delete J.serializers,y([J],be,oe,this._stdErrSerialize)}function le(me){this._childLevel=(me._childLevel|0)+1,this.error=g(me,J,"error"),this.fatal=g(me,J,"fatal"),this.warn=g(me,J,"warn"),this.info=g(me,J,"info"),this.debug=g(me,J,"debug"),this.trace=g(me,J,"trace"),oe&&(this.serializers=oe,this._serialize=be),u&&(this._logEvent=D([].concat(me._logEvent.bindings,J)))}return le.prototype=this,new le(this)}return b}o.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},o.stdSerializers=t,o.stdTimeFunctions=Object.assign({},{nullTime:ie,epochTime:U,unixTime:j,isoTime:O});function c(E,u,_,G){const W=Object.getPrototypeOf(u);u[_]=u.levelVal>u.levels.values[_]?H:W[_]?W[_]:e[_]||e[G]||H,d(E,u,_)}function d(E,u,_){!E.transmit&&u[_]===H||(u[_]=function(G){return function(){const se=E.timestamp(),ue=new Array(arguments.length),de=Object.getPrototypeOf&&Object.getPrototypeOf(this)===e?e:this;for(var b=0;b<ue.length;b++)ue[b]=arguments[b];if(E.serialize&&!E.asObject&&y(ue,this._serialize,this.serializers,this._stdErrSerialize),E.asObject?G.call(de,f(this,_,ue,se)):G.apply(de,ue),E.transmit){const C=E.transmit.level||u.level,ee=o.levels.values[C],Q=o.levels.values[_];if(Q<ee)return;m(this,{ts:se,methodLevel:_,methodValue:Q,transmitLevel:C,transmitValue:o.levels.values[E.transmit.level||u.level],send:E.transmit.send,val:u.levelVal},ue)}}}(u[_]))}function f(E,u,_,G){E._serialize&&y(_,E._serialize,E.serializers,E._stdErrSerialize);const W=_.slice();let se=W[0];const ue={};G&&(ue.time=G),ue.level=o.levels.values[u];let de=(E._childLevel|0)+1;if(de<1&&(de=1),se!==null&&typeof se=="object"){for(;de--&&typeof W[0]=="object";)Object.assign(ue,W.shift());se=W.length?i(W.shift(),W):void 0}else typeof se=="string"&&(se=i(W.shift(),W));return se!==void 0&&(ue.msg=se),ue}function y(E,u,_,G){for(const W in E)if(G&&E[W]instanceof Error)E[W]=o.stdSerializers.err(E[W]);else if(typeof E[W]=="object"&&!Array.isArray(E[W]))for(const se in E[W])u&&u.indexOf(se)>-1&&se in _&&(E[W][se]=_[se](E[W][se]))}function g(E,u,_){return function(){const G=new Array(1+arguments.length);G[0]=u;for(var W=1;W<G.length;W++)G[W]=arguments[W-1];return E[_].apply(this,G)}}function m(E,u,_){const G=u.send,W=u.ts,se=u.methodLevel,ue=u.methodValue,de=u.val,b=E._logEvent.bindings;y(_,E._serialize||Object.keys(E.serializers),E.serializers,E._stdErrSerialize===void 0?!0:E._stdErrSerialize),E._logEvent.ts=W,E._logEvent.messages=_.filter(function(C){return b.indexOf(C)===-1}),E._logEvent.level.label=se,E._logEvent.level.value=ue,G(se,E._logEvent,de),E._logEvent=D(b)}function D(E){return{ts:0,messages:[],bindings:E||[],level:{label:"",value:0}}}function I(E){const u={type:E.constructor.name,msg:E.message,stack:E.stack};for(const _ in E)u[_]===void 0&&(u[_]=E[_]);return u}function T(E){return typeof E.timestamp=="function"?E.timestamp:E.timestamp===!1?ie:U}function P(){return{}}function z(E){return E}function H(){}function ie(){return!1}function U(){return Date.now()}function j(){return Math.round(Date.now()/1e3)}function O(){return new Date(Date.now()).toISOString()}function A(){function E(u){return typeof u<"u"&&u}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return E(self)||E(window)||E(this)||{}}}return Jc}var cn={},Kf;function mp(){return Kf||(Kf=1,Object.defineProperty(cn,"__esModule",{value:!0}),cn.PINO_CUSTOM_CONTEXT_KEY=cn.PINO_LOGGER_DEFAULTS=void 0,cn.PINO_LOGGER_DEFAULTS={level:"info"},cn.PINO_CUSTOM_CONTEXT_KEY="custom_context"),cn}var cr={},kf;function D3(){if(kf)return cr;kf=1,Object.defineProperty(cr,"__esModule",{value:!0}),cr.generateChildLogger=cr.formatChildLoggerContext=cr.getLoggerContext=cr.setBrowserLoggerContext=cr.getBrowserLoggerContext=cr.getDefaultLoggerOptions=void 0;const i=mp();function e(f){return Object.assign(Object.assign({},f),{level:(f==null?void 0:f.level)||i.PINO_LOGGER_DEFAULTS.level})}cr.getDefaultLoggerOptions=e;function t(f,y=i.PINO_CUSTOM_CONTEXT_KEY){return f[y]||""}cr.getBrowserLoggerContext=t;function s(f,y,g=i.PINO_CUSTOM_CONTEXT_KEY){return f[g]=y,f}cr.setBrowserLoggerContext=s;function o(f,y=i.PINO_CUSTOM_CONTEXT_KEY){let g="";return typeof f.bindings>"u"?g=t(f,y):g=f.bindings().context||"",g}cr.getLoggerContext=o;function c(f,y,g=i.PINO_CUSTOM_CONTEXT_KEY){const m=o(f,g);return m.trim()?`${m}/${y}`:y}cr.formatChildLoggerContext=c;function d(f,y,g=i.PINO_CUSTOM_CONTEXT_KEY){const m=c(f,y,g),D=f.child({context:m});return s(D,m,g)}return cr.generateChildLogger=d,cr}(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.pino=void 0;const e=ai,t=e.__importDefault(E3());Object.defineProperty(i,"pino",{enumerable:!0,get:function(){return t.default}}),e.__exportStar(mp(),i),e.__exportStar(D3(),i)})(Je);class S3 extends pn{constructor(e){super(),this.opts=e,this.protocol="wc",this.version=2}}let I3=class extends pn{constructor(e,t){super(),this.core=e,this.logger=t,this.records=new Map}},x3=class{constructor(e,t){this.logger=e,this.core=t}},O3=class extends pn{constructor(e,t){super(),this.relayer=e,this.logger=t}},P3=class extends pn{constructor(e){super()}},C3=class{constructor(e,t,s,o){this.core=e,this.logger=t,this.name=s}};class A3 extends pn{constructor(e,t){super(),this.relayer=e,this.logger=t}}let T3=class extends pn{constructor(e,t){super(),this.core=e,this.logger=t}},R3=class{constructor(e,t){this.projectId=e,this.logger=t}},N3=class{constructor(e,t){this.projectId=e,this.logger=t}},U3=class{constructor(e){this.opts=e,this.protocol="wc",this.version=2}},$3=class{constructor(e){this.client=e}};var Ku={},wp={};(function(i){Object.defineProperty(i,"__esModule",{value:!0});var e=Le,t=Ar;i.DIGEST_LENGTH=64,i.BLOCK_SIZE=128;var s=function(){function f(){this.digestLength=i.DIGEST_LENGTH,this.blockSize=i.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return f.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},f.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},f.prototype.clean=function(){t.wipe(this._buffer),t.wipe(this._tempHi),t.wipe(this._tempLo),this.reset()},f.prototype.update=function(y,g){if(g===void 0&&(g=y.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var m=0;if(this._bytesHashed+=g,this._bufferLength>0){for(;this._bufferLength<i.BLOCK_SIZE&&g>0;)this._buffer[this._bufferLength++]=y[m++],g--;this._bufferLength===this.blockSize&&(c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(g>=this.blockSize&&(m=c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,y,m,g),g%=this.blockSize);g>0;)this._buffer[this._bufferLength++]=y[m++],g--;return this},f.prototype.finish=function(y){if(!this._finished){var g=this._bytesHashed,m=this._bufferLength,D=g/536870912|0,I=g<<3,T=g%128<112?128:256;this._buffer[m]=128;for(var P=m+1;P<T-8;P++)this._buffer[P]=0;e.writeUint32BE(D,this._buffer,T-8),e.writeUint32BE(I,this._buffer,T-4),c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,T),this._finished=!0}for(var P=0;P<this.digestLength/8;P++)e.writeUint32BE(this._stateHi[P],y,P*8),e.writeUint32BE(this._stateLo[P],y,P*8+4);return this},f.prototype.digest=function(){var y=new Uint8Array(this.digestLength);return this.finish(y),y},f.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},f.prototype.restoreState=function(y){return this._stateHi.set(y.stateHi),this._stateLo.set(y.stateLo),this._bufferLength=y.bufferLength,y.buffer&&this._buffer.set(y.buffer),this._bytesHashed=y.bytesHashed,this._finished=!1,this},f.prototype.cleanSavedState=function(y){t.wipe(y.stateHi),t.wipe(y.stateLo),y.buffer&&t.wipe(y.buffer),y.bufferLength=0,y.bytesHashed=0},f}();i.SHA512=s;var o=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function c(f,y,g,m,D,I,T){for(var P=g[0],z=g[1],H=g[2],ie=g[3],U=g[4],j=g[5],O=g[6],A=g[7],E=m[0],u=m[1],_=m[2],G=m[3],W=m[4],se=m[5],ue=m[6],de=m[7],b,C,ee,Q,k,V,J,re;T>=128;){for(var _e=0;_e<16;_e++){var oe=8*_e+I;f[_e]=e.readUint32BE(D,oe),y[_e]=e.readUint32BE(D,oe+4)}for(var _e=0;_e<80;_e++){var be=P,le=z,me=H,B=ie,F=U,$=j,l=O,R=A,ae=E,fe=u,Ie=_,Be=G,ke=W,Me=se,gt=ue,yt=de;if(b=A,C=de,k=C&65535,V=C>>>16,J=b&65535,re=b>>>16,b=(U>>>14|W<<18)^(U>>>18|W<<14)^(W>>>9|U<<23),C=(W>>>14|U<<18)^(W>>>18|U<<14)^(U>>>9|W<<23),k+=C&65535,V+=C>>>16,J+=b&65535,re+=b>>>16,b=U&j^~U&O,C=W&se^~W&ue,k+=C&65535,V+=C>>>16,J+=b&65535,re+=b>>>16,b=o[_e*2],C=o[_e*2+1],k+=C&65535,V+=C>>>16,J+=b&65535,re+=b>>>16,b=f[_e%16],C=y[_e%16],k+=C&65535,V+=C>>>16,J+=b&65535,re+=b>>>16,V+=k>>>16,J+=V>>>16,re+=J>>>16,ee=J&65535|re<<16,Q=k&65535|V<<16,b=ee,C=Q,k=C&65535,V=C>>>16,J=b&65535,re=b>>>16,b=(P>>>28|E<<4)^(E>>>2|P<<30)^(E>>>7|P<<25),C=(E>>>28|P<<4)^(P>>>2|E<<30)^(P>>>7|E<<25),k+=C&65535,V+=C>>>16,J+=b&65535,re+=b>>>16,b=P&z^P&H^z&H,C=E&u^E&_^u&_,k+=C&65535,V+=C>>>16,J+=b&65535,re+=b>>>16,V+=k>>>16,J+=V>>>16,re+=J>>>16,R=J&65535|re<<16,yt=k&65535|V<<16,b=B,C=Be,k=C&65535,V=C>>>16,J=b&65535,re=b>>>16,b=ee,C=Q,k+=C&65535,V+=C>>>16,J+=b&65535,re+=b>>>16,V+=k>>>16,J+=V>>>16,re+=J>>>16,B=J&65535|re<<16,Be=k&65535|V<<16,z=be,H=le,ie=me,U=B,j=F,O=$,A=l,P=R,u=ae,_=fe,G=Ie,W=Be,se=ke,ue=Me,de=gt,E=yt,_e%16===15)for(var oe=0;oe<16;oe++)b=f[oe],C=y[oe],k=C&65535,V=C>>>16,J=b&65535,re=b>>>16,b=f[(oe+9)%16],C=y[(oe+9)%16],k+=C&65535,V+=C>>>16,J+=b&65535,re+=b>>>16,ee=f[(oe+1)%16],Q=y[(oe+1)%16],b=(ee>>>1|Q<<31)^(ee>>>8|Q<<24)^ee>>>7,C=(Q>>>1|ee<<31)^(Q>>>8|ee<<24)^(Q>>>7|ee<<25),k+=C&65535,V+=C>>>16,J+=b&65535,re+=b>>>16,ee=f[(oe+14)%16],Q=y[(oe+14)%16],b=(ee>>>19|Q<<13)^(Q>>>29|ee<<3)^ee>>>6,C=(Q>>>19|ee<<13)^(ee>>>29|Q<<3)^(Q>>>6|ee<<26),k+=C&65535,V+=C>>>16,J+=b&65535,re+=b>>>16,V+=k>>>16,J+=V>>>16,re+=J>>>16,f[oe]=J&65535|re<<16,y[oe]=k&65535|V<<16}b=P,C=E,k=C&65535,V=C>>>16,J=b&65535,re=b>>>16,b=g[0],C=m[0],k+=C&65535,V+=C>>>16,J+=b&65535,re+=b>>>16,V+=k>>>16,J+=V>>>16,re+=J>>>16,g[0]=P=J&65535|re<<16,m[0]=E=k&65535|V<<16,b=z,C=u,k=C&65535,V=C>>>16,J=b&65535,re=b>>>16,b=g[1],C=m[1],k+=C&65535,V+=C>>>16,J+=b&65535,re+=b>>>16,V+=k>>>16,J+=V>>>16,re+=J>>>16,g[1]=z=J&65535|re<<16,m[1]=u=k&65535|V<<16,b=H,C=_,k=C&65535,V=C>>>16,J=b&65535,re=b>>>16,b=g[2],C=m[2],k+=C&65535,V+=C>>>16,J+=b&65535,re+=b>>>16,V+=k>>>16,J+=V>>>16,re+=J>>>16,g[2]=H=J&65535|re<<16,m[2]=_=k&65535|V<<16,b=ie,C=G,k=C&65535,V=C>>>16,J=b&65535,re=b>>>16,b=g[3],C=m[3],k+=C&65535,V+=C>>>16,J+=b&65535,re+=b>>>16,V+=k>>>16,J+=V>>>16,re+=J>>>16,g[3]=ie=J&65535|re<<16,m[3]=G=k&65535|V<<16,b=U,C=W,k=C&65535,V=C>>>16,J=b&65535,re=b>>>16,b=g[4],C=m[4],k+=C&65535,V+=C>>>16,J+=b&65535,re+=b>>>16,V+=k>>>16,J+=V>>>16,re+=J>>>16,g[4]=U=J&65535|re<<16,m[4]=W=k&65535|V<<16,b=j,C=se,k=C&65535,V=C>>>16,J=b&65535,re=b>>>16,b=g[5],C=m[5],k+=C&65535,V+=C>>>16,J+=b&65535,re+=b>>>16,V+=k>>>16,J+=V>>>16,re+=J>>>16,g[5]=j=J&65535|re<<16,m[5]=se=k&65535|V<<16,b=O,C=ue,k=C&65535,V=C>>>16,J=b&65535,re=b>>>16,b=g[6],C=m[6],k+=C&65535,V+=C>>>16,J+=b&65535,re+=b>>>16,V+=k>>>16,J+=V>>>16,re+=J>>>16,g[6]=O=J&65535|re<<16,m[6]=ue=k&65535|V<<16,b=A,C=de,k=C&65535,V=C>>>16,J=b&65535,re=b>>>16,b=g[7],C=m[7],k+=C&65535,V+=C>>>16,J+=b&65535,re+=b>>>16,V+=k>>>16,J+=V>>>16,re+=J>>>16,g[7]=A=J&65535|re<<16,m[7]=de=k&65535|V<<16,I+=128,T-=128}return I}function d(f){var y=new s;y.update(f);var g=y.digest();return y.clean(),g}i.hash=d})(wp);(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.convertSecretKeyToX25519=i.convertPublicKeyToX25519=i.verify=i.sign=i.extractPublicKeyFromSecretKey=i.generateKeyPair=i.generateKeyPairFromSeed=i.SEED_LENGTH=i.SECRET_KEY_LENGTH=i.PUBLIC_KEY_LENGTH=i.SIGNATURE_LENGTH=void 0;const e=Bn,t=wp,s=Ar;i.SIGNATURE_LENGTH=64,i.PUBLIC_KEY_LENGTH=32,i.SECRET_KEY_LENGTH=64,i.SEED_LENGTH=32;function o(B){const F=new Float64Array(16);if(B)for(let $=0;$<B.length;$++)F[$]=B[$];return F}const c=new Uint8Array(32);c[0]=9;const d=o(),f=o([1]),y=o([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),g=o([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),m=o([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),D=o([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),I=o([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function T(B,F){for(let $=0;$<16;$++)B[$]=F[$]|0}function P(B){let F=1;for(let $=0;$<16;$++){let l=B[$]+F+65535;F=Math.floor(l/65536),B[$]=l-F*65536}B[0]+=F-1+37*(F-1)}function z(B,F,$){const l=~($-1);for(let R=0;R<16;R++){const ae=l&(B[R]^F[R]);B[R]^=ae,F[R]^=ae}}function H(B,F){const $=o(),l=o();for(let R=0;R<16;R++)l[R]=F[R];P(l),P(l),P(l);for(let R=0;R<2;R++){$[0]=l[0]-65517;for(let fe=1;fe<15;fe++)$[fe]=l[fe]-65535-($[fe-1]>>16&1),$[fe-1]&=65535;$[15]=l[15]-32767-($[14]>>16&1);const ae=$[15]>>16&1;$[14]&=65535,z(l,$,1-ae)}for(let R=0;R<16;R++)B[2*R]=l[R]&255,B[2*R+1]=l[R]>>8}function ie(B,F){let $=0;for(let l=0;l<32;l++)$|=B[l]^F[l];return(1&$-1>>>8)-1}function U(B,F){const $=new Uint8Array(32),l=new Uint8Array(32);return H($,B),H(l,F),ie($,l)}function j(B){const F=new Uint8Array(32);return H(F,B),F[0]&1}function O(B,F){for(let $=0;$<16;$++)B[$]=F[2*$]+(F[2*$+1]<<8);B[15]&=32767}function A(B,F,$){for(let l=0;l<16;l++)B[l]=F[l]+$[l]}function E(B,F,$){for(let l=0;l<16;l++)B[l]=F[l]-$[l]}function u(B,F,$){let l,R,ae=0,fe=0,Ie=0,Be=0,ke=0,Me=0,gt=0,yt=0,qe=0,xe=0,Ne=0,Ue=0,Fe=0,Pe=0,$e=0,Se=0,Ce=0,He=0,Oe=0,Ve=0,We=0,et=0,tt=0,Qe=0,rr=0,dr=0,Qr=0,ir=0,ci=0,Pi=0,Ki=0,St=$[0],vt=$[1],It=$[2],xt=$[3],Et=$[4],mt=$[5],Lt=$[6],Mt=$[7],Ot=$[8],jt=$[9],Pt=$[10],Tt=$[11],Ct=$[12],lt=$[13],qt=$[14],Ft=$[15];l=F[0],ae+=l*St,fe+=l*vt,Ie+=l*It,Be+=l*xt,ke+=l*Et,Me+=l*mt,gt+=l*Lt,yt+=l*Mt,qe+=l*Ot,xe+=l*jt,Ne+=l*Pt,Ue+=l*Tt,Fe+=l*Ct,Pe+=l*lt,$e+=l*qt,Se+=l*Ft,l=F[1],fe+=l*St,Ie+=l*vt,Be+=l*It,ke+=l*xt,Me+=l*Et,gt+=l*mt,yt+=l*Lt,qe+=l*Mt,xe+=l*Ot,Ne+=l*jt,Ue+=l*Pt,Fe+=l*Tt,Pe+=l*Ct,$e+=l*lt,Se+=l*qt,Ce+=l*Ft,l=F[2],Ie+=l*St,Be+=l*vt,ke+=l*It,Me+=l*xt,gt+=l*Et,yt+=l*mt,qe+=l*Lt,xe+=l*Mt,Ne+=l*Ot,Ue+=l*jt,Fe+=l*Pt,Pe+=l*Tt,$e+=l*Ct,Se+=l*lt,Ce+=l*qt,He+=l*Ft,l=F[3],Be+=l*St,ke+=l*vt,Me+=l*It,gt+=l*xt,yt+=l*Et,qe+=l*mt,xe+=l*Lt,Ne+=l*Mt,Ue+=l*Ot,Fe+=l*jt,Pe+=l*Pt,$e+=l*Tt,Se+=l*Ct,Ce+=l*lt,He+=l*qt,Oe+=l*Ft,l=F[4],ke+=l*St,Me+=l*vt,gt+=l*It,yt+=l*xt,qe+=l*Et,xe+=l*mt,Ne+=l*Lt,Ue+=l*Mt,Fe+=l*Ot,Pe+=l*jt,$e+=l*Pt,Se+=l*Tt,Ce+=l*Ct,He+=l*lt,Oe+=l*qt,Ve+=l*Ft,l=F[5],Me+=l*St,gt+=l*vt,yt+=l*It,qe+=l*xt,xe+=l*Et,Ne+=l*mt,Ue+=l*Lt,Fe+=l*Mt,Pe+=l*Ot,$e+=l*jt,Se+=l*Pt,Ce+=l*Tt,He+=l*Ct,Oe+=l*lt,Ve+=l*qt,We+=l*Ft,l=F[6],gt+=l*St,yt+=l*vt,qe+=l*It,xe+=l*xt,Ne+=l*Et,Ue+=l*mt,Fe+=l*Lt,Pe+=l*Mt,$e+=l*Ot,Se+=l*jt,Ce+=l*Pt,He+=l*Tt,Oe+=l*Ct,Ve+=l*lt,We+=l*qt,et+=l*Ft,l=F[7],yt+=l*St,qe+=l*vt,xe+=l*It,Ne+=l*xt,Ue+=l*Et,Fe+=l*mt,Pe+=l*Lt,$e+=l*Mt,Se+=l*Ot,Ce+=l*jt,He+=l*Pt,Oe+=l*Tt,Ve+=l*Ct,We+=l*lt,et+=l*qt,tt+=l*Ft,l=F[8],qe+=l*St,xe+=l*vt,Ne+=l*It,Ue+=l*xt,Fe+=l*Et,Pe+=l*mt,$e+=l*Lt,Se+=l*Mt,Ce+=l*Ot,He+=l*jt,Oe+=l*Pt,Ve+=l*Tt,We+=l*Ct,et+=l*lt,tt+=l*qt,Qe+=l*Ft,l=F[9],xe+=l*St,Ne+=l*vt,Ue+=l*It,Fe+=l*xt,Pe+=l*Et,$e+=l*mt,Se+=l*Lt,Ce+=l*Mt,He+=l*Ot,Oe+=l*jt,Ve+=l*Pt,We+=l*Tt,et+=l*Ct,tt+=l*lt,Qe+=l*qt,rr+=l*Ft,l=F[10],Ne+=l*St,Ue+=l*vt,Fe+=l*It,Pe+=l*xt,$e+=l*Et,Se+=l*mt,Ce+=l*Lt,He+=l*Mt,Oe+=l*Ot,Ve+=l*jt,We+=l*Pt,et+=l*Tt,tt+=l*Ct,Qe+=l*lt,rr+=l*qt,dr+=l*Ft,l=F[11],Ue+=l*St,Fe+=l*vt,Pe+=l*It,$e+=l*xt,Se+=l*Et,Ce+=l*mt,He+=l*Lt,Oe+=l*Mt,Ve+=l*Ot,We+=l*jt,et+=l*Pt,tt+=l*Tt,Qe+=l*Ct,rr+=l*lt,dr+=l*qt,Qr+=l*Ft,l=F[12],Fe+=l*St,Pe+=l*vt,$e+=l*It,Se+=l*xt,Ce+=l*Et,He+=l*mt,Oe+=l*Lt,Ve+=l*Mt,We+=l*Ot,et+=l*jt,tt+=l*Pt,Qe+=l*Tt,rr+=l*Ct,dr+=l*lt,Qr+=l*qt,ir+=l*Ft,l=F[13],Pe+=l*St,$e+=l*vt,Se+=l*It,Ce+=l*xt,He+=l*Et,Oe+=l*mt,Ve+=l*Lt,We+=l*Mt,et+=l*Ot,tt+=l*jt,Qe+=l*Pt,rr+=l*Tt,dr+=l*Ct,Qr+=l*lt,ir+=l*qt,ci+=l*Ft,l=F[14],$e+=l*St,Se+=l*vt,Ce+=l*It,He+=l*xt,Oe+=l*Et,Ve+=l*mt,We+=l*Lt,et+=l*Mt,tt+=l*Ot,Qe+=l*jt,rr+=l*Pt,dr+=l*Tt,Qr+=l*Ct,ir+=l*lt,ci+=l*qt,Pi+=l*Ft,l=F[15],Se+=l*St,Ce+=l*vt,He+=l*It,Oe+=l*xt,Ve+=l*Et,We+=l*mt,et+=l*Lt,tt+=l*Mt,Qe+=l*Ot,rr+=l*jt,dr+=l*Pt,Qr+=l*Tt,ir+=l*Ct,ci+=l*lt,Pi+=l*qt,Ki+=l*Ft,ae+=38*Ce,fe+=38*He,Ie+=38*Oe,Be+=38*Ve,ke+=38*We,Me+=38*et,gt+=38*tt,yt+=38*Qe,qe+=38*rr,xe+=38*dr,Ne+=38*Qr,Ue+=38*ir,Fe+=38*ci,Pe+=38*Pi,$e+=38*Ki,R=1,l=ae+R+65535,R=Math.floor(l/65536),ae=l-R*65536,l=fe+R+65535,R=Math.floor(l/65536),fe=l-R*65536,l=Ie+R+65535,R=Math.floor(l/65536),Ie=l-R*65536,l=Be+R+65535,R=Math.floor(l/65536),Be=l-R*65536,l=ke+R+65535,R=Math.floor(l/65536),ke=l-R*65536,l=Me+R+65535,R=Math.floor(l/65536),Me=l-R*65536,l=gt+R+65535,R=Math.floor(l/65536),gt=l-R*65536,l=yt+R+65535,R=Math.floor(l/65536),yt=l-R*65536,l=qe+R+65535,R=Math.floor(l/65536),qe=l-R*65536,l=xe+R+65535,R=Math.floor(l/65536),xe=l-R*65536,l=Ne+R+65535,R=Math.floor(l/65536),Ne=l-R*65536,l=Ue+R+65535,R=Math.floor(l/65536),Ue=l-R*65536,l=Fe+R+65535,R=Math.floor(l/65536),Fe=l-R*65536,l=Pe+R+65535,R=Math.floor(l/65536),Pe=l-R*65536,l=$e+R+65535,R=Math.floor(l/65536),$e=l-R*65536,l=Se+R+65535,R=Math.floor(l/65536),Se=l-R*65536,ae+=R-1+37*(R-1),R=1,l=ae+R+65535,R=Math.floor(l/65536),ae=l-R*65536,l=fe+R+65535,R=Math.floor(l/65536),fe=l-R*65536,l=Ie+R+65535,R=Math.floor(l/65536),Ie=l-R*65536,l=Be+R+65535,R=Math.floor(l/65536),Be=l-R*65536,l=ke+R+65535,R=Math.floor(l/65536),ke=l-R*65536,l=Me+R+65535,R=Math.floor(l/65536),Me=l-R*65536,l=gt+R+65535,R=Math.floor(l/65536),gt=l-R*65536,l=yt+R+65535,R=Math.floor(l/65536),yt=l-R*65536,l=qe+R+65535,R=Math.floor(l/65536),qe=l-R*65536,l=xe+R+65535,R=Math.floor(l/65536),xe=l-R*65536,l=Ne+R+65535,R=Math.floor(l/65536),Ne=l-R*65536,l=Ue+R+65535,R=Math.floor(l/65536),Ue=l-R*65536,l=Fe+R+65535,R=Math.floor(l/65536),Fe=l-R*65536,l=Pe+R+65535,R=Math.floor(l/65536),Pe=l-R*65536,l=$e+R+65535,R=Math.floor(l/65536),$e=l-R*65536,l=Se+R+65535,R=Math.floor(l/65536),Se=l-R*65536,ae+=R-1+37*(R-1),B[0]=ae,B[1]=fe,B[2]=Ie,B[3]=Be,B[4]=ke,B[5]=Me,B[6]=gt,B[7]=yt,B[8]=qe,B[9]=xe,B[10]=Ne,B[11]=Ue,B[12]=Fe,B[13]=Pe,B[14]=$e,B[15]=Se}function _(B,F){u(B,F,F)}function G(B,F){const $=o();let l;for(l=0;l<16;l++)$[l]=F[l];for(l=253;l>=0;l--)_($,$),l!==2&&l!==4&&u($,$,F);for(l=0;l<16;l++)B[l]=$[l]}function W(B,F){const $=o();let l;for(l=0;l<16;l++)$[l]=F[l];for(l=250;l>=0;l--)_($,$),l!==1&&u($,$,F);for(l=0;l<16;l++)B[l]=$[l]}function se(B,F){const $=o(),l=o(),R=o(),ae=o(),fe=o(),Ie=o(),Be=o(),ke=o(),Me=o();E($,B[1],B[0]),E(Me,F[1],F[0]),u($,$,Me),A(l,B[0],B[1]),A(Me,F[0],F[1]),u(l,l,Me),u(R,B[3],F[3]),u(R,R,g),u(ae,B[2],F[2]),A(ae,ae,ae),E(fe,l,$),E(Ie,ae,R),A(Be,ae,R),A(ke,l,$),u(B[0],fe,Ie),u(B[1],ke,Be),u(B[2],Be,Ie),u(B[3],fe,ke)}function ue(B,F,$){for(let l=0;l<4;l++)z(B[l],F[l],$)}function de(B,F){const $=o(),l=o(),R=o();G(R,F[2]),u($,F[0],R),u(l,F[1],R),H(B,l),B[31]^=j($)<<7}function b(B,F,$){T(B[0],d),T(B[1],f),T(B[2],f),T(B[3],d);for(let l=255;l>=0;--l){const R=$[l/8|0]>>(l&7)&1;ue(B,F,R),se(F,B),se(B,B),ue(B,F,R)}}function C(B,F){const $=[o(),o(),o(),o()];T($[0],m),T($[1],D),T($[2],f),u($[3],m,D),b(B,$,F)}function ee(B){if(B.length!==i.SEED_LENGTH)throw new Error(`ed25519: seed must be ${i.SEED_LENGTH} bytes`);const F=(0,t.hash)(B);F[0]&=248,F[31]&=127,F[31]|=64;const $=new Uint8Array(32),l=[o(),o(),o(),o()];C(l,F),de($,l);const R=new Uint8Array(64);return R.set(B),R.set($,32),{publicKey:$,secretKey:R}}i.generateKeyPairFromSeed=ee;function Q(B){const F=(0,e.randomBytes)(32,B),$=ee(F);return(0,s.wipe)(F),$}i.generateKeyPair=Q;function k(B){if(B.length!==i.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${i.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(B.subarray(32))}i.extractPublicKeyFromSecretKey=k;const V=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function J(B,F){let $,l,R,ae;for(l=63;l>=32;--l){for($=0,R=l-32,ae=l-12;R<ae;++R)F[R]+=$-16*F[l]*V[R-(l-32)],$=Math.floor((F[R]+128)/256),F[R]-=$*256;F[R]+=$,F[l]=0}for($=0,R=0;R<32;R++)F[R]+=$-(F[31]>>4)*V[R],$=F[R]>>8,F[R]&=255;for(R=0;R<32;R++)F[R]-=$*V[R];for(l=0;l<32;l++)F[l+1]+=F[l]>>8,B[l]=F[l]&255}function re(B){const F=new Float64Array(64);for(let $=0;$<64;$++)F[$]=B[$];for(let $=0;$<64;$++)B[$]=0;J(B,F)}function _e(B,F){const $=new Float64Array(64),l=[o(),o(),o(),o()],R=(0,t.hash)(B.subarray(0,32));R[0]&=248,R[31]&=127,R[31]|=64;const ae=new Uint8Array(64);ae.set(R.subarray(32),32);const fe=new t.SHA512;fe.update(ae.subarray(32)),fe.update(F);const Ie=fe.digest();fe.clean(),re(Ie),C(l,Ie),de(ae,l),fe.reset(),fe.update(ae.subarray(0,32)),fe.update(B.subarray(32)),fe.update(F);const Be=fe.digest();re(Be);for(let ke=0;ke<32;ke++)$[ke]=Ie[ke];for(let ke=0;ke<32;ke++)for(let Me=0;Me<32;Me++)$[ke+Me]+=Be[ke]*R[Me];return J(ae.subarray(32),$),ae}i.sign=_e;function oe(B,F){const $=o(),l=o(),R=o(),ae=o(),fe=o(),Ie=o(),Be=o();return T(B[2],f),O(B[1],F),_(R,B[1]),u(ae,R,y),E(R,R,B[2]),A(ae,B[2],ae),_(fe,ae),_(Ie,fe),u(Be,Ie,fe),u($,Be,R),u($,$,ae),W($,$),u($,$,R),u($,$,ae),u($,$,ae),u(B[0],$,ae),_(l,B[0]),u(l,l,ae),U(l,R)&&u(B[0],B[0],I),_(l,B[0]),u(l,l,ae),U(l,R)?-1:(j(B[0])===F[31]>>7&&E(B[0],d,B[0]),u(B[3],B[0],B[1]),0)}function be(B,F,$){const l=new Uint8Array(32),R=[o(),o(),o(),o()],ae=[o(),o(),o(),o()];if($.length!==i.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${i.SIGNATURE_LENGTH} bytes`);if(oe(ae,B))return!1;const fe=new t.SHA512;fe.update($.subarray(0,32)),fe.update(B),fe.update(F);const Ie=fe.digest();return re(Ie),b(R,ae,Ie),C(ae,$.subarray(32)),se(R,ae),de(l,R),!ie($,l)}i.verify=be;function le(B){let F=[o(),o(),o(),o()];if(oe(F,B))throw new Error("Ed25519: invalid public key");let $=o(),l=o(),R=F[1];A($,f,R),E(l,f,R),G(l,l),u($,$,l);let ae=new Uint8Array(32);return H(ae,$),ae}i.convertPublicKeyToX25519=le;function me(B){const F=(0,t.hash)(B.subarray(0,32));F[0]&=248,F[31]&=127,F[31]|=64;const $=new Uint8Array(F.subarray(0,32));return(0,s.wipe)(F),$}i.convertSecretKeyToX25519=me})(Ku);const L3="EdDSA",M3="JWT",_p=".",bp="base64url",j3="utf8",q3="utf8",F3=":",z3="did",B3="key",Vf="base58btc",H3="z",K3="K36",k3=32;function Zo(i){return fr(br(hn(i),j3),bp)}function Ep(i){const e=br(K3,Vf),t=H3+fr(lu([e,i]),Vf);return[z3,B3,t].join(F3)}function V3(i){return fr(i,bp)}function G3(i){return br([Zo(i.header),Zo(i.payload)].join(_p),q3)}function W3(i){return[Zo(i.header),Zo(i.payload),V3(i.signature)].join(_p)}function Gf(i=Bn.randomBytes(k3)){return Ku.generateKeyPairFromSeed(i)}async function Y3(i,e,t,s,o=ve.fromMiliseconds(Date.now())){const c={alg:L3,typ:M3},d=Ep(s.publicKey),f=o+t,y={iss:d,sub:i,aud:e,iat:o,exp:f},g=G3({header:c,payload:y}),m=Ku.sign(s.secretKey,g);return W3({header:c,payload:y,signature:m})}const J3="PARSE_ERROR",Q3="INVALID_REQUEST",X3="METHOD_NOT_FOUND",Z3="INVALID_PARAMS",Dp="INTERNAL_ERROR",ku="SERVER_ERROR",e6=[-32700,-32600,-32601,-32602,-32603],Ds={[J3]:{code:-32700,message:"Parse error"},[Q3]:{code:-32600,message:"Invalid Request"},[X3]:{code:-32601,message:"Method not found"},[Z3]:{code:-32602,message:"Invalid params"},[Dp]:{code:-32603,message:"Internal error"},[ku]:{code:-32e3,message:"Server error"}},Sp=ku;function t6(i){return e6.includes(i)}function Wf(i){return Object.keys(Ds).includes(i)?Ds[i]:Ds[Sp]}function r6(i){const e=Object.values(Ds).find(t=>t.code===i);return e||Ds[Sp]}function Ip(i,e,t){return i.message.includes("getaddrinfo ENOTFOUND")||i.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${t} RPC url at ${e}`):i}var xp={},_i={},Yf;function i6(){if(Yf)return _i;Yf=1,Object.defineProperty(_i,"__esModule",{value:!0}),_i.isBrowserCryptoAvailable=_i.getSubtleCrypto=_i.getBrowerCrypto=void 0;function i(){return(Jr===null||Jr===void 0?void 0:Jr.crypto)||(Jr===null||Jr===void 0?void 0:Jr.msCrypto)||{}}_i.getBrowerCrypto=i;function e(){const s=i();return s.subtle||s.webkitSubtle}_i.getSubtleCrypto=e;function t(){return!!i()&&!!e()}return _i.isBrowserCryptoAvailable=t,_i}var bi={},Jf;function n6(){if(Jf)return bi;Jf=1,Object.defineProperty(bi,"__esModule",{value:!0}),bi.isBrowser=bi.isNode=bi.isReactNative=void 0;function i(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}bi.isReactNative=i;function e(){return typeof si<"u"&&typeof si.versions<"u"&&typeof si.versions.node<"u"}bi.isNode=e;function t(){return!i()&&!e()}return bi.isBrowser=t,bi}(function(i){Object.defineProperty(i,"__esModule",{value:!0});const e=ai;e.__exportStar(i6(),i),e.__exportStar(n6(),i)})(xp);function Vu(i=3){const e=Date.now()*Math.pow(10,i),t=Math.floor(Math.random()*Math.pow(10,i));return e+t}function Op(i=6){return BigInt(Vu(i))}function zn(i,e,t){return{id:t||Vu(),jsonrpc:"2.0",method:i,params:e}}function ca(i,e){return{id:i,jsonrpc:"2.0",result:e}}function ua(i,e,t){return{id:i,jsonrpc:"2.0",error:s6(e,t)}}function s6(i,e){return typeof i>"u"?Wf(Dp):(typeof i=="string"&&(i=Object.assign(Object.assign({},Wf(ku)),{message:i})),typeof e<"u"&&(i.data=e),t6(i.code)&&(i=r6(i.code)),i)}class o6{}class a6 extends o6{constructor(){super()}}class c6 extends a6{constructor(e){super()}}const u6="^https?:",h6="^wss?:";function l6(i){const e=i.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function Pp(i,e){const t=l6(i);return typeof t>"u"?!1:new RegExp(e).test(t)}function Qf(i){return Pp(i,u6)}function Xf(i){return Pp(i,h6)}function f6(i){return new RegExp("wss?://localhost(:d{2,5})?").test(i)}function Cp(i){return typeof i=="object"&&"id"in i&&"jsonrpc"in i&&i.jsonrpc==="2.0"}function Gu(i){return Cp(i)&&"method"in i}function ha(i){return Cp(i)&&(Ii(i)||Yr(i))}function Ii(i){return"result"in i}function Yr(i){return"error"in i}class xi extends c6{constructor(e){super(e),this.events=new zr.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async request(e,t){return this.requestStrict(zn(e.method,e.params||[],e.id||Op().toString()),t)}async requestStrict(e,t){return new Promise(async(s,o)=>{if(!this.connection.connected)try{await this.open()}catch(c){o(c)}this.events.on(`${e.id}`,c=>{Yr(c)?o(c.error):s(c.result)});try{await this.connection.send(e,t)}catch(c){o(c)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),ha(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&e.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",e=>this.onClose(e)),this.connection.on("error",e=>this.events.emit("error",e)),this.connection.on("register_error",e=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const d6=()=>typeof WebSocket<"u"?WebSocket:typeof st<"u"&&typeof st.WebSocket<"u"?st.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),p6=()=>typeof WebSocket<"u"||typeof st<"u"&&typeof st.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",Zf=i=>i.split("?")[0],ed=10,g6=d6();let y6=class{constructor(e){if(this.url=e,this.events=new zr.EventEmitter,this.registering=!1,!Xf(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,t)=>{if(typeof this.socket>"u"){t(new Error("Connection already closed"));return}this.socket.onclose=s=>{this.onClose(s),e()},this.socket.close()})}async send(e){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(hn(e))}catch(t){this.onError(e.id,t)}}register(e=this.url){if(!Xf(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const t=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t)&&this.events.setMaxListeners(t+1),new Promise((s,o)=>{this.events.once("register_error",c=>{this.resetMaxListeners(),o(c)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return o(new Error("WebSocket connection is missing or invalid"));s(this.socket)})})}return this.url=e,this.registering=!0,new Promise((t,s)=>{const o=new URLSearchParams(e).get("origin"),c=xp.isReactNative()?{headers:{origin:o}}:{rejectUnauthorized:!f6(e)},d=new g6(e,[],c);p6()?d.onerror=f=>{const y=f;s(this.emitError(y.error))}:d.on("error",f=>{s(this.emitError(f))}),d.onopen=()=>{this.onOpen(d),t(d)}})}onOpen(e){e.onmessage=t=>this.onPayload(t),e.onclose=t=>this.onClose(t),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;const t=typeof e.data=="string"?Ns(e.data):e.data;this.events.emit("payload",t)}onError(e,t){const s=this.parseError(t),o=s.message||s.toString(),c=ua(e,o);this.events.emit("payload",c)}parseError(e,t=this.url){return Ip(e,Zf(t),"WS")}resetMaxListeners(){this.events.getMaxListeners()>ed&&this.events.setMaxListeners(ed)}emitError(e){const t=this.parseError(new Error((e==null?void 0:e.message)||`WebSocket connection failed for host: ${Zf(this.url)}`));return this.events.emit("register_error",t),t}};var ea={exports:{}};ea.exports;(function(i,e){var t=200,s="__lodash_hash_undefined__",o=1,c=2,d=9007199254740991,f="[object Arguments]",y="[object Array]",g="[object AsyncFunction]",m="[object Boolean]",D="[object Date]",I="[object Error]",T="[object Function]",P="[object GeneratorFunction]",z="[object Map]",H="[object Number]",ie="[object Null]",U="[object Object]",j="[object Promise]",O="[object Proxy]",A="[object RegExp]",E="[object Set]",u="[object String]",_="[object Symbol]",G="[object Undefined]",W="[object WeakMap]",se="[object ArrayBuffer]",ue="[object DataView]",de="[object Float32Array]",b="[object Float64Array]",C="[object Int8Array]",ee="[object Int16Array]",Q="[object Int32Array]",k="[object Uint8Array]",V="[object Uint8ClampedArray]",J="[object Uint16Array]",re="[object Uint32Array]",_e=/[\\^$.*+?()[\]{}|]/g,oe=/^\[object .+?Constructor\]$/,be=/^(?:0|[1-9]\d*)$/,le={};le[de]=le[b]=le[C]=le[ee]=le[Q]=le[k]=le[V]=le[J]=le[re]=!0,le[f]=le[y]=le[se]=le[m]=le[ue]=le[D]=le[I]=le[T]=le[z]=le[H]=le[U]=le[A]=le[E]=le[u]=le[W]=!1;var me=typeof Jr=="object"&&Jr&&Jr.Object===Object&&Jr,B=typeof self=="object"&&self&&self.Object===Object&&self,F=me||B||Function("return this")(),$=e&&!e.nodeType&&e,l=$&&!0&&i&&!i.nodeType&&i,R=l&&l.exports===$,ae=R&&me.process,fe=function(){try{return ae&&ae.binding&&ae.binding("util")}catch{}}(),Ie=fe&&fe.isTypedArray;function Be(S,L){for(var te=-1,pe=S==null?0:S.length,ct=0,Te=[];++te<pe;){var dt=S[te];L(dt,te,S)&&(Te[ct++]=dt)}return Te}function ke(S,L){for(var te=-1,pe=L.length,ct=S.length;++te<pe;)S[ct+te]=L[te];return S}function Me(S,L){for(var te=-1,pe=S==null?0:S.length;++te<pe;)if(L(S[te],te,S))return!0;return!1}function gt(S,L){for(var te=-1,pe=Array(S);++te<S;)pe[te]=L(te);return pe}function yt(S){return function(L){return S(L)}}function qe(S,L){return S.has(L)}function xe(S,L){return S==null?void 0:S[L]}function Ne(S){var L=-1,te=Array(S.size);return S.forEach(function(pe,ct){te[++L]=[ct,pe]}),te}function Ue(S,L){return function(te){return S(L(te))}}function Fe(S){var L=-1,te=Array(S.size);return S.forEach(function(pe){te[++L]=pe}),te}var Pe=Array.prototype,$e=Function.prototype,Se=Object.prototype,Ce=F["__core-js_shared__"],He=$e.toString,Oe=Se.hasOwnProperty,Ve=function(){var S=/[^.]+$/.exec(Ce&&Ce.keys&&Ce.keys.IE_PROTO||"");return S?"Symbol(src)_1."+S:""}(),We=Se.toString,et=RegExp("^"+He.call(Oe).replace(_e,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),tt=R?F.Buffer:void 0,Qe=F.Symbol,rr=F.Uint8Array,dr=Se.propertyIsEnumerable,Qr=Pe.splice,ir=Qe?Qe.toStringTag:void 0,ci=Object.getOwnPropertySymbols,Pi=tt?tt.isBuffer:void 0,Ki=Ue(Object.keys,Object),St=Er(F,"DataView"),vt=Er(F,"Map"),It=Er(F,"Promise"),xt=Er(F,"Set"),Et=Er(F,"WeakMap"),mt=Er(Object,"create"),Lt=hi(St),Mt=hi(vt),Ot=hi(It),jt=hi(xt),Pt=hi(Et),Tt=Qe?Qe.prototype:void 0,Ct=Tt?Tt.valueOf:void 0;function lt(S){var L=-1,te=S==null?0:S.length;for(this.clear();++L<te;){var pe=S[L];this.set(pe[0],pe[1])}}function qt(){this.__data__=mt?mt(null):{},this.size=0}function Ft(S){var L=this.has(S)&&delete this.__data__[S];return this.size-=L?1:0,L}function da(S){var L=this.__data__;if(mt){var te=L[S];return te===s?void 0:te}return Oe.call(L,S)?L[S]:void 0}function pa(S){var L=this.__data__;return mt?L[S]!==void 0:Oe.call(L,S)}function ga(S,L){var te=this.__data__;return this.size+=this.has(S)?0:1,te[S]=mt&&L===void 0?s:L,this}lt.prototype.clear=qt,lt.prototype.delete=Ft,lt.prototype.get=da,lt.prototype.has=pa,lt.prototype.set=ga;function Tr(S){var L=-1,te=S==null?0:S.length;for(this.clear();++L<te;){var pe=S[L];this.set(pe[0],pe[1])}}function ya(){this.__data__=[],this.size=0}function va(S){var L=this.__data__,te=ki(L,S);if(te<0)return!1;var pe=L.length-1;return te==pe?L.pop():Qr.call(L,te,1),--this.size,!0}function ma(S){var L=this.__data__,te=ki(L,S);return te<0?void 0:L[te][1]}function wa(S){return ki(this.__data__,S)>-1}function _a(S,L){var te=this.__data__,pe=ki(te,S);return pe<0?(++this.size,te.push([S,L])):te[pe][1]=L,this}Tr.prototype.clear=ya,Tr.prototype.delete=va,Tr.prototype.get=ma,Tr.prototype.has=wa,Tr.prototype.set=_a;function ui(S){var L=-1,te=S==null?0:S.length;for(this.clear();++L<te;){var pe=S[L];this.set(pe[0],pe[1])}}function yn(){this.size=0,this.__data__={hash:new lt,map:new(vt||Tr),string:new lt}}function ba(S){var L=Ci(this,S).delete(S);return this.size-=L?1:0,L}function vn(S){return Ci(this,S).get(S)}function Ea(S){return Ci(this,S).has(S)}function Da(S,L){var te=Ci(this,S),pe=te.size;return te.set(S,L),this.size+=te.size==pe?0:1,this}ui.prototype.clear=yn,ui.prototype.delete=ba,ui.prototype.get=vn,ui.prototype.has=Ea,ui.prototype.set=Da;function mn(S){var L=-1,te=S==null?0:S.length;for(this.__data__=new ui;++L<te;)this.add(S[L])}function $s(S){return this.__data__.set(S,s),this}function Ls(S){return this.__data__.has(S)}mn.prototype.add=mn.prototype.push=$s,mn.prototype.has=Ls;function Br(S){var L=this.__data__=new Tr(S);this.size=L.size}function Sa(){this.__data__=new Tr,this.size=0}function Ia(S){var L=this.__data__,te=L.delete(S);return this.size=L.size,te}function xa(S){return this.__data__.get(S)}function Oa(S){return this.__data__.has(S)}function Ms(S,L){var te=this.__data__;if(te instanceof Tr){var pe=te.__data__;if(!vt||pe.length<t-1)return pe.push([S,L]),this.size=++te.size,this;te=this.__data__=new ui(pe)}return te.set(S,L),this.size=te.size,this}Br.prototype.clear=Sa,Br.prototype.delete=Ia,Br.prototype.get=xa,Br.prototype.has=Oa,Br.prototype.set=Ms;function js(S,L){var te=bn(S),pe=!te&&Js(S),ct=!te&&!pe&&Jn(S),Te=!te&&!pe&&!ct&&Zs(S),dt=te||pe||ct||Te,zt=dt?gt(S.length,String):[],Xe=zt.length;for(var ut in S)(L||Oe.call(S,ut))&&!(dt&&(ut=="length"||ct&&(ut=="offset"||ut=="parent")||Te&&(ut=="buffer"||ut=="byteLength"||ut=="byteOffset")||ks(ut,Xe)))&&zt.push(ut);return zt}function ki(S,L){for(var te=S.length;te--;)if(Ys(S[te][0],L))return te;return-1}function Wn(S,L,te){var pe=L(S);return bn(S)?pe:ke(pe,te(S))}function Vi(S){return S==null?S===void 0?G:ie:ir&&ir in Object(S)?Hs(S):Aa(S)}function Yn(S){return Wi(S)&&Vi(S)==f}function Gi(S,L,te,pe,ct){return S===L?!0:S==null||L==null||!Wi(S)&&!Wi(L)?S!==S&&L!==L:qs(S,L,te,pe,Gi,ct)}function qs(S,L,te,pe,ct,Te){var dt=bn(S),zt=bn(L),Xe=dt?y:Xr(S),ut=zt?y:Xr(L);Xe=Xe==f?U:Xe,ut=ut==f?U:ut;var Rt=Xe==U,pr=ut==U,Bt=Xe==ut;if(Bt&&Jn(S)){if(!Jn(L))return!1;dt=!0,Rt=!1}if(Bt&&!Rt)return Te||(Te=new Br),dt||Zs(S)?wn(S,L,te,pe,ct,Te):Ca(S,L,Xe,te,pe,ct,Te);if(!(te&o)){var pt=Rt&&Oe.call(S,"__wrapped__"),nr=pr&&Oe.call(L,"__wrapped__");if(pt||nr){var Hr=pt?S.value():S,Rr=nr?L.value():L;return Te||(Te=new Br),ct(Hr,Rr,te,pe,Te)}}return Bt?(Te||(Te=new Br),Bs(S,L,te,pe,ct,Te)):!1}function Pa(S){if(!Xs(S)||Gs(S))return!1;var L=En(S)?et:oe;return L.test(hi(S))}function Fs(S){return Wi(S)&&Qs(S.length)&&!!le[Vi(S)]}function zs(S){if(!Ws(S))return Ki(S);var L=[];for(var te in Object(S))Oe.call(S,te)&&te!="constructor"&&L.push(te);return L}function wn(S,L,te,pe,ct,Te){var dt=te&o,zt=S.length,Xe=L.length;if(zt!=Xe&&!(dt&&Xe>zt))return!1;var ut=Te.get(S);if(ut&&Te.get(L))return ut==L;var Rt=-1,pr=!0,Bt=te&c?new mn:void 0;for(Te.set(S,L),Te.set(L,S);++Rt<zt;){var pt=S[Rt],nr=L[Rt];if(pe)var Hr=dt?pe(nr,pt,Rt,L,S,Te):pe(pt,nr,Rt,S,L,Te);if(Hr!==void 0){if(Hr)continue;pr=!1;break}if(Bt){if(!Me(L,function(Rr,Zr){if(!qe(Bt,Zr)&&(pt===Rr||ct(pt,Rr,te,pe,Te)))return Bt.push(Zr)})){pr=!1;break}}else if(!(pt===nr||ct(pt,nr,te,pe,Te))){pr=!1;break}}return Te.delete(S),Te.delete(L),pr}function Ca(S,L,te,pe,ct,Te,dt){switch(te){case ue:if(S.byteLength!=L.byteLength||S.byteOffset!=L.byteOffset)return!1;S=S.buffer,L=L.buffer;case se:return!(S.byteLength!=L.byteLength||!Te(new rr(S),new rr(L)));case m:case D:case H:return Ys(+S,+L);case I:return S.name==L.name&&S.message==L.message;case A:case u:return S==L+"";case z:var zt=Ne;case E:var Xe=pe&o;if(zt||(zt=Fe),S.size!=L.size&&!Xe)return!1;var ut=dt.get(S);if(ut)return ut==L;pe|=c,dt.set(S,L);var Rt=wn(zt(S),zt(L),pe,ct,Te,dt);return dt.delete(S),Rt;case _:if(Ct)return Ct.call(S)==Ct.call(L)}return!1}function Bs(S,L,te,pe,ct,Te){var dt=te&o,zt=_n(S),Xe=zt.length,ut=_n(L),Rt=ut.length;if(Xe!=Rt&&!dt)return!1;for(var pr=Xe;pr--;){var Bt=zt[pr];if(!(dt?Bt in L:Oe.call(L,Bt)))return!1}var pt=Te.get(S);if(pt&&Te.get(L))return pt==L;var nr=!0;Te.set(S,L),Te.set(L,S);for(var Hr=dt;++pr<Xe;){Bt=zt[pr];var Rr=S[Bt],Zr=L[Bt];if(pe)var Qn=dt?pe(Zr,Rr,Bt,L,S,Te):pe(Rr,Zr,Bt,S,L,Te);if(!(Qn===void 0?Rr===Zr||ct(Rr,Zr,te,pe,Te):Qn)){nr=!1;break}Hr||(Hr=Bt=="constructor")}if(nr&&!Hr){var Yi=S.constructor,kt=L.constructor;Yi!=kt&&"constructor"in S&&"constructor"in L&&!(typeof Yi=="function"&&Yi instanceof Yi&&typeof kt=="function"&&kt instanceof kt)&&(nr=!1)}return Te.delete(S),Te.delete(L),nr}function _n(S){return Wn(S,Na,Ks)}function Ci(S,L){var te=S.__data__;return Vs(L)?te[typeof L=="string"?"string":"hash"]:te.map}function Er(S,L){var te=xe(S,L);return Pa(te)?te:void 0}function Hs(S){var L=Oe.call(S,ir),te=S[ir];try{S[ir]=void 0;var pe=!0}catch{}var ct=We.call(S);return pe&&(L?S[ir]=te:delete S[ir]),ct}var Ks=ci?function(S){return S==null?[]:(S=Object(S),Be(ci(S),function(L){return dr.call(S,L)}))}:at,Xr=Vi;(St&&Xr(new St(new ArrayBuffer(1)))!=ue||vt&&Xr(new vt)!=z||It&&Xr(It.resolve())!=j||xt&&Xr(new xt)!=E||Et&&Xr(new Et)!=W)&&(Xr=function(S){var L=Vi(S),te=L==U?S.constructor:void 0,pe=te?hi(te):"";if(pe)switch(pe){case Lt:return ue;case Mt:return z;case Ot:return j;case jt:return E;case Pt:return W}return L});function ks(S,L){return L=L??d,!!L&&(typeof S=="number"||be.test(S))&&S>-1&&S%1==0&&S<L}function Vs(S){var L=typeof S;return L=="string"||L=="number"||L=="symbol"||L=="boolean"?S!=="__proto__":S===null}function Gs(S){return!!Ve&&Ve in S}function Ws(S){var L=S&&S.constructor,te=typeof L=="function"&&L.prototype||Se;return S===te}function Aa(S){return We.call(S)}function hi(S){if(S!=null){try{return He.call(S)}catch{}try{return S+""}catch{}}return""}function Ys(S,L){return S===L||S!==S&&L!==L}var Js=Yn(function(){return arguments}())?Yn:function(S){return Wi(S)&&Oe.call(S,"callee")&&!dr.call(S,"callee")},bn=Array.isArray;function Ta(S){return S!=null&&Qs(S.length)&&!En(S)}var Jn=Pi||ot;function Ra(S,L){return Gi(S,L)}function En(S){if(!Xs(S))return!1;var L=Vi(S);return L==T||L==P||L==g||L==O}function Qs(S){return typeof S=="number"&&S>-1&&S%1==0&&S<=d}function Xs(S){var L=typeof S;return S!=null&&(L=="object"||L=="function")}function Wi(S){return S!=null&&typeof S=="object"}var Zs=Ie?yt(Ie):Fs;function Na(S){return Ta(S)?js(S):zs(S)}function at(){return[]}function ot(){return!1}i.exports=Ra})(ea,ea.exports);var v6=ea.exports;const m6=Au(v6);function w6(i,e){return e=e||{},new Promise(function(t,s){var o=new XMLHttpRequest,c=[],d=[],f={},y=function(){return{ok:(o.status/100|0)==2,statusText:o.statusText,status:o.status,url:o.responseURL,text:function(){return Promise.resolve(o.responseText)},json:function(){return Promise.resolve(o.responseText).then(JSON.parse)},blob:function(){return Promise.resolve(new Blob([o.response]))},clone:y,headers:{keys:function(){return c},entries:function(){return d},get:function(m){return f[m.toLowerCase()]},has:function(m){return m.toLowerCase()in f}}}};for(var g in o.open(e.method||"get",i,!0),o.onload=function(){o.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,function(m,D,I){c.push(D=D.toLowerCase()),d.push([D,I]),f[D]=f[D]?f[D]+","+I:I}),t(y())},o.onerror=s,o.withCredentials=e.credentials=="include",e.headers)o.setRequestHeader(g,e.headers[g]);o.send(e.body||null)})}const _6=Object.freeze(Object.defineProperty({__proto__:null,default:w6},Symbol.toStringTag,{value:"Module"})),td=Pu(_6);var b6=self.fetch||(self.fetch=td.default||td);const E6=Au(b6);var D6={};function S6(i,e){if(i.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),s=0;s<t.length;s++)t[s]=255;for(var o=0;o<i.length;o++){var c=i.charAt(o),d=c.charCodeAt(0);if(t[d]!==255)throw new TypeError(c+" is ambiguous");t[d]=o}var f=i.length,y=i.charAt(0),g=Math.log(f)/Math.log(256),m=Math.log(256)/Math.log(f);function D(P){if(P instanceof Uint8Array||(ArrayBuffer.isView(P)?P=new Uint8Array(P.buffer,P.byteOffset,P.byteLength):Array.isArray(P)&&(P=Uint8Array.from(P))),!(P instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(P.length===0)return"";for(var z=0,H=0,ie=0,U=P.length;ie!==U&&P[ie]===0;)ie++,z++;for(var j=(U-ie)*m+1>>>0,O=new Uint8Array(j);ie!==U;){for(var A=P[ie],E=0,u=j-1;(A!==0||E<H)&&u!==-1;u--,E++)A+=256*O[u]>>>0,O[u]=A%f>>>0,A=A/f>>>0;if(A!==0)throw new Error("Non-zero carry");H=E,ie++}for(var _=j-H;_!==j&&O[_]===0;)_++;for(var G=y.repeat(z);_<j;++_)G+=i.charAt(O[_]);return G}function I(P){if(typeof P!="string")throw new TypeError("Expected String");if(P.length===0)return new Uint8Array;var z=0;if(P[z]!==" "){for(var H=0,ie=0;P[z]===y;)H++,z++;for(var U=(P.length-z)*g+1>>>0,j=new Uint8Array(U);P[z];){var O=t[P.charCodeAt(z)];if(O===255)return;for(var A=0,E=U-1;(O!==0||A<ie)&&E!==-1;E--,A++)O+=f*j[E]>>>0,j[E]=O%256>>>0,O=O/256>>>0;if(O!==0)throw new Error("Non-zero carry");ie=A,z++}if(P[z]!==" "){for(var u=U-ie;u!==U&&j[u]===0;)u++;for(var _=new Uint8Array(H+(U-u)),G=H;u!==U;)_[G++]=j[u++];return _}}}function T(P){var z=I(P);if(z)return z;throw new Error(`Non-${e} character`)}return{encode:D,decodeUnsafe:I,decode:T}}var I6=S6,x6=I6;const Ap=i=>{if(i instanceof Uint8Array&&i.constructor.name==="Uint8Array")return i;if(i instanceof ArrayBuffer)return new Uint8Array(i);if(ArrayBuffer.isView(i))return new Uint8Array(i.buffer,i.byteOffset,i.byteLength);throw new Error("Unknown type, must be binary type")},O6=i=>new TextEncoder().encode(i),P6=i=>new TextDecoder().decode(i);class C6{constructor(e,t,s){this.name=e,this.prefix=t,this.baseEncode=s}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class A6{constructor(e,t,s){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=s}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Tp(this,e)}}class T6{constructor(e){this.decoders=e}or(e){return Tp(this,e)}decode(e){const t=e[0],s=this.decoders[t];if(s)return s.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Tp=(i,e)=>new T6({...i.decoders||{[i.prefix]:i},...e.decoders||{[e.prefix]:e}});class R6{constructor(e,t,s,o){this.name=e,this.prefix=t,this.baseEncode=s,this.baseDecode=o,this.encoder=new C6(e,t,s),this.decoder=new A6(e,t,o)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const la=({name:i,prefix:e,encode:t,decode:s})=>new R6(i,e,t,s),Us=({prefix:i,name:e,alphabet:t})=>{const{encode:s,decode:o}=x6(t,e);return la({prefix:i,name:e,encode:s,decode:c=>Ap(o(c))})},N6=(i,e,t,s)=>{const o={};for(let m=0;m<e.length;++m)o[e[m]]=m;let c=i.length;for(;i[c-1]==="=";)--c;const d=new Uint8Array(c*t/8|0);let f=0,y=0,g=0;for(let m=0;m<c;++m){const D=o[i[m]];if(D===void 0)throw new SyntaxError(`Non-${s} character`);y=y<<t|D,f+=t,f>=8&&(f-=8,d[g++]=255&y>>f)}if(f>=t||255&y<<8-f)throw new SyntaxError("Unexpected end of data");return d},U6=(i,e,t)=>{const s=e[e.length-1]==="=",o=(1<<t)-1;let c="",d=0,f=0;for(let y=0;y<i.length;++y)for(f=f<<8|i[y],d+=8;d>t;)d-=t,c+=e[o&f>>d];if(d&&(c+=e[o&f<<t-d]),s)for(;c.length*t&7;)c+="=";return c},Qt=({name:i,prefix:e,bitsPerChar:t,alphabet:s})=>la({prefix:e,name:i,encode(o){return U6(o,s,t)},decode(o){return N6(o,s,t,i)}}),$6=la({prefix:"\0",name:"identity",encode:i=>P6(i),decode:i=>O6(i)});var L6=Object.freeze({__proto__:null,identity:$6});const M6=Qt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var j6=Object.freeze({__proto__:null,base2:M6});const q6=Qt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var F6=Object.freeze({__proto__:null,base8:q6});const z6=Us({prefix:"9",name:"base10",alphabet:"0123456789"});var B6=Object.freeze({__proto__:null,base10:z6});const H6=Qt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),K6=Qt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var k6=Object.freeze({__proto__:null,base16:H6,base16upper:K6});const V6=Qt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),G6=Qt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),W6=Qt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Y6=Qt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),J6=Qt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Q6=Qt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),X6=Qt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Z6=Qt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),eS=Qt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var tS=Object.freeze({__proto__:null,base32:V6,base32upper:G6,base32pad:W6,base32padupper:Y6,base32hex:J6,base32hexupper:Q6,base32hexpad:X6,base32hexpadupper:Z6,base32z:eS});const rS=Us({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),iS=Us({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var nS=Object.freeze({__proto__:null,base36:rS,base36upper:iS});const sS=Us({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),oS=Us({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var aS=Object.freeze({__proto__:null,base58btc:sS,base58flickr:oS});const cS=Qt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),uS=Qt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),hS=Qt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),lS=Qt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var fS=Object.freeze({__proto__:null,base64:cS,base64pad:uS,base64url:hS,base64urlpad:lS});const Rp=Array.from("ðŸš€ðŸªâ˜„ðŸ›°ðŸŒŒðŸŒ‘ðŸŒ’ðŸŒ“ðŸŒ”ðŸŒ•ðŸŒ–ðŸŒ—ðŸŒ˜ðŸŒðŸŒðŸŒŽðŸ‰â˜€ðŸ’»ðŸ–¥ðŸ’¾ðŸ’¿ðŸ˜‚â¤ðŸ˜ðŸ¤£ðŸ˜ŠðŸ™ðŸ’•ðŸ˜­ðŸ˜˜ðŸ‘ðŸ˜…ðŸ‘ðŸ˜ðŸ”¥ðŸ¥°ðŸ’”ðŸ’–ðŸ’™ðŸ˜¢ðŸ¤”ðŸ˜†ðŸ™„ðŸ’ªðŸ˜‰â˜ºðŸ‘ŒðŸ¤—ðŸ’œðŸ˜”ðŸ˜ŽðŸ˜‡ðŸŒ¹ðŸ¤¦ðŸŽ‰ðŸ’žâœŒâœ¨ðŸ¤·ðŸ˜±ðŸ˜ŒðŸŒ¸ðŸ™ŒðŸ˜‹ðŸ’—ðŸ’šðŸ˜ðŸ’›ðŸ™‚ðŸ’“ðŸ¤©ðŸ˜„ðŸ˜€ðŸ–¤ðŸ˜ƒðŸ’¯ðŸ™ˆðŸ‘‡ðŸŽ¶ðŸ˜’ðŸ¤­â£ðŸ˜œðŸ’‹ðŸ‘€ðŸ˜ªðŸ˜‘ðŸ’¥ðŸ™‹ðŸ˜žðŸ˜©ðŸ˜¡ðŸ¤ªðŸ‘ŠðŸ¥³ðŸ˜¥ðŸ¤¤ðŸ‘‰ðŸ’ƒðŸ˜³âœ‹ðŸ˜šðŸ˜ðŸ˜´ðŸŒŸðŸ˜¬ðŸ™ƒðŸ€ðŸŒ·ðŸ˜»ðŸ˜“â­âœ…ðŸ¥ºðŸŒˆðŸ˜ˆðŸ¤˜ðŸ’¦âœ”ðŸ˜£ðŸƒðŸ’â˜¹ðŸŽŠðŸ’˜ðŸ˜ â˜ðŸ˜•ðŸŒºðŸŽ‚ðŸŒ»ðŸ˜ðŸ–•ðŸ’ðŸ™ŠðŸ˜¹ðŸ—£ðŸ’«ðŸ’€ðŸ‘‘ðŸŽµðŸ¤žðŸ˜›ðŸ”´ðŸ˜¤ðŸŒ¼ðŸ˜«âš½ðŸ¤™â˜•ðŸ†ðŸ¤«ðŸ‘ˆðŸ˜®ðŸ™†ðŸ»ðŸƒðŸ¶ðŸ’ðŸ˜²ðŸŒ¿ðŸ§¡ðŸŽâš¡ðŸŒžðŸŽˆâŒâœŠðŸ‘‹ðŸ˜°ðŸ¤¨ðŸ˜¶ðŸ¤ðŸš¶ðŸ’°ðŸ“ðŸ’¢ðŸ¤ŸðŸ™ðŸš¨ðŸ’¨ðŸ¤¬âœˆðŸŽ€ðŸºðŸ¤“ðŸ˜™ðŸ’ŸðŸŒ±ðŸ˜–ðŸ‘¶ðŸ¥´â–¶âž¡â“ðŸ’ŽðŸ’¸â¬‡ðŸ˜¨ðŸŒšðŸ¦‹ðŸ˜·ðŸ•ºâš ðŸ™…ðŸ˜ŸðŸ˜µðŸ‘ŽðŸ¤²ðŸ¤ ðŸ¤§ðŸ“ŒðŸ”µðŸ’…ðŸ§ðŸ¾ðŸ’ðŸ˜—ðŸ¤‘ðŸŒŠðŸ¤¯ðŸ·â˜ŽðŸ’§ðŸ˜¯ðŸ’†ðŸ‘†ðŸŽ¤ðŸ™‡ðŸ‘â„ðŸŒ´ðŸ’£ðŸ¸ðŸ’ŒðŸ“ðŸ¥€ðŸ¤¢ðŸ‘…ðŸ’¡ðŸ’©ðŸ‘ðŸ“¸ðŸ‘»ðŸ¤ðŸ¤®ðŸŽ¼ðŸ¥µðŸš©ðŸŽðŸŠðŸ‘¼ðŸ’ðŸ“£ðŸ¥‚"),dS=Rp.reduce((i,e,t)=>(i[t]=e,i),[]),pS=Rp.reduce((i,e,t)=>(i[e.codePointAt(0)]=t,i),[]);function gS(i){return i.reduce((e,t)=>(e+=dS[t],e),"")}function yS(i){const e=[];for(const t of i){const s=pS[t.codePointAt(0)];if(s===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(s)}return new Uint8Array(e)}const vS=la({prefix:"ðŸš€",name:"base256emoji",encode:gS,decode:yS});var mS=Object.freeze({__proto__:null,base256emoji:vS}),wS=Np,rd=128,_S=127,bS=~_S,ES=Math.pow(2,31);function Np(i,e,t){e=e||[],t=t||0;for(var s=t;i>=ES;)e[t++]=i&255|rd,i/=128;for(;i&bS;)e[t++]=i&255|rd,i>>>=7;return e[t]=i|0,Np.bytes=t-s+1,e}var DS=bu,SS=128,id=127;function bu(i,s){var t=0,s=s||0,o=0,c=s,d,f=i.length;do{if(c>=f)throw bu.bytes=0,new RangeError("Could not decode varint");d=i[c++],t+=o<28?(d&id)<<o:(d&id)*Math.pow(2,o),o+=7}while(d>=SS);return bu.bytes=c-s,t}var IS=Math.pow(2,7),xS=Math.pow(2,14),OS=Math.pow(2,21),PS=Math.pow(2,28),CS=Math.pow(2,35),AS=Math.pow(2,42),TS=Math.pow(2,49),RS=Math.pow(2,56),NS=Math.pow(2,63),US=function(i){return i<IS?1:i<xS?2:i<OS?3:i<PS?4:i<CS?5:i<AS?6:i<TS?7:i<RS?8:i<NS?9:10},$S={encode:wS,decode:DS,encodingLength:US},Up=$S;const nd=(i,e,t=0)=>(Up.encode(i,e,t),e),sd=i=>Up.encodingLength(i),Eu=(i,e)=>{const t=e.byteLength,s=sd(i),o=s+sd(t),c=new Uint8Array(o+t);return nd(i,c,0),nd(t,c,s),c.set(e,o),new LS(i,t,e,c)};class LS{constructor(e,t,s,o){this.code=e,this.size=t,this.digest=s,this.bytes=o}}const $p=({name:i,code:e,encode:t})=>new MS(i,e,t);class MS{constructor(e,t,s){this.name=e,this.code=t,this.encode=s}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?Eu(this.code,t):t.then(s=>Eu(this.code,s))}else throw Error("Unknown type, must be binary type")}}const Lp=i=>async e=>new Uint8Array(await crypto.subtle.digest(i,e)),jS=$p({name:"sha2-256",code:18,encode:Lp("SHA-256")}),qS=$p({name:"sha2-512",code:19,encode:Lp("SHA-512")});var FS=Object.freeze({__proto__:null,sha256:jS,sha512:qS});const Mp=0,zS="identity",jp=Ap,BS=i=>Eu(Mp,jp(i)),HS={code:Mp,name:zS,encode:jp,digest:BS};var KS=Object.freeze({__proto__:null,identity:HS});new TextEncoder,new TextDecoder;const od={...L6,...j6,...F6,...B6,...k6,...tS,...nS,...aS,...fS,...mS};({...FS,...KS});function qp(i){return globalThis.Buffer!=null?new Uint8Array(i.buffer,i.byteOffset,i.byteLength):i}function kS(i=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?qp(globalThis.Buffer.allocUnsafe(i)):new Uint8Array(i)}function Fp(i,e,t,s){return{name:i,prefix:e,encoder:{name:i,prefix:e,encode:t},decoder:{decode:s}}}const ad=Fp("utf8","u",i=>"u"+new TextDecoder("utf8").decode(i),i=>new TextEncoder().encode(i.substring(1))),Qc=Fp("ascii","a",i=>{let e="a";for(let t=0;t<i.length;t++)e+=String.fromCharCode(i[t]);return e},i=>{i=i.substring(1);const e=kS(i.length);for(let t=0;t<i.length;t++)e[t]=i.charCodeAt(t);return e}),VS={utf8:ad,"utf-8":ad,hex:od.base16,latin1:Qc,ascii:Qc,binary:Qc,...od};function GS(i,e="utf8"){const t=VS[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?qp(globalThis.Buffer.from(i,"utf-8")):t.decoder.decode(`${t.prefix}${i}`)}const zp="wc",WS=2,Wu="core",Fi=`${zp}@2:${Wu}:`,YS={name:Wu,logger:"error"},JS={database:":memory:"},QS="crypto",cd="client_ed25519_seed",XS=ve.ONE_DAY,ZS="keychain",e2="0.3",t2="messages",r2="0.3",i2=ve.SIX_HOURS,n2="publisher",Bp="irn",s2="error",Hp="wss://relay.walletconnect.com",ud="wss://relay.walletconnect.org",o2="relayer",tr={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},a2="_subscription",Ei={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},c2=ve.ONE_SECOND,u2="2.11.1",h2=1e4,l2="0.3",f2="WALLETCONNECT_CLIENT_ID",Wr={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},d2="subscription",p2="0.3",g2=ve.FIVE_SECONDS*1e3,y2="pairing",v2="0.3",vs={wc_pairingDelete:{req:{ttl:ve.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:ve.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:ve.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:ve.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:ve.ONE_DAY,prompt:!1,tag:0},res:{ttl:ve.ONE_DAY,prompt:!1,tag:0}}},bs={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},ni={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},m2="history",w2="0.3",_2="expirer",Fr={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},b2="0.3",Xc="verify-api",qn="https://verify.walletconnect.com",Du="https://verify.walletconnect.org",E2=[qn,Du],D2="echo",S2="https://echo.walletconnect.com";class I2{constructor(e,t){this.core=e,this.logger=t,this.keychain=new Map,this.name=ZS,this.version=e2,this.initialized=!1,this.storagePrefix=Fi,this.init=async()=>{if(!this.initialized){const s=await this.getKeyChain();typeof s<"u"&&(this.keychain=s),this.initialized=!0}},this.has=s=>(this.isInitialized(),this.keychain.has(s)),this.set=async(s,o)=>{this.isInitialized(),this.keychain.set(s,o),await this.persist()},this.get=s=>{this.isInitialized();const o=this.keychain.get(s);if(typeof o>"u"){const{message:c}=ce("NO_MATCHING_KEY",`${this.name}: ${s}`);throw new Error(c)}return o},this.del=async s=>{this.isInitialized(),this.keychain.delete(s),await this.persist()},this.core=e,this.logger=Je.generateChildLogger(t,this.name)}get context(){return Je.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,cp(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?up(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=ce("NOT_INITIALIZED",this.name);throw new Error(e)}}}class x2{constructor(e,t,s){this.core=e,this.logger=t,this.name=QS,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=o=>(this.isInitialized(),this.keychain.has(o)),this.getClientId=async()=>{this.isInitialized();const o=await this.getClientSeed(),c=Gf(o);return Ep(c.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const o=EE();return this.setPrivateKey(o.publicKey,o.privateKey)},this.signJWT=async o=>{this.isInitialized();const c=await this.getClientSeed(),d=Gf(c),f=mu();return await Y3(f,o,XS,d)},this.generateSharedKey=(o,c,d)=>{this.isInitialized();const f=this.getPrivateKey(o),y=DE(f,c);return this.setSymKey(y,d)},this.setSymKey=async(o,c)=>{this.isInitialized();const d=c||SE(o);return await this.keychain.set(d,o),d},this.deleteKeyPair=async o=>{this.isInitialized(),await this.keychain.del(o)},this.deleteSymKey=async o=>{this.isInitialized(),await this.keychain.del(o)},this.encode=async(o,c,d)=>{this.isInitialized();const f=ap(d),y=hn(c);if(bf(f)){const I=f.senderPublicKey,T=f.receiverPublicKey;o=await this.generateSharedKey(I,T)}const g=this.getSymKey(o),{type:m,senderPublicKey:D}=f;return xE({type:m,symKey:g,message:y,senderPublicKey:D})},this.decode=async(o,c,d)=>{this.isInitialized();const f=CE(c,d);if(bf(f)){const y=f.receiverPublicKey,g=f.senderPublicKey;o=await this.generateSharedKey(y,g)}try{const y=this.getSymKey(o),g=OE({symKey:y,encoded:c});return Ns(g)}catch(y){this.logger.error(`Failed to decode message from topic: '${o}', clientId: '${await this.getClientId()}'`),this.logger.error(y)}},this.getPayloadType=o=>{const c=Qo(o);return As(c.type)},this.getPayloadSenderPublicKey=o=>{const c=Qo(o);return c.senderPublicKey?fr(c.senderPublicKey,lr):void 0},this.core=e,this.logger=Je.generateChildLogger(t,this.name),this.keychain=s||new I2(this.core,this.logger)}get context(){return Je.getLoggerContext(this.logger)}async setPrivateKey(e,t){return await this.keychain.set(e,t),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(cd)}catch{e=mu(),await this.keychain.set(cd,e)}return GS(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=ce("NOT_INITIALIZED",this.name);throw new Error(e)}}}class O2 extends x3{constructor(e,t){super(e,t),this.logger=e,this.core=t,this.messages=new Map,this.name=t2,this.version=r2,this.initialized=!1,this.storagePrefix=Fi,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const s=await this.getRelayerMessages();typeof s<"u"&&(this.messages=s),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(s){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(s)}finally{this.initialized=!0}}},this.set=async(s,o)=>{this.isInitialized();const c=Fn(o);let d=this.messages.get(s);return typeof d>"u"&&(d={}),typeof d[c]<"u"||(d[c]=o,this.messages.set(s,d),await this.persist()),c},this.get=s=>{this.isInitialized();let o=this.messages.get(s);return typeof o>"u"&&(o={}),o},this.has=(s,o)=>{this.isInitialized();const c=this.get(s),d=Fn(o);return typeof c[d]<"u"},this.del=async s=>{this.isInitialized(),this.messages.delete(s),await this.persist()},this.logger=Je.generateChildLogger(e,this.name),this.core=t}get context(){return Je.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,cp(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?up(e):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:e}=ce("NOT_INITIALIZED",this.name);throw new Error(e)}}}class P2 extends O3{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,this.events=new zr.EventEmitter,this.name=n2,this.queue=new Map,this.publishTimeout=ve.toMiliseconds(ve.TEN_SECONDS*2),this.needsTransportRestart=!1,this.publish=async(s,o,c)=>{var d;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:o,opts:c}});try{const f=(c==null?void 0:c.ttl)||i2,y=wu(c),g=(c==null?void 0:c.prompt)||!1,m=(c==null?void 0:c.tag)||0,D=(c==null?void 0:c.id)||Op().toString(),I={topic:s,message:o,opts:{ttl:f,relay:y,prompt:g,tag:m,id:D}},T=setTimeout(()=>this.queue.set(D,I),this.publishTimeout);try{await await xs(this.rpcPublish(s,o,f,y,g,m,D),this.publishTimeout,`Failed to publish payload, please try again. id:${D} tag:${m}`),this.removeRequestFromQueue(D),this.relayer.events.emit(tr.publish,I)}catch(P){if(this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0,(d=c==null?void 0:c.internal)!=null&&d.throwOnFailedPublish)throw this.removeRequestFromQueue(D),P;return}finally{clearTimeout(T)}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:o,opts:c}})}catch(f){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(f),f}},this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.relayer=e,this.logger=Je.generateChildLogger(t,this.name),this.registerEventListeners()}get context(){return Je.getLoggerContext(this.logger)}rpcPublish(e,t,s,o,c,d,f){var y,g,m,D;const I={method:Vo(o.protocol).publish,params:{topic:e,message:t,ttl:s,prompt:c,tag:d},id:f};return hr((y=I.params)==null?void 0:y.prompt)&&((g=I.params)==null||delete g.prompt),hr((m=I.params)==null?void 0:m.tag)&&((D=I.params)==null||delete D.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:I}),this.relayer.request(I)}removeRequestFromQueue(e){this.queue.delete(e)}checkQueue(){this.queue.forEach(async e=>{const{topic:t,message:s,opts:o}=e;await this.publish(t,s,o)})}registerEventListeners(){this.relayer.core.heartbeat.on(Gn.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(tr.connection_stalled);return}this.checkQueue()}),this.relayer.on(tr.message_ack,e=>{this.removeRequestFromQueue(e.id.toString())})}}class C2{constructor(){this.map=new Map,this.set=(e,t)=>{const s=this.get(e);this.exists(e,t)||this.map.set(e,[...s,t])},this.get=e=>this.map.get(e)||[],this.exists=(e,t)=>this.get(e).includes(t),this.delete=(e,t)=>{if(typeof t>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const s=this.get(e);if(!this.exists(e,t))return;const o=s.filter(c=>c!==t);if(!o.length){this.map.delete(e);return}this.map.set(e,o)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var A2=Object.defineProperty,T2=Object.defineProperties,R2=Object.getOwnPropertyDescriptors,hd=Object.getOwnPropertySymbols,N2=Object.prototype.hasOwnProperty,U2=Object.prototype.propertyIsEnumerable,ld=(i,e,t)=>e in i?A2(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,ms=(i,e)=>{for(var t in e||(e={}))N2.call(e,t)&&ld(i,t,e[t]);if(hd)for(var t of hd(e))U2.call(e,t)&&ld(i,t,e[t]);return i},Zc=(i,e)=>T2(i,R2(e));class $2 extends A3{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,this.subscriptions=new Map,this.topicMap=new C2,this.events=new zr.EventEmitter,this.name=d2,this.version=p2,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=Fi,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(s,o)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:o}});try{const c=wu(o),d={topic:s,relay:c};this.pending.set(s,d);const f=await this.rpcSubscribe(s,c);return this.onSubscribe(f,d),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:o}}),f}catch(c){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(c),c}},this.unsubscribe=async(s,o)=>{await this.restartToComplete(),this.isInitialized(),typeof(o==null?void 0:o.id)<"u"?await this.unsubscribeById(s,o.id,o):await this.unsubscribeByTopic(s,o)},this.isSubscribed=async s=>{if(this.topics.includes(s))return!0;const o=`${this.pendingSubscriptionWatchLabel}_${s}`;return await new Promise((c,d)=>{const f=new ve.Watch;f.start(o);const y=setInterval(()=>{!this.pending.has(s)&&this.topics.includes(s)&&(clearInterval(y),f.stop(o),c(!0)),f.elapsed(o)>=g2&&(clearInterval(y),f.stop(o),d(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1)},this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=e,this.logger=Je.generateChildLogger(t,this.name),this.clientId=""}get context(){return Je.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(e,t){let s=!1;try{s=this.getSubscription(e).topic===t}catch{}return s}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,t){const s=this.topicMap.get(e);await Promise.all(s.map(async o=>await this.unsubscribeById(e,o,t)))}async unsubscribeById(e,t,s){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:s}});try{const o=wu(s);await this.rpcUnsubscribe(e,t,o);const c=_t("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,t,c),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:s}})}catch(o){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(o),o}}async rpcSubscribe(e,t){const s={method:Vo(t.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{await await xs(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(tr.connection_stalled)}return Fn(e+this.clientId)}async rpcBatchSubscribe(e){if(!e.length)return;const t=e[0].relay,s={method:Vo(t.protocol).batchSubscribe,params:{topics:e.map(o=>o.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{return await await xs(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(tr.connection_stalled)}}rpcUnsubscribe(e,t,s){const o={method:Vo(s.protocol).unsubscribe,params:{topic:e,id:t}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:o}),this.relayer.request(o)}onSubscribe(e,t){this.setSubscription(e,Zc(ms({},t),{id:e})),this.pending.delete(t.topic)}onBatchSubscribe(e){e.length&&e.forEach(t=>{this.setSubscription(t.id,ms({},t)),this.pending.delete(t.topic)})}async onUnsubscribe(e,t,s){this.events.removeAllListeners(t),this.hasSubscription(t,e)&&this.deleteSubscription(t,s),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,t){this.subscriptions.has(e)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:t}),this.addSubscription(e,t))}addSubscription(e,t){this.subscriptions.set(e,ms({},t)),this.topicMap.set(t.topic,e),this.events.emit(Wr.created,t)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const t=this.subscriptions.get(e);if(!t){const{message:s}=ce("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(s)}return t}deleteSubscription(e,t){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:t});const s=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(s.topic,e),this.events.emit(Wr.deleted,Zc(ms({},s),{reason:t}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Wr.sync)}async reset(){if(this.cached.length){const e=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let t=0;t<e;t++){const s=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(s)}}this.events.emit(Wr.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){const{message:t}=ce("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){if(!e.length)return;const t=await this.rpcBatchSubscribe(e);oi(t)&&this.onBatchSubscribe(t.map((s,o)=>Zc(ms({},e[o]),{id:s})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(!this.initialized||this.relayer.transportExplicitlyClosed)return;const e=[];this.pending.forEach(t=>{e.push(t)}),await this.batchSubscribe(e)}registerEventListeners(){this.relayer.core.heartbeat.on(Gn.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(tr.connect,async()=>{await this.onConnect()}),this.relayer.on(tr.disconnect,()=>{this.onDisconnect()}),this.events.on(Wr.created,async e=>{const t=Wr.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),await this.persist()}),this.events.on(Wr.deleted,async e=>{const t=Wr.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=ce("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(){this.restartInProgress&&await new Promise(e=>{const t=setInterval(()=>{this.restartInProgress||(clearInterval(t),e())},this.pollingInterval)})}}var L2=Object.defineProperty,fd=Object.getOwnPropertySymbols,M2=Object.prototype.hasOwnProperty,j2=Object.prototype.propertyIsEnumerable,dd=(i,e,t)=>e in i?L2(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,q2=(i,e)=>{for(var t in e||(e={}))M2.call(e,t)&&dd(i,t,e[t]);if(fd)for(var t of fd(e))j2.call(e,t)&&dd(i,t,e[t]);return i};class F2 extends P3{constructor(e){super(e),this.protocol="wc",this.version=2,this.events=new zr.EventEmitter,this.name=o2,this.transportExplicitlyClosed=!1,this.initialized=!1,this.connectionAttemptInProgress=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.hasExperiencedNetworkDisruption=!1,this.requestsInFlight=new Map,this.request=async t=>{this.logger.debug("Publishing Request Payload");const s=t.id,o=this.provider.request(t);this.requestsInFlight.set(s,{promise:o,request:t});try{return await this.toEstablishConnection(),await o}catch(c){throw this.logger.debug("Failed to Publish Request"),this.logger.error(c),c}finally{this.requestsInFlight.delete(s)}},this.onPayloadHandler=t=>{this.onProviderPayload(t)},this.onConnectHandler=()=>{this.events.emit(tr.connect)},this.onDisconnectHandler=()=>{this.onProviderDisconnect()},this.onProviderErrorHandler=t=>{this.logger.error(t),this.events.emit(tr.error,t),this.logger.info("Fatal socket error received, closing transport"),this.transportClose()},this.registerProviderListeners=()=>{this.provider.on(Ei.payload,this.onPayloadHandler),this.provider.on(Ei.connect,this.onConnectHandler),this.provider.on(Ei.disconnect,this.onDisconnectHandler),this.provider.on(Ei.error,this.onProviderErrorHandler)},this.core=e.core,this.logger=typeof e.logger<"u"&&typeof e.logger!="string"?Je.generateChildLogger(e.logger,this.name):Je.pino(Je.getDefaultLoggerOptions({level:e.logger||s2})),this.messages=new O2(this.logger,e.core),this.subscriber=new $2(this,this.logger),this.publisher=new P2(this,this.logger),this.relayUrl=(e==null?void 0:e.relayUrl)||Hp,this.projectId=e.projectId,this.bundleId=$E(),this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${ud}...`),await this.restartTransport(ud)}this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},h2)}get context(){return Je.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(e,t,s){this.isInitialized(),await this.publisher.publish(e,t,s),await this.recordMessageEvent({topic:e,message:t,publishedAt:Date.now()})}async subscribe(e,t){var s;this.isInitialized();let o=((s=this.subscriber.topicMap.get(e))==null?void 0:s[0])||"";if(o)return o;let c;const d=f=>{f.topic===e&&(this.subscriber.off(Wr.created,d),c())};return await Promise.all([new Promise(f=>{c=f,this.subscriber.on(Wr.created,d)}),new Promise(async f=>{o=await this.subscriber.subscribe(e,t),f()})]),o}async unsubscribe(e,t){this.isInitialized(),await this.subscriber.unsubscribe(e,t)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async transportClose(){this.requestsInFlight.size>0&&(this.logger.debug("Waiting for all in-flight requests to finish before closing transport..."),this.requestsInFlight.forEach(async e=>{await e.promise})),this.transportExplicitlyClosed=!0,this.hasExperiencedNetworkDisruption&&this.connected?await xs(this.provider.disconnect(),1e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.connected&&await this.provider.disconnect()}async transportOpen(e){if(this.transportExplicitlyClosed=!1,await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress){e&&e!==this.relayUrl&&(this.relayUrl=e,await this.transportClose(),await this.createProvider()),this.connectionAttemptInProgress=!0;try{await Promise.all([new Promise(t=>{if(!this.initialized)return t();this.subscriber.once(Wr.resubscribed,()=>{t()})}),new Promise(async(t,s)=>{try{await xs(this.provider.connect(),1e4,`Socket stalled when trying to connect to ${this.relayUrl}`)}catch(o){s(o);return}t()})])}catch(t){this.logger.error(t);const s=t;if(!this.isConnectionStalled(s.message))throw t;this.provider.events.emit(Ei.disconnect)}finally{this.connectionAttemptInProgress=!1,this.hasExperiencedNetworkDisruption=!1}}}async restartTransport(e){await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress&&(this.relayUrl=e||this.relayUrl,await this.transportClose(),await this.createProvider(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await Rf())throw new Error("No internet connection detected. Please restart your network and try again.")}isConnectionStalled(e){return this.staleConnectionErrors.some(t=>e.includes(t))}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new xi(new y6(zE({sdkVersion:u2,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0,bundleId:this.bundleId}))),this.registerProviderListeners()}async recordMessageEvent(e){const{topic:t,message:s}=e;await this.messages.set(t,s)}async shouldIgnoreMessageEvent(e){const{topic:t,message:s}=e;if(!s||s.length===0)return this.logger.debug(`Ignoring invalid/empty message: ${s}`),!0;if(!await this.subscriber.isSubscribed(t))return this.logger.debug(`Ignoring message for non-subscribed topic ${t}`),!0;const o=this.messages.has(t,s);return o&&this.logger.debug(`Ignoring duplicate message: ${s}`),o}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),Gu(e)){if(!e.method.endsWith(a2))return;const t=e.params,{topic:s,message:o,publishedAt:c}=t.data,d={topic:s,message:o,publishedAt:c};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(q2({type:"event",event:t.id},d)),this.events.emit(t.id,d),await this.acknowledgePayload(e),await this.onMessageEvent(d)}else ha(e)&&this.events.emit(tr.message_ack,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(this.events.emit(tr.message,e),await this.recordMessageEvent(e))}async acknowledgePayload(e){const t=ca(e.id,!0);await this.provider.connection.send(t)}unregisterProviderListeners(){this.provider.off(Ei.payload,this.onPayloadHandler),this.provider.off(Ei.connect,this.onConnectHandler),this.provider.off(Ei.disconnect,this.onDisconnectHandler),this.provider.off(Ei.error,this.onProviderErrorHandler)}async registerEventListeners(){this.events.on(tr.connection_stalled,()=>{this.restartTransport().catch(t=>this.logger.error(t))});let e=await Rf();$D(async t=>{this.initialized&&e!==t&&(e=t,t?await this.restartTransport().catch(s=>this.logger.error(s)):(this.hasExperiencedNetworkDisruption=!0,await this.transportClose().catch(s=>this.logger.error(s))))})}onProviderDisconnect(){this.events.emit(tr.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||(this.logger.info("attemptToReconnect called. Connecting..."),setTimeout(async()=>{await this.restartTransport().catch(e=>this.logger.error(e))},ve.toMiliseconds(c2)))}isInitialized(){if(!this.initialized){const{message:e}=ce("NOT_INITIALIZED",this.name);throw new Error(e)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectionAttemptInProgress)return await new Promise(e=>{const t=setInterval(()=>{this.connected&&(clearInterval(t),e())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var z2=Object.defineProperty,pd=Object.getOwnPropertySymbols,B2=Object.prototype.hasOwnProperty,H2=Object.prototype.propertyIsEnumerable,gd=(i,e,t)=>e in i?z2(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,yd=(i,e)=>{for(var t in e||(e={}))B2.call(e,t)&&gd(i,t,e[t]);if(pd)for(var t of pd(e))H2.call(e,t)&&gd(i,t,e[t]);return i};class fa extends C3{constructor(e,t,s,o=Fi,c=void 0){super(e,t,s,o),this.core=e,this.logger=t,this.name=s,this.map=new Map,this.version=l2,this.cached=[],this.initialized=!1,this.storagePrefix=Fi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(d=>{this.getKey&&d!==null&&!hr(d)?this.map.set(this.getKey(d),d):fD(d)?this.map.set(d.id,d):dD(d)&&this.map.set(d.topic,d)}),this.cached=[],this.initialized=!0)},this.set=async(d,f)=>{this.isInitialized(),this.map.has(d)?await this.update(d,f):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:d,value:f}),this.map.set(d,f),await this.persist())},this.get=d=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:d}),this.getData(d)),this.getAll=d=>(this.isInitialized(),d?this.values.filter(f=>Object.keys(d).every(y=>m6(f[y],d[y]))):this.values),this.update=async(d,f)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:d,update:f});const y=yd(yd({},this.getData(d)),f);this.map.set(d,y),await this.persist()},this.delete=async(d,f)=>{this.isInitialized(),this.map.has(d)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:d,reason:f}),this.map.delete(d),await this.persist())},this.logger=Je.generateChildLogger(t,this.name),this.storagePrefix=o,this.getKey=c}get context(){return Je.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const t=this.map.get(e);if(!t){const{message:s}=ce("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(s),new Error(s)}return t}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:t}=ce("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=ce("NOT_INITIALIZED",this.name);throw new Error(e)}}}class K2{constructor(e,t){this.core=e,this.logger=t,this.name=y2,this.version=v2,this.events=new Tu,this.initialized=!1,this.storagePrefix=Fi,this.ignoredPayloadTypes=[fn],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:s})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...s])]},this.create=async()=>{this.isInitialized();const s=mu(),o=await this.core.crypto.setSymKey(s),c=Pr(ve.FIVE_MINUTES),d={protocol:Bp},f={topic:o,expiry:c,relay:d,active:!1},y=iD({protocol:this.core.protocol,version:this.core.version,topic:o,symKey:s,relay:d,expiryTimestamp:c});return await this.pairings.set(o,f),await this.core.relayer.subscribe(o),this.core.expirer.set(o,c),{topic:o,uri:y}},this.pair=async s=>{this.isInitialized(),this.isValidPair(s);const{topic:o,symKey:c,relay:d,expiryTimestamp:f}=Of(s.uri);let y;if(this.pairings.keys.includes(o)&&(y=this.pairings.get(o),y.active))throw new Error(`Pairing already exists: ${o}. Please try again with a new connection URI.`);const g=f||Pr(ve.FIVE_MINUTES),m={topic:o,relay:d,expiry:g,active:!1};return await this.pairings.set(o,m),this.core.expirer.set(o,g),s.activatePairing&&await this.activate({topic:o}),this.events.emit(bs.create,m),this.core.crypto.keychain.has(o)||(await this.core.crypto.setSymKey(c,o),await this.core.relayer.subscribe(o,{relay:d})),m},this.activate=async({topic:s})=>{this.isInitialized();const o=Pr(ve.THIRTY_DAYS);await this.pairings.update(s,{active:!0,expiry:o}),this.core.expirer.set(s,o)},this.ping=async s=>{this.isInitialized(),await this.isValidPing(s);const{topic:o}=s;if(this.pairings.keys.includes(o)){const c=await this.sendRequest(o,"wc_pairingPing",{}),{done:d,resolve:f,reject:y}=jn();this.events.once($t("pairing_ping",c),({error:g})=>{g?y(g):f()}),await d()}},this.updateExpiry=async({topic:s,expiry:o})=>{this.isInitialized(),await this.pairings.update(s,{expiry:o})},this.updateMetadata=async({topic:s,metadata:o})=>{this.isInitialized(),await this.pairings.update(s,{peerMetadata:o})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async s=>{this.isInitialized(),await this.isValidDisconnect(s);const{topic:o}=s;this.pairings.keys.includes(o)&&(await this.sendRequest(o,"wc_pairingDelete",_t("USER_DISCONNECTED")),await this.deletePairing(o))},this.sendRequest=async(s,o,c)=>{const d=zn(o,c),f=await this.core.crypto.encode(s,d),y=vs[o].req;return this.core.history.set(s,d),this.core.relayer.publish(s,f,y),d.id},this.sendResult=async(s,o,c)=>{const d=ca(s,c),f=await this.core.crypto.encode(o,d),y=await this.core.history.get(o,s),g=vs[y.request.method].res;await this.core.relayer.publish(o,f,g),await this.core.history.resolve(d)},this.sendError=async(s,o,c)=>{const d=ua(s,c),f=await this.core.crypto.encode(o,d),y=await this.core.history.get(o,s),g=vs[y.request.method]?vs[y.request.method].res:vs.unregistered_method.res;await this.core.relayer.publish(o,f,g),await this.core.history.resolve(d)},this.deletePairing=async(s,o)=>{await this.core.relayer.unsubscribe(s),await Promise.all([this.pairings.delete(s,_t("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(s),o?Promise.resolve():this.core.expirer.del(s)])},this.cleanup=async()=>{const s=this.pairings.getAll().filter(o=>qi(o.expiry));await Promise.all(s.map(o=>this.deletePairing(o.topic)))},this.onRelayEventRequest=s=>{const{topic:o,payload:c}=s;switch(c.method){case"wc_pairingPing":return this.onPairingPingRequest(o,c);case"wc_pairingDelete":return this.onPairingDeleteRequest(o,c);default:return this.onUnknownRpcMethodRequest(o,c)}},this.onRelayEventResponse=async s=>{const{topic:o,payload:c}=s,d=(await this.core.history.get(o,c.id)).request.method;switch(d){case"wc_pairingPing":return this.onPairingPingResponse(o,c);default:return this.onUnknownRpcMethodResponse(d)}},this.onPairingPingRequest=async(s,o)=>{const{id:c}=o;try{this.isValidPing({topic:s}),await this.sendResult(c,s,!0),this.events.emit(bs.ping,{id:c,topic:s})}catch(d){await this.sendError(c,s,d),this.logger.error(d)}},this.onPairingPingResponse=(s,o)=>{const{id:c}=o;setTimeout(()=>{Ii(o)?this.events.emit($t("pairing_ping",c),{}):Yr(o)&&this.events.emit($t("pairing_ping",c),{error:o.error})},500)},this.onPairingDeleteRequest=async(s,o)=>{const{id:c}=o;try{this.isValidDisconnect({topic:s}),await this.deletePairing(s),this.events.emit(bs.delete,{id:c,topic:s})}catch(d){await this.sendError(c,s,d),this.logger.error(d)}},this.onUnknownRpcMethodRequest=async(s,o)=>{const{id:c,method:d}=o;try{if(this.registeredMethods.includes(d))return;const f=_t("WC_METHOD_UNSUPPORTED",d);await this.sendError(c,s,f),this.logger.error(f)}catch(f){await this.sendError(c,s,f),this.logger.error(f)}},this.onUnknownRpcMethodResponse=s=>{this.registeredMethods.includes(s)||this.logger.error(_t("WC_METHOD_UNSUPPORTED",s))},this.isValidPair=s=>{var o;if(!_r(s)){const{message:d}=ce("MISSING_OR_INVALID",`pair() params: ${s}`);throw new Error(d)}if(!lD(s.uri)){const{message:d}=ce("MISSING_OR_INVALID",`pair() uri: ${s.uri}`);throw new Error(d)}const c=Of(s.uri);if(!((o=c==null?void 0:c.relay)!=null&&o.protocol)){const{message:d}=ce("MISSING_OR_INVALID","pair() uri#relay-protocol");throw new Error(d)}if(!(c!=null&&c.symKey)){const{message:d}=ce("MISSING_OR_INVALID","pair() uri#symKey");throw new Error(d)}if(c!=null&&c.expiryTimestamp&&ve.toMiliseconds(c==null?void 0:c.expiryTimestamp)<Date.now()){const{message:d}=ce("EXPIRED","pair() URI has expired. Please try again with a new connection URI.");throw new Error(d)}},this.isValidPing=async s=>{if(!_r(s)){const{message:c}=ce("MISSING_OR_INVALID",`ping() params: ${s}`);throw new Error(c)}const{topic:o}=s;await this.isValidPairingTopic(o)},this.isValidDisconnect=async s=>{if(!_r(s)){const{message:c}=ce("MISSING_OR_INVALID",`disconnect() params: ${s}`);throw new Error(c)}const{topic:o}=s;await this.isValidPairingTopic(o)},this.isValidPairingTopic=async s=>{if(!Wt(s,!1)){const{message:o}=ce("MISSING_OR_INVALID",`pairing topic should be a string: ${s}`);throw new Error(o)}if(!this.pairings.keys.includes(s)){const{message:o}=ce("NO_MATCHING_KEY",`pairing topic doesn't exist: ${s}`);throw new Error(o)}if(qi(this.pairings.get(s).expiry)){await this.deletePairing(s);const{message:o}=ce("EXPIRED",`pairing topic: ${s}`);throw new Error(o)}},this.core=e,this.logger=Je.generateChildLogger(t,this.name),this.pairings=new fa(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Je.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=ce("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(tr.message,async e=>{const{topic:t,message:s}=e;if(!this.pairings.keys.includes(t)||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(s)))return;const o=await this.core.crypto.decode(t,s);try{Gu(o)?(this.core.history.set(t,o),this.onRelayEventRequest({topic:t,payload:o})):ha(o)&&(await this.core.history.resolve(o),await this.onRelayEventResponse({topic:t,payload:o}),this.core.history.delete(t,o.id))}catch(c){this.logger.error(c)}})}registerExpirerEvents(){this.core.expirer.on(Fr.expired,async e=>{const{topic:t}=lp(e.target);t&&this.pairings.keys.includes(t)&&(await this.deletePairing(t,!0),this.events.emit(bs.expire,{topic:t}))})}}class k2 extends I3{constructor(e,t){super(e,t),this.core=e,this.logger=t,this.records=new Map,this.events=new zr.EventEmitter,this.name=m2,this.version=w2,this.cached=[],this.initialized=!1,this.storagePrefix=Fi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.records.set(s.id,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(s,o,c)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:s,request:o,chainId:c}),this.records.has(o.id))return;const d={id:o.id,topic:s,request:{method:o.method,params:o.params||null},chainId:c,expiry:Pr(ve.THIRTY_DAYS)};this.records.set(d.id,d),this.events.emit(ni.created,d)},this.resolve=async s=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:s}),!this.records.has(s.id))return;const o=await this.getRecord(s.id);typeof o.response>"u"&&(o.response=Yr(s)?{error:s.error}:{result:s.result},this.records.set(o.id,o),this.events.emit(ni.updated,o))},this.get=async(s,o)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:s,id:o}),await this.getRecord(o)),this.delete=(s,o)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:o}),this.values.forEach(c=>{if(c.topic===s){if(typeof o<"u"&&c.id!==o)return;this.records.delete(c.id),this.events.emit(ni.deleted,c)}})},this.exists=async(s,o)=>(this.isInitialized(),this.records.has(o)?(await this.getRecord(o)).topic===s:!1),this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.logger=Je.generateChildLogger(t,this.name)}get context(){return Je.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(t=>{if(typeof t.response<"u")return;const s={topic:t.topic,request:zn(t.request.method,t.request.params,t.id),chainId:t.chainId};return e.push(s)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const t=this.records.get(e);if(!t){const{message:s}=ce("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(s)}return t}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(ni.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:t}=ce("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(ni.created,e=>{const t=ni.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e}),this.persist()}),this.events.on(ni.updated,e=>{const t=ni.updated;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e}),this.persist()}),this.events.on(ni.deleted,e=>{const t=ni.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e}),this.persist()}),this.core.heartbeat.on(Gn.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach(e=>{ve.toMiliseconds(e.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${e.id}`),this.delete(e.topic,e.id))})}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){const{message:e}=ce("NOT_INITIALIZED",this.name);throw new Error(e)}}}class V2 extends T3{constructor(e,t){super(e,t),this.core=e,this.logger=t,this.expirations=new Map,this.events=new zr.EventEmitter,this.name=_2,this.version=b2,this.cached=[],this.initialized=!1,this.storagePrefix=Fi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.expirations.set(s.target,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=s=>{try{const o=this.formatTarget(s);return typeof this.getExpiration(o)<"u"}catch{return!1}},this.set=(s,o)=>{this.isInitialized();const c=this.formatTarget(s),d={target:c,expiry:o};this.expirations.set(c,d),this.checkExpiry(c,d),this.events.emit(Fr.created,{target:c,expiration:d})},this.get=s=>{this.isInitialized();const o=this.formatTarget(s);return this.getExpiration(o)},this.del=s=>{if(this.isInitialized(),this.has(s)){const o=this.formatTarget(s),c=this.getExpiration(o);this.expirations.delete(o),this.events.emit(Fr.deleted,{target:o,expiration:c})}},this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.logger=Je.generateChildLogger(t,this.name)}get context(){return Je.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return BE(e);if(typeof e=="number")return HE(e);const{message:t}=ce("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(t)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Fr.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:t}=ce("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const t=this.expirations.get(e);if(!t){const{message:s}=ce("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(s),new Error(s)}return t}checkExpiry(e,t){const{expiry:s}=t;ve.toMiliseconds(s)-Date.now()<=0&&this.expire(e,t)}expire(e,t){this.expirations.delete(e),this.events.emit(Fr.expired,{target:e,expiration:t})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,t)=>this.checkExpiry(t,e))}registerEventListeners(){this.core.heartbeat.on(Gn.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(Fr.created,e=>{const t=Fr.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(Fr.expired,e=>{const t=Fr.expired;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(Fr.deleted,e=>{const t=Fr.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=ce("NOT_INITIALIZED",this.name);throw new Error(e)}}}class G2 extends R3{constructor(e,t){super(e,t),this.projectId=e,this.logger=t,this.name=Xc,this.initialized=!1,this.queue=[],this.verifyDisabled=!1,this.init=async s=>{if(this.verifyDisabled||Kn()||!kn())return;const o=this.getVerifyUrl(s==null?void 0:s.verifyUrl);this.verifyUrl!==o&&this.removeIframe(),this.verifyUrl=o;try{await this.createIframe()}catch(c){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(c)}if(!this.initialized){this.removeIframe(),this.verifyUrl=Du;try{await this.createIframe()}catch(c){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(c),this.verifyDisabled=!0}}},this.register=async s=>{this.initialized?this.sendPost(s.attestationId):(this.addToQueue(s.attestationId),await this.init())},this.resolve=async s=>{if(this.isDevEnv)return"";const o=this.getVerifyUrl(s==null?void 0:s.verifyUrl);let c;try{c=await this.fetchAttestation(s.attestationId,o)}catch(d){this.logger.info(`failed to resolve attestation: ${s.attestationId} from url: ${o}`),this.logger.info(d),c=await this.fetchAttestation(s.attestationId,Du)}return c},this.fetchAttestation=async(s,o)=>{this.logger.info(`resolving attestation: ${s} from url: ${o}`);const c=this.startAbortTimer(ve.ONE_SECOND*2),d=await fetch(`${o}/attestation/${s}`,{signal:this.abortController.signal});return clearTimeout(c),d.status===200?await d.json():void 0},this.addToQueue=s=>{this.queue.push(s)},this.processQueue=()=>{this.queue.length!==0&&(this.queue.forEach(s=>this.sendPost(s)),this.queue=[])},this.sendPost=s=>{var o;try{if(!this.iframe)return;(o=this.iframe.contentWindow)==null||o.postMessage(s,"*"),this.logger.info(`postMessage sent: ${s} ${this.verifyUrl}`)}catch{}},this.createIframe=async()=>{let s;const o=c=>{c.data==="verify_ready"&&(this.initialized=!0,this.processQueue(),window.removeEventListener("message",o),s())};await Promise.race([new Promise(c=>{if(document.getElementById(Xc))return c();window.addEventListener("message",o);const d=document.createElement("iframe");d.id=Xc,d.src=`${this.verifyUrl}/${this.projectId}`,d.style.display="none",document.body.append(d),this.iframe=d,s=c}),new Promise((c,d)=>setTimeout(()=>{window.removeEventListener("message",o),d("verify iframe load timeout")},ve.toMiliseconds(ve.FIVE_SECONDS)))])},this.removeIframe=()=>{this.iframe&&(this.iframe.remove(),this.iframe=void 0,this.initialized=!1)},this.getVerifyUrl=s=>{let o=s||qn;return E2.includes(o)||(this.logger.info(`verify url: ${o}, not included in trusted list, assigning default: ${qn}`),o=qn),o},this.logger=Je.generateChildLogger(t,this.name),this.verifyUrl=qn,this.abortController=new AbortController,this.isDevEnv=zu()&&D6.IS_VITEST}get context(){return Je.getLoggerContext(this.logger)}startAbortTimer(e){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),ve.toMiliseconds(e))}}class W2 extends N3{constructor(e,t){super(e,t),this.projectId=e,this.logger=t,this.context=D2,this.registerDeviceToken=async s=>{const{clientId:o,token:c,notificationType:d,enableEncrypted:f=!1}=s,y=`${S2}/${this.projectId}/clients`;await E6(y,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:o,type:d,token:c,always_raw:f})})},this.logger=Je.generateChildLogger(t,this.context)}}var Y2=Object.defineProperty,vd=Object.getOwnPropertySymbols,J2=Object.prototype.hasOwnProperty,Q2=Object.prototype.propertyIsEnumerable,md=(i,e,t)=>e in i?Y2(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,wd=(i,e)=>{for(var t in e||(e={}))J2.call(e,t)&&md(i,t,e[t]);if(vd)for(var t of vd(e))Q2.call(e,t)&&md(i,t,e[t]);return i};class Yu extends S3{constructor(e){super(e),this.protocol=zp,this.version=WS,this.name=Wu,this.events=new zr.EventEmitter,this.initialized=!1,this.on=(s,o)=>this.events.on(s,o),this.once=(s,o)=>this.events.once(s,o),this.off=(s,o)=>this.events.off(s,o),this.removeListener=(s,o)=>this.events.removeListener(s,o),this.projectId=e==null?void 0:e.projectId,this.relayUrl=(e==null?void 0:e.relayUrl)||Hp,this.customStoragePrefix=e!=null&&e.customStoragePrefix?`:${e.customStoragePrefix}`:"";const t=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:Je.pino(Je.getDefaultLoggerOptions({level:(e==null?void 0:e.logger)||YS.logger}));this.logger=Je.generateChildLogger(t,this.name),this.heartbeat=new Gn.HeartBeat,this.crypto=new x2(this,this.logger,e==null?void 0:e.keychain),this.history=new k2(this,this.logger),this.expirer=new V2(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new g3(wd(wd({},JS),e==null?void 0:e.storageOptions)),this.relayer=new F2({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new K2(this,this.logger),this.verify=new G2(this.projectId||"",this.logger),this.echoClient=new W2(this.projectId||"",this.logger)}static async init(e){const t=new Yu(e);await t.initialize();const s=await t.crypto.getClientId();return await t.storage.setItem(f2,s),t}get context(){return Je.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}}const X2=Yu,Kp="wc",kp=2,Vp="client",Ju=`${Kp}@${kp}:${Vp}:`,eu={name:Vp,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},_d="WALLETCONNECT_DEEPLINK_CHOICE",Z2="proposal",Gp="Proposal expired",eI="session",Ho=ve.SEVEN_DAYS,tI="engine",Di={wc_sessionPropose:{req:{ttl:ve.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:ve.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:ve.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:ve.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:ve.ONE_DAY,prompt:!1,tag:1104},res:{ttl:ve.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:ve.ONE_DAY,prompt:!1,tag:1106},res:{ttl:ve.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:ve.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:ve.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:ve.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:ve.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:ve.ONE_DAY,prompt:!1,tag:1112},res:{ttl:ve.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:ve.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:ve.THIRTY_SECONDS,prompt:!1,tag:1115}}},tu={min:ve.FIVE_MINUTES,max:ve.SEVEN_DAYS},Si={idle:"IDLE",active:"ACTIVE"},rI="request",iI=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var nI=Object.defineProperty,sI=Object.defineProperties,oI=Object.getOwnPropertyDescriptors,bd=Object.getOwnPropertySymbols,aI=Object.prototype.hasOwnProperty,cI=Object.prototype.propertyIsEnumerable,Ed=(i,e,t)=>e in i?nI(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,ur=(i,e)=>{for(var t in e||(e={}))aI.call(e,t)&&Ed(i,t,e[t]);if(bd)for(var t of bd(e))cI.call(e,t)&&Ed(i,t,e[t]);return i},Mn=(i,e)=>sI(i,oI(e));class uI extends $3{constructor(e){super(e),this.name=tI,this.events=new Tu,this.initialized=!1,this.ignoredPayloadTypes=[fn],this.requestQueue={state:Si.idle,queue:[]},this.sessionRequestQueue={state:Si.idle,queue:[]},this.requestQueueDelay=ve.ONE_SECOND,this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),this.client.core.pairing.register({methods:Object.keys(Di)}),this.initialized=!0,setTimeout(()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},ve.toMiliseconds(this.requestQueueDelay)))},this.connect=async t=>{await this.isInitialized();const s=Mn(ur({},t),{requiredNamespaces:t.requiredNamespaces||{},optionalNamespaces:t.optionalNamespaces||{}});await this.isValidConnect(s);const{pairingTopic:o,requiredNamespaces:c,optionalNamespaces:d,sessionProperties:f,relays:y}=s;let g=o,m,D=!1;if(g&&(D=this.client.core.pairing.pairings.get(g).active),!g||!D){const{topic:O,uri:A}=await this.client.core.pairing.create();g=O,m=A}const I=await this.client.core.crypto.generateKeyPair(),T=Di.wc_sessionPropose.req.ttl||ve.FIVE_MINUTES,P=Pr(T),z=ur({requiredNamespaces:c,optionalNamespaces:d,relays:y??[{protocol:Bp}],proposer:{publicKey:I,metadata:this.client.metadata},expiryTimestamp:P},f&&{sessionProperties:f}),{reject:H,resolve:ie,done:U}=jn(T,Gp);if(this.events.once($t("session_connect"),async({error:O,session:A})=>{if(O)H(O);else if(A){A.self.publicKey=I;const E=Mn(ur({},A),{requiredNamespaces:z.requiredNamespaces,optionalNamespaces:z.optionalNamespaces});await this.client.session.set(A.topic,E),await this.setExpiry(A.topic,A.expiry),g&&await this.client.core.pairing.updateMetadata({topic:g,metadata:A.peer.metadata}),ie(E)}}),!g){const{message:O}=ce("NO_MATCHING_KEY",`connect() pairing topic: ${g}`);throw new Error(O)}const j=await this.sendRequest({topic:g,method:"wc_sessionPropose",params:z,throwOnFailedPublish:!0});return await this.setProposal(j,ur({id:j},z)),{uri:m,approval:U}},this.pair=async t=>(await this.isInitialized(),await this.client.core.pairing.pair(t)),this.approve=async t=>{await this.isInitialized(),await this.isValidApprove(t);const{id:s,relayProtocol:o,namespaces:c,sessionProperties:d}=t,f=this.client.proposal.get(s);let{pairingTopic:y,proposer:g,requiredNamespaces:m,optionalNamespaces:D}=f;y=y||"";const I=await this.client.core.crypto.generateKeyPair(),T=g.publicKey,P=await this.client.core.crypto.generateSharedKey(I,T);y&&s&&(await this.client.core.pairing.updateMetadata({topic:y,metadata:g.metadata}),await this.sendResult({id:s,topic:y,result:{relay:{protocol:o??"irn"},responderPublicKey:I}}),await this.client.proposal.delete(s,_t("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:y}));const z=ur({relay:{protocol:o??"irn"},namespaces:c,pairingTopic:y,controller:{publicKey:I,metadata:this.client.metadata},expiry:Pr(Ho)},d&&{sessionProperties:d});await this.client.core.relayer.subscribe(P);const H=Mn(ur({},z),{topic:P,requiredNamespaces:m,optionalNamespaces:D,pairingTopic:y,acknowledged:!1,self:z.controller,peer:{publicKey:g.publicKey,metadata:g.metadata},controller:I});await this.client.session.set(P,H);try{await this.sendRequest({topic:P,method:"wc_sessionSettle",params:z,throwOnFailedPublish:!0})}catch(ie){throw this.client.logger.error(ie),this.client.session.delete(P,_t("USER_DISCONNECTED")),await this.client.core.relayer.unsubscribe(P),ie}return await this.setExpiry(P,Pr(Ho)),{topic:P,acknowledged:()=>new Promise(ie=>setTimeout(()=>ie(this.client.session.get(P)),500))}},this.reject=async t=>{await this.isInitialized(),await this.isValidReject(t);const{id:s,reason:o}=t,{pairingTopic:c}=this.client.proposal.get(s);c&&(await this.sendError(s,c,o),await this.client.proposal.delete(s,_t("USER_DISCONNECTED")))},this.update=async t=>{await this.isInitialized(),await this.isValidUpdate(t);const{topic:s,namespaces:o}=t,c=await this.sendRequest({topic:s,method:"wc_sessionUpdate",params:{namespaces:o}}),{done:d,resolve:f,reject:y}=jn();return this.events.once($t("session_update",c),({error:g})=>{g?y(g):f()}),await this.client.session.update(s,{namespaces:o}),{acknowledged:d}},this.extend=async t=>{await this.isInitialized(),await this.isValidExtend(t);const{topic:s}=t,o=await this.sendRequest({topic:s,method:"wc_sessionExtend",params:{}}),{done:c,resolve:d,reject:f}=jn();return this.events.once($t("session_extend",o),({error:y})=>{y?f(y):d()}),await this.setExpiry(s,Pr(Ho)),{acknowledged:c}},this.request=async t=>{await this.isInitialized(),await this.isValidRequest(t);const{chainId:s,request:o,topic:c,expiry:d=Di.wc_sessionRequest.req.ttl}=t,f=Vu(),{done:y,resolve:g,reject:m}=jn(d,"Request expired. Please try again.");return this.events.once($t("session_request",f),({error:D,result:I})=>{D?m(D):g(I)}),await Promise.all([new Promise(async D=>{await this.sendRequest({clientRpcId:f,topic:c,method:"wc_sessionRequest",params:{request:Mn(ur({},o),{expiryTimestamp:Pr(d)}),chainId:s},expiry:d,throwOnFailedPublish:!0}).catch(I=>m(I)),this.client.events.emit("session_request_sent",{topic:c,request:o,chainId:s,id:f}),D()}),new Promise(async D=>{const I=await kE(this.client.core.storage,_d);KE({id:f,topic:c,wcDeepLink:I}),D()}),y()]).then(D=>D[2])},this.respond=async t=>{await this.isInitialized(),await this.isValidRespond(t);const{topic:s,response:o}=t,{id:c}=o;Ii(o)?await this.sendResult({id:c,topic:s,result:o.result,throwOnFailedPublish:!0}):Yr(o)&&await this.sendError(c,s,o.error),this.cleanupAfterResponse(t)},this.ping=async t=>{await this.isInitialized(),await this.isValidPing(t);const{topic:s}=t;if(this.client.session.keys.includes(s)){const o=await this.sendRequest({topic:s,method:"wc_sessionPing",params:{}}),{done:c,resolve:d,reject:f}=jn();this.events.once($t("session_ping",o),({error:y})=>{y?f(y):d()}),await c()}else this.client.core.pairing.pairings.keys.includes(s)&&await this.client.core.pairing.ping({topic:s})},this.emit=async t=>{await this.isInitialized(),await this.isValidEmit(t);const{topic:s,event:o,chainId:c}=t;await this.sendRequest({topic:s,method:"wc_sessionEvent",params:{event:o,chainId:c}})},this.disconnect=async t=>{await this.isInitialized(),await this.isValidDisconnect(t);const{topic:s}=t;if(this.client.session.keys.includes(s))await this.sendRequest({topic:s,method:"wc_sessionDelete",params:_t("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession({topic:s,emitEvent:!1});else if(this.client.core.pairing.pairings.keys.includes(s))await this.client.core.pairing.disconnect({topic:s});else{const{message:o}=ce("MISMATCHED_TOPIC",`Session or pairing topic not found: ${s}`);throw new Error(o)}},this.find=t=>(this.isInitialized(),this.client.session.getAll().filter(s=>uD(s,t))),this.getPendingSessionRequests=()=>this.client.pendingRequest.getAll(),this.cleanupDuplicatePairings=async t=>{if(t.pairingTopic)try{const s=this.client.core.pairing.pairings.get(t.pairingTopic),o=this.client.core.pairing.pairings.getAll().filter(c=>{var d,f;return((d=c.peerMetadata)==null?void 0:d.url)&&((f=c.peerMetadata)==null?void 0:f.url)===t.peer.metadata.url&&c.topic&&c.topic!==s.topic});if(o.length===0)return;this.client.logger.info(`Cleaning up ${o.length} duplicate pairing(s)`),await Promise.all(o.map(c=>this.client.core.pairing.disconnect({topic:c.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(s){this.client.logger.error(s)}},this.deleteSession=async t=>{const{topic:s,expirerHasDeleted:o=!1,emitEvent:c=!0,id:d=0}=t,{self:f}=this.client.session.get(s);await this.client.core.relayer.unsubscribe(s),await this.client.session.delete(s,_t("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(f.publicKey)&&await this.client.core.crypto.deleteKeyPair(f.publicKey),this.client.core.crypto.keychain.has(s)&&await this.client.core.crypto.deleteSymKey(s),o||this.client.core.expirer.del(s),this.client.core.storage.removeItem(_d).catch(y=>this.client.logger.warn(y)),this.getPendingSessionRequests().forEach(y=>{y.topic===s&&this.deletePendingSessionRequest(y.id,_t("USER_DISCONNECTED"))}),c&&this.client.events.emit("session_delete",{id:d,topic:s})},this.deleteProposal=async(t,s)=>{await Promise.all([this.client.proposal.delete(t,_t("USER_DISCONNECTED")),s?Promise.resolve():this.client.core.expirer.del(t)])},this.deletePendingSessionRequest=async(t,s,o=!1)=>{await Promise.all([this.client.pendingRequest.delete(t,s),o?Promise.resolve():this.client.core.expirer.del(t)]),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(c=>c.id!==t),o&&(this.sessionRequestQueue.state=Si.idle,this.client.events.emit("session_request_expire",{id:t}))},this.setExpiry=async(t,s)=>{this.client.session.keys.includes(t)&&await this.client.session.update(t,{expiry:s}),this.client.core.expirer.set(t,s)},this.setProposal=async(t,s)=>{await this.client.proposal.set(t,s),this.client.core.expirer.set(t,Pr(Di.wc_sessionPropose.req.ttl))},this.setPendingSessionRequest=async t=>{const{id:s,topic:o,params:c,verifyContext:d}=t,f=c.request.expiryTimestamp||Pr(Di.wc_sessionRequest.req.ttl);await this.client.pendingRequest.set(s,{id:s,topic:o,params:c,verifyContext:d}),f&&this.client.core.expirer.set(s,f)},this.sendRequest=async t=>{const{topic:s,method:o,params:c,expiry:d,relayRpcId:f,clientRpcId:y,throwOnFailedPublish:g}=t,m=zn(o,c,y);if(kn()&&iI.includes(o)){const T=Fn(JSON.stringify(m));this.client.core.verify.register({attestationId:T})}const D=await this.client.core.crypto.encode(s,m),I=Di[o].req;return d&&(I.ttl=d),f&&(I.id=f),this.client.core.history.set(s,m),g?(I.internal=Mn(ur({},I.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(s,D,I)):this.client.core.relayer.publish(s,D,I).catch(T=>this.client.logger.error(T)),m.id},this.sendResult=async t=>{const{id:s,topic:o,result:c,throwOnFailedPublish:d}=t,f=ca(s,c),y=await this.client.core.crypto.encode(o,f),g=await this.client.core.history.get(o,s),m=Di[g.request.method].res;d?(m.internal=Mn(ur({},m.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(o,y,m)):this.client.core.relayer.publish(o,y,m).catch(D=>this.client.logger.error(D)),await this.client.core.history.resolve(f)},this.sendError=async(t,s,o)=>{const c=ua(t,o),d=await this.client.core.crypto.encode(s,c),f=await this.client.core.history.get(s,t),y=Di[f.request.method].res;this.client.core.relayer.publish(s,d,y),await this.client.core.history.resolve(c)},this.cleanup=async()=>{const t=[],s=[];this.client.session.getAll().forEach(o=>{let c=!1;qi(o.expiry)&&(c=!0),this.client.core.crypto.keychain.has(o.topic)||(c=!0),c&&t.push(o.topic)}),this.client.proposal.getAll().forEach(o=>{qi(o.expiryTimestamp)&&s.push(o.id)}),await Promise.all([...t.map(o=>this.deleteSession({topic:o})),...s.map(o=>this.deleteProposal(o))])},this.onRelayEventRequest=async t=>{this.requestQueue.queue.push(t),await this.processRequestsQueue()},this.processRequestsQueue=async()=>{if(this.requestQueue.state===Si.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=Si.active;const t=this.requestQueue.queue.shift();if(t)try{this.processRequest(t),await new Promise(s=>setTimeout(s,300))}catch(s){this.client.logger.warn(s)}}this.requestQueue.state=Si.idle},this.processRequest=t=>{const{topic:s,payload:o}=t,c=o.method;switch(c){case"wc_sessionPropose":return this.onSessionProposeRequest(s,o);case"wc_sessionSettle":return this.onSessionSettleRequest(s,o);case"wc_sessionUpdate":return this.onSessionUpdateRequest(s,o);case"wc_sessionExtend":return this.onSessionExtendRequest(s,o);case"wc_sessionPing":return this.onSessionPingRequest(s,o);case"wc_sessionDelete":return this.onSessionDeleteRequest(s,o);case"wc_sessionRequest":return this.onSessionRequest(s,o);case"wc_sessionEvent":return this.onSessionEventRequest(s,o);default:return this.client.logger.info(`Unsupported request method ${c}`)}},this.onRelayEventResponse=async t=>{const{topic:s,payload:o}=t,c=(await this.client.core.history.get(s,o.id)).request.method;switch(c){case"wc_sessionPropose":return this.onSessionProposeResponse(s,o);case"wc_sessionSettle":return this.onSessionSettleResponse(s,o);case"wc_sessionUpdate":return this.onSessionUpdateResponse(s,o);case"wc_sessionExtend":return this.onSessionExtendResponse(s,o);case"wc_sessionPing":return this.onSessionPingResponse(s,o);case"wc_sessionRequest":return this.onSessionRequestResponse(s,o);default:return this.client.logger.info(`Unsupported response method ${c}`)}},this.onRelayEventUnknownPayload=t=>{const{topic:s}=t,{message:o}=ce("MISSING_OR_INVALID",`Decoded payload on topic ${s} is not identifiable as a JSON-RPC request or a response.`);throw new Error(o)},this.onSessionProposeRequest=async(t,s)=>{const{params:o,id:c}=s;try{this.isValidConnect(ur({},s.params));const d=o.expiryTimestamp||Pr(Di.wc_sessionPropose.req.ttl),f=ur({id:c,pairingTopic:t,expiryTimestamp:d},o);await this.setProposal(c,f);const y=Fn(JSON.stringify(s)),g=await this.getVerifyContext(y,f.proposer.metadata);this.client.events.emit("session_proposal",{id:c,params:f,verifyContext:g})}catch(d){await this.sendError(c,t,d),this.client.logger.error(d)}},this.onSessionProposeResponse=async(t,s)=>{const{id:o}=s;if(Ii(s)){const{result:c}=s;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:c});const d=this.client.proposal.get(o);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:d});const f=d.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:f});const y=c.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:y});const g=await this.client.core.crypto.generateSharedKey(f,y);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:g});const m=await this.client.core.relayer.subscribe(g);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:m}),await this.client.core.pairing.activate({topic:t})}else Yr(s)&&(await this.client.proposal.delete(o,_t("USER_DISCONNECTED")),this.events.emit($t("session_connect"),{error:s.error}))},this.onSessionSettleRequest=async(t,s)=>{const{id:o,params:c}=s;try{this.isValidSessionSettleRequest(c);const{relay:d,controller:f,expiry:y,namespaces:g,sessionProperties:m,pairingTopic:D}=s.params,I=ur({topic:t,relay:d,expiry:y,namespaces:g,acknowledged:!0,pairingTopic:D,requiredNamespaces:{},optionalNamespaces:{},controller:f.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:f.publicKey,metadata:f.metadata}},m&&{sessionProperties:m});await this.sendResult({id:s.id,topic:t,result:!0}),this.events.emit($t("session_connect"),{session:I}),this.cleanupDuplicatePairings(I)}catch(d){await this.sendError(o,t,d),this.client.logger.error(d)}},this.onSessionSettleResponse=async(t,s)=>{const{id:o}=s;Ii(s)?(await this.client.session.update(t,{acknowledged:!0}),this.events.emit($t("session_approve",o),{})):Yr(s)&&(await this.client.session.delete(t,_t("USER_DISCONNECTED")),this.events.emit($t("session_approve",o),{error:s.error}))},this.onSessionUpdateRequest=async(t,s)=>{const{params:o,id:c}=s;try{const d=`${t}_session_update`,f=Fo.get(d);if(f&&this.isRequestOutOfSync(f,c)){this.client.logger.info(`Discarding out of sync request - ${c}`);return}this.isValidUpdate(ur({topic:t},o)),await this.client.session.update(t,{namespaces:o.namespaces}),await this.sendResult({id:c,topic:t,result:!0}),this.client.events.emit("session_update",{id:c,topic:t,params:o}),Fo.set(d,c)}catch(d){await this.sendError(c,t,d),this.client.logger.error(d)}},this.isRequestOutOfSync=(t,s)=>parseInt(s.toString().slice(0,-3))<=parseInt(t.toString().slice(0,-3)),this.onSessionUpdateResponse=(t,s)=>{const{id:o}=s;Ii(s)?this.events.emit($t("session_update",o),{}):Yr(s)&&this.events.emit($t("session_update",o),{error:s.error})},this.onSessionExtendRequest=async(t,s)=>{const{id:o}=s;try{this.isValidExtend({topic:t}),await this.setExpiry(t,Pr(Ho)),await this.sendResult({id:o,topic:t,result:!0}),this.client.events.emit("session_extend",{id:o,topic:t})}catch(c){await this.sendError(o,t,c),this.client.logger.error(c)}},this.onSessionExtendResponse=(t,s)=>{const{id:o}=s;Ii(s)?this.events.emit($t("session_extend",o),{}):Yr(s)&&this.events.emit($t("session_extend",o),{error:s.error})},this.onSessionPingRequest=async(t,s)=>{const{id:o}=s;try{this.isValidPing({topic:t}),await this.sendResult({id:o,topic:t,result:!0}),this.client.events.emit("session_ping",{id:o,topic:t})}catch(c){await this.sendError(o,t,c),this.client.logger.error(c)}},this.onSessionPingResponse=(t,s)=>{const{id:o}=s;setTimeout(()=>{Ii(s)?this.events.emit($t("session_ping",o),{}):Yr(s)&&this.events.emit($t("session_ping",o),{error:s.error})},500)},this.onSessionDeleteRequest=async(t,s)=>{const{id:o}=s;try{this.isValidDisconnect({topic:t,reason:s.params}),await Promise.all([new Promise(c=>{this.client.core.relayer.once(tr.publish,async()=>{c(await this.deleteSession({topic:t,id:o}))})}),this.sendResult({id:o,topic:t,result:!0}),this.cleanupPendingSentRequestsForTopic({topic:t,error:_t("USER_DISCONNECTED")})])}catch(c){this.client.logger.error(c)}},this.onSessionRequest=async(t,s)=>{const{id:o,params:c}=s;try{this.isValidRequest(ur({topic:t},c));const d=Fn(JSON.stringify(zn("wc_sessionRequest",c,o))),f=this.client.session.get(t),y=await this.getVerifyContext(d,f.peer.metadata),g={id:o,topic:t,params:c,verifyContext:y};await this.setPendingSessionRequest(g),this.addSessionRequestToSessionRequestQueue(g),this.processSessionRequestQueue()}catch(d){await this.sendError(o,t,d),this.client.logger.error(d)}},this.onSessionRequestResponse=(t,s)=>{const{id:o}=s;Ii(s)?this.events.emit($t("session_request",o),{result:s.result}):Yr(s)&&this.events.emit($t("session_request",o),{error:s.error})},this.onSessionEventRequest=async(t,s)=>{const{id:o,params:c}=s;try{const d=`${t}_session_event_${c.event.name}`,f=Fo.get(d);if(f&&this.isRequestOutOfSync(f,o)){this.client.logger.info(`Discarding out of sync request - ${o}`);return}this.isValidEmit(ur({topic:t},c)),this.client.events.emit("session_event",{id:o,topic:t,params:c}),Fo.set(d,o)}catch(d){await this.sendError(o,t,d),this.client.logger.error(d)}},this.addSessionRequestToSessionRequestQueue=t=>{this.sessionRequestQueue.queue.push(t)},this.cleanupAfterResponse=t=>{this.deletePendingSessionRequest(t.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=Si.idle,this.processSessionRequestQueue()},ve.toMiliseconds(this.requestQueueDelay))},this.cleanupPendingSentRequestsForTopic=({topic:t,error:s})=>{const o=this.client.core.history.pending;o.length>0&&o.filter(c=>c.topic===t&&c.request.method==="wc_sessionRequest").forEach(c=>{this.events.emit($t("session_request",c.request.id),{error:s})})},this.processSessionRequestQueue=()=>{if(this.sessionRequestQueue.state===Si.active){this.client.logger.info("session request queue is already active.");return}const t=this.sessionRequestQueue.queue[0];if(!t){this.client.logger.info("session request queue is empty.");return}try{this.sessionRequestQueue.state=Si.active,this.client.events.emit("session_request",t)}catch(s){this.client.logger.error(s)}},this.onPairingCreated=t=>{if(t.active)return;const s=this.client.proposal.getAll().find(o=>o.pairingTopic===t.topic);s&&this.onSessionProposeRequest(t.topic,zn("wc_sessionPropose",{requiredNamespaces:s.requiredNamespaces,optionalNamespaces:s.optionalNamespaces,relays:s.relays,proposer:s.proposer,sessionProperties:s.sessionProperties},s.id))},this.isValidConnect=async t=>{if(!_r(t)){const{message:y}=ce("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(t)}`);throw new Error(y)}const{pairingTopic:s,requiredNamespaces:o,optionalNamespaces:c,sessionProperties:d,relays:f}=t;if(hr(s)||await this.isValidPairingTopic(s),!bD(f,!0)){const{message:y}=ce("MISSING_OR_INVALID",`connect() relays: ${f}`);throw new Error(y)}!hr(o)&&Os(o)!==0&&this.validateNamespaces(o,"requiredNamespaces"),!hr(c)&&Os(c)!==0&&this.validateNamespaces(c,"optionalNamespaces"),hr(d)||this.validateSessionProps(d,"sessionProperties")},this.validateNamespaces=(t,s)=>{const o=_D(t,"connect()",s);if(o)throw new Error(o.message)},this.isValidApprove=async t=>{if(!_r(t))throw new Error(ce("MISSING_OR_INVALID",`approve() params: ${t}`).message);const{id:s,namespaces:o,relayProtocol:c,sessionProperties:d}=t;await this.isValidProposalId(s);const f=this.client.proposal.get(s),y=Hc(o,"approve()");if(y)throw new Error(y.message);const g=Af(f.requiredNamespaces,o,"approve()");if(g)throw new Error(g.message);if(!Wt(c,!0)){const{message:m}=ce("MISSING_OR_INVALID",`approve() relayProtocol: ${c}`);throw new Error(m)}hr(d)||this.validateSessionProps(d,"sessionProperties")},this.isValidReject=async t=>{if(!_r(t)){const{message:c}=ce("MISSING_OR_INVALID",`reject() params: ${t}`);throw new Error(c)}const{id:s,reason:o}=t;if(await this.isValidProposalId(s),!DD(o)){const{message:c}=ce("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(o)}`);throw new Error(c)}},this.isValidSessionSettleRequest=t=>{if(!_r(t)){const{message:g}=ce("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${t}`);throw new Error(g)}const{relay:s,controller:o,namespaces:c,expiry:d}=t;if(!dp(s)){const{message:g}=ce("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(g)}const f=pD(o,"onSessionSettleRequest()");if(f)throw new Error(f.message);const y=Hc(c,"onSessionSettleRequest()");if(y)throw new Error(y.message);if(qi(d)){const{message:g}=ce("EXPIRED","onSessionSettleRequest()");throw new Error(g)}},this.isValidUpdate=async t=>{if(!_r(t)){const{message:y}=ce("MISSING_OR_INVALID",`update() params: ${t}`);throw new Error(y)}const{topic:s,namespaces:o}=t;await this.isValidSessionTopic(s);const c=this.client.session.get(s),d=Hc(o,"update()");if(d)throw new Error(d.message);const f=Af(c.requiredNamespaces,o,"update()");if(f)throw new Error(f.message)},this.isValidExtend=async t=>{if(!_r(t)){const{message:o}=ce("MISSING_OR_INVALID",`extend() params: ${t}`);throw new Error(o)}const{topic:s}=t;await this.isValidSessionTopic(s)},this.isValidRequest=async t=>{if(!_r(t)){const{message:y}=ce("MISSING_OR_INVALID",`request() params: ${t}`);throw new Error(y)}const{topic:s,request:o,chainId:c,expiry:d}=t;await this.isValidSessionTopic(s);const{namespaces:f}=this.client.session.get(s);if(!Cf(f,c)){const{message:y}=ce("MISSING_OR_INVALID",`request() chainId: ${c}`);throw new Error(y)}if(!SD(o)){const{message:y}=ce("MISSING_OR_INVALID",`request() ${JSON.stringify(o)}`);throw new Error(y)}if(!OD(f,c,o.method)){const{message:y}=ce("MISSING_OR_INVALID",`request() method: ${o.method}`);throw new Error(y)}if(d&&!TD(d,tu)){const{message:y}=ce("MISSING_OR_INVALID",`request() expiry: ${d}. Expiry must be a number (in seconds) between ${tu.min} and ${tu.max}`);throw new Error(y)}},this.isValidRespond=async t=>{var s;if(!_r(t)){const{message:d}=ce("MISSING_OR_INVALID",`respond() params: ${t}`);throw new Error(d)}const{topic:o,response:c}=t;try{await this.isValidSessionTopic(o)}catch(d){throw(s=t==null?void 0:t.response)!=null&&s.id&&this.cleanupAfterResponse(t),d}if(!ID(c)){const{message:d}=ce("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(c)}`);throw new Error(d)}},this.isValidPing=async t=>{if(!_r(t)){const{message:o}=ce("MISSING_OR_INVALID",`ping() params: ${t}`);throw new Error(o)}const{topic:s}=t;await this.isValidSessionOrPairingTopic(s)},this.isValidEmit=async t=>{if(!_r(t)){const{message:f}=ce("MISSING_OR_INVALID",`emit() params: ${t}`);throw new Error(f)}const{topic:s,event:o,chainId:c}=t;await this.isValidSessionTopic(s);const{namespaces:d}=this.client.session.get(s);if(!Cf(d,c)){const{message:f}=ce("MISSING_OR_INVALID",`emit() chainId: ${c}`);throw new Error(f)}if(!xD(o)){const{message:f}=ce("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(f)}if(!PD(d,c,o.name)){const{message:f}=ce("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(f)}},this.isValidDisconnect=async t=>{if(!_r(t)){const{message:o}=ce("MISSING_OR_INVALID",`disconnect() params: ${t}`);throw new Error(o)}const{topic:s}=t;await this.isValidSessionOrPairingTopic(s)},this.getVerifyContext=async(t,s)=>{const o={verified:{verifyUrl:s.verifyUrl||qn,validation:"UNKNOWN",origin:s.url||""}};try{const c=await this.client.core.verify.resolve({attestationId:t,verifyUrl:s.verifyUrl});c&&(o.verified.origin=c.origin,o.verified.isScam=c.isScam,o.verified.validation=c.origin===new URL(s.url).origin?"VALID":"INVALID")}catch(c){this.client.logger.info(c)}return this.client.logger.info(`Verify context: ${JSON.stringify(o)}`),o},this.validateSessionProps=(t,s)=>{Object.values(t).forEach(o=>{if(!Wt(o,!1)){const{message:c}=ce("MISSING_OR_INVALID",`${s} must be in Record<string, string> format. Received: ${JSON.stringify(o)}`);throw new Error(c)}})}}async isInitialized(){if(!this.initialized){const{message:e}=ce("NOT_INITIALIZED",this.name);throw new Error(e)}await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(tr.message,async e=>{const{topic:t,message:s}=e;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(s)))return;const o=await this.client.core.crypto.decode(t,s);try{Gu(o)?(this.client.core.history.set(t,o),this.onRelayEventRequest({topic:t,payload:o})):ha(o)?(await this.client.core.history.resolve(o),await this.onRelayEventResponse({topic:t,payload:o}),this.client.core.history.delete(t,o.id)):this.onRelayEventUnknownPayload({topic:t,payload:o})}catch(c){this.client.logger.error(c)}})}registerExpirerEvents(){this.client.core.expirer.on(Fr.expired,async e=>{const{topic:t,id:s}=lp(e.target);if(s&&this.client.pendingRequest.keys.includes(s))return await this.deletePendingSessionRequest(s,ce("EXPIRED"),!0);t?this.client.session.keys.includes(t)&&(await this.deleteSession({topic:t,expirerHasDeleted:!0}),this.client.events.emit("session_expire",{topic:t})):s&&(await this.deleteProposal(s,!0),this.client.events.emit("proposal_expire",{id:s}))})}registerPairingEvents(){this.client.core.pairing.events.on(bs.create,e=>this.onPairingCreated(e))}isValidPairingTopic(e){if(!Wt(e,!1)){const{message:t}=ce("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(t)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:t}=ce("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(t)}if(qi(this.client.core.pairing.pairings.get(e).expiry)){const{message:t}=ce("EXPIRED",`pairing topic: ${e}`);throw new Error(t)}}async isValidSessionTopic(e){if(!Wt(e,!1)){const{message:t}=ce("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(t)}if(!this.client.session.keys.includes(e)){const{message:t}=ce("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(t)}if(qi(this.client.session.get(e).expiry)){await this.deleteSession({topic:e});const{message:t}=ce("EXPIRED",`session topic: ${e}`);throw new Error(t)}if(!this.client.core.crypto.keychain.has(e)){const{message:t}=ce("MISSING_OR_INVALID",`session topic does not exist in keychain: ${e}`);throw await this.deleteSession({topic:e}),new Error(t)}}async isValidSessionOrPairingTopic(e){if(this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(Wt(e,!1)){const{message:t}=ce("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(t)}else{const{message:t}=ce("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(t)}}async isValidProposalId(e){if(!ED(e)){const{message:t}=ce("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(t)}if(!this.client.proposal.keys.includes(e)){const{message:t}=ce("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(t)}if(qi(this.client.proposal.get(e).expiryTimestamp)){await this.deleteProposal(e);const{message:t}=ce("EXPIRED",`proposal id: ${e}`);throw new Error(t)}}}class hI extends fa{constructor(e,t){super(e,t,Z2,Ju),this.core=e,this.logger=t}}let lI=class extends fa{constructor(e,t){super(e,t,eI,Ju),this.core=e,this.logger=t}};class fI extends fa{constructor(e,t){super(e,t,rI,Ju,s=>s.id),this.core=e,this.logger=t}}let dI=class Wp extends U3{constructor(e){super(e),this.protocol=Kp,this.version=kp,this.name=eu.name,this.events=new zr.EventEmitter,this.on=(s,o)=>this.events.on(s,o),this.once=(s,o)=>this.events.once(s,o),this.off=(s,o)=>this.events.off(s,o),this.removeListener=(s,o)=>this.events.removeListener(s,o),this.removeAllListeners=s=>this.events.removeAllListeners(s),this.connect=async s=>{try{return await this.engine.connect(s)}catch(o){throw this.logger.error(o.message),o}},this.pair=async s=>{try{return await this.engine.pair(s)}catch(o){throw this.logger.error(o.message),o}},this.approve=async s=>{try{return await this.engine.approve(s)}catch(o){throw this.logger.error(o.message),o}},this.reject=async s=>{try{return await this.engine.reject(s)}catch(o){throw this.logger.error(o.message),o}},this.update=async s=>{try{return await this.engine.update(s)}catch(o){throw this.logger.error(o.message),o}},this.extend=async s=>{try{return await this.engine.extend(s)}catch(o){throw this.logger.error(o.message),o}},this.request=async s=>{try{return await this.engine.request(s)}catch(o){throw this.logger.error(o.message),o}},this.respond=async s=>{try{return await this.engine.respond(s)}catch(o){throw this.logger.error(o.message),o}},this.ping=async s=>{try{return await this.engine.ping(s)}catch(o){throw this.logger.error(o.message),o}},this.emit=async s=>{try{return await this.engine.emit(s)}catch(o){throw this.logger.error(o.message),o}},this.disconnect=async s=>{try{return await this.engine.disconnect(s)}catch(o){throw this.logger.error(o.message),o}},this.find=s=>{try{return this.engine.find(s)}catch(o){throw this.logger.error(o.message),o}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(s){throw this.logger.error(s.message),s}},this.name=(e==null?void 0:e.name)||eu.name,this.metadata=(e==null?void 0:e.metadata)||ME();const t=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:Je.pino(Je.getDefaultLoggerOptions({level:(e==null?void 0:e.logger)||eu.logger}));this.core=(e==null?void 0:e.core)||new X2(e),this.logger=Je.generateChildLogger(t,this.name),this.session=new lI(this.core,this.logger),this.proposal=new hI(this.core,this.logger),this.pendingRequest=new fI(this.core,this.logger),this.engine=new uI(this)}static async init(e){const t=new Wp(e);return await t.initialize(),t}get context(){return Je.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}};var Su={exports:{}};(function(i,e){var t=typeof self<"u"?self:Jr,s=function(){function c(){this.fetch=!1,this.DOMException=t.DOMException}return c.prototype=t,new c}();(function(c){(function(d){var f={searchParams:"URLSearchParams"in c,iterable:"Symbol"in c&&"iterator"in Symbol,blob:"FileReader"in c&&"Blob"in c&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in c,arrayBuffer:"ArrayBuffer"in c};function y(b){return b&&DataView.prototype.isPrototypeOf(b)}if(f.arrayBuffer)var g=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],m=ArrayBuffer.isView||function(b){return b&&g.indexOf(Object.prototype.toString.call(b))>-1};function D(b){if(typeof b!="string"&&(b=String(b)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(b))throw new TypeError("Invalid character in header field name");return b.toLowerCase()}function I(b){return typeof b!="string"&&(b=String(b)),b}function T(b){var C={next:function(){var ee=b.shift();return{done:ee===void 0,value:ee}}};return f.iterable&&(C[Symbol.iterator]=function(){return C}),C}function P(b){this.map={},b instanceof P?b.forEach(function(C,ee){this.append(ee,C)},this):Array.isArray(b)?b.forEach(function(C){this.append(C[0],C[1])},this):b&&Object.getOwnPropertyNames(b).forEach(function(C){this.append(C,b[C])},this)}P.prototype.append=function(b,C){b=D(b),C=I(C);var ee=this.map[b];this.map[b]=ee?ee+", "+C:C},P.prototype.delete=function(b){delete this.map[D(b)]},P.prototype.get=function(b){return b=D(b),this.has(b)?this.map[b]:null},P.prototype.has=function(b){return this.map.hasOwnProperty(D(b))},P.prototype.set=function(b,C){this.map[D(b)]=I(C)},P.prototype.forEach=function(b,C){for(var ee in this.map)this.map.hasOwnProperty(ee)&&b.call(C,this.map[ee],ee,this)},P.prototype.keys=function(){var b=[];return this.forEach(function(C,ee){b.push(ee)}),T(b)},P.prototype.values=function(){var b=[];return this.forEach(function(C){b.push(C)}),T(b)},P.prototype.entries=function(){var b=[];return this.forEach(function(C,ee){b.push([ee,C])}),T(b)},f.iterable&&(P.prototype[Symbol.iterator]=P.prototype.entries);function z(b){if(b.bodyUsed)return Promise.reject(new TypeError("Already read"));b.bodyUsed=!0}function H(b){return new Promise(function(C,ee){b.onload=function(){C(b.result)},b.onerror=function(){ee(b.error)}})}function ie(b){var C=new FileReader,ee=H(C);return C.readAsArrayBuffer(b),ee}function U(b){var C=new FileReader,ee=H(C);return C.readAsText(b),ee}function j(b){for(var C=new Uint8Array(b),ee=new Array(C.length),Q=0;Q<C.length;Q++)ee[Q]=String.fromCharCode(C[Q]);return ee.join("")}function O(b){if(b.slice)return b.slice(0);var C=new Uint8Array(b.byteLength);return C.set(new Uint8Array(b)),C.buffer}function A(){return this.bodyUsed=!1,this._initBody=function(b){this._bodyInit=b,b?typeof b=="string"?this._bodyText=b:f.blob&&Blob.prototype.isPrototypeOf(b)?this._bodyBlob=b:f.formData&&FormData.prototype.isPrototypeOf(b)?this._bodyFormData=b:f.searchParams&&URLSearchParams.prototype.isPrototypeOf(b)?this._bodyText=b.toString():f.arrayBuffer&&f.blob&&y(b)?(this._bodyArrayBuffer=O(b.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):f.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(b)||m(b))?this._bodyArrayBuffer=O(b):this._bodyText=b=Object.prototype.toString.call(b):this._bodyText="",this.headers.get("content-type")||(typeof b=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):f.searchParams&&URLSearchParams.prototype.isPrototypeOf(b)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},f.blob&&(this.blob=function(){var b=z(this);if(b)return b;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?z(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(ie)}),this.text=function(){var b=z(this);if(b)return b;if(this._bodyBlob)return U(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(j(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},f.formData&&(this.formData=function(){return this.text().then(G)}),this.json=function(){return this.text().then(JSON.parse)},this}var E=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function u(b){var C=b.toUpperCase();return E.indexOf(C)>-1?C:b}function _(b,C){C=C||{};var ee=C.body;if(b instanceof _){if(b.bodyUsed)throw new TypeError("Already read");this.url=b.url,this.credentials=b.credentials,C.headers||(this.headers=new P(b.headers)),this.method=b.method,this.mode=b.mode,this.signal=b.signal,!ee&&b._bodyInit!=null&&(ee=b._bodyInit,b.bodyUsed=!0)}else this.url=String(b);if(this.credentials=C.credentials||this.credentials||"same-origin",(C.headers||!this.headers)&&(this.headers=new P(C.headers)),this.method=u(C.method||this.method||"GET"),this.mode=C.mode||this.mode||null,this.signal=C.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&ee)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(ee)}_.prototype.clone=function(){return new _(this,{body:this._bodyInit})};function G(b){var C=new FormData;return b.trim().split("&").forEach(function(ee){if(ee){var Q=ee.split("="),k=Q.shift().replace(/\+/g," "),V=Q.join("=").replace(/\+/g," ");C.append(decodeURIComponent(k),decodeURIComponent(V))}}),C}function W(b){var C=new P,ee=b.replace(/\r?\n[\t ]+/g," ");return ee.split(/\r?\n/).forEach(function(Q){var k=Q.split(":"),V=k.shift().trim();if(V){var J=k.join(":").trim();C.append(V,J)}}),C}A.call(_.prototype);function se(b,C){C||(C={}),this.type="default",this.status=C.status===void 0?200:C.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in C?C.statusText:"OK",this.headers=new P(C.headers),this.url=C.url||"",this._initBody(b)}A.call(se.prototype),se.prototype.clone=function(){return new se(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new P(this.headers),url:this.url})},se.error=function(){var b=new se(null,{status:0,statusText:""});return b.type="error",b};var ue=[301,302,303,307,308];se.redirect=function(b,C){if(ue.indexOf(C)===-1)throw new RangeError("Invalid status code");return new se(null,{status:C,headers:{location:b}})},d.DOMException=c.DOMException;try{new d.DOMException}catch{d.DOMException=function(C,ee){this.message=C,this.name=ee;var Q=Error(C);this.stack=Q.stack},d.DOMException.prototype=Object.create(Error.prototype),d.DOMException.prototype.constructor=d.DOMException}function de(b,C){return new Promise(function(ee,Q){var k=new _(b,C);if(k.signal&&k.signal.aborted)return Q(new d.DOMException("Aborted","AbortError"));var V=new XMLHttpRequest;function J(){V.abort()}V.onload=function(){var re={status:V.status,statusText:V.statusText,headers:W(V.getAllResponseHeaders()||"")};re.url="responseURL"in V?V.responseURL:re.headers.get("X-Request-URL");var _e="response"in V?V.response:V.responseText;ee(new se(_e,re))},V.onerror=function(){Q(new TypeError("Network request failed"))},V.ontimeout=function(){Q(new TypeError("Network request failed"))},V.onabort=function(){Q(new d.DOMException("Aborted","AbortError"))},V.open(k.method,k.url,!0),k.credentials==="include"?V.withCredentials=!0:k.credentials==="omit"&&(V.withCredentials=!1),"responseType"in V&&f.blob&&(V.responseType="blob"),k.headers.forEach(function(re,_e){V.setRequestHeader(_e,re)}),k.signal&&(k.signal.addEventListener("abort",J),V.onreadystatechange=function(){V.readyState===4&&k.signal.removeEventListener("abort",J)}),V.send(typeof k._bodyInit>"u"?null:k._bodyInit)})}return de.polyfill=!0,c.fetch||(c.fetch=de,c.Headers=P,c.Request=_,c.Response=se),d.Headers=P,d.Request=_,d.Response=se,d.fetch=de,Object.defineProperty(d,"__esModule",{value:!0}),d})({})})(s),s.fetch.ponyfill=!0,delete s.fetch.polyfill;var o=s;e=o.fetch,e.default=o.fetch,e.fetch=o.fetch,e.Headers=o.Headers,e.Request=o.Request,e.Response=o.Response,i.exports=e})(Su,Su.exports);var pI=Su.exports;const Dd=Au(pI),gI={Accept:"application/json","Content-Type":"application/json"},yI="POST",Sd={headers:gI,method:yI},Id=10;class Hi{constructor(e,t=!1){if(this.url=e,this.disableProviderPing=t,this.events=new zr.EventEmitter,this.isAvailable=!1,this.registering=!1,!Qf(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);this.url=e,this.disableProviderPing=t}get connected(){return this.isAvailable}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(e=this.url){await this.register(e)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(e,t){this.isAvailable||await this.register();try{const s=hn(e),c=await(await Dd(this.url,Object.assign(Object.assign({},Sd),{body:s}))).json();this.onPayload({data:c})}catch(s){this.onError(e.id,s)}}async register(e=this.url){if(!Qf(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);if(this.registering){const t=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t)&&this.events.setMaxListeners(t+1),new Promise((s,o)=>{this.events.once("register_error",c=>{this.resetMaxListeners(),o(c)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return o(new Error("HTTP connection is missing or invalid"));s()})})}this.url=e,this.registering=!0;try{if(!this.disableProviderPing){const t=hn({id:1,jsonrpc:"2.0",method:"test",params:[]});await Dd(e,Object.assign(Object.assign({},Sd),{body:t}))}this.onOpen()}catch(t){const s=this.parseError(t);throw this.events.emit("register_error",s),this.onClose(),s}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const t=typeof e.data=="string"?Ns(e.data):e.data;this.events.emit("payload",t)}onError(e,t){const s=this.parseError(t),o=s.message||s.toString(),c=ua(e,o);this.events.emit("payload",c)}parseError(e,t=this.url){return Ip(e,t,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>Id&&this.events.setMaxListeners(Id)}}const xd="error",vI="wss://relay.walletconnect.com",mI="wc",wI="universal_provider",Od=`${mI}@2:${wI}:`,_I="https://rpc.walletconnect.com/v1/",Oi={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var ws=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof st<"u"?st:typeof self<"u"?self:{},Iu={exports:{}};/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(i,e){(function(){var t,s="4.17.21",o=200,c="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",d="Expected a function",f="Invalid `variable` option passed into `_.template`",y="__lodash_hash_undefined__",g=500,m="__lodash_placeholder__",D=1,I=2,T=4,P=1,z=2,H=1,ie=2,U=4,j=8,O=16,A=32,E=64,u=128,_=256,G=512,W=30,se="...",ue=800,de=16,b=1,C=2,ee=3,Q=1/0,k=9007199254740991,V=17976931348623157e292,J=NaN,re=4294967295,_e=re-1,oe=re>>>1,be=[["ary",u],["bind",H],["bindKey",ie],["curry",j],["curryRight",O],["flip",G],["partial",A],["partialRight",E],["rearg",_]],le="[object Arguments]",me="[object Array]",B="[object AsyncFunction]",F="[object Boolean]",$="[object Date]",l="[object DOMException]",R="[object Error]",ae="[object Function]",fe="[object GeneratorFunction]",Ie="[object Map]",Be="[object Number]",ke="[object Null]",Me="[object Object]",gt="[object Promise]",yt="[object Proxy]",qe="[object RegExp]",xe="[object Set]",Ne="[object String]",Ue="[object Symbol]",Fe="[object Undefined]",Pe="[object WeakMap]",$e="[object WeakSet]",Se="[object ArrayBuffer]",Ce="[object DataView]",He="[object Float32Array]",Oe="[object Float64Array]",Ve="[object Int8Array]",We="[object Int16Array]",et="[object Int32Array]",tt="[object Uint8Array]",Qe="[object Uint8ClampedArray]",rr="[object Uint16Array]",dr="[object Uint32Array]",Qr=/\b__p \+= '';/g,ir=/\b(__p \+=) '' \+/g,ci=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Pi=/&(?:amp|lt|gt|quot|#39);/g,Ki=/[&<>"']/g,St=RegExp(Pi.source),vt=RegExp(Ki.source),It=/<%-([\s\S]+?)%>/g,xt=/<%([\s\S]+?)%>/g,Et=/<%=([\s\S]+?)%>/g,mt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Lt=/^\w*$/,Mt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Ot=/[\\^$.*+?()[\]{}|]/g,jt=RegExp(Ot.source),Pt=/^\s+/,Tt=/\s/,Ct=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,lt=/\{\n\/\* \[wrapped with (.+)\] \*/,qt=/,? & /,Ft=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,da=/[()=,{}\[\]\/\s]/,pa=/\\(\\)?/g,ga=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Tr=/\w*$/,ya=/^[-+]0x[0-9a-f]+$/i,va=/^0b[01]+$/i,ma=/^\[object .+?Constructor\]$/,wa=/^0o[0-7]+$/i,_a=/^(?:0|[1-9]\d*)$/,ui=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,yn=/($^)/,ba=/['\n\r\u2028\u2029\\]/g,vn="\\ud800-\\udfff",Ea="\\u0300-\\u036f",Da="\\ufe20-\\ufe2f",mn="\\u20d0-\\u20ff",$s=Ea+Da+mn,Ls="\\u2700-\\u27bf",Br="a-z\\xdf-\\xf6\\xf8-\\xff",Sa="\\xac\\xb1\\xd7\\xf7",Ia="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",xa="\\u2000-\\u206f",Oa=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Ms="A-Z\\xc0-\\xd6\\xd8-\\xde",js="\\ufe0e\\ufe0f",ki=Sa+Ia+xa+Oa,Wn="['â€™]",Vi="["+vn+"]",Yn="["+ki+"]",Gi="["+$s+"]",qs="\\d+",Pa="["+Ls+"]",Fs="["+Br+"]",zs="[^"+vn+ki+qs+Ls+Br+Ms+"]",wn="\\ud83c[\\udffb-\\udfff]",Ca="(?:"+Gi+"|"+wn+")",Bs="[^"+vn+"]",_n="(?:\\ud83c[\\udde6-\\uddff]){2}",Ci="[\\ud800-\\udbff][\\udc00-\\udfff]",Er="["+Ms+"]",Hs="\\u200d",Ks="(?:"+Fs+"|"+zs+")",Xr="(?:"+Er+"|"+zs+")",ks="(?:"+Wn+"(?:d|ll|m|re|s|t|ve))?",Vs="(?:"+Wn+"(?:D|LL|M|RE|S|T|VE))?",Gs=Ca+"?",Ws="["+js+"]?",Aa="(?:"+Hs+"(?:"+[Bs,_n,Ci].join("|")+")"+Ws+Gs+")*",hi="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Ys="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Js=Ws+Gs+Aa,bn="(?:"+[Pa,_n,Ci].join("|")+")"+Js,Ta="(?:"+[Bs+Gi+"?",Gi,_n,Ci,Vi].join("|")+")",Jn=RegExp(Wn,"g"),Ra=RegExp(Gi,"g"),En=RegExp(wn+"(?="+wn+")|"+Ta+Js,"g"),Qs=RegExp([Er+"?"+Fs+"+"+ks+"(?="+[Yn,Er,"$"].join("|")+")",Xr+"+"+Vs+"(?="+[Yn,Er+Ks,"$"].join("|")+")",Er+"?"+Ks+"+"+ks,Er+"+"+Vs,Ys,hi,qs,bn].join("|"),"g"),Xs=RegExp("["+Hs+vn+$s+js+"]"),Wi=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Zs=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Na=-1,at={};at[He]=at[Oe]=at[Ve]=at[We]=at[et]=at[tt]=at[Qe]=at[rr]=at[dr]=!0,at[le]=at[me]=at[Se]=at[F]=at[Ce]=at[$]=at[R]=at[ae]=at[Ie]=at[Be]=at[Me]=at[qe]=at[xe]=at[Ne]=at[Pe]=!1;var ot={};ot[le]=ot[me]=ot[Se]=ot[Ce]=ot[F]=ot[$]=ot[He]=ot[Oe]=ot[Ve]=ot[We]=ot[et]=ot[Ie]=ot[Be]=ot[Me]=ot[qe]=ot[xe]=ot[Ne]=ot[Ue]=ot[tt]=ot[Qe]=ot[rr]=ot[dr]=!0,ot[R]=ot[ae]=ot[Pe]=!1;var S={Ã€:"A",Ã:"A",Ã‚:"A",Ãƒ:"A",Ã„:"A",Ã…:"A",Ã :"a",Ã¡:"a",Ã¢:"a",Ã£:"a",Ã¤:"a",Ã¥:"a",Ã‡:"C",Ã§:"c",Ã:"D",Ã°:"d",Ãˆ:"E",Ã‰:"E",ÃŠ:"E",Ã‹:"E",Ã¨:"e",Ã©:"e",Ãª:"e",Ã«:"e",ÃŒ:"I",Ã:"I",ÃŽ:"I",Ã:"I",Ã¬:"i",Ã­:"i",Ã®:"i",Ã¯:"i",Ã‘:"N",Ã±:"n",Ã’:"O",Ã“:"O",Ã”:"O",Ã•:"O",Ã–:"O",Ã˜:"O",Ã²:"o",Ã³:"o",Ã´:"o",Ãµ:"o",Ã¶:"o",Ã¸:"o",Ã™:"U",Ãš:"U",Ã›:"U",Ãœ:"U",Ã¹:"u",Ãº:"u",Ã»:"u",Ã¼:"u",Ã:"Y",Ã½:"y",Ã¿:"y",Ã†:"Ae",Ã¦:"ae",Ãž:"Th",Ã¾:"th",ÃŸ:"ss",Ä€:"A",Ä‚:"A",Ä„:"A",Ä:"a",Äƒ:"a",Ä…:"a",Ä†:"C",Äˆ:"C",ÄŠ:"C",ÄŒ:"C",Ä‡:"c",Ä‰:"c",Ä‹:"c",Ä:"c",ÄŽ:"D",Ä:"D",Ä:"d",Ä‘:"d",Ä’:"E",Ä”:"E",Ä–:"E",Ä˜:"E",Äš:"E",Ä“:"e",Ä•:"e",Ä—:"e",Ä™:"e",Ä›:"e",Äœ:"G",Äž:"G",Ä :"G",Ä¢:"G",Ä:"g",ÄŸ:"g",Ä¡:"g",Ä£:"g",Ä¤:"H",Ä¦:"H",Ä¥:"h",Ä§:"h",Ä¨:"I",Äª:"I",Ä¬:"I",Ä®:"I",Ä°:"I",Ä©:"i",Ä«:"i",Ä­:"i",Ä¯:"i",Ä±:"i",Ä´:"J",Äµ:"j",Ä¶:"K",Ä·:"k",Ä¸:"k",Ä¹:"L",Ä»:"L",Ä½:"L",Ä¿:"L",Å:"L",Äº:"l",Ä¼:"l",Ä¾:"l",Å€:"l",Å‚:"l",Åƒ:"N",Å…:"N",Å‡:"N",ÅŠ:"N",Å„:"n",Å†:"n",Åˆ:"n",Å‹:"n",ÅŒ:"O",ÅŽ:"O",Å:"O",Å:"o",Å:"o",Å‘:"o",Å”:"R",Å–:"R",Å˜:"R",Å•:"r",Å—:"r",Å™:"r",Åš:"S",Åœ:"S",Åž:"S",Å :"S",Å›:"s",Å:"s",ÅŸ:"s",Å¡:"s",Å¢:"T",Å¤:"T",Å¦:"T",Å£:"t",Å¥:"t",Å§:"t",Å¨:"U",Åª:"U",Å¬:"U",Å®:"U",Å°:"U",Å²:"U",Å©:"u",Å«:"u",Å­:"u",Å¯:"u",Å±:"u",Å³:"u",Å´:"W",Åµ:"w",Å¶:"Y",Å·:"y",Å¸:"Y",Å¹:"Z",Å»:"Z",Å½:"Z",Åº:"z",Å¼:"z",Å¾:"z",Ä²:"IJ",Ä³:"ij",Å’:"Oe",Å“:"oe",Å‰:"'n",Å¿:"s"},L={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},te={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},pe={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},ct=parseFloat,Te=parseInt,dt=typeof ws=="object"&&ws&&ws.Object===Object&&ws,zt=typeof self=="object"&&self&&self.Object===Object&&self,Xe=dt||zt||Function("return this")(),ut=e&&!e.nodeType&&e,Rt=ut&&!0&&i&&!i.nodeType&&i,pr=Rt&&Rt.exports===ut,Bt=pr&&dt.process,pt=function(){try{var M=Rt&&Rt.require&&Rt.require("util").types;return M||Bt&&Bt.binding&&Bt.binding("util")}catch{}}(),nr=pt&&pt.isArrayBuffer,Hr=pt&&pt.isDate,Rr=pt&&pt.isMap,Zr=pt&&pt.isRegExp,Qn=pt&&pt.isSet,Yi=pt&&pt.isTypedArray;function kt(M,Y,K){switch(K.length){case 0:return M.call(Y);case 1:return M.call(Y,K[0]);case 2:return M.call(Y,K[0],K[1]);case 3:return M.call(Y,K[0],K[1],K[2])}return M.apply(Y,K)}function Qp(M,Y,K,ge){for(var Ae=-1,rt=M==null?0:M.length;++Ae<rt;){var Ht=M[Ae];Y(ge,Ht,K(Ht),M)}return ge}function Nr(M,Y){for(var K=-1,ge=M==null?0:M.length;++K<ge&&Y(M[K],K,M)!==!1;);return M}function Xp(M,Y){for(var K=M==null?0:M.length;K--&&Y(M[K],K,M)!==!1;);return M}function Zu(M,Y){for(var K=-1,ge=M==null?0:M.length;++K<ge;)if(!Y(M[K],K,M))return!1;return!0}function Ai(M,Y){for(var K=-1,ge=M==null?0:M.length,Ae=0,rt=[];++K<ge;){var Ht=M[K];Y(Ht,K,M)&&(rt[Ae++]=Ht)}return rt}function eo(M,Y){var K=M==null?0:M.length;return!!K&&Dn(M,Y,0)>-1}function Ua(M,Y,K){for(var ge=-1,Ae=M==null?0:M.length;++ge<Ae;)if(K(Y,M[ge]))return!0;return!1}function wt(M,Y){for(var K=-1,ge=M==null?0:M.length,Ae=Array(ge);++K<ge;)Ae[K]=Y(M[K],K,M);return Ae}function Ti(M,Y){for(var K=-1,ge=Y.length,Ae=M.length;++K<ge;)M[Ae+K]=Y[K];return M}function $a(M,Y,K,ge){var Ae=-1,rt=M==null?0:M.length;for(ge&&rt&&(K=M[++Ae]);++Ae<rt;)K=Y(K,M[Ae],Ae,M);return K}function Zp(M,Y,K,ge){var Ae=M==null?0:M.length;for(ge&&Ae&&(K=M[--Ae]);Ae--;)K=Y(K,M[Ae],Ae,M);return K}function La(M,Y){for(var K=-1,ge=M==null?0:M.length;++K<ge;)if(Y(M[K],K,M))return!0;return!1}var eg=Ma("length");function tg(M){return M.split("")}function rg(M){return M.match(Ft)||[]}function eh(M,Y,K){var ge;return K(M,function(Ae,rt,Ht){if(Y(Ae,rt,Ht))return ge=rt,!1}),ge}function to(M,Y,K,ge){for(var Ae=M.length,rt=K+(ge?1:-1);ge?rt--:++rt<Ae;)if(Y(M[rt],rt,M))return rt;return-1}function Dn(M,Y,K){return Y===Y?pg(M,Y,K):to(M,th,K)}function ig(M,Y,K,ge){for(var Ae=K-1,rt=M.length;++Ae<rt;)if(ge(M[Ae],Y))return Ae;return-1}function th(M){return M!==M}function rh(M,Y){var K=M==null?0:M.length;return K?qa(M,Y)/K:J}function Ma(M){return function(Y){return Y==null?t:Y[M]}}function ja(M){return function(Y){return M==null?t:M[Y]}}function ih(M,Y,K,ge,Ae){return Ae(M,function(rt,Ht,ht){K=ge?(ge=!1,rt):Y(K,rt,Ht,ht)}),K}function ng(M,Y){var K=M.length;for(M.sort(Y);K--;)M[K]=M[K].value;return M}function qa(M,Y){for(var K,ge=-1,Ae=M.length;++ge<Ae;){var rt=Y(M[ge]);rt!==t&&(K=K===t?rt:K+rt)}return K}function Fa(M,Y){for(var K=-1,ge=Array(M);++K<M;)ge[K]=Y(K);return ge}function sg(M,Y){return wt(Y,function(K){return[K,M[K]]})}function nh(M){return M&&M.slice(0,ch(M)+1).replace(Pt,"")}function Dr(M){return function(Y){return M(Y)}}function za(M,Y){return wt(Y,function(K){return M[K]})}function Xn(M,Y){return M.has(Y)}function sh(M,Y){for(var K=-1,ge=M.length;++K<ge&&Dn(Y,M[K],0)>-1;);return K}function oh(M,Y){for(var K=M.length;K--&&Dn(Y,M[K],0)>-1;);return K}function og(M,Y){for(var K=M.length,ge=0;K--;)M[K]===Y&&++ge;return ge}var ag=ja(S),cg=ja(L);function ug(M){return"\\"+pe[M]}function hg(M,Y){return M==null?t:M[Y]}function Sn(M){return Xs.test(M)}function lg(M){return Wi.test(M)}function fg(M){for(var Y,K=[];!(Y=M.next()).done;)K.push(Y.value);return K}function Ba(M){var Y=-1,K=Array(M.size);return M.forEach(function(ge,Ae){K[++Y]=[Ae,ge]}),K}function ah(M,Y){return function(K){return M(Y(K))}}function Ri(M,Y){for(var K=-1,ge=M.length,Ae=0,rt=[];++K<ge;){var Ht=M[K];(Ht===Y||Ht===m)&&(M[K]=m,rt[Ae++]=K)}return rt}function ro(M){var Y=-1,K=Array(M.size);return M.forEach(function(ge){K[++Y]=ge}),K}function dg(M){var Y=-1,K=Array(M.size);return M.forEach(function(ge){K[++Y]=[ge,ge]}),K}function pg(M,Y,K){for(var ge=K-1,Ae=M.length;++ge<Ae;)if(M[ge]===Y)return ge;return-1}function gg(M,Y,K){for(var ge=K+1;ge--;)if(M[ge]===Y)return ge;return ge}function In(M){return Sn(M)?vg(M):eg(M)}function Kr(M){return Sn(M)?mg(M):tg(M)}function ch(M){for(var Y=M.length;Y--&&Tt.test(M.charAt(Y)););return Y}var yg=ja(te);function vg(M){for(var Y=En.lastIndex=0;En.test(M);)++Y;return Y}function mg(M){return M.match(En)||[]}function wg(M){return M.match(Qs)||[]}var _g=function M(Y){Y=Y==null?Xe:xn.defaults(Xe.Object(),Y,xn.pick(Xe,Zs));var K=Y.Array,ge=Y.Date,Ae=Y.Error,rt=Y.Function,Ht=Y.Math,ht=Y.Object,Ha=Y.RegExp,bg=Y.String,Ur=Y.TypeError,io=K.prototype,Eg=rt.prototype,On=ht.prototype,no=Y["__core-js_shared__"],so=Eg.toString,nt=On.hasOwnProperty,Dg=0,uh=function(){var r=/[^.]+$/.exec(no&&no.keys&&no.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""}(),oo=On.toString,Sg=so.call(ht),Ig=Xe._,xg=Ha("^"+so.call(nt).replace(Ot,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ao=pr?Y.Buffer:t,Ni=Y.Symbol,co=Y.Uint8Array,hh=ao?ao.allocUnsafe:t,uo=ah(ht.getPrototypeOf,ht),lh=ht.create,fh=On.propertyIsEnumerable,ho=io.splice,dh=Ni?Ni.isConcatSpreadable:t,Zn=Ni?Ni.iterator:t,Ji=Ni?Ni.toStringTag:t,lo=function(){try{var r=tn(ht,"defineProperty");return r({},"",{}),r}catch{}}(),Og=Y.clearTimeout!==Xe.clearTimeout&&Y.clearTimeout,Pg=ge&&ge.now!==Xe.Date.now&&ge.now,Cg=Y.setTimeout!==Xe.setTimeout&&Y.setTimeout,fo=Ht.ceil,po=Ht.floor,Ka=ht.getOwnPropertySymbols,Ag=ao?ao.isBuffer:t,ph=Y.isFinite,Tg=io.join,Rg=ah(ht.keys,ht),Kt=Ht.max,Xt=Ht.min,Ng=ge.now,Ug=Y.parseInt,gh=Ht.random,$g=io.reverse,ka=tn(Y,"DataView"),es=tn(Y,"Map"),Va=tn(Y,"Promise"),Pn=tn(Y,"Set"),ts=tn(Y,"WeakMap"),rs=tn(ht,"create"),go=ts&&new ts,Cn={},Lg=rn(ka),Mg=rn(es),jg=rn(Va),qg=rn(Pn),Fg=rn(ts),yo=Ni?Ni.prototype:t,is=yo?yo.valueOf:t,yh=yo?yo.toString:t;function v(r){if(At(r)&&!Re(r)&&!(r instanceof Ye)){if(r instanceof $r)return r;if(nt.call(r,"__wrapped__"))return vl(r)}return new $r(r)}var An=function(){function r(){}return function(n){if(!Dt(n))return{};if(lh)return lh(n);r.prototype=n;var a=new r;return r.prototype=t,a}}();function vo(){}function $r(r,n){this.__wrapped__=r,this.__actions__=[],this.__chain__=!!n,this.__index__=0,this.__values__=t}v.templateSettings={escape:It,evaluate:xt,interpolate:Et,variable:"",imports:{_:v}},v.prototype=vo.prototype,v.prototype.constructor=v,$r.prototype=An(vo.prototype),$r.prototype.constructor=$r;function Ye(r){this.__wrapped__=r,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=re,this.__views__=[]}function zg(){var r=new Ye(this.__wrapped__);return r.__actions__=gr(this.__actions__),r.__dir__=this.__dir__,r.__filtered__=this.__filtered__,r.__iteratees__=gr(this.__iteratees__),r.__takeCount__=this.__takeCount__,r.__views__=gr(this.__views__),r}function Bg(){if(this.__filtered__){var r=new Ye(this);r.__dir__=-1,r.__filtered__=!0}else r=this.clone(),r.__dir__*=-1;return r}function Hg(){var r=this.__wrapped__.value(),n=this.__dir__,a=Re(r),h=n<0,p=a?r.length:0,w=ty(0,p,this.__views__),x=w.start,N=w.end,q=N-x,X=h?N:x-1,Z=this.__iteratees__,ne=Z.length,he=0,ye=Xt(q,this.__takeCount__);if(!a||!h&&p==q&&ye==q)return Fh(r,this.__actions__);var Ee=[];e:for(;q--&&he<ye;){X+=n;for(var ze=-1,De=r[X];++ze<ne;){var Ge=Z[ze],Ze=Ge.iteratee,xr=Ge.type,ar=Ze(De);if(xr==C)De=ar;else if(!ar){if(xr==b)continue e;break e}}Ee[he++]=De}return Ee}Ye.prototype=An(vo.prototype),Ye.prototype.constructor=Ye;function Qi(r){var n=-1,a=r==null?0:r.length;for(this.clear();++n<a;){var h=r[n];this.set(h[0],h[1])}}function Kg(){this.__data__=rs?rs(null):{},this.size=0}function kg(r){var n=this.has(r)&&delete this.__data__[r];return this.size-=n?1:0,n}function Vg(r){var n=this.__data__;if(rs){var a=n[r];return a===y?t:a}return nt.call(n,r)?n[r]:t}function Gg(r){var n=this.__data__;return rs?n[r]!==t:nt.call(n,r)}function Wg(r,n){var a=this.__data__;return this.size+=this.has(r)?0:1,a[r]=rs&&n===t?y:n,this}Qi.prototype.clear=Kg,Qi.prototype.delete=kg,Qi.prototype.get=Vg,Qi.prototype.has=Gg,Qi.prototype.set=Wg;function li(r){var n=-1,a=r==null?0:r.length;for(this.clear();++n<a;){var h=r[n];this.set(h[0],h[1])}}function Yg(){this.__data__=[],this.size=0}function Jg(r){var n=this.__data__,a=mo(n,r);if(a<0)return!1;var h=n.length-1;return a==h?n.pop():ho.call(n,a,1),--this.size,!0}function Qg(r){var n=this.__data__,a=mo(n,r);return a<0?t:n[a][1]}function Xg(r){return mo(this.__data__,r)>-1}function Zg(r,n){var a=this.__data__,h=mo(a,r);return h<0?(++this.size,a.push([r,n])):a[h][1]=n,this}li.prototype.clear=Yg,li.prototype.delete=Jg,li.prototype.get=Qg,li.prototype.has=Xg,li.prototype.set=Zg;function fi(r){var n=-1,a=r==null?0:r.length;for(this.clear();++n<a;){var h=r[n];this.set(h[0],h[1])}}function e0(){this.size=0,this.__data__={hash:new Qi,map:new(es||li),string:new Qi}}function t0(r){var n=Ao(this,r).delete(r);return this.size-=n?1:0,n}function r0(r){return Ao(this,r).get(r)}function i0(r){return Ao(this,r).has(r)}function n0(r,n){var a=Ao(this,r),h=a.size;return a.set(r,n),this.size+=a.size==h?0:1,this}fi.prototype.clear=e0,fi.prototype.delete=t0,fi.prototype.get=r0,fi.prototype.has=i0,fi.prototype.set=n0;function Xi(r){var n=-1,a=r==null?0:r.length;for(this.__data__=new fi;++n<a;)this.add(r[n])}function s0(r){return this.__data__.set(r,y),this}function o0(r){return this.__data__.has(r)}Xi.prototype.add=Xi.prototype.push=s0,Xi.prototype.has=o0;function kr(r){var n=this.__data__=new li(r);this.size=n.size}function a0(){this.__data__=new li,this.size=0}function c0(r){var n=this.__data__,a=n.delete(r);return this.size=n.size,a}function u0(r){return this.__data__.get(r)}function h0(r){return this.__data__.has(r)}function l0(r,n){var a=this.__data__;if(a instanceof li){var h=a.__data__;if(!es||h.length<o-1)return h.push([r,n]),this.size=++a.size,this;a=this.__data__=new fi(h)}return a.set(r,n),this.size=a.size,this}kr.prototype.clear=a0,kr.prototype.delete=c0,kr.prototype.get=u0,kr.prototype.has=h0,kr.prototype.set=l0;function vh(r,n){var a=Re(r),h=!a&&nn(r),p=!a&&!h&&ji(r),w=!a&&!h&&!p&&Un(r),x=a||h||p||w,N=x?Fa(r.length,bg):[],q=N.length;for(var X in r)(n||nt.call(r,X))&&!(x&&(X=="length"||p&&(X=="offset"||X=="parent")||w&&(X=="buffer"||X=="byteLength"||X=="byteOffset")||yi(X,q)))&&N.push(X);return N}function mh(r){var n=r.length;return n?r[ic(0,n-1)]:t}function f0(r,n){return To(gr(r),Zi(n,0,r.length))}function d0(r){return To(gr(r))}function Ga(r,n,a){(a!==t&&!Vr(r[n],a)||a===t&&!(n in r))&&di(r,n,a)}function ns(r,n,a){var h=r[n];(!(nt.call(r,n)&&Vr(h,a))||a===t&&!(n in r))&&di(r,n,a)}function mo(r,n){for(var a=r.length;a--;)if(Vr(r[a][0],n))return a;return-1}function p0(r,n,a,h){return Ui(r,function(p,w,x){n(h,p,a(p),x)}),h}function wh(r,n){return r&&ti(n,Vt(n),r)}function g0(r,n){return r&&ti(n,vr(n),r)}function di(r,n,a){n=="__proto__"&&lo?lo(r,n,{configurable:!0,enumerable:!0,value:a,writable:!0}):r[n]=a}function Wa(r,n){for(var a=-1,h=n.length,p=K(h),w=r==null;++a<h;)p[a]=w?t:Pc(r,n[a]);return p}function Zi(r,n,a){return r===r&&(a!==t&&(r=r<=a?r:a),n!==t&&(r=r>=n?r:n)),r}function Lr(r,n,a,h,p,w){var x,N=n&D,q=n&I,X=n&T;if(a&&(x=p?a(r,h,p,w):a(r)),x!==t)return x;if(!Dt(r))return r;var Z=Re(r);if(Z){if(x=iy(r),!N)return gr(r,x)}else{var ne=Zt(r),he=ne==ae||ne==fe;if(ji(r))return Hh(r,N);if(ne==Me||ne==le||he&&!p){if(x=q||he?{}:cl(r),!N)return q?V0(r,g0(x,r)):k0(r,wh(x,r))}else{if(!ot[ne])return p?r:{};x=ny(r,ne,N)}}w||(w=new kr);var ye=w.get(r);if(ye)return ye;w.set(r,x),Ml(r)?r.forEach(function(De){x.add(Lr(De,n,a,De,r,w))}):$l(r)&&r.forEach(function(De,Ge){x.set(Ge,Lr(De,n,a,Ge,r,w))});var Ee=X?q?pc:dc:q?vr:Vt,ze=Z?t:Ee(r);return Nr(ze||r,function(De,Ge){ze&&(Ge=De,De=r[Ge]),ns(x,Ge,Lr(De,n,a,Ge,r,w))}),x}function y0(r){var n=Vt(r);return function(a){return _h(a,r,n)}}function _h(r,n,a){var h=a.length;if(r==null)return!h;for(r=ht(r);h--;){var p=a[h],w=n[p],x=r[p];if(x===t&&!(p in r)||!w(x))return!1}return!0}function bh(r,n,a){if(typeof r!="function")throw new Ur(d);return ls(function(){r.apply(t,a)},n)}function ss(r,n,a,h){var p=-1,w=eo,x=!0,N=r.length,q=[],X=n.length;if(!N)return q;a&&(n=wt(n,Dr(a))),h?(w=Ua,x=!1):n.length>=o&&(w=Xn,x=!1,n=new Xi(n));e:for(;++p<N;){var Z=r[p],ne=a==null?Z:a(Z);if(Z=h||Z!==0?Z:0,x&&ne===ne){for(var he=X;he--;)if(n[he]===ne)continue e;q.push(Z)}else w(n,ne,h)||q.push(Z)}return q}var Ui=Wh(ei),Eh=Wh(Ja,!0);function v0(r,n){var a=!0;return Ui(r,function(h,p,w){return a=!!n(h,p,w),a}),a}function wo(r,n,a){for(var h=-1,p=r.length;++h<p;){var w=r[h],x=n(w);if(x!=null&&(N===t?x===x&&!Ir(x):a(x,N)))var N=x,q=w}return q}function m0(r,n,a,h){var p=r.length;for(a=je(a),a<0&&(a=-a>p?0:p+a),h=h===t||h>p?p:je(h),h<0&&(h+=p),h=a>h?0:ql(h);a<h;)r[a++]=n;return r}function Dh(r,n){var a=[];return Ui(r,function(h,p,w){n(h,p,w)&&a.push(h)}),a}function Yt(r,n,a,h,p){var w=-1,x=r.length;for(a||(a=oy),p||(p=[]);++w<x;){var N=r[w];n>0&&a(N)?n>1?Yt(N,n-1,a,h,p):Ti(p,N):h||(p[p.length]=N)}return p}var Ya=Yh(),Sh=Yh(!0);function ei(r,n){return r&&Ya(r,n,Vt)}function Ja(r,n){return r&&Sh(r,n,Vt)}function _o(r,n){return Ai(n,function(a){return vi(r[a])})}function en(r,n){n=Li(n,r);for(var a=0,h=n.length;r!=null&&a<h;)r=r[ri(n[a++])];return a&&a==h?r:t}function Ih(r,n,a){var h=n(r);return Re(r)?h:Ti(h,a(r))}function sr(r){return r==null?r===t?Fe:ke:Ji&&Ji in ht(r)?ey(r):dy(r)}function Qa(r,n){return r>n}function w0(r,n){return r!=null&&nt.call(r,n)}function _0(r,n){return r!=null&&n in ht(r)}function b0(r,n,a){return r>=Xt(n,a)&&r<Kt(n,a)}function Xa(r,n,a){for(var h=a?Ua:eo,p=r[0].length,w=r.length,x=w,N=K(w),q=1/0,X=[];x--;){var Z=r[x];x&&n&&(Z=wt(Z,Dr(n))),q=Xt(Z.length,q),N[x]=!a&&(n||p>=120&&Z.length>=120)?new Xi(x&&Z):t}Z=r[0];var ne=-1,he=N[0];e:for(;++ne<p&&X.length<q;){var ye=Z[ne],Ee=n?n(ye):ye;if(ye=a||ye!==0?ye:0,!(he?Xn(he,Ee):h(X,Ee,a))){for(x=w;--x;){var ze=N[x];if(!(ze?Xn(ze,Ee):h(r[x],Ee,a)))continue e}he&&he.push(Ee),X.push(ye)}}return X}function E0(r,n,a,h){return ei(r,function(p,w,x){n(h,a(p),w,x)}),h}function os(r,n,a){n=Li(n,r),r=fl(r,n);var h=r==null?r:r[ri(jr(n))];return h==null?t:kt(h,r,a)}function xh(r){return At(r)&&sr(r)==le}function D0(r){return At(r)&&sr(r)==Se}function S0(r){return At(r)&&sr(r)==$}function as(r,n,a,h,p){return r===n?!0:r==null||n==null||!At(r)&&!At(n)?r!==r&&n!==n:I0(r,n,a,h,as,p)}function I0(r,n,a,h,p,w){var x=Re(r),N=Re(n),q=x?me:Zt(r),X=N?me:Zt(n);q=q==le?Me:q,X=X==le?Me:X;var Z=q==Me,ne=X==Me,he=q==X;if(he&&ji(r)){if(!ji(n))return!1;x=!0,Z=!1}if(he&&!Z)return w||(w=new kr),x||Un(r)?sl(r,n,a,h,p,w):X0(r,n,q,a,h,p,w);if(!(a&P)){var ye=Z&&nt.call(r,"__wrapped__"),Ee=ne&&nt.call(n,"__wrapped__");if(ye||Ee){var ze=ye?r.value():r,De=Ee?n.value():n;return w||(w=new kr),p(ze,De,a,h,w)}}return he?(w||(w=new kr),Z0(r,n,a,h,p,w)):!1}function x0(r){return At(r)&&Zt(r)==Ie}function Za(r,n,a,h){var p=a.length,w=p,x=!h;if(r==null)return!w;for(r=ht(r);p--;){var N=a[p];if(x&&N[2]?N[1]!==r[N[0]]:!(N[0]in r))return!1}for(;++p<w;){N=a[p];var q=N[0],X=r[q],Z=N[1];if(x&&N[2]){if(X===t&&!(q in r))return!1}else{var ne=new kr;if(h)var he=h(X,Z,q,r,n,ne);if(!(he===t?as(Z,X,P|z,h,ne):he))return!1}}return!0}function Oh(r){if(!Dt(r)||cy(r))return!1;var n=vi(r)?xg:ma;return n.test(rn(r))}function O0(r){return At(r)&&sr(r)==qe}function P0(r){return At(r)&&Zt(r)==xe}function C0(r){return At(r)&&Mo(r.length)&&!!at[sr(r)]}function Ph(r){return typeof r=="function"?r:r==null?mr:typeof r=="object"?Re(r)?Th(r[0],r[1]):Ah(r):Jl(r)}function ec(r){if(!hs(r))return Rg(r);var n=[];for(var a in ht(r))nt.call(r,a)&&a!="constructor"&&n.push(a);return n}function A0(r){if(!Dt(r))return fy(r);var n=hs(r),a=[];for(var h in r)h=="constructor"&&(n||!nt.call(r,h))||a.push(h);return a}function tc(r,n){return r<n}function Ch(r,n){var a=-1,h=yr(r)?K(r.length):[];return Ui(r,function(p,w,x){h[++a]=n(p,w,x)}),h}function Ah(r){var n=yc(r);return n.length==1&&n[0][2]?hl(n[0][0],n[0][1]):function(a){return a===r||Za(a,r,n)}}function Th(r,n){return mc(r)&&ul(n)?hl(ri(r),n):function(a){var h=Pc(a,r);return h===t&&h===n?Cc(a,r):as(n,h,P|z)}}function bo(r,n,a,h,p){r!==n&&Ya(n,function(w,x){if(p||(p=new kr),Dt(w))T0(r,n,x,a,bo,h,p);else{var N=h?h(_c(r,x),w,x+"",r,n,p):t;N===t&&(N=w),Ga(r,x,N)}},vr)}function T0(r,n,a,h,p,w,x){var N=_c(r,a),q=_c(n,a),X=x.get(q);if(X){Ga(r,a,X);return}var Z=w?w(N,q,a+"",r,n,x):t,ne=Z===t;if(ne){var he=Re(q),ye=!he&&ji(q),Ee=!he&&!ye&&Un(q);Z=q,he||ye||Ee?Re(N)?Z=N:Nt(N)?Z=gr(N):ye?(ne=!1,Z=Hh(q,!0)):Ee?(ne=!1,Z=Kh(q,!0)):Z=[]:fs(q)||nn(q)?(Z=N,nn(N)?Z=Fl(N):(!Dt(N)||vi(N))&&(Z=cl(q))):ne=!1}ne&&(x.set(q,Z),p(Z,q,h,w,x),x.delete(q)),Ga(r,a,Z)}function Rh(r,n){var a=r.length;if(a)return n+=n<0?a:0,yi(n,a)?r[n]:t}function Nh(r,n,a){n.length?n=wt(n,function(w){return Re(w)?function(x){return en(x,w.length===1?w[0]:w)}:w}):n=[mr];var h=-1;n=wt(n,Dr(we()));var p=Ch(r,function(w,x,N){var q=wt(n,function(X){return X(w)});return{criteria:q,index:++h,value:w}});return ng(p,function(w,x){return K0(w,x,a)})}function R0(r,n){return Uh(r,n,function(a,h){return Cc(r,h)})}function Uh(r,n,a){for(var h=-1,p=n.length,w={};++h<p;){var x=n[h],N=en(r,x);a(N,x)&&cs(w,Li(x,r),N)}return w}function N0(r){return function(n){return en(n,r)}}function rc(r,n,a,h){var p=h?ig:Dn,w=-1,x=n.length,N=r;for(r===n&&(n=gr(n)),a&&(N=wt(r,Dr(a)));++w<x;)for(var q=0,X=n[w],Z=a?a(X):X;(q=p(N,Z,q,h))>-1;)N!==r&&ho.call(N,q,1),ho.call(r,q,1);return r}function $h(r,n){for(var a=r?n.length:0,h=a-1;a--;){var p=n[a];if(a==h||p!==w){var w=p;yi(p)?ho.call(r,p,1):oc(r,p)}}return r}function ic(r,n){return r+po(gh()*(n-r+1))}function U0(r,n,a,h){for(var p=-1,w=Kt(fo((n-r)/(a||1)),0),x=K(w);w--;)x[h?w:++p]=r,r+=a;return x}function nc(r,n){var a="";if(!r||n<1||n>k)return a;do n%2&&(a+=r),n=po(n/2),n&&(r+=r);while(n);return a}function Ke(r,n){return bc(ll(r,n,mr),r+"")}function $0(r){return mh($n(r))}function L0(r,n){var a=$n(r);return To(a,Zi(n,0,a.length))}function cs(r,n,a,h){if(!Dt(r))return r;n=Li(n,r);for(var p=-1,w=n.length,x=w-1,N=r;N!=null&&++p<w;){var q=ri(n[p]),X=a;if(q==="__proto__"||q==="constructor"||q==="prototype")return r;if(p!=x){var Z=N[q];X=h?h(Z,q,N):t,X===t&&(X=Dt(Z)?Z:yi(n[p+1])?[]:{})}ns(N,q,X),N=N[q]}return r}var Lh=go?function(r,n){return go.set(r,n),r}:mr,M0=lo?function(r,n){return lo(r,"toString",{configurable:!0,enumerable:!1,value:Tc(n),writable:!0})}:mr;function j0(r){return To($n(r))}function Mr(r,n,a){var h=-1,p=r.length;n<0&&(n=-n>p?0:p+n),a=a>p?p:a,a<0&&(a+=p),p=n>a?0:a-n>>>0,n>>>=0;for(var w=K(p);++h<p;)w[h]=r[h+n];return w}function q0(r,n){var a;return Ui(r,function(h,p,w){return a=n(h,p,w),!a}),!!a}function Eo(r,n,a){var h=0,p=r==null?h:r.length;if(typeof n=="number"&&n===n&&p<=oe){for(;h<p;){var w=h+p>>>1,x=r[w];x!==null&&!Ir(x)&&(a?x<=n:x<n)?h=w+1:p=w}return p}return sc(r,n,mr,a)}function sc(r,n,a,h){var p=0,w=r==null?0:r.length;if(w===0)return 0;n=a(n);for(var x=n!==n,N=n===null,q=Ir(n),X=n===t;p<w;){var Z=po((p+w)/2),ne=a(r[Z]),he=ne!==t,ye=ne===null,Ee=ne===ne,ze=Ir(ne);if(x)var De=h||Ee;else X?De=Ee&&(h||he):N?De=Ee&&he&&(h||!ye):q?De=Ee&&he&&!ye&&(h||!ze):ye||ze?De=!1:De=h?ne<=n:ne<n;De?p=Z+1:w=Z}return Xt(w,_e)}function Mh(r,n){for(var a=-1,h=r.length,p=0,w=[];++a<h;){var x=r[a],N=n?n(x):x;if(!a||!Vr(N,q)){var q=N;w[p++]=x===0?0:x}}return w}function jh(r){return typeof r=="number"?r:Ir(r)?J:+r}function Sr(r){if(typeof r=="string")return r;if(Re(r))return wt(r,Sr)+"";if(Ir(r))return yh?yh.call(r):"";var n=r+"";return n=="0"&&1/r==-Q?"-0":n}function $i(r,n,a){var h=-1,p=eo,w=r.length,x=!0,N=[],q=N;if(a)x=!1,p=Ua;else if(w>=o){var X=n?null:J0(r);if(X)return ro(X);x=!1,p=Xn,q=new Xi}else q=n?[]:N;e:for(;++h<w;){var Z=r[h],ne=n?n(Z):Z;if(Z=a||Z!==0?Z:0,x&&ne===ne){for(var he=q.length;he--;)if(q[he]===ne)continue e;n&&q.push(ne),N.push(Z)}else p(q,ne,a)||(q!==N&&q.push(ne),N.push(Z))}return N}function oc(r,n){return n=Li(n,r),r=fl(r,n),r==null||delete r[ri(jr(n))]}function qh(r,n,a,h){return cs(r,n,a(en(r,n)),h)}function Do(r,n,a,h){for(var p=r.length,w=h?p:-1;(h?w--:++w<p)&&n(r[w],w,r););return a?Mr(r,h?0:w,h?w+1:p):Mr(r,h?w+1:0,h?p:w)}function Fh(r,n){var a=r;return a instanceof Ye&&(a=a.value()),$a(n,function(h,p){return p.func.apply(p.thisArg,Ti([h],p.args))},a)}function ac(r,n,a){var h=r.length;if(h<2)return h?$i(r[0]):[];for(var p=-1,w=K(h);++p<h;)for(var x=r[p],N=-1;++N<h;)N!=p&&(w[p]=ss(w[p]||x,r[N],n,a));return $i(Yt(w,1),n,a)}function zh(r,n,a){for(var h=-1,p=r.length,w=n.length,x={};++h<p;){var N=h<w?n[h]:t;a(x,r[h],N)}return x}function cc(r){return Nt(r)?r:[]}function uc(r){return typeof r=="function"?r:mr}function Li(r,n){return Re(r)?r:mc(r,n)?[r]:yl(it(r))}var F0=Ke;function Mi(r,n,a){var h=r.length;return a=a===t?h:a,!n&&a>=h?r:Mr(r,n,a)}var Bh=Og||function(r){return Xe.clearTimeout(r)};function Hh(r,n){if(n)return r.slice();var a=r.length,h=hh?hh(a):new r.constructor(a);return r.copy(h),h}function hc(r){var n=new r.constructor(r.byteLength);return new co(n).set(new co(r)),n}function z0(r,n){var a=n?hc(r.buffer):r.buffer;return new r.constructor(a,r.byteOffset,r.byteLength)}function B0(r){var n=new r.constructor(r.source,Tr.exec(r));return n.lastIndex=r.lastIndex,n}function H0(r){return is?ht(is.call(r)):{}}function Kh(r,n){var a=n?hc(r.buffer):r.buffer;return new r.constructor(a,r.byteOffset,r.length)}function kh(r,n){if(r!==n){var a=r!==t,h=r===null,p=r===r,w=Ir(r),x=n!==t,N=n===null,q=n===n,X=Ir(n);if(!N&&!X&&!w&&r>n||w&&x&&q&&!N&&!X||h&&x&&q||!a&&q||!p)return 1;if(!h&&!w&&!X&&r<n||X&&a&&p&&!h&&!w||N&&a&&p||!x&&p||!q)return-1}return 0}function K0(r,n,a){for(var h=-1,p=r.criteria,w=n.criteria,x=p.length,N=a.length;++h<x;){var q=kh(p[h],w[h]);if(q){if(h>=N)return q;var X=a[h];return q*(X=="desc"?-1:1)}}return r.index-n.index}function Vh(r,n,a,h){for(var p=-1,w=r.length,x=a.length,N=-1,q=n.length,X=Kt(w-x,0),Z=K(q+X),ne=!h;++N<q;)Z[N]=n[N];for(;++p<x;)(ne||p<w)&&(Z[a[p]]=r[p]);for(;X--;)Z[N++]=r[p++];return Z}function Gh(r,n,a,h){for(var p=-1,w=r.length,x=-1,N=a.length,q=-1,X=n.length,Z=Kt(w-N,0),ne=K(Z+X),he=!h;++p<Z;)ne[p]=r[p];for(var ye=p;++q<X;)ne[ye+q]=n[q];for(;++x<N;)(he||p<w)&&(ne[ye+a[x]]=r[p++]);return ne}function gr(r,n){var a=-1,h=r.length;for(n||(n=K(h));++a<h;)n[a]=r[a];return n}function ti(r,n,a,h){var p=!a;a||(a={});for(var w=-1,x=n.length;++w<x;){var N=n[w],q=h?h(a[N],r[N],N,a,r):t;q===t&&(q=r[N]),p?di(a,N,q):ns(a,N,q)}return a}function k0(r,n){return ti(r,vc(r),n)}function V0(r,n){return ti(r,ol(r),n)}function So(r,n){return function(a,h){var p=Re(a)?Qp:p0,w=n?n():{};return p(a,r,we(h,2),w)}}function Tn(r){return Ke(function(n,a){var h=-1,p=a.length,w=p>1?a[p-1]:t,x=p>2?a[2]:t;for(w=r.length>3&&typeof w=="function"?(p--,w):t,x&&or(a[0],a[1],x)&&(w=p<3?t:w,p=1),n=ht(n);++h<p;){var N=a[h];N&&r(n,N,h,w)}return n})}function Wh(r,n){return function(a,h){if(a==null)return a;if(!yr(a))return r(a,h);for(var p=a.length,w=n?p:-1,x=ht(a);(n?w--:++w<p)&&h(x[w],w,x)!==!1;);return a}}function Yh(r){return function(n,a,h){for(var p=-1,w=ht(n),x=h(n),N=x.length;N--;){var q=x[r?N:++p];if(a(w[q],q,w)===!1)break}return n}}function G0(r,n,a){var h=n&H,p=us(r);function w(){var x=this&&this!==Xe&&this instanceof w?p:r;return x.apply(h?a:this,arguments)}return w}function Jh(r){return function(n){n=it(n);var a=Sn(n)?Kr(n):t,h=a?a[0]:n.charAt(0),p=a?Mi(a,1).join(""):n.slice(1);return h[r]()+p}}function Rn(r){return function(n){return $a(Wl(Gl(n).replace(Jn,"")),r,"")}}function us(r){return function(){var n=arguments;switch(n.length){case 0:return new r;case 1:return new r(n[0]);case 2:return new r(n[0],n[1]);case 3:return new r(n[0],n[1],n[2]);case 4:return new r(n[0],n[1],n[2],n[3]);case 5:return new r(n[0],n[1],n[2],n[3],n[4]);case 6:return new r(n[0],n[1],n[2],n[3],n[4],n[5]);case 7:return new r(n[0],n[1],n[2],n[3],n[4],n[5],n[6])}var a=An(r.prototype),h=r.apply(a,n);return Dt(h)?h:a}}function W0(r,n,a){var h=us(r);function p(){for(var w=arguments.length,x=K(w),N=w,q=Nn(p);N--;)x[N]=arguments[N];var X=w<3&&x[0]!==q&&x[w-1]!==q?[]:Ri(x,q);if(w-=X.length,w<a)return tl(r,n,Io,p.placeholder,t,x,X,t,t,a-w);var Z=this&&this!==Xe&&this instanceof p?h:r;return kt(Z,this,x)}return p}function Qh(r){return function(n,a,h){var p=ht(n);if(!yr(n)){var w=we(a,3);n=Vt(n),a=function(N){return w(p[N],N,p)}}var x=r(n,a,h);return x>-1?p[w?n[x]:x]:t}}function Xh(r){return gi(function(n){var a=n.length,h=a,p=$r.prototype.thru;for(r&&n.reverse();h--;){var w=n[h];if(typeof w!="function")throw new Ur(d);if(p&&!x&&Co(w)=="wrapper")var x=new $r([],!0)}for(h=x?h:a;++h<a;){w=n[h];var N=Co(w),q=N=="wrapper"?gc(w):t;q&&wc(q[0])&&q[1]==(u|j|A|_)&&!q[4].length&&q[9]==1?x=x[Co(q[0])].apply(x,q[3]):x=w.length==1&&wc(w)?x[N]():x.thru(w)}return function(){var X=arguments,Z=X[0];if(x&&X.length==1&&Re(Z))return x.plant(Z).value();for(var ne=0,he=a?n[ne].apply(this,X):Z;++ne<a;)he=n[ne].call(this,he);return he}})}function Io(r,n,a,h,p,w,x,N,q,X){var Z=n&u,ne=n&H,he=n&ie,ye=n&(j|O),Ee=n&G,ze=he?t:us(r);function De(){for(var Ge=arguments.length,Ze=K(Ge),xr=Ge;xr--;)Ze[xr]=arguments[xr];if(ye)var ar=Nn(De),Or=og(Ze,ar);if(h&&(Ze=Vh(Ze,h,p,ye)),w&&(Ze=Gh(Ze,w,x,ye)),Ge-=Or,ye&&Ge<X){var Ut=Ri(Ze,ar);return tl(r,n,Io,De.placeholder,a,Ze,Ut,N,q,X-Ge)}var Gr=ne?a:this,wi=he?Gr[r]:r;return Ge=Ze.length,N?Ze=py(Ze,N):Ee&&Ge>1&&Ze.reverse(),Z&&q<Ge&&(Ze.length=q),this&&this!==Xe&&this instanceof De&&(wi=ze||us(wi)),wi.apply(Gr,Ze)}return De}function Zh(r,n){return function(a,h){return E0(a,r,n(h),{})}}function xo(r,n){return function(a,h){var p;if(a===t&&h===t)return n;if(a!==t&&(p=a),h!==t){if(p===t)return h;typeof a=="string"||typeof h=="string"?(a=Sr(a),h=Sr(h)):(a=jh(a),h=jh(h)),p=r(a,h)}return p}}function lc(r){return gi(function(n){return n=wt(n,Dr(we())),Ke(function(a){var h=this;return r(n,function(p){return kt(p,h,a)})})})}function Oo(r,n){n=n===t?" ":Sr(n);var a=n.length;if(a<2)return a?nc(n,r):n;var h=nc(n,fo(r/In(n)));return Sn(n)?Mi(Kr(h),0,r).join(""):h.slice(0,r)}function Y0(r,n,a,h){var p=n&H,w=us(r);function x(){for(var N=-1,q=arguments.length,X=-1,Z=h.length,ne=K(Z+q),he=this&&this!==Xe&&this instanceof x?w:r;++X<Z;)ne[X]=h[X];for(;q--;)ne[X++]=arguments[++N];return kt(he,p?a:this,ne)}return x}function el(r){return function(n,a,h){return h&&typeof h!="number"&&or(n,a,h)&&(a=h=t),n=mi(n),a===t?(a=n,n=0):a=mi(a),h=h===t?n<a?1:-1:mi(h),U0(n,a,h,r)}}function Po(r){return function(n,a){return typeof n=="string"&&typeof a=="string"||(n=qr(n),a=qr(a)),r(n,a)}}function tl(r,n,a,h,p,w,x,N,q,X){var Z=n&j,ne=Z?x:t,he=Z?t:x,ye=Z?w:t,Ee=Z?t:w;n|=Z?A:E,n&=~(Z?E:A),n&U||(n&=~(H|ie));var ze=[r,n,p,ye,ne,Ee,he,N,q,X],De=a.apply(t,ze);return wc(r)&&dl(De,ze),De.placeholder=h,pl(De,r,n)}function fc(r){var n=Ht[r];return function(a,h){if(a=qr(a),h=h==null?0:Xt(je(h),292),h&&ph(a)){var p=(it(a)+"e").split("e"),w=n(p[0]+"e"+(+p[1]+h));return p=(it(w)+"e").split("e"),+(p[0]+"e"+(+p[1]-h))}return n(a)}}var J0=Pn&&1/ro(new Pn([,-0]))[1]==Q?function(r){return new Pn(r)}:Uc;function rl(r){return function(n){var a=Zt(n);return a==Ie?Ba(n):a==xe?dg(n):sg(n,r(n))}}function pi(r,n,a,h,p,w,x,N){var q=n&ie;if(!q&&typeof r!="function")throw new Ur(d);var X=h?h.length:0;if(X||(n&=~(A|E),h=p=t),x=x===t?x:Kt(je(x),0),N=N===t?N:je(N),X-=p?p.length:0,n&E){var Z=h,ne=p;h=p=t}var he=q?t:gc(r),ye=[r,n,a,h,p,Z,ne,w,x,N];if(he&&ly(ye,he),r=ye[0],n=ye[1],a=ye[2],h=ye[3],p=ye[4],N=ye[9]=ye[9]===t?q?0:r.length:Kt(ye[9]-X,0),!N&&n&(j|O)&&(n&=~(j|O)),!n||n==H)var Ee=G0(r,n,a);else n==j||n==O?Ee=W0(r,n,N):(n==A||n==(H|A))&&!p.length?Ee=Y0(r,n,a,h):Ee=Io.apply(t,ye);var ze=he?Lh:dl;return pl(ze(Ee,ye),r,n)}function il(r,n,a,h){return r===t||Vr(r,On[a])&&!nt.call(h,a)?n:r}function nl(r,n,a,h,p,w){return Dt(r)&&Dt(n)&&(w.set(n,r),bo(r,n,t,nl,w),w.delete(n)),r}function Q0(r){return fs(r)?t:r}function sl(r,n,a,h,p,w){var x=a&P,N=r.length,q=n.length;if(N!=q&&!(x&&q>N))return!1;var X=w.get(r),Z=w.get(n);if(X&&Z)return X==n&&Z==r;var ne=-1,he=!0,ye=a&z?new Xi:t;for(w.set(r,n),w.set(n,r);++ne<N;){var Ee=r[ne],ze=n[ne];if(h)var De=x?h(ze,Ee,ne,n,r,w):h(Ee,ze,ne,r,n,w);if(De!==t){if(De)continue;he=!1;break}if(ye){if(!La(n,function(Ge,Ze){if(!Xn(ye,Ze)&&(Ee===Ge||p(Ee,Ge,a,h,w)))return ye.push(Ze)})){he=!1;break}}else if(!(Ee===ze||p(Ee,ze,a,h,w))){he=!1;break}}return w.delete(r),w.delete(n),he}function X0(r,n,a,h,p,w,x){switch(a){case Ce:if(r.byteLength!=n.byteLength||r.byteOffset!=n.byteOffset)return!1;r=r.buffer,n=n.buffer;case Se:return!(r.byteLength!=n.byteLength||!w(new co(r),new co(n)));case F:case $:case Be:return Vr(+r,+n);case R:return r.name==n.name&&r.message==n.message;case qe:case Ne:return r==n+"";case Ie:var N=Ba;case xe:var q=h&P;if(N||(N=ro),r.size!=n.size&&!q)return!1;var X=x.get(r);if(X)return X==n;h|=z,x.set(r,n);var Z=sl(N(r),N(n),h,p,w,x);return x.delete(r),Z;case Ue:if(is)return is.call(r)==is.call(n)}return!1}function Z0(r,n,a,h,p,w){var x=a&P,N=dc(r),q=N.length,X=dc(n),Z=X.length;if(q!=Z&&!x)return!1;for(var ne=q;ne--;){var he=N[ne];if(!(x?he in n:nt.call(n,he)))return!1}var ye=w.get(r),Ee=w.get(n);if(ye&&Ee)return ye==n&&Ee==r;var ze=!0;w.set(r,n),w.set(n,r);for(var De=x;++ne<q;){he=N[ne];var Ge=r[he],Ze=n[he];if(h)var xr=x?h(Ze,Ge,he,n,r,w):h(Ge,Ze,he,r,n,w);if(!(xr===t?Ge===Ze||p(Ge,Ze,a,h,w):xr)){ze=!1;break}De||(De=he=="constructor")}if(ze&&!De){var ar=r.constructor,Or=n.constructor;ar!=Or&&"constructor"in r&&"constructor"in n&&!(typeof ar=="function"&&ar instanceof ar&&typeof Or=="function"&&Or instanceof Or)&&(ze=!1)}return w.delete(r),w.delete(n),ze}function gi(r){return bc(ll(r,t,_l),r+"")}function dc(r){return Ih(r,Vt,vc)}function pc(r){return Ih(r,vr,ol)}var gc=go?function(r){return go.get(r)}:Uc;function Co(r){for(var n=r.name+"",a=Cn[n],h=nt.call(Cn,n)?a.length:0;h--;){var p=a[h],w=p.func;if(w==null||w==r)return p.name}return n}function Nn(r){var n=nt.call(v,"placeholder")?v:r;return n.placeholder}function we(){var r=v.iteratee||Rc;return r=r===Rc?Ph:r,arguments.length?r(arguments[0],arguments[1]):r}function Ao(r,n){var a=r.__data__;return ay(n)?a[typeof n=="string"?"string":"hash"]:a.map}function yc(r){for(var n=Vt(r),a=n.length;a--;){var h=n[a],p=r[h];n[a]=[h,p,ul(p)]}return n}function tn(r,n){var a=hg(r,n);return Oh(a)?a:t}function ey(r){var n=nt.call(r,Ji),a=r[Ji];try{r[Ji]=t;var h=!0}catch{}var p=oo.call(r);return h&&(n?r[Ji]=a:delete r[Ji]),p}var vc=Ka?function(r){return r==null?[]:(r=ht(r),Ai(Ka(r),function(n){return fh.call(r,n)}))}:$c,ol=Ka?function(r){for(var n=[];r;)Ti(n,vc(r)),r=uo(r);return n}:$c,Zt=sr;(ka&&Zt(new ka(new ArrayBuffer(1)))!=Ce||es&&Zt(new es)!=Ie||Va&&Zt(Va.resolve())!=gt||Pn&&Zt(new Pn)!=xe||ts&&Zt(new ts)!=Pe)&&(Zt=function(r){var n=sr(r),a=n==Me?r.constructor:t,h=a?rn(a):"";if(h)switch(h){case Lg:return Ce;case Mg:return Ie;case jg:return gt;case qg:return xe;case Fg:return Pe}return n});function ty(r,n,a){for(var h=-1,p=a.length;++h<p;){var w=a[h],x=w.size;switch(w.type){case"drop":r+=x;break;case"dropRight":n-=x;break;case"take":n=Xt(n,r+x);break;case"takeRight":r=Kt(r,n-x);break}}return{start:r,end:n}}function ry(r){var n=r.match(lt);return n?n[1].split(qt):[]}function al(r,n,a){n=Li(n,r);for(var h=-1,p=n.length,w=!1;++h<p;){var x=ri(n[h]);if(!(w=r!=null&&a(r,x)))break;r=r[x]}return w||++h!=p?w:(p=r==null?0:r.length,!!p&&Mo(p)&&yi(x,p)&&(Re(r)||nn(r)))}function iy(r){var n=r.length,a=new r.constructor(n);return n&&typeof r[0]=="string"&&nt.call(r,"index")&&(a.index=r.index,a.input=r.input),a}function cl(r){return typeof r.constructor=="function"&&!hs(r)?An(uo(r)):{}}function ny(r,n,a){var h=r.constructor;switch(n){case Se:return hc(r);case F:case $:return new h(+r);case Ce:return z0(r,a);case He:case Oe:case Ve:case We:case et:case tt:case Qe:case rr:case dr:return Kh(r,a);case Ie:return new h;case Be:case Ne:return new h(r);case qe:return B0(r);case xe:return new h;case Ue:return H0(r)}}function sy(r,n){var a=n.length;if(!a)return r;var h=a-1;return n[h]=(a>1?"& ":"")+n[h],n=n.join(a>2?", ":" "),r.replace(Ct,`{
/* [wrapped with `+n+`] */
`)}function oy(r){return Re(r)||nn(r)||!!(dh&&r&&r[dh])}function yi(r,n){var a=typeof r;return n=n??k,!!n&&(a=="number"||a!="symbol"&&_a.test(r))&&r>-1&&r%1==0&&r<n}function or(r,n,a){if(!Dt(a))return!1;var h=typeof n;return(h=="number"?yr(a)&&yi(n,a.length):h=="string"&&n in a)?Vr(a[n],r):!1}function mc(r,n){if(Re(r))return!1;var a=typeof r;return a=="number"||a=="symbol"||a=="boolean"||r==null||Ir(r)?!0:Lt.test(r)||!mt.test(r)||n!=null&&r in ht(n)}function ay(r){var n=typeof r;return n=="string"||n=="number"||n=="symbol"||n=="boolean"?r!=="__proto__":r===null}function wc(r){var n=Co(r),a=v[n];if(typeof a!="function"||!(n in Ye.prototype))return!1;if(r===a)return!0;var h=gc(a);return!!h&&r===h[0]}function cy(r){return!!uh&&uh in r}var uy=no?vi:Lc;function hs(r){var n=r&&r.constructor,a=typeof n=="function"&&n.prototype||On;return r===a}function ul(r){return r===r&&!Dt(r)}function hl(r,n){return function(a){return a==null?!1:a[r]===n&&(n!==t||r in ht(a))}}function hy(r){var n=$o(r,function(h){return a.size===g&&a.clear(),h}),a=n.cache;return n}function ly(r,n){var a=r[1],h=n[1],p=a|h,w=p<(H|ie|u),x=h==u&&a==j||h==u&&a==_&&r[7].length<=n[8]||h==(u|_)&&n[7].length<=n[8]&&a==j;if(!(w||x))return r;h&H&&(r[2]=n[2],p|=a&H?0:U);var N=n[3];if(N){var q=r[3];r[3]=q?Vh(q,N,n[4]):N,r[4]=q?Ri(r[3],m):n[4]}return N=n[5],N&&(q=r[5],r[5]=q?Gh(q,N,n[6]):N,r[6]=q?Ri(r[5],m):n[6]),N=n[7],N&&(r[7]=N),h&u&&(r[8]=r[8]==null?n[8]:Xt(r[8],n[8])),r[9]==null&&(r[9]=n[9]),r[0]=n[0],r[1]=p,r}function fy(r){var n=[];if(r!=null)for(var a in ht(r))n.push(a);return n}function dy(r){return oo.call(r)}function ll(r,n,a){return n=Kt(n===t?r.length-1:n,0),function(){for(var h=arguments,p=-1,w=Kt(h.length-n,0),x=K(w);++p<w;)x[p]=h[n+p];p=-1;for(var N=K(n+1);++p<n;)N[p]=h[p];return N[n]=a(x),kt(r,this,N)}}function fl(r,n){return n.length<2?r:en(r,Mr(n,0,-1))}function py(r,n){for(var a=r.length,h=Xt(n.length,a),p=gr(r);h--;){var w=n[h];r[h]=yi(w,a)?p[w]:t}return r}function _c(r,n){if(!(n==="constructor"&&typeof r[n]=="function")&&n!="__proto__")return r[n]}var dl=gl(Lh),ls=Cg||function(r,n){return Xe.setTimeout(r,n)},bc=gl(M0);function pl(r,n,a){var h=n+"";return bc(r,sy(h,gy(ry(h),a)))}function gl(r){var n=0,a=0;return function(){var h=Ng(),p=de-(h-a);if(a=h,p>0){if(++n>=ue)return arguments[0]}else n=0;return r.apply(t,arguments)}}function To(r,n){var a=-1,h=r.length,p=h-1;for(n=n===t?h:n;++a<n;){var w=ic(a,p),x=r[w];r[w]=r[a],r[a]=x}return r.length=n,r}var yl=hy(function(r){var n=[];return r.charCodeAt(0)===46&&n.push(""),r.replace(Mt,function(a,h,p,w){n.push(p?w.replace(pa,"$1"):h||a)}),n});function ri(r){if(typeof r=="string"||Ir(r))return r;var n=r+"";return n=="0"&&1/r==-Q?"-0":n}function rn(r){if(r!=null){try{return so.call(r)}catch{}try{return r+""}catch{}}return""}function gy(r,n){return Nr(be,function(a){var h="_."+a[0];n&a[1]&&!eo(r,h)&&r.push(h)}),r.sort()}function vl(r){if(r instanceof Ye)return r.clone();var n=new $r(r.__wrapped__,r.__chain__);return n.__actions__=gr(r.__actions__),n.__index__=r.__index__,n.__values__=r.__values__,n}function yy(r,n,a){(a?or(r,n,a):n===t)?n=1:n=Kt(je(n),0);var h=r==null?0:r.length;if(!h||n<1)return[];for(var p=0,w=0,x=K(fo(h/n));p<h;)x[w++]=Mr(r,p,p+=n);return x}function vy(r){for(var n=-1,a=r==null?0:r.length,h=0,p=[];++n<a;){var w=r[n];w&&(p[h++]=w)}return p}function my(){var r=arguments.length;if(!r)return[];for(var n=K(r-1),a=arguments[0],h=r;h--;)n[h-1]=arguments[h];return Ti(Re(a)?gr(a):[a],Yt(n,1))}var wy=Ke(function(r,n){return Nt(r)?ss(r,Yt(n,1,Nt,!0)):[]}),_y=Ke(function(r,n){var a=jr(n);return Nt(a)&&(a=t),Nt(r)?ss(r,Yt(n,1,Nt,!0),we(a,2)):[]}),by=Ke(function(r,n){var a=jr(n);return Nt(a)&&(a=t),Nt(r)?ss(r,Yt(n,1,Nt,!0),t,a):[]});function Ey(r,n,a){var h=r==null?0:r.length;return h?(n=a||n===t?1:je(n),Mr(r,n<0?0:n,h)):[]}function Dy(r,n,a){var h=r==null?0:r.length;return h?(n=a||n===t?1:je(n),n=h-n,Mr(r,0,n<0?0:n)):[]}function Sy(r,n){return r&&r.length?Do(r,we(n,3),!0,!0):[]}function Iy(r,n){return r&&r.length?Do(r,we(n,3),!0):[]}function xy(r,n,a,h){var p=r==null?0:r.length;return p?(a&&typeof a!="number"&&or(r,n,a)&&(a=0,h=p),m0(r,n,a,h)):[]}function ml(r,n,a){var h=r==null?0:r.length;if(!h)return-1;var p=a==null?0:je(a);return p<0&&(p=Kt(h+p,0)),to(r,we(n,3),p)}function wl(r,n,a){var h=r==null?0:r.length;if(!h)return-1;var p=h-1;return a!==t&&(p=je(a),p=a<0?Kt(h+p,0):Xt(p,h-1)),to(r,we(n,3),p,!0)}function _l(r){var n=r==null?0:r.length;return n?Yt(r,1):[]}function Oy(r){var n=r==null?0:r.length;return n?Yt(r,Q):[]}function Py(r,n){var a=r==null?0:r.length;return a?(n=n===t?1:je(n),Yt(r,n)):[]}function Cy(r){for(var n=-1,a=r==null?0:r.length,h={};++n<a;){var p=r[n];h[p[0]]=p[1]}return h}function bl(r){return r&&r.length?r[0]:t}function Ay(r,n,a){var h=r==null?0:r.length;if(!h)return-1;var p=a==null?0:je(a);return p<0&&(p=Kt(h+p,0)),Dn(r,n,p)}function Ty(r){var n=r==null?0:r.length;return n?Mr(r,0,-1):[]}var Ry=Ke(function(r){var n=wt(r,cc);return n.length&&n[0]===r[0]?Xa(n):[]}),Ny=Ke(function(r){var n=jr(r),a=wt(r,cc);return n===jr(a)?n=t:a.pop(),a.length&&a[0]===r[0]?Xa(a,we(n,2)):[]}),Uy=Ke(function(r){var n=jr(r),a=wt(r,cc);return n=typeof n=="function"?n:t,n&&a.pop(),a.length&&a[0]===r[0]?Xa(a,t,n):[]});function $y(r,n){return r==null?"":Tg.call(r,n)}function jr(r){var n=r==null?0:r.length;return n?r[n-1]:t}function Ly(r,n,a){var h=r==null?0:r.length;if(!h)return-1;var p=h;return a!==t&&(p=je(a),p=p<0?Kt(h+p,0):Xt(p,h-1)),n===n?gg(r,n,p):to(r,th,p,!0)}function My(r,n){return r&&r.length?Rh(r,je(n)):t}var jy=Ke(El);function El(r,n){return r&&r.length&&n&&n.length?rc(r,n):r}function qy(r,n,a){return r&&r.length&&n&&n.length?rc(r,n,we(a,2)):r}function Fy(r,n,a){return r&&r.length&&n&&n.length?rc(r,n,t,a):r}var zy=gi(function(r,n){var a=r==null?0:r.length,h=Wa(r,n);return $h(r,wt(n,function(p){return yi(p,a)?+p:p}).sort(kh)),h});function By(r,n){var a=[];if(!(r&&r.length))return a;var h=-1,p=[],w=r.length;for(n=we(n,3);++h<w;){var x=r[h];n(x,h,r)&&(a.push(x),p.push(h))}return $h(r,p),a}function Ec(r){return r==null?r:$g.call(r)}function Hy(r,n,a){var h=r==null?0:r.length;return h?(a&&typeof a!="number"&&or(r,n,a)?(n=0,a=h):(n=n==null?0:je(n),a=a===t?h:je(a)),Mr(r,n,a)):[]}function Ky(r,n){return Eo(r,n)}function ky(r,n,a){return sc(r,n,we(a,2))}function Vy(r,n){var a=r==null?0:r.length;if(a){var h=Eo(r,n);if(h<a&&Vr(r[h],n))return h}return-1}function Gy(r,n){return Eo(r,n,!0)}function Wy(r,n,a){return sc(r,n,we(a,2),!0)}function Yy(r,n){var a=r==null?0:r.length;if(a){var h=Eo(r,n,!0)-1;if(Vr(r[h],n))return h}return-1}function Jy(r){return r&&r.length?Mh(r):[]}function Qy(r,n){return r&&r.length?Mh(r,we(n,2)):[]}function Xy(r){var n=r==null?0:r.length;return n?Mr(r,1,n):[]}function Zy(r,n,a){return r&&r.length?(n=a||n===t?1:je(n),Mr(r,0,n<0?0:n)):[]}function ev(r,n,a){var h=r==null?0:r.length;return h?(n=a||n===t?1:je(n),n=h-n,Mr(r,n<0?0:n,h)):[]}function tv(r,n){return r&&r.length?Do(r,we(n,3),!1,!0):[]}function rv(r,n){return r&&r.length?Do(r,we(n,3)):[]}var iv=Ke(function(r){return $i(Yt(r,1,Nt,!0))}),nv=Ke(function(r){var n=jr(r);return Nt(n)&&(n=t),$i(Yt(r,1,Nt,!0),we(n,2))}),sv=Ke(function(r){var n=jr(r);return n=typeof n=="function"?n:t,$i(Yt(r,1,Nt,!0),t,n)});function ov(r){return r&&r.length?$i(r):[]}function av(r,n){return r&&r.length?$i(r,we(n,2)):[]}function cv(r,n){return n=typeof n=="function"?n:t,r&&r.length?$i(r,t,n):[]}function Dc(r){if(!(r&&r.length))return[];var n=0;return r=Ai(r,function(a){if(Nt(a))return n=Kt(a.length,n),!0}),Fa(n,function(a){return wt(r,Ma(a))})}function Dl(r,n){if(!(r&&r.length))return[];var a=Dc(r);return n==null?a:wt(a,function(h){return kt(n,t,h)})}var uv=Ke(function(r,n){return Nt(r)?ss(r,n):[]}),hv=Ke(function(r){return ac(Ai(r,Nt))}),lv=Ke(function(r){var n=jr(r);return Nt(n)&&(n=t),ac(Ai(r,Nt),we(n,2))}),fv=Ke(function(r){var n=jr(r);return n=typeof n=="function"?n:t,ac(Ai(r,Nt),t,n)}),dv=Ke(Dc);function pv(r,n){return zh(r||[],n||[],ns)}function gv(r,n){return zh(r||[],n||[],cs)}var yv=Ke(function(r){var n=r.length,a=n>1?r[n-1]:t;return a=typeof a=="function"?(r.pop(),a):t,Dl(r,a)});function Sl(r){var n=v(r);return n.__chain__=!0,n}function vv(r,n){return n(r),r}function Ro(r,n){return n(r)}var mv=gi(function(r){var n=r.length,a=n?r[0]:0,h=this.__wrapped__,p=function(w){return Wa(w,r)};return n>1||this.__actions__.length||!(h instanceof Ye)||!yi(a)?this.thru(p):(h=h.slice(a,+a+(n?1:0)),h.__actions__.push({func:Ro,args:[p],thisArg:t}),new $r(h,this.__chain__).thru(function(w){return n&&!w.length&&w.push(t),w}))});function wv(){return Sl(this)}function _v(){return new $r(this.value(),this.__chain__)}function bv(){this.__values__===t&&(this.__values__=jl(this.value()));var r=this.__index__>=this.__values__.length,n=r?t:this.__values__[this.__index__++];return{done:r,value:n}}function Ev(){return this}function Dv(r){for(var n,a=this;a instanceof vo;){var h=vl(a);h.__index__=0,h.__values__=t,n?p.__wrapped__=h:n=h;var p=h;a=a.__wrapped__}return p.__wrapped__=r,n}function Sv(){var r=this.__wrapped__;if(r instanceof Ye){var n=r;return this.__actions__.length&&(n=new Ye(this)),n=n.reverse(),n.__actions__.push({func:Ro,args:[Ec],thisArg:t}),new $r(n,this.__chain__)}return this.thru(Ec)}function Iv(){return Fh(this.__wrapped__,this.__actions__)}var xv=So(function(r,n,a){nt.call(r,a)?++r[a]:di(r,a,1)});function Ov(r,n,a){var h=Re(r)?Zu:v0;return a&&or(r,n,a)&&(n=t),h(r,we(n,3))}function Pv(r,n){var a=Re(r)?Ai:Dh;return a(r,we(n,3))}var Cv=Qh(ml),Av=Qh(wl);function Tv(r,n){return Yt(No(r,n),1)}function Rv(r,n){return Yt(No(r,n),Q)}function Nv(r,n,a){return a=a===t?1:je(a),Yt(No(r,n),a)}function Il(r,n){var a=Re(r)?Nr:Ui;return a(r,we(n,3))}function xl(r,n){var a=Re(r)?Xp:Eh;return a(r,we(n,3))}var Uv=So(function(r,n,a){nt.call(r,a)?r[a].push(n):di(r,a,[n])});function $v(r,n,a,h){r=yr(r)?r:$n(r),a=a&&!h?je(a):0;var p=r.length;return a<0&&(a=Kt(p+a,0)),jo(r)?a<=p&&r.indexOf(n,a)>-1:!!p&&Dn(r,n,a)>-1}var Lv=Ke(function(r,n,a){var h=-1,p=typeof n=="function",w=yr(r)?K(r.length):[];return Ui(r,function(x){w[++h]=p?kt(n,x,a):os(x,n,a)}),w}),Mv=So(function(r,n,a){di(r,a,n)});function No(r,n){var a=Re(r)?wt:Ch;return a(r,we(n,3))}function jv(r,n,a,h){return r==null?[]:(Re(n)||(n=n==null?[]:[n]),a=h?t:a,Re(a)||(a=a==null?[]:[a]),Nh(r,n,a))}var qv=So(function(r,n,a){r[a?0:1].push(n)},function(){return[[],[]]});function Fv(r,n,a){var h=Re(r)?$a:ih,p=arguments.length<3;return h(r,we(n,4),a,p,Ui)}function zv(r,n,a){var h=Re(r)?Zp:ih,p=arguments.length<3;return h(r,we(n,4),a,p,Eh)}function Bv(r,n){var a=Re(r)?Ai:Dh;return a(r,Lo(we(n,3)))}function Hv(r){var n=Re(r)?mh:$0;return n(r)}function Kv(r,n,a){(a?or(r,n,a):n===t)?n=1:n=je(n);var h=Re(r)?f0:L0;return h(r,n)}function kv(r){var n=Re(r)?d0:j0;return n(r)}function Vv(r){if(r==null)return 0;if(yr(r))return jo(r)?In(r):r.length;var n=Zt(r);return n==Ie||n==xe?r.size:ec(r).length}function Gv(r,n,a){var h=Re(r)?La:q0;return a&&or(r,n,a)&&(n=t),h(r,we(n,3))}var Wv=Ke(function(r,n){if(r==null)return[];var a=n.length;return a>1&&or(r,n[0],n[1])?n=[]:a>2&&or(n[0],n[1],n[2])&&(n=[n[0]]),Nh(r,Yt(n,1),[])}),Uo=Pg||function(){return Xe.Date.now()};function Yv(r,n){if(typeof n!="function")throw new Ur(d);return r=je(r),function(){if(--r<1)return n.apply(this,arguments)}}function Ol(r,n,a){return n=a?t:n,n=r&&n==null?r.length:n,pi(r,u,t,t,t,t,n)}function Pl(r,n){var a;if(typeof n!="function")throw new Ur(d);return r=je(r),function(){return--r>0&&(a=n.apply(this,arguments)),r<=1&&(n=t),a}}var Sc=Ke(function(r,n,a){var h=H;if(a.length){var p=Ri(a,Nn(Sc));h|=A}return pi(r,h,n,a,p)}),Cl=Ke(function(r,n,a){var h=H|ie;if(a.length){var p=Ri(a,Nn(Cl));h|=A}return pi(n,h,r,a,p)});function Al(r,n,a){n=a?t:n;var h=pi(r,j,t,t,t,t,t,n);return h.placeholder=Al.placeholder,h}function Tl(r,n,a){n=a?t:n;var h=pi(r,O,t,t,t,t,t,n);return h.placeholder=Tl.placeholder,h}function Rl(r,n,a){var h,p,w,x,N,q,X=0,Z=!1,ne=!1,he=!0;if(typeof r!="function")throw new Ur(d);n=qr(n)||0,Dt(a)&&(Z=!!a.leading,ne="maxWait"in a,w=ne?Kt(qr(a.maxWait)||0,n):w,he="trailing"in a?!!a.trailing:he);function ye(Ut){var Gr=h,wi=p;return h=p=t,X=Ut,x=r.apply(wi,Gr),x}function Ee(Ut){return X=Ut,N=ls(Ge,n),Z?ye(Ut):x}function ze(Ut){var Gr=Ut-q,wi=Ut-X,Ql=n-Gr;return ne?Xt(Ql,w-wi):Ql}function De(Ut){var Gr=Ut-q,wi=Ut-X;return q===t||Gr>=n||Gr<0||ne&&wi>=w}function Ge(){var Ut=Uo();if(De(Ut))return Ze(Ut);N=ls(Ge,ze(Ut))}function Ze(Ut){return N=t,he&&h?ye(Ut):(h=p=t,x)}function xr(){N!==t&&Bh(N),X=0,h=q=p=N=t}function ar(){return N===t?x:Ze(Uo())}function Or(){var Ut=Uo(),Gr=De(Ut);if(h=arguments,p=this,q=Ut,Gr){if(N===t)return Ee(q);if(ne)return Bh(N),N=ls(Ge,n),ye(q)}return N===t&&(N=ls(Ge,n)),x}return Or.cancel=xr,Or.flush=ar,Or}var Jv=Ke(function(r,n){return bh(r,1,n)}),Qv=Ke(function(r,n,a){return bh(r,qr(n)||0,a)});function Xv(r){return pi(r,G)}function $o(r,n){if(typeof r!="function"||n!=null&&typeof n!="function")throw new Ur(d);var a=function(){var h=arguments,p=n?n.apply(this,h):h[0],w=a.cache;if(w.has(p))return w.get(p);var x=r.apply(this,h);return a.cache=w.set(p,x)||w,x};return a.cache=new($o.Cache||fi),a}$o.Cache=fi;function Lo(r){if(typeof r!="function")throw new Ur(d);return function(){var n=arguments;switch(n.length){case 0:return!r.call(this);case 1:return!r.call(this,n[0]);case 2:return!r.call(this,n[0],n[1]);case 3:return!r.call(this,n[0],n[1],n[2])}return!r.apply(this,n)}}function Zv(r){return Pl(2,r)}var em=F0(function(r,n){n=n.length==1&&Re(n[0])?wt(n[0],Dr(we())):wt(Yt(n,1),Dr(we()));var a=n.length;return Ke(function(h){for(var p=-1,w=Xt(h.length,a);++p<w;)h[p]=n[p].call(this,h[p]);return kt(r,this,h)})}),Ic=Ke(function(r,n){var a=Ri(n,Nn(Ic));return pi(r,A,t,n,a)}),Nl=Ke(function(r,n){var a=Ri(n,Nn(Nl));return pi(r,E,t,n,a)}),tm=gi(function(r,n){return pi(r,_,t,t,t,n)});function rm(r,n){if(typeof r!="function")throw new Ur(d);return n=n===t?n:je(n),Ke(r,n)}function im(r,n){if(typeof r!="function")throw new Ur(d);return n=n==null?0:Kt(je(n),0),Ke(function(a){var h=a[n],p=Mi(a,0,n);return h&&Ti(p,h),kt(r,this,p)})}function nm(r,n,a){var h=!0,p=!0;if(typeof r!="function")throw new Ur(d);return Dt(a)&&(h="leading"in a?!!a.leading:h,p="trailing"in a?!!a.trailing:p),Rl(r,n,{leading:h,maxWait:n,trailing:p})}function sm(r){return Ol(r,1)}function om(r,n){return Ic(uc(n),r)}function am(){if(!arguments.length)return[];var r=arguments[0];return Re(r)?r:[r]}function cm(r){return Lr(r,T)}function um(r,n){return n=typeof n=="function"?n:t,Lr(r,T,n)}function hm(r){return Lr(r,D|T)}function lm(r,n){return n=typeof n=="function"?n:t,Lr(r,D|T,n)}function fm(r,n){return n==null||_h(r,n,Vt(n))}function Vr(r,n){return r===n||r!==r&&n!==n}var dm=Po(Qa),pm=Po(function(r,n){return r>=n}),nn=xh(function(){return arguments}())?xh:function(r){return At(r)&&nt.call(r,"callee")&&!fh.call(r,"callee")},Re=K.isArray,gm=nr?Dr(nr):D0;function yr(r){return r!=null&&Mo(r.length)&&!vi(r)}function Nt(r){return At(r)&&yr(r)}function ym(r){return r===!0||r===!1||At(r)&&sr(r)==F}var ji=Ag||Lc,vm=Hr?Dr(Hr):S0;function mm(r){return At(r)&&r.nodeType===1&&!fs(r)}function wm(r){if(r==null)return!0;if(yr(r)&&(Re(r)||typeof r=="string"||typeof r.splice=="function"||ji(r)||Un(r)||nn(r)))return!r.length;var n=Zt(r);if(n==Ie||n==xe)return!r.size;if(hs(r))return!ec(r).length;for(var a in r)if(nt.call(r,a))return!1;return!0}function _m(r,n){return as(r,n)}function bm(r,n,a){a=typeof a=="function"?a:t;var h=a?a(r,n):t;return h===t?as(r,n,t,a):!!h}function xc(r){if(!At(r))return!1;var n=sr(r);return n==R||n==l||typeof r.message=="string"&&typeof r.name=="string"&&!fs(r)}function Em(r){return typeof r=="number"&&ph(r)}function vi(r){if(!Dt(r))return!1;var n=sr(r);return n==ae||n==fe||n==B||n==yt}function Ul(r){return typeof r=="number"&&r==je(r)}function Mo(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=k}function Dt(r){var n=typeof r;return r!=null&&(n=="object"||n=="function")}function At(r){return r!=null&&typeof r=="object"}var $l=Rr?Dr(Rr):x0;function Dm(r,n){return r===n||Za(r,n,yc(n))}function Sm(r,n,a){return a=typeof a=="function"?a:t,Za(r,n,yc(n),a)}function Im(r){return Ll(r)&&r!=+r}function xm(r){if(uy(r))throw new Ae(c);return Oh(r)}function Om(r){return r===null}function Pm(r){return r==null}function Ll(r){return typeof r=="number"||At(r)&&sr(r)==Be}function fs(r){if(!At(r)||sr(r)!=Me)return!1;var n=uo(r);if(n===null)return!0;var a=nt.call(n,"constructor")&&n.constructor;return typeof a=="function"&&a instanceof a&&so.call(a)==Sg}var Oc=Zr?Dr(Zr):O0;function Cm(r){return Ul(r)&&r>=-k&&r<=k}var Ml=Qn?Dr(Qn):P0;function jo(r){return typeof r=="string"||!Re(r)&&At(r)&&sr(r)==Ne}function Ir(r){return typeof r=="symbol"||At(r)&&sr(r)==Ue}var Un=Yi?Dr(Yi):C0;function Am(r){return r===t}function Tm(r){return At(r)&&Zt(r)==Pe}function Rm(r){return At(r)&&sr(r)==$e}var Nm=Po(tc),Um=Po(function(r,n){return r<=n});function jl(r){if(!r)return[];if(yr(r))return jo(r)?Kr(r):gr(r);if(Zn&&r[Zn])return fg(r[Zn]());var n=Zt(r),a=n==Ie?Ba:n==xe?ro:$n;return a(r)}function mi(r){if(!r)return r===0?r:0;if(r=qr(r),r===Q||r===-Q){var n=r<0?-1:1;return n*V}return r===r?r:0}function je(r){var n=mi(r),a=n%1;return n===n?a?n-a:n:0}function ql(r){return r?Zi(je(r),0,re):0}function qr(r){if(typeof r=="number")return r;if(Ir(r))return J;if(Dt(r)){var n=typeof r.valueOf=="function"?r.valueOf():r;r=Dt(n)?n+"":n}if(typeof r!="string")return r===0?r:+r;r=nh(r);var a=va.test(r);return a||wa.test(r)?Te(r.slice(2),a?2:8):ya.test(r)?J:+r}function Fl(r){return ti(r,vr(r))}function $m(r){return r?Zi(je(r),-k,k):r===0?r:0}function it(r){return r==null?"":Sr(r)}var Lm=Tn(function(r,n){if(hs(n)||yr(n)){ti(n,Vt(n),r);return}for(var a in n)nt.call(n,a)&&ns(r,a,n[a])}),zl=Tn(function(r,n){ti(n,vr(n),r)}),qo=Tn(function(r,n,a,h){ti(n,vr(n),r,h)}),Mm=Tn(function(r,n,a,h){ti(n,Vt(n),r,h)}),jm=gi(Wa);function qm(r,n){var a=An(r);return n==null?a:wh(a,n)}var Fm=Ke(function(r,n){r=ht(r);var a=-1,h=n.length,p=h>2?n[2]:t;for(p&&or(n[0],n[1],p)&&(h=1);++a<h;)for(var w=n[a],x=vr(w),N=-1,q=x.length;++N<q;){var X=x[N],Z=r[X];(Z===t||Vr(Z,On[X])&&!nt.call(r,X))&&(r[X]=w[X])}return r}),zm=Ke(function(r){return r.push(t,nl),kt(Bl,t,r)});function Bm(r,n){return eh(r,we(n,3),ei)}function Hm(r,n){return eh(r,we(n,3),Ja)}function Km(r,n){return r==null?r:Ya(r,we(n,3),vr)}function km(r,n){return r==null?r:Sh(r,we(n,3),vr)}function Vm(r,n){return r&&ei(r,we(n,3))}function Gm(r,n){return r&&Ja(r,we(n,3))}function Wm(r){return r==null?[]:_o(r,Vt(r))}function Ym(r){return r==null?[]:_o(r,vr(r))}function Pc(r,n,a){var h=r==null?t:en(r,n);return h===t?a:h}function Jm(r,n){return r!=null&&al(r,n,w0)}function Cc(r,n){return r!=null&&al(r,n,_0)}var Qm=Zh(function(r,n,a){n!=null&&typeof n.toString!="function"&&(n=oo.call(n)),r[n]=a},Tc(mr)),Xm=Zh(function(r,n,a){n!=null&&typeof n.toString!="function"&&(n=oo.call(n)),nt.call(r,n)?r[n].push(a):r[n]=[a]},we),Zm=Ke(os);function Vt(r){return yr(r)?vh(r):ec(r)}function vr(r){return yr(r)?vh(r,!0):A0(r)}function ew(r,n){var a={};return n=we(n,3),ei(r,function(h,p,w){di(a,n(h,p,w),h)}),a}function tw(r,n){var a={};return n=we(n,3),ei(r,function(h,p,w){di(a,p,n(h,p,w))}),a}var rw=Tn(function(r,n,a){bo(r,n,a)}),Bl=Tn(function(r,n,a,h){bo(r,n,a,h)}),iw=gi(function(r,n){var a={};if(r==null)return a;var h=!1;n=wt(n,function(w){return w=Li(w,r),h||(h=w.length>1),w}),ti(r,pc(r),a),h&&(a=Lr(a,D|I|T,Q0));for(var p=n.length;p--;)oc(a,n[p]);return a});function nw(r,n){return Hl(r,Lo(we(n)))}var sw=gi(function(r,n){return r==null?{}:R0(r,n)});function Hl(r,n){if(r==null)return{};var a=wt(pc(r),function(h){return[h]});return n=we(n),Uh(r,a,function(h,p){return n(h,p[0])})}function ow(r,n,a){n=Li(n,r);var h=-1,p=n.length;for(p||(p=1,r=t);++h<p;){var w=r==null?t:r[ri(n[h])];w===t&&(h=p,w=a),r=vi(w)?w.call(r):w}return r}function aw(r,n,a){return r==null?r:cs(r,n,a)}function cw(r,n,a,h){return h=typeof h=="function"?h:t,r==null?r:cs(r,n,a,h)}var Kl=rl(Vt),kl=rl(vr);function uw(r,n,a){var h=Re(r),p=h||ji(r)||Un(r);if(n=we(n,4),a==null){var w=r&&r.constructor;p?a=h?new w:[]:Dt(r)?a=vi(w)?An(uo(r)):{}:a={}}return(p?Nr:ei)(r,function(x,N,q){return n(a,x,N,q)}),a}function hw(r,n){return r==null?!0:oc(r,n)}function lw(r,n,a){return r==null?r:qh(r,n,uc(a))}function fw(r,n,a,h){return h=typeof h=="function"?h:t,r==null?r:qh(r,n,uc(a),h)}function $n(r){return r==null?[]:za(r,Vt(r))}function dw(r){return r==null?[]:za(r,vr(r))}function pw(r,n,a){return a===t&&(a=n,n=t),a!==t&&(a=qr(a),a=a===a?a:0),n!==t&&(n=qr(n),n=n===n?n:0),Zi(qr(r),n,a)}function gw(r,n,a){return n=mi(n),a===t?(a=n,n=0):a=mi(a),r=qr(r),b0(r,n,a)}function yw(r,n,a){if(a&&typeof a!="boolean"&&or(r,n,a)&&(n=a=t),a===t&&(typeof n=="boolean"?(a=n,n=t):typeof r=="boolean"&&(a=r,r=t)),r===t&&n===t?(r=0,n=1):(r=mi(r),n===t?(n=r,r=0):n=mi(n)),r>n){var h=r;r=n,n=h}if(a||r%1||n%1){var p=gh();return Xt(r+p*(n-r+ct("1e-"+((p+"").length-1))),n)}return ic(r,n)}var vw=Rn(function(r,n,a){return n=n.toLowerCase(),r+(a?Vl(n):n)});function Vl(r){return Ac(it(r).toLowerCase())}function Gl(r){return r=it(r),r&&r.replace(ui,ag).replace(Ra,"")}function mw(r,n,a){r=it(r),n=Sr(n);var h=r.length;a=a===t?h:Zi(je(a),0,h);var p=a;return a-=n.length,a>=0&&r.slice(a,p)==n}function ww(r){return r=it(r),r&&vt.test(r)?r.replace(Ki,cg):r}function _w(r){return r=it(r),r&&jt.test(r)?r.replace(Ot,"\\$&"):r}var bw=Rn(function(r,n,a){return r+(a?"-":"")+n.toLowerCase()}),Ew=Rn(function(r,n,a){return r+(a?" ":"")+n.toLowerCase()}),Dw=Jh("toLowerCase");function Sw(r,n,a){r=it(r),n=je(n);var h=n?In(r):0;if(!n||h>=n)return r;var p=(n-h)/2;return Oo(po(p),a)+r+Oo(fo(p),a)}function Iw(r,n,a){r=it(r),n=je(n);var h=n?In(r):0;return n&&h<n?r+Oo(n-h,a):r}function xw(r,n,a){r=it(r),n=je(n);var h=n?In(r):0;return n&&h<n?Oo(n-h,a)+r:r}function Ow(r,n,a){return a||n==null?n=0:n&&(n=+n),Ug(it(r).replace(Pt,""),n||0)}function Pw(r,n,a){return(a?or(r,n,a):n===t)?n=1:n=je(n),nc(it(r),n)}function Cw(){var r=arguments,n=it(r[0]);return r.length<3?n:n.replace(r[1],r[2])}var Aw=Rn(function(r,n,a){return r+(a?"_":"")+n.toLowerCase()});function Tw(r,n,a){return a&&typeof a!="number"&&or(r,n,a)&&(n=a=t),a=a===t?re:a>>>0,a?(r=it(r),r&&(typeof n=="string"||n!=null&&!Oc(n))&&(n=Sr(n),!n&&Sn(r))?Mi(Kr(r),0,a):r.split(n,a)):[]}var Rw=Rn(function(r,n,a){return r+(a?" ":"")+Ac(n)});function Nw(r,n,a){return r=it(r),a=a==null?0:Zi(je(a),0,r.length),n=Sr(n),r.slice(a,a+n.length)==n}function Uw(r,n,a){var h=v.templateSettings;a&&or(r,n,a)&&(n=t),r=it(r),n=qo({},n,h,il);var p=qo({},n.imports,h.imports,il),w=Vt(p),x=za(p,w),N,q,X=0,Z=n.interpolate||yn,ne="__p += '",he=Ha((n.escape||yn).source+"|"+Z.source+"|"+(Z===Et?ga:yn).source+"|"+(n.evaluate||yn).source+"|$","g"),ye="//# sourceURL="+(nt.call(n,"sourceURL")?(n.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Na+"]")+`
`;r.replace(he,function(De,Ge,Ze,xr,ar,Or){return Ze||(Ze=xr),ne+=r.slice(X,Or).replace(ba,ug),Ge&&(N=!0,ne+=`' +
__e(`+Ge+`) +
'`),ar&&(q=!0,ne+=`';
`+ar+`;
__p += '`),Ze&&(ne+=`' +
((__t = (`+Ze+`)) == null ? '' : __t) +
'`),X=Or+De.length,De}),ne+=`';
`;var Ee=nt.call(n,"variable")&&n.variable;if(!Ee)ne=`with (obj) {
`+ne+`
}
`;else if(da.test(Ee))throw new Ae(f);ne=(q?ne.replace(Qr,""):ne).replace(ir,"$1").replace(ci,"$1;"),ne="function("+(Ee||"obj")+`) {
`+(Ee?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(N?", __e = _.escape":"")+(q?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+ne+`return __p
}`;var ze=Yl(function(){return rt(w,ye+"return "+ne).apply(t,x)});if(ze.source=ne,xc(ze))throw ze;return ze}function $w(r){return it(r).toLowerCase()}function Lw(r){return it(r).toUpperCase()}function Mw(r,n,a){if(r=it(r),r&&(a||n===t))return nh(r);if(!r||!(n=Sr(n)))return r;var h=Kr(r),p=Kr(n),w=sh(h,p),x=oh(h,p)+1;return Mi(h,w,x).join("")}function jw(r,n,a){if(r=it(r),r&&(a||n===t))return r.slice(0,ch(r)+1);if(!r||!(n=Sr(n)))return r;var h=Kr(r),p=oh(h,Kr(n))+1;return Mi(h,0,p).join("")}function qw(r,n,a){if(r=it(r),r&&(a||n===t))return r.replace(Pt,"");if(!r||!(n=Sr(n)))return r;var h=Kr(r),p=sh(h,Kr(n));return Mi(h,p).join("")}function Fw(r,n){var a=W,h=se;if(Dt(n)){var p="separator"in n?n.separator:p;a="length"in n?je(n.length):a,h="omission"in n?Sr(n.omission):h}r=it(r);var w=r.length;if(Sn(r)){var x=Kr(r);w=x.length}if(a>=w)return r;var N=a-In(h);if(N<1)return h;var q=x?Mi(x,0,N).join(""):r.slice(0,N);if(p===t)return q+h;if(x&&(N+=q.length-N),Oc(p)){if(r.slice(N).search(p)){var X,Z=q;for(p.global||(p=Ha(p.source,it(Tr.exec(p))+"g")),p.lastIndex=0;X=p.exec(Z);)var ne=X.index;q=q.slice(0,ne===t?N:ne)}}else if(r.indexOf(Sr(p),N)!=N){var he=q.lastIndexOf(p);he>-1&&(q=q.slice(0,he))}return q+h}function zw(r){return r=it(r),r&&St.test(r)?r.replace(Pi,yg):r}var Bw=Rn(function(r,n,a){return r+(a?" ":"")+n.toUpperCase()}),Ac=Jh("toUpperCase");function Wl(r,n,a){return r=it(r),n=a?t:n,n===t?lg(r)?wg(r):rg(r):r.match(n)||[]}var Yl=Ke(function(r,n){try{return kt(r,t,n)}catch(a){return xc(a)?a:new Ae(a)}}),Hw=gi(function(r,n){return Nr(n,function(a){a=ri(a),di(r,a,Sc(r[a],r))}),r});function Kw(r){var n=r==null?0:r.length,a=we();return r=n?wt(r,function(h){if(typeof h[1]!="function")throw new Ur(d);return[a(h[0]),h[1]]}):[],Ke(function(h){for(var p=-1;++p<n;){var w=r[p];if(kt(w[0],this,h))return kt(w[1],this,h)}})}function kw(r){return y0(Lr(r,D))}function Tc(r){return function(){return r}}function Vw(r,n){return r==null||r!==r?n:r}var Gw=Xh(),Ww=Xh(!0);function mr(r){return r}function Rc(r){return Ph(typeof r=="function"?r:Lr(r,D))}function Yw(r){return Ah(Lr(r,D))}function Jw(r,n){return Th(r,Lr(n,D))}var Qw=Ke(function(r,n){return function(a){return os(a,r,n)}}),Xw=Ke(function(r,n){return function(a){return os(r,a,n)}});function Nc(r,n,a){var h=Vt(n),p=_o(n,h);a==null&&!(Dt(n)&&(p.length||!h.length))&&(a=n,n=r,r=this,p=_o(n,Vt(n)));var w=!(Dt(a)&&"chain"in a)||!!a.chain,x=vi(r);return Nr(p,function(N){var q=n[N];r[N]=q,x&&(r.prototype[N]=function(){var X=this.__chain__;if(w||X){var Z=r(this.__wrapped__),ne=Z.__actions__=gr(this.__actions__);return ne.push({func:q,args:arguments,thisArg:r}),Z.__chain__=X,Z}return q.apply(r,Ti([this.value()],arguments))})}),r}function Zw(){return Xe._===this&&(Xe._=Ig),this}function Uc(){}function e_(r){return r=je(r),Ke(function(n){return Rh(n,r)})}var t_=lc(wt),r_=lc(Zu),i_=lc(La);function Jl(r){return mc(r)?Ma(ri(r)):N0(r)}function n_(r){return function(n){return r==null?t:en(r,n)}}var s_=el(),o_=el(!0);function $c(){return[]}function Lc(){return!1}function a_(){return{}}function c_(){return""}function u_(){return!0}function h_(r,n){if(r=je(r),r<1||r>k)return[];var a=re,h=Xt(r,re);n=we(n),r-=re;for(var p=Fa(h,n);++a<r;)n(a);return p}function l_(r){return Re(r)?wt(r,ri):Ir(r)?[r]:gr(yl(it(r)))}function f_(r){var n=++Dg;return it(r)+n}var d_=xo(function(r,n){return r+n},0),p_=fc("ceil"),g_=xo(function(r,n){return r/n},1),y_=fc("floor");function v_(r){return r&&r.length?wo(r,mr,Qa):t}function m_(r,n){return r&&r.length?wo(r,we(n,2),Qa):t}function w_(r){return rh(r,mr)}function __(r,n){return rh(r,we(n,2))}function b_(r){return r&&r.length?wo(r,mr,tc):t}function E_(r,n){return r&&r.length?wo(r,we(n,2),tc):t}var D_=xo(function(r,n){return r*n},1),S_=fc("round"),I_=xo(function(r,n){return r-n},0);function x_(r){return r&&r.length?qa(r,mr):0}function O_(r,n){return r&&r.length?qa(r,we(n,2)):0}return v.after=Yv,v.ary=Ol,v.assign=Lm,v.assignIn=zl,v.assignInWith=qo,v.assignWith=Mm,v.at=jm,v.before=Pl,v.bind=Sc,v.bindAll=Hw,v.bindKey=Cl,v.castArray=am,v.chain=Sl,v.chunk=yy,v.compact=vy,v.concat=my,v.cond=Kw,v.conforms=kw,v.constant=Tc,v.countBy=xv,v.create=qm,v.curry=Al,v.curryRight=Tl,v.debounce=Rl,v.defaults=Fm,v.defaultsDeep=zm,v.defer=Jv,v.delay=Qv,v.difference=wy,v.differenceBy=_y,v.differenceWith=by,v.drop=Ey,v.dropRight=Dy,v.dropRightWhile=Sy,v.dropWhile=Iy,v.fill=xy,v.filter=Pv,v.flatMap=Tv,v.flatMapDeep=Rv,v.flatMapDepth=Nv,v.flatten=_l,v.flattenDeep=Oy,v.flattenDepth=Py,v.flip=Xv,v.flow=Gw,v.flowRight=Ww,v.fromPairs=Cy,v.functions=Wm,v.functionsIn=Ym,v.groupBy=Uv,v.initial=Ty,v.intersection=Ry,v.intersectionBy=Ny,v.intersectionWith=Uy,v.invert=Qm,v.invertBy=Xm,v.invokeMap=Lv,v.iteratee=Rc,v.keyBy=Mv,v.keys=Vt,v.keysIn=vr,v.map=No,v.mapKeys=ew,v.mapValues=tw,v.matches=Yw,v.matchesProperty=Jw,v.memoize=$o,v.merge=rw,v.mergeWith=Bl,v.method=Qw,v.methodOf=Xw,v.mixin=Nc,v.negate=Lo,v.nthArg=e_,v.omit=iw,v.omitBy=nw,v.once=Zv,v.orderBy=jv,v.over=t_,v.overArgs=em,v.overEvery=r_,v.overSome=i_,v.partial=Ic,v.partialRight=Nl,v.partition=qv,v.pick=sw,v.pickBy=Hl,v.property=Jl,v.propertyOf=n_,v.pull=jy,v.pullAll=El,v.pullAllBy=qy,v.pullAllWith=Fy,v.pullAt=zy,v.range=s_,v.rangeRight=o_,v.rearg=tm,v.reject=Bv,v.remove=By,v.rest=rm,v.reverse=Ec,v.sampleSize=Kv,v.set=aw,v.setWith=cw,v.shuffle=kv,v.slice=Hy,v.sortBy=Wv,v.sortedUniq=Jy,v.sortedUniqBy=Qy,v.split=Tw,v.spread=im,v.tail=Xy,v.take=Zy,v.takeRight=ev,v.takeRightWhile=tv,v.takeWhile=rv,v.tap=vv,v.throttle=nm,v.thru=Ro,v.toArray=jl,v.toPairs=Kl,v.toPairsIn=kl,v.toPath=l_,v.toPlainObject=Fl,v.transform=uw,v.unary=sm,v.union=iv,v.unionBy=nv,v.unionWith=sv,v.uniq=ov,v.uniqBy=av,v.uniqWith=cv,v.unset=hw,v.unzip=Dc,v.unzipWith=Dl,v.update=lw,v.updateWith=fw,v.values=$n,v.valuesIn=dw,v.without=uv,v.words=Wl,v.wrap=om,v.xor=hv,v.xorBy=lv,v.xorWith=fv,v.zip=dv,v.zipObject=pv,v.zipObjectDeep=gv,v.zipWith=yv,v.entries=Kl,v.entriesIn=kl,v.extend=zl,v.extendWith=qo,Nc(v,v),v.add=d_,v.attempt=Yl,v.camelCase=vw,v.capitalize=Vl,v.ceil=p_,v.clamp=pw,v.clone=cm,v.cloneDeep=hm,v.cloneDeepWith=lm,v.cloneWith=um,v.conformsTo=fm,v.deburr=Gl,v.defaultTo=Vw,v.divide=g_,v.endsWith=mw,v.eq=Vr,v.escape=ww,v.escapeRegExp=_w,v.every=Ov,v.find=Cv,v.findIndex=ml,v.findKey=Bm,v.findLast=Av,v.findLastIndex=wl,v.findLastKey=Hm,v.floor=y_,v.forEach=Il,v.forEachRight=xl,v.forIn=Km,v.forInRight=km,v.forOwn=Vm,v.forOwnRight=Gm,v.get=Pc,v.gt=dm,v.gte=pm,v.has=Jm,v.hasIn=Cc,v.head=bl,v.identity=mr,v.includes=$v,v.indexOf=Ay,v.inRange=gw,v.invoke=Zm,v.isArguments=nn,v.isArray=Re,v.isArrayBuffer=gm,v.isArrayLike=yr,v.isArrayLikeObject=Nt,v.isBoolean=ym,v.isBuffer=ji,v.isDate=vm,v.isElement=mm,v.isEmpty=wm,v.isEqual=_m,v.isEqualWith=bm,v.isError=xc,v.isFinite=Em,v.isFunction=vi,v.isInteger=Ul,v.isLength=Mo,v.isMap=$l,v.isMatch=Dm,v.isMatchWith=Sm,v.isNaN=Im,v.isNative=xm,v.isNil=Pm,v.isNull=Om,v.isNumber=Ll,v.isObject=Dt,v.isObjectLike=At,v.isPlainObject=fs,v.isRegExp=Oc,v.isSafeInteger=Cm,v.isSet=Ml,v.isString=jo,v.isSymbol=Ir,v.isTypedArray=Un,v.isUndefined=Am,v.isWeakMap=Tm,v.isWeakSet=Rm,v.join=$y,v.kebabCase=bw,v.last=jr,v.lastIndexOf=Ly,v.lowerCase=Ew,v.lowerFirst=Dw,v.lt=Nm,v.lte=Um,v.max=v_,v.maxBy=m_,v.mean=w_,v.meanBy=__,v.min=b_,v.minBy=E_,v.stubArray=$c,v.stubFalse=Lc,v.stubObject=a_,v.stubString=c_,v.stubTrue=u_,v.multiply=D_,v.nth=My,v.noConflict=Zw,v.noop=Uc,v.now=Uo,v.pad=Sw,v.padEnd=Iw,v.padStart=xw,v.parseInt=Ow,v.random=yw,v.reduce=Fv,v.reduceRight=zv,v.repeat=Pw,v.replace=Cw,v.result=ow,v.round=S_,v.runInContext=M,v.sample=Hv,v.size=Vv,v.snakeCase=Aw,v.some=Gv,v.sortedIndex=Ky,v.sortedIndexBy=ky,v.sortedIndexOf=Vy,v.sortedLastIndex=Gy,v.sortedLastIndexBy=Wy,v.sortedLastIndexOf=Yy,v.startCase=Rw,v.startsWith=Nw,v.subtract=I_,v.sum=x_,v.sumBy=O_,v.template=Uw,v.times=h_,v.toFinite=mi,v.toInteger=je,v.toLength=ql,v.toLower=$w,v.toNumber=qr,v.toSafeInteger=$m,v.toString=it,v.toUpper=Lw,v.trim=Mw,v.trimEnd=jw,v.trimStart=qw,v.truncate=Fw,v.unescape=zw,v.uniqueId=f_,v.upperCase=Bw,v.upperFirst=Ac,v.each=Il,v.eachRight=xl,v.first=bl,Nc(v,function(){var r={};return ei(v,function(n,a){nt.call(v.prototype,a)||(r[a]=n)}),r}(),{chain:!1}),v.VERSION=s,Nr(["bind","bindKey","curry","curryRight","partial","partialRight"],function(r){v[r].placeholder=v}),Nr(["drop","take"],function(r,n){Ye.prototype[r]=function(a){a=a===t?1:Kt(je(a),0);var h=this.__filtered__&&!n?new Ye(this):this.clone();return h.__filtered__?h.__takeCount__=Xt(a,h.__takeCount__):h.__views__.push({size:Xt(a,re),type:r+(h.__dir__<0?"Right":"")}),h},Ye.prototype[r+"Right"]=function(a){return this.reverse()[r](a).reverse()}}),Nr(["filter","map","takeWhile"],function(r,n){var a=n+1,h=a==b||a==ee;Ye.prototype[r]=function(p){var w=this.clone();return w.__iteratees__.push({iteratee:we(p,3),type:a}),w.__filtered__=w.__filtered__||h,w}}),Nr(["head","last"],function(r,n){var a="take"+(n?"Right":"");Ye.prototype[r]=function(){return this[a](1).value()[0]}}),Nr(["initial","tail"],function(r,n){var a="drop"+(n?"":"Right");Ye.prototype[r]=function(){return this.__filtered__?new Ye(this):this[a](1)}}),Ye.prototype.compact=function(){return this.filter(mr)},Ye.prototype.find=function(r){return this.filter(r).head()},Ye.prototype.findLast=function(r){return this.reverse().find(r)},Ye.prototype.invokeMap=Ke(function(r,n){return typeof r=="function"?new Ye(this):this.map(function(a){return os(a,r,n)})}),Ye.prototype.reject=function(r){return this.filter(Lo(we(r)))},Ye.prototype.slice=function(r,n){r=je(r);var a=this;return a.__filtered__&&(r>0||n<0)?new Ye(a):(r<0?a=a.takeRight(-r):r&&(a=a.drop(r)),n!==t&&(n=je(n),a=n<0?a.dropRight(-n):a.take(n-r)),a)},Ye.prototype.takeRightWhile=function(r){return this.reverse().takeWhile(r).reverse()},Ye.prototype.toArray=function(){return this.take(re)},ei(Ye.prototype,function(r,n){var a=/^(?:filter|find|map|reject)|While$/.test(n),h=/^(?:head|last)$/.test(n),p=v[h?"take"+(n=="last"?"Right":""):n],w=h||/^find/.test(n);p&&(v.prototype[n]=function(){var x=this.__wrapped__,N=h?[1]:arguments,q=x instanceof Ye,X=N[0],Z=q||Re(x),ne=function(Ge){var Ze=p.apply(v,Ti([Ge],N));return h&&he?Ze[0]:Ze};Z&&a&&typeof X=="function"&&X.length!=1&&(q=Z=!1);var he=this.__chain__,ye=!!this.__actions__.length,Ee=w&&!he,ze=q&&!ye;if(!w&&Z){x=ze?x:new Ye(this);var De=r.apply(x,N);return De.__actions__.push({func:Ro,args:[ne],thisArg:t}),new $r(De,he)}return Ee&&ze?r.apply(this,N):(De=this.thru(ne),Ee?h?De.value()[0]:De.value():De)})}),Nr(["pop","push","shift","sort","splice","unshift"],function(r){var n=io[r],a=/^(?:push|sort|unshift)$/.test(r)?"tap":"thru",h=/^(?:pop|shift)$/.test(r);v.prototype[r]=function(){var p=arguments;if(h&&!this.__chain__){var w=this.value();return n.apply(Re(w)?w:[],p)}return this[a](function(x){return n.apply(Re(x)?x:[],p)})}}),ei(Ye.prototype,function(r,n){var a=v[n];if(a){var h=a.name+"";nt.call(Cn,h)||(Cn[h]=[]),Cn[h].push({name:n,func:a})}}),Cn[Io(t,ie).name]=[{name:"wrapper",func:t}],Ye.prototype.clone=zg,Ye.prototype.reverse=Bg,Ye.prototype.value=Hg,v.prototype.at=mv,v.prototype.chain=wv,v.prototype.commit=_v,v.prototype.next=bv,v.prototype.plant=Dv,v.prototype.reverse=Sv,v.prototype.toJSON=v.prototype.valueOf=v.prototype.value=Iv,v.prototype.first=v.prototype.head,Zn&&(v.prototype[Zn]=Ev),v},xn=_g();Rt?((Rt.exports=xn)._=xn,ut._=xn):Xe._=xn}).call(ws)})(Iu,Iu.exports);var bI=Object.defineProperty,EI=Object.defineProperties,DI=Object.getOwnPropertyDescriptors,Pd=Object.getOwnPropertySymbols,SI=Object.prototype.hasOwnProperty,II=Object.prototype.propertyIsEnumerable,Cd=(i,e,t)=>e in i?bI(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,Ko=(i,e)=>{for(var t in e||(e={}))SI.call(e,t)&&Cd(i,t,e[t]);if(Pd)for(var t of Pd(e))II.call(e,t)&&Cd(i,t,e[t]);return i},xI=(i,e)=>EI(i,DI(e));function zi(i,e,t){var s;const o=wE(i);return((s=e.rpcMap)==null?void 0:s[o.reference])||`${_I}?chainId=${o.namespace}:${o.reference}&projectId=${t}`}function gn(i){return i.includes(":")?i.split(":")[1]:i}function Yp(i){return i.map(e=>`${e.split(":")[0]}:${e.split(":")[1]}`)}function OI(i,e){const t=Object.keys(e.namespaces).filter(o=>o.includes(i));if(!t.length)return[];const s=[];return t.forEach(o=>{const c=e.namespaces[o].accounts;s.push(...c)}),s}function Ad(i={},e={}){const t=Td(i),s=Td(e);return Iu.exports.merge(t,s)}function Td(i){var e,t,s,o;const c={};if(!Os(i))return c;for(const[d,f]of Object.entries(i)){const y=Bu(d)?[d]:f.chains,g=f.methods||[],m=f.events||[],D=f.rpcMap||{},I=_s(d);c[I]=xI(Ko(Ko({},c[I]),f),{chains:Bc(y,(e=c[I])==null?void 0:e.chains),methods:Bc(g,(t=c[I])==null?void 0:t.methods),events:Bc(m,(s=c[I])==null?void 0:s.events),rpcMap:Ko(Ko({},D),(o=c[I])==null?void 0:o.rpcMap)})}return c}function PI(i){return i.includes(":")?i.split(":")[2]:i}function CI(i){const e={};for(const[t,s]of Object.entries(i)){const o=s.methods||[],c=s.events||[],d=s.accounts||[],f=Bu(t)?[t]:s.chains?s.chains:Yp(s.accounts);e[t]={chains:f,methods:o,events:c,accounts:d}}return e}function ru(i){return typeof i=="number"?i:i.includes("0x")?parseInt(i,16):(i=i.includes(":")?i.split(":")[1]:i,isNaN(Number(i))?i:Number(i))}const Jp={},bt=i=>Jp[i],iu=(i,e)=>{Jp[i]=e};class AI{constructor(e){this.name="polkadot",this.namespace=e.namespace,this.events=bt("events"),this.client=bt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(Oi.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;const o=gn(t);e[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||zi(e,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new xi(new Hi(s,bt("disableProviderPing")))}}class TI{constructor(e){this.name="eip155",this.namespace=e.namespace,this.events=bt("events"),this.client=bt("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(e){switch(e.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(e);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(e.request.method)?await this.client.request(e):this.getHttpProvider().request(e.request)}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(parseInt(e),t),this.chainId=parseInt(e),this.events.emit(Oi.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}createHttpProvider(e,t){const s=t||zi(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new xi(new Hi(s,bt("disableProviderPing")))}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;const o=parseInt(gn(t));e[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}getHttpProvider(){const e=this.chainId,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}async handleSwitchChain(e){var t,s;let o=e.request.params?(t=e.request.params[0])==null?void 0:t.chainId:"0x0";o=o.startsWith("0x")?o:`0x${o}`;const c=parseInt(o,16);if(this.isChainApproved(c))this.setDefaultChain(`${c}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:e.topic,request:{method:e.request.method,params:[{chainId:o}]},chainId:(s=this.namespace.chains)==null?void 0:s[0]}),this.setDefaultChain(`${c}`);else throw new Error(`Failed to switch to chain 'eip155:${c}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(e){return this.namespace.chains.includes(`${this.name}:${e}`)}}class RI{constructor(e){this.name="solana",this.namespace=e.namespace,this.events=bt("events"),this.client=bt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(Oi.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;const o=gn(t);e[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||zi(e,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new xi(new Hi(s,bt("disableProviderPing")))}}class NI{constructor(e){this.name="cosmos",this.namespace=e.namespace,this.events=bt("events"),this.client=bt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(Oi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;const o=gn(t);e[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||zi(e,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new xi(new Hi(s,bt("disableProviderPing")))}}class UI{constructor(e){this.name="cip34",this.namespace=e.namespace,this.events=bt("events"),this.client=bt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(Oi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{const s=this.getCardanoRPCUrl(t),o=gn(t);e[o]=this.createHttpProvider(o,s)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}getCardanoRPCUrl(e){const t=this.namespace.rpcMap;if(t)return t[e]}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||this.getCardanoRPCUrl(e);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new xi(new Hi(s,bt("disableProviderPing")))}}class $I{constructor(e){this.name="elrond",this.namespace=e.namespace,this.events=bt("events"),this.client=bt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(Oi.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;const o=gn(t);e[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||zi(e,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new xi(new Hi(s,bt("disableProviderPing")))}}class LI{constructor(e){this.name="multiversx",this.namespace=e.namespace,this.events=bt("events"),this.client=bt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(Oi.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;const o=gn(t);e[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||zi(e,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new xi(new Hi(s,bt("disableProviderPing")))}}class MI{constructor(e){this.name="near",this.namespace=e.namespace,this.events=bt("events"),this.client=bt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){const s=t||zi(`${this.name}:${e}`,this.namespace);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,s)}this.events.emit(Oi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;e[t]=this.createHttpProvider(t,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||zi(e,this.namespace);return typeof s>"u"?void 0:new xi(new Hi(s,bt("disableProviderPing")))}}var jI=Object.defineProperty,qI=Object.defineProperties,FI=Object.getOwnPropertyDescriptors,Rd=Object.getOwnPropertySymbols,zI=Object.prototype.hasOwnProperty,BI=Object.prototype.propertyIsEnumerable,Nd=(i,e,t)=>e in i?jI(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,ko=(i,e)=>{for(var t in e||(e={}))zI.call(e,t)&&Nd(i,t,e[t]);if(Rd)for(var t of Rd(e))BI.call(e,t)&&Nd(i,t,e[t]);return i},nu=(i,e)=>qI(i,FI(e));class Qu{constructor(e){this.events=new Tu,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=e,this.logger=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:Je.pino(Je.getDefaultLoggerOptions({level:(e==null?void 0:e.logger)||xd})),this.disableProviderPing=(e==null?void 0:e.disableProviderPing)||!1}static async init(e){const t=new Qu(e);return await t.initialize(),t}async request(e,t,s){const[o,c]=this.validateChain(t);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(o).request({request:ko({},e),chainId:`${o}:${c}`,topic:this.session.topic,expiry:s})}sendAsync(e,t,s,o){const c=new Date().getTime();this.request(e,s,o).then(d=>t(null,ca(c,d))).catch(d=>t(d,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var e;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(e=this.session)==null?void 0:e.topic,reason:_t("USER_DISCONNECTED")}),await this.cleanup()}async connect(e){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(e),await this.cleanupPendingPairings(),!e.skipPairing)return await this.pair(e.pairingTopic)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}removeListener(e,t){this.events.removeListener(e,t)}off(e,t){this.events.off(e,t)}get isWalletConnect(){return!0}async pair(e){this.shouldAbortPairingAttempt=!1;let t=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(t>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:s,approval:o}=await this.client.connect({pairingTopic:e,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});s&&(this.uri=s,this.events.emit("display_uri",s)),await o().then(c=>{this.session=c;const d=CI(c.namespaces);this.namespaces=Ad(this.namespaces,d),this.persist("namespaces",this.namespaces)}).catch(c=>{if(c.message!==Gp)throw c;t++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(e,t){try{if(!this.session)return;const[s,o]=this.validateChain(e);this.getProvider(s).setDefaultChain(o,t)}catch(s){if(!/Please call connect/.test(s.message))throw s}}async cleanupPendingPairings(e={}){this.logger.info("Cleaning up inactive pairings...");const t=this.client.pairing.getAll();if(oi(t)){for(const s of t)e.deletePairings?this.client.core.expirer.set(s.topic,0):await this.client.core.relayer.subscriber.unsubscribe(s.topic);this.logger.info(`Inactive pairings cleared: ${t.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const e=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[e]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await dI.init({logger:this.providerOpts.logger||xd,relayUrl:this.providerOpts.relayUrl||vI,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const e=[...new Set(Object.keys(this.session.namespaces).map(t=>_s(t)))];iu("client",this.client),iu("events",this.events),iu("disableProviderPing",this.disableProviderPing),e.forEach(t=>{if(!this.session)return;const s=OI(t,this.session),o=Yp(s),c=Ad(this.namespaces,this.optionalNamespaces),d=nu(ko({},c[t]),{accounts:s,chains:o});switch(t){case"eip155":this.rpcProviders[t]=new TI({namespace:d});break;case"solana":this.rpcProviders[t]=new RI({namespace:d});break;case"cosmos":this.rpcProviders[t]=new NI({namespace:d});break;case"polkadot":this.rpcProviders[t]=new AI({namespace:d});break;case"cip34":this.rpcProviders[t]=new UI({namespace:d});break;case"elrond":this.rpcProviders[t]=new $I({namespace:d});break;case"multiversx":this.rpcProviders[t]=new LI({namespace:d});break;case"near":this.rpcProviders[t]=new MI({namespace:d});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",e=>{this.events.emit("session_ping",e)}),this.client.on("session_event",e=>{const{params:t}=e,{event:s}=t;if(s.name==="accountsChanged"){const o=s.data;o&&oi(o)&&this.events.emit("accountsChanged",o.map(PI))}else if(s.name==="chainChanged"){const o=t.chainId,c=t.event.data,d=_s(o),f=ru(o)!==ru(c)?`${d}:${ru(c)}`:o;this.onChainChanged(f)}else this.events.emit(s.name,s.data);this.events.emit("session_event",e)}),this.client.on("session_update",({topic:e,params:t})=>{var s;const{namespaces:o}=t,c=(s=this.client)==null?void 0:s.session.get(e);this.session=nu(ko({},c),{namespaces:o}),this.onSessionUpdate(),this.events.emit("session_update",{topic:e,params:t})}),this.client.on("session_delete",async e=>{await this.cleanup(),this.events.emit("session_delete",e),this.events.emit("disconnect",nu(ko({},_t("USER_DISCONNECTED")),{data:e.topic}))}),this.on(Oi.DEFAULT_CHAIN_CHANGED,e=>{this.onChainChanged(e,!0)})}getProvider(e){if(!this.rpcProviders[e])throw new Error(`Provider not found: ${e}`);return this.rpcProviders[e]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(e=>{var t;this.getProvider(e).updateNamespace((t=this.session)==null?void 0:t.namespaces[e])})}setNamespaces(e){const{namespaces:t,optionalNamespaces:s,sessionProperties:o}=e;t&&Object.keys(t).length&&(this.namespaces=t),s&&Object.keys(s).length&&(this.optionalNamespaces=s),this.sessionProperties=o,this.persist("namespaces",t),this.persist("optionalNamespaces",s)}validateChain(e){const[t,s]=(e==null?void 0:e.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[t,s];if(t&&!Object.keys(this.namespaces||{}).map(d=>_s(d)).includes(t))throw new Error(`Namespace '${t}' is not configured. Please call connect() first with namespace config.`);if(t&&s)return[t,s];const o=_s(Object.keys(this.namespaces)[0]),c=this.rpcProviders[o].getDefaultChain();return[o,c]}async requestAccounts(){const[e]=this.validateChain();return await this.getProvider(e).requestAccounts()}onChainChanged(e,t=!1){if(!this.namespaces)return;const[s,o]=this.validateChain(e);o&&(t||this.getProvider(s).setDefaultChain(o),this.namespaces[s]?this.namespaces[s].defaultChain=o:this.namespaces[`${s}:${o}`]?this.namespaces[`${s}:${o}`].defaultChain=o:this.namespaces[`${s}:${o}`]={defaultChain:o},this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",o))}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(e,t){this.client.core.storage.setItem(`${Od}/${e}`,t)}async getFromStore(e){return await this.client.core.storage.getItem(`${Od}/${e}`)}}const HI=Qu,KI="wc",kI="ethereum_provider",VI=`${KI}@2:${kI}:`,GI="https://rpc.walletconnect.com/v1/",xu=["eth_sendTransaction","personal_sign"],WI=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],Ou=["chainChanged","accountsChanged"],YI=["chainChanged","accountsChanged","message","disconnect","connect"];var JI=Object.defineProperty,QI=Object.defineProperties,XI=Object.getOwnPropertyDescriptors,Ud=Object.getOwnPropertySymbols,ZI=Object.prototype.hasOwnProperty,e5=Object.prototype.propertyIsEnumerable,$d=(i,e,t)=>e in i?JI(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,Es=(i,e)=>{for(var t in e||(e={}))ZI.call(e,t)&&$d(i,t,e[t]);if(Ud)for(var t of Ud(e))e5.call(e,t)&&$d(i,t,e[t]);return i},Ld=(i,e)=>QI(i,XI(e));function ta(i){return Number(i[0].split(":")[1])}function su(i){return`0x${i.toString(16)}`}function t5(i){const{chains:e,optionalChains:t,methods:s,optionalMethods:o,events:c,optionalEvents:d,rpcMap:f}=i;if(!oi(e))throw new Error("Invalid chains");const y={chains:e,methods:s||xu,events:c||Ou,rpcMap:Es({},e.length?{[ta(e)]:f[ta(e)]}:{})},g=c==null?void 0:c.filter(T=>!Ou.includes(T)),m=s==null?void 0:s.filter(T=>!xu.includes(T));if(!t&&!d&&!o&&!(g!=null&&g.length)&&!(m!=null&&m.length))return{required:e.length?y:void 0};const D=(g==null?void 0:g.length)&&(m==null?void 0:m.length)||!t,I={chains:[...new Set(D?y.chains.concat(t||[]):t)],methods:[...new Set(y.methods.concat(o!=null&&o.length?o:WI))],events:[...new Set(y.events.concat(d!=null&&d.length?d:YI))],rpcMap:f};return{required:e.length?y:void 0,optional:t.length?I:void 0}}class Xu{constructor(){this.events=new zr.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=VI,this.on=(e,t)=>(this.events.on(e,t),this),this.once=(e,t)=>(this.events.once(e,t),this),this.removeListener=(e,t)=>(this.events.removeListener(e,t),this),this.off=(e,t)=>(this.events.off(e,t),this),this.parseAccount=e=>this.isCompatibleChainId(e)?this.parseAccountId(e).address:e,this.signer={},this.rpc={}}static async init(e){const t=new Xu;return await t.initialize(e),t}async request(e,t){return await this.signer.request(e,this.formatChainId(this.chainId),t)}sendAsync(e,t,s){this.signer.sendAsync(e,t,this.formatChainId(this.chainId),s)}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(e){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(e);const{required:t,optional:s}=t5(this.rpc);try{const o=await new Promise(async(d,f)=>{var y;this.rpc.showQrModal&&((y=this.modal)==null||y.subscribeModal(g=>{!g.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),f(new Error("Connection request reset. Please try again.")))})),await this.signer.connect(Ld(Es({namespaces:Es({},t&&{[this.namespace]:t})},s&&{optionalNamespaces:{[this.namespace]:s}}),{pairingTopic:e==null?void 0:e.pairingTopic})).then(g=>{d(g)}).catch(g=>{f(new Error(g.message))})});if(!o)return;const c=_E(o.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:c),this.setAccounts(c),this.events.emit("connect",{chainId:su(this.chainId)})}catch(o){throw this.signer.logger.error(o),o}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",e=>{const{params:t}=e,{event:s}=t;s.name==="accountsChanged"?(this.accounts=this.parseAccounts(s.data),this.events.emit("accountsChanged",this.accounts)):s.name==="chainChanged"?this.setChainId(this.formatChainId(s.data)):this.events.emit(s.name,s.data),this.events.emit("session_event",e)}),this.signer.on("chainChanged",e=>{const t=parseInt(e);this.chainId=t,this.events.emit("chainChanged",su(this.chainId)),this.persist()}),this.signer.on("session_update",e=>{this.events.emit("session_update",e)}),this.signer.on("session_delete",e=>{this.reset(),this.events.emit("session_delete",e),this.events.emit("disconnect",Ld(Es({},_t("USER_DISCONNECTED")),{data:e.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",e=>{var t,s;this.rpc.showQrModal&&((t=this.modal)==null||t.closeModal(),(s=this.modal)==null||s.openModal({uri:e})),this.events.emit("display_uri",e)})}switchEthereumChain(e){this.request({method:"wallet_switchEthereumChain",params:[{chainId:e.toString(16)}]})}isCompatibleChainId(e){return typeof e=="string"?e.startsWith(`${this.namespace}:`):!1}formatChainId(e){return`${this.namespace}:${e}`}parseChainId(e){return Number(e.split(":")[1])}setChainIds(e){const t=e.filter(s=>this.isCompatibleChainId(s)).map(s=>this.parseChainId(s));t.length&&(this.chainId=t[0],this.events.emit("chainChanged",su(this.chainId)),this.persist())}setChainId(e){if(this.isCompatibleChainId(e)){const t=this.parseChainId(e);this.chainId=t,this.switchEthereumChain(t)}}parseAccountId(e){const[t,s,o]=e.split(":");return{chainId:`${t}:${s}`,address:o}}setAccounts(e){this.accounts=e.filter(t=>this.parseChainId(this.parseAccountId(t).chainId)===this.chainId).map(t=>this.parseAccountId(t).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(e){var t,s;const o=(t=e==null?void 0:e.chains)!=null?t:[],c=(s=e==null?void 0:e.optionalChains)!=null?s:[],d=o.concat(c);if(!d.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const f=o.length?(e==null?void 0:e.methods)||xu:[],y=o.length?(e==null?void 0:e.events)||Ou:[],g=(e==null?void 0:e.optionalMethods)||[],m=(e==null?void 0:e.optionalEvents)||[],D=(e==null?void 0:e.rpcMap)||this.buildRpcMap(d,e.projectId),I=(e==null?void 0:e.qrModalOptions)||void 0;return{chains:o==null?void 0:o.map(T=>this.formatChainId(T)),optionalChains:c.map(T=>this.formatChainId(T)),methods:f,events:y,optionalMethods:g,optionalEvents:m,rpcMap:D,showQrModal:!!(e!=null&&e.showQrModal),qrModalOptions:I,projectId:e.projectId,metadata:e.metadata}}buildRpcMap(e,t){const s={};return e.forEach(o=>{s[o]=this.getRpcUrl(o,t)}),s}async initialize(e){if(this.rpc=this.getRpcConfig(e),this.chainId=this.rpc.chains.length?ta(this.rpc.chains):ta(this.rpc.optionalChains),this.signer=await HI.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:e.disableProviderPing,relayUrl:e.relayUrl,storageOptions:e.storageOptions}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let t;try{const{WalletConnectModal:s}=await P_(()=>import("./index-BWInxmV3.js").then(o=>o.i),__vite__mapDeps([0,1,2]),import.meta.url);t=s}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(t)try{this.modal=new t(Es({projectId:this.rpc.projectId},this.rpc.qrModalOptions))}catch(s){throw this.signer.logger.error(s),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(e){if(!e)return;const{chains:t,optionalChains:s,rpcMap:o}=e;t&&oi(t)&&(this.rpc.chains=t.map(c=>this.formatChainId(c)),t.forEach(c=>{this.rpc.rpcMap[c]=(o==null?void 0:o[c])||this.getRpcUrl(c)})),s&&oi(s)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=s==null?void 0:s.map(c=>this.formatChainId(c)),s.forEach(c=>{this.rpc.rpcMap[c]=(o==null?void 0:o[c])||this.getRpcUrl(c)}))}getRpcUrl(e,t){var s;return((s=this.rpc.rpcMap)==null?void 0:s[e])||`${GI}?chainId=eip155:${e}&projectId=${t||this.rpc.projectId}`}async loadPersistedSession(){if(!this.session)return;const e=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),t=this.session.namespaces[`${this.namespace}:${e}`]?this.session.namespaces[`${this.namespace}:${e}`]:this.session.namespaces[this.namespace];this.setChainIds(e?[this.formatChainId(e)]:t==null?void 0:t.accounts),this.setAccounts(t==null?void 0:t.accounts)}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(e){return typeof e=="string"||e instanceof String?[this.parseAccount(e)]:e.map(t=>this.parseAccount(t))}}const _5=Xu;export{_5 as EthereumProvider,YI as OPTIONAL_EVENTS,WI as OPTIONAL_METHODS,Ou as REQUIRED_EVENTS,xu as REQUIRED_METHODS,Xu as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["./index-BWInxmV3.js","./index-DvzIrRmi.js","./index-FR7z6tA6.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
